<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./src/defaults.css">
    <script src="./dist/index.js"></script> 
</head>
<body>
    
</body>
<script type="module">

    // import * as visualscript from "./dist/index.esm.js"
    console.log(visualscript)

    // ---------------- Create Processs ----------------
    const parent = new visualscript.Process(null, null, true)
    const upstream = new visualscript.Process(null, null, true)
    const func = (input, self) => {
        return input + self.get('increment')?.value
    }
    const internal = new visualscript.Process(func, null, true)
    const downstream = new visualscript.Process((input, self) => {
        const output = input + 1
        document.body.insertAdjacentHTML(`beforeend`, `<p>Output: ${output}</p>`)
        return output
    }, null, true)

    // ---------------- Set Upstream Functions ----------------
    upstream.set('increment', 1)
    const functionProcess = upstream.set('function', func) // or upstream.get('function')
    const processProcess = upstream.set('process', internal)

    // ---------------- Subscribe to Upstream ----------------
    functionProcess.subscribe(downstream)
    processProcess.subscribe(downstream)
    downstream.subscribe(upstream.get('increment')) // change incrementer

    // ---------------- Populate Parent ----------------
    parent.set('upstream', upstream)
    parent.set('downstream', downstream)

    // ---------------- Push Values to Upstream ----------------
    const input = 2
    await functionProcess.push(input)
    await processProcess.push(input)
    
    console.log(parent)

    // ---------------- Visualize ----------------
    const editor = new visualscript.ui.Editor(parent)
    editor.toggleDisplay()

</script>
</html>