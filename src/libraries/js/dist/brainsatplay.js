/*! For license information please see brainsatplay.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.brainsatplay=e():t.brainsatplay=e()}(this,(function(){return(()=>{var t={9954:(t,e,n)=>{parcelRequire=function(e,r,i,o){var s,a="function"==typeof parcelRequire&&parcelRequire;function u(t,i){if(!r[t]){if(!e[t]){var o="function"==typeof parcelRequire&&parcelRequire;if(!i&&o)return o(t,!0);if(a)return a(t,!0);if("string"==typeof t)return n(1308)(t);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}l.resolve=function(n){return e[t][1][n]||n},l.cache={};var c=r[t]=new u.Module(t);e[t][0].call(c.exports,l,c,c.exports,this)}return r[t].exports;function l(t){return u(l.resolve(t))}}u.isParcelRequire=!0,u.Module=function(t){this.id=t,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=a,u.register=function(t,n){e[t]=[function(t,e){e.exports=n},{}]};for(var c=0;c<i.length;c++)try{u(i[c])}catch(e){s||(s=e)}if(i.length){var l=u(i[i.length-1]);t.exports=l}if(parcelRequire=u,s)throw s;return u}({vCxL:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.__extends=function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n.__rest=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n},n.__decorate=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},n.__param=function(t,e){return function(n,r){e(n,r,t)}},n.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},n.__awaiter=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},n.__generator=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},n.__exportStar=function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])},n.__values=o,n.__read=s,n.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},n.__await=a,n.__asyncGenerator=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||u(t,e)}))})}function u(t,e){try{(n=i[t](e)).value instanceof a?Promise.resolve(n.value.v).then(c,l):h(o[0][2],n)}catch(t){h(o[0][3],t)}var n}function c(t){u("next",t)}function l(t){u("throw",t)}function h(t,e){t(e),o.shift(),o.length&&u(o[0][0],o[0][1])}},n.__asyncDelegator=function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:a(t[r](e)),done:"return"===r}:i?i(e):e}:i}},n.__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=o(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}},n.__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},n.__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},n.__importDefault=function(t){return t&&t.__esModule?t:{default:t}},n.__assign=void 0;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},i=function(){return n.__assign=i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)};function o(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(t){return this instanceof a?(this.v=t,this):new a(t)}n.__assign=i},{}],Qnsq:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isFunction=function(t){return"function"==typeof t}},{}],Q3iD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.config=void 0;var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack,r=t},get useDeprecatedSynchronousErrorHandling(){return r}};n.config=i},{}],JfKC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hostReportError=function(t){setTimeout((function(){throw t}),0)}},{}],wIlR:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.empty=void 0;var r=t("./config"),i=t("./util/hostReportError"),o={closed:!0,next:function(t){},error:function(t){if(r.config.useDeprecatedSynchronousErrorHandling)throw t;(0,i.hostReportError)(t)},complete:function(){}};n.empty=o},{"./config":"Q3iD","./util/hostReportError":"JfKC"}],KeTG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isArray=void 0;var r=Array.isArray||function(t){return t&&"number"==typeof t.length};n.isArray=r},{}],nU7r:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isObject=function(t){return null!==t&&"object"==typeof t}},{}],pMaL:[function(t,e,n){"use strict";function r(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}Object.defineProperty(n,"__esModule",{value:!0}),n.UnsubscriptionError=void 0,r.prototype=Object.create(Error.prototype);var i=r;n.UnsubscriptionError=i},{}],I8KM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Subscription=void 0;var r=t("./util/isArray"),i=t("./util/isObject"),o=t("./util/isFunction"),s=t("./util/UnsubscriptionError"),a=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this._parentOrParents,a=this._unsubscribe,c=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var l=0;l<n.length;++l)n[l].remove(this);if((0,o.isFunction)(a))try{a.call(this)}catch(t){e=t instanceof s.UnsubscriptionError?u(t.errors):[t]}if((0,r.isArray)(c)){l=-1;for(var h=c.length;++l<h;){var f=c[l];if((0,i.isObject)(f))try{f.unsubscribe()}catch(t){e=e||[],t instanceof s.UnsubscriptionError?e=e.concat(u(t.errors)):e.push(t)}}}if(e)throw new s.UnsubscriptionError(e)}},t.prototype.add=function(e){var n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:if(!e)return t.EMPTY;throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function u(t){return t.reduce((function(t,e){return t.concat(e instanceof s.UnsubscriptionError?e.errors:e)}),[])}n.Subscription=a},{"./util/isArray":"KeTG","./util/isObject":"nU7r","./util/isFunction":"Qnsq","./util/UnsubscriptionError":"pMaL"}],yAZp:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.$$rxSubscriber=n.rxSubscriber=void 0;var r="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();n.rxSubscriber=r;var i=r;n.$$rxSubscriber=i},{}],RaFB:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SafeSubscriber=n.Subscriber=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./util/isFunction"),o=t("./Observer"),s=t("./Subscription"),a=t("../internal/symbol/rxSubscriber"),u=t("./config"),c=t("./util/hostReportError");function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}var h=function(t){function e(n,r,i){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=o.empty;break;case 1:if(!n){s.destination=o.empty;break}if("object"==typeof n){n instanceof e?(s.syncErrorThrowable=n.syncErrorThrowable,s.destination=n,n.add(s)):(s.syncErrorThrowable=!0,s.destination=new f(s,n));break}default:s.syncErrorThrowable=!0,s.destination=new f(s,n,r,i)}return s}return r.__extends(e,t),e.prototype[a.rxSubscriber]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(s.Subscription);n.Subscriber=h;var f=function(t){function e(e,n,r,s){var a,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return(0,i.isFunction)(n)?a=n:n&&(a=n.next,r=n.error,s=n.complete,n!==o.empty&&(c=Object.create(n),(0,i.isFunction)(c.unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=a,u._error=r,u._complete=s,u}return r.__extends(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=u.config.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,c.hostReportError)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,c.hostReportError)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};u.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),u.config.useDeprecatedSynchronousErrorHandling)throw t;(0,c.hostReportError)(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!u.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return u.config.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):((0,c.hostReportError)(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(h);n.SafeSubscriber=f},{tslib:"vCxL","./util/isFunction":"Qnsq","./Observer":"wIlR","./Subscription":"I8KM","../internal/symbol/rxSubscriber":"yAZp","./config":"Q3iD","./util/hostReportError":"JfKC"}],wHmS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.canReportError=function(t){for(;t;){var e=t,n=e.closed,i=e.destination,o=e.isStopped;if(n||o)return!1;t=i&&i instanceof r.Subscriber?i:null}return!0};var r=t("../Subscriber")},{"../Subscriber":"RaFB"}],SEU0:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toSubscriber=function(t,e,n){if(t){if(t instanceof r.Subscriber)return t;if(t[i.rxSubscriber])return t[i.rxSubscriber]()}return t||e||n?new r.Subscriber(t,e,n):new r.Subscriber(o.empty)};var r=t("../Subscriber"),i=t("../symbol/rxSubscriber"),o=t("../Observer")},{"../Subscriber":"RaFB","../symbol/rxSubscriber":"yAZp","../Observer":"wIlR"}],tjV3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.observable=void 0;var r="function"==typeof Symbol&&Symbol.observable||"@@observable";n.observable=r},{}],rXfM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.noop=function(){}},{}],HQCS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i(t)},n.pipeFromArray=i;var r=t("./noop");function i(t){return t?1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}:r.noop}},{"./noop":"rXfM"}],wbSE:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Observable=void 0;var r=t("./util/canReportError"),i=t("./util/toSubscriber"),o=t("./symbol/observable"),s=t("./util/pipe"),a=t("./config"),u=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=(0,i.toSubscriber)(t,e,n);if(r?o.add(r.call(o,this.source)):o.add(this.source||a.config.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),a.config.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){a.config.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),(0,r.canReportError)(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=c(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(t){r(t),i&&i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[o.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:(0,s.pipeFromArray)(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=c(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function c(t){if(t||(t=a.config.Promise||Promise),!t)throw new Error("no Promise impl found");return t}n.Observable=u},{"./util/canReportError":"wHmS","./util/toSubscriber":"SEU0","./symbol/observable":"tjV3","./util/pipe":"HQCS","./config":"Q3iD"}],xQEi:[function(t,e,n){"use strict";function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}Object.defineProperty(n,"__esModule",{value:!0}),n.ObjectUnsubscribedError=void 0,r.prototype=Object.create(Error.prototype);var i=r;n.ObjectUnsubscribedError=i},{}],fyc3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SubjectSubscription=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return r.__extends(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(t("./Subscription").Subscription);n.SubjectSubscription=o},{tslib:"vCxL","./Subscription":"I8KM"}],r9t1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AnonymousSubject=n.Subject=n.SubjectSubscriber=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./Observable"),o=t("./Subscriber"),s=t("./Subscription"),a=t("./util/ObjectUnsubscribedError"),u=t("./SubjectSubscription"),c=t("../internal/symbol/rxSubscriber");function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}var h=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return r.__extends(e,t),e}(o.Subscriber);n.SubjectSubscriber=h;var f=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.__extends(e,t),e.prototype[c.rxSubscriber]=function(){return new h(this)},e.prototype.lift=function(t){var e=new p(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),s.Subscription.EMPTY):this.isStopped?(t.complete(),s.Subscription.EMPTY):(this.observers.push(t),new u.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new i.Observable;return t.source=this,t},e.create=function(t,e){return new p(t,e)},e}(i.Observable);n.Subject=f;var p=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return r.__extends(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):s.Subscription.EMPTY},e}(f);n.AnonymousSubject=p},{tslib:"vCxL","./Observable":"wbSE","./Subscriber":"RaFB","./Subscription":"I8KM","./util/ObjectUnsubscribedError":"xQEi","./SubjectSubscription":"fyc3","../internal/symbol/rxSubscriber":"yAZp"}],vT9o:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.refCount=function(){return function(t){return t.lift(new s(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new a(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return r.__extends(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],kkfD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.connectableObservableDescriptor=n.ConnectableObservable=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../Observable"),s=t("../Subscriber"),a=t("../Subscription"),u=t("../operators/refCount");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return r.__extends(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new a.Subscription).add(this.source.subscribe(new p(this.getSubject(),this))),t.closed&&(this._connection=null,t=a.Subscription.EMPTY)),t},e.prototype.refCount=function(){return(0,u.refCount)()(this)},e}(o.Observable);n.ConnectableObservable=l;var h=l.prototype,f={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:h._subscribe},_isComplete:{value:h._isComplete,writable:!0},getSubject:{value:h.getSubject},connect:{value:h.connect},refCount:{value:h.refCount}};n.connectableObservableDescriptor=f;var p=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return r.__extends(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(i.SubjectSubscriber);!function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}r.__extends(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}(s.Subscriber)},{tslib:"vCxL","../Subject":"r9t1","../Observable":"wbSE","../Subscriber":"RaFB","../Subscription":"I8KM","../operators/refCount":"vT9o"}],dNgG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.groupBy=function(t,e,n,r){return function(i){return i.lift(new c(t,e,n,r))}},n.GroupedObservable=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../Subscription"),s=t("../Observable"),a=t("../Subject");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var c=function(){function t(t,e,n,r){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=r}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),l=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.keySelector=n,s.elementSelector=r,s.durationSelector=i,s.subjectSelector=o,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return r.__extends(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},e.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var r,i=n.get(e);if(this.elementSelector)try{r=this.elementSelector(t)}catch(t){this.error(t)}else r=t;if(!i){i=this.subjectSelector?this.subjectSelector():new a.Subject,n.set(e,i);var o=new f(e,i,this);if(this.destination.next(o),this.durationSelector){var s=void 0;try{s=this.durationSelector(new f(e,i))}catch(t){return void this.error(t)}this.add(s.subscribe(new h(e,i,this)))}}i.closed||i.next(r)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach((function(e,n){e.error(t)})),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach((function(t,e){t.complete()})),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(i.Subscriber),h=function(t){function e(e,n,r){var i=t.call(this,n)||this;return i.key=e,i.group=n,i.parent=r,i}return r.__extends(e,t),e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},e}(i.Subscriber),f=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.groupSubject=n,i.refCountSubscription=r,i}return r.__extends(e,t),e.prototype._subscribe=function(t){var e=new o.Subscription,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&e.add(new p(n)),e.add(r.subscribe(t)),e},e}(s.Observable);n.GroupedObservable=f;var p=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,e.count++,n}return r.__extends(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(o.Subscription)},{tslib:"vCxL","../Subscriber":"RaFB","../Subscription":"I8KM","../Observable":"wbSE","../Subject":"r9t1"}],MPU6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BehaviorSubject=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./Subject"),o=t("./util/ObjectUnsubscribedError");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return r.__extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(i.Subject);n.BehaviorSubject=a},{tslib:"vCxL","./Subject":"r9t1","./util/ObjectUnsubscribedError":"xQEi"}],arqX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Action=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(e,n){return t.call(this)||this}return r.__extends(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(t("../Subscription").Subscription);n.Action=o},{tslib:"vCxL","../Subscription":"I8KM"}],llYF:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AsyncAction=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return r.__extends(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(t("./Action").Action);n.AsyncAction=o},{tslib:"vCxL","./Action":"arqX"}],pLkv:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.QueueAction=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.__extends(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(t("./AsyncAction").AsyncAction);n.QueueAction=o},{tslib:"vCxL","./AsyncAction":"llYF"}],QglZ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Scheduler=void 0;var r=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}();n.Scheduler=r},{}],hnPK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AsyncScheduler=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Scheduler");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(t){function e(n,r){void 0===r&&(r=i.Scheduler.now);var o=t.call(this,n,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return r.__extends(e,t),e.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,i):t.prototype.schedule.call(this,n,r,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(i.Scheduler);n.AsyncScheduler=s},{tslib:"vCxL","../Scheduler":"QglZ"}],j0lZ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.QueueScheduler=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(t("./AsyncScheduler").AsyncScheduler);n.QueueScheduler=o},{tslib:"vCxL","./AsyncScheduler":"hnPK"}],HGOP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.queue=void 0;var r=t("./QueueAction"),i=new(t("./QueueScheduler").QueueScheduler)(r.QueueAction);n.queue=i},{"./QueueAction":"pLkv","./QueueScheduler":"j0lZ"}],XsKQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.empty=function(t){return t?o(t):i},n.EMPTY=void 0;var r=t("../Observable"),i=new r.Observable((function(t){return t.complete()}));function o(t){return new r.Observable((function(e){return t.schedule((function(){return e.complete()}))}))}n.EMPTY=i},{"../Observable":"wbSE"}],VqoH:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isScheduler=function(t){return t&&"function"==typeof t.schedule}},{}],lrFe:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeToArray=void 0,n.subscribeToArray=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}}},{}],ZGwk:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.scheduleArray=function(t,e){return new r.Observable((function(n){var r=new i.Subscription,o=0;return r.add(e.schedule((function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))};var r=t("../Observable"),i=t("../Subscription")},{"../Observable":"wbSE","../Subscription":"I8KM"}],PJGF:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fromArray=function(t,e){return e?(0,o.scheduleArray)(t,e):new r.Observable((0,i.subscribeToArray)(t))};var r=t("../Observable"),i=t("../util/subscribeToArray"),o=t("../scheduled/scheduleArray")},{"../Observable":"wbSE","../util/subscribeToArray":"lrFe","../scheduled/scheduleArray":"ZGwk"}],wZuk:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return(0,r.isScheduler)(n)?(t.pop(),(0,o.scheduleArray)(t,n)):(0,i.fromArray)(t)};var r=t("../util/isScheduler"),i=t("./fromArray"),o=t("../scheduled/scheduleArray")},{"../util/isScheduler":"VqoH","./fromArray":"PJGF","../scheduled/scheduleArray":"ZGwk"}],FdIu:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.throwError=function(t,e){return e?new r.Observable((function(n){return e.schedule(i,0,{error:t,subscriber:n})})):new r.Observable((function(e){return e.error(t)}))};var r=t("../Observable");function i(t){var e=t.error;t.subscriber.error(e)}},{"../Observable":"wbSE"}],n7Mc:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Notification=n.NotificationKind=void 0;var r,i=t("./observable/empty"),o=t("./observable/of"),s=t("./observable/throwError");n.NotificationKind=r,function(t){t.NEXT="N",t.ERROR="E",t.COMPLETE="C"}(r||(n.NotificationKind=r={}));var a=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return(0,o.of)(this.value);case"E":return(0,s.throwError)(this.error);case"C":return(0,i.empty)()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();n.Notification=a},{"./observable/empty":"XsKQ","./observable/of":"wZuk","./observable/throwError":"FdIu"}],ezNs:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.observeOn=function(t,e){return void 0===e&&(e=0),function(n){return n.lift(new a(t,e))}},n.ObserveOnMessage=n.ObserveOnSubscriber=n.ObserveOnOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../Notification");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))},t}();n.ObserveOnOperator=a;var u=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e)||this;return i.scheduler=n,i.delay=r,i}return r.__extends(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new c(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.Notification.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(o.Notification.createComplete()),this.unsubscribe()},e}(i.Subscriber);n.ObserveOnSubscriber=u;var c=function(t,e){this.notification=t,this.destination=e};n.ObserveOnMessage=c},{tslib:"vCxL","../Subscriber":"RaFB","../Notification":"n7Mc"}],Cp6P:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ReplaySubject=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./Subject"),o=t("./scheduler/queue"),s=t("./Subscription"),a=t("./operators/observeOn"),u=t("./util/ObjectUnsubscribedError"),c=t("./SubjectSubscription");function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}var h=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=e<1?1:e,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return r.__extends(e,t),e.prototype.nextInfiniteTimeWindow=function(e){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift(),t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this._events.push(new f(this._getNow(),e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new u.ObjectUnsubscribedError;if(this.isStopped||this.hasError?e=s.Subscription.EMPTY:(this.observers.push(t),e=new c.SubjectSubscription(this,t)),i&&t.add(t=new a.ObserveOnSubscriber(t,i)),n)for(var l=0;l<o&&!t.closed;l++)t.next(r[l]);else for(l=0;l<o&&!t.closed;l++)t.next(r[l].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||o.queue).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r},e}(i.Subject);n.ReplaySubject=h;var f=function(t,e){this.time=t,this.value=e}},{tslib:"vCxL","./Subject":"r9t1","./scheduler/queue":"HGOP","./Subscription":"I8KM","./operators/observeOn":"ezNs","./util/ObjectUnsubscribedError":"xQEi","./SubjectSubscription":"fyc3"}],Scvc:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AsyncSubject=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./Subject"),o=t("./Subscription");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return r.__extends(e,t),e.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),o.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),o.Subscription.EMPTY):t.prototype._subscribe.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(i.Subject);n.AsyncSubject=a},{tslib:"vCxL","./Subject":"r9t1","./Subscription":"I8KM"}],Z56L:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Immediate=void 0;var r=1,i={},o={setImmediate:function(t){var e=r++;return i[e]=t,Promise.resolve().then((function(){return function(t){var e=i[t];e&&e()}(e)})),e},clearImmediate:function(t){delete i[t]}};n.Immediate=o},{}],k3eS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AsapAction=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../util/Immediate");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.__extends(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=i.Immediate.setImmediate(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(i.Immediate.clearImmediate(n),e.scheduled=void 0)},e}(t("./AsyncAction").AsyncAction);n.AsapAction=s},{tslib:"vCxL","../util/Immediate":"Z56L","./AsyncAction":"llYF"}],czze:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AsapScheduler=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(t("./AsyncScheduler").AsyncScheduler);n.AsapScheduler=o},{tslib:"vCxL","./AsyncScheduler":"hnPK"}],ZqYc:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.asap=void 0;var r=t("./AsapAction"),i=new(t("./AsapScheduler").AsapScheduler)(r.AsapAction);n.asap=i},{"./AsapAction":"k3eS","./AsapScheduler":"czze"}],jun6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.async=void 0;var r=t("./AsyncAction"),i=new(t("./AsyncScheduler").AsyncScheduler)(r.AsyncAction);n.async=i},{"./AsyncAction":"llYF","./AsyncScheduler":"hnPK"}],m8qQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AnimationFrameAction=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.__extends(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},e}(t("./AsyncAction").AsyncAction);n.AnimationFrameAction=o},{tslib:"vCxL","./AsyncAction":"llYF"}],gboY:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AnimationFrameScheduler=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(t("./AsyncScheduler").AsyncScheduler);n.AnimationFrameScheduler=o},{tslib:"vCxL","./AsyncScheduler":"hnPK"}],zUKp:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.animationFrame=void 0;var r=t("./AnimationFrameAction"),i=new(t("./AnimationFrameScheduler").AnimationFrameScheduler)(r.AnimationFrameAction);n.animationFrame=i},{"./AnimationFrameAction":"m8qQ","./AnimationFrameScheduler":"gboY"}],RuMO:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.VirtualAction=n.VirtualTimeScheduler=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./AsyncAction");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(t){function e(e,n){void 0===e&&(e=a),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=t.call(this,e,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return r.__extends(e,t),e.prototype.flush=function(){for(var t,e,n=this.actions,r=this.maxFrames;(e=n[0])&&e.delay<=r&&(n.shift(),this.frame=e.delay,!(t=e.execute(e.state,e.delay))););if(t){for(;e=n.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(t("./AsyncScheduler").AsyncScheduler);n.VirtualTimeScheduler=s;var a=function(t){function e(e,n,r){void 0===r&&(r=e.index+=1);var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.index=r,i.active=!0,i.index=e.index=r,i}return r.__extends(e,t),e.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return t.prototype.schedule.call(this,n,r);this.active=!1;var i=new e(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},e.prototype.requestAsyncId=function(t,n,r){void 0===r&&(r=0),this.delay=t.frame+r;var i=t.actions;return i.push(this),i.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,e,n){void 0===n&&(n=0)},e.prototype._execute=function(e,n){if(!0===this.active)return t.prototype._execute.call(this,e,n)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(i.AsyncAction);n.VirtualAction=a},{tslib:"vCxL","./AsyncAction":"llYF","./AsyncScheduler":"hnPK"}],LXph:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.identity=function(t){return t}},{}],cUXi:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isObservable=function(t){return!!t&&(t instanceof r.Observable||"function"==typeof t.lift&&"function"==typeof t.subscribe)};var r=t("../Observable")},{"../Observable":"wbSE"}],Qh4I:[function(t,e,n){"use strict";function r(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}Object.defineProperty(n,"__esModule",{value:!0}),n.ArgumentOutOfRangeError=void 0,r.prototype=Object.create(Error.prototype);var i=r;n.ArgumentOutOfRangeError=i},{}],vsl0:[function(t,e,n){"use strict";function r(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Object.defineProperty(n,"__esModule",{value:!0}),n.EmptyError=void 0,r.prototype=Object.create(Error.prototype);var i=r;n.EmptyError=i},{}],SZK7:[function(t,e,n){"use strict";function r(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}Object.defineProperty(n,"__esModule",{value:!0}),n.TimeoutError=void 0,r.prototype=Object.create(Error.prototype);var i=r;n.TimeoutError=i},{}],dNh5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.map=function(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}},n.MapOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.project,this.thisArg))},t}();n.MapOperator=s;var a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return r.__extends(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],lxDK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bindCallback=function t(e,n,l){if(n){if(!(0,u.isScheduler)(n))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return t(e,l).apply(void 0,r).pipe((0,o.map)((function(t){return(0,a.isArray)(t)?n.apply(void 0,t):n(t)})))};l=n}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o,a=this,u={context:a,subject:o,callbackFunc:e,scheduler:l};return new r.Observable((function(n){if(l){var r={args:t,subscriber:n,params:u};return l.schedule(c,0,r)}if(!o){o=new i.AsyncSubject;try{e.apply(a,t.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.next(t.length<=1?t[0]:t),o.complete()}]))}catch(t){(0,s.canReportError)(o)?o.error(t):console.warn(t)}}return o.subscribe(n)}))}};var r=t("../Observable"),i=t("../AsyncSubject"),o=t("../operators/map"),s=t("../util/canReportError"),a=t("../util/isArray"),u=t("../util/isScheduler");function c(t){var e=this,n=t.args,r=t.subscriber,o=t.params,s=o.callbackFunc,a=o.context,u=o.scheduler,c=o.subject;if(!c){c=o.subject=new i.AsyncSubject;try{s.apply(a,n.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.length<=1?t[0]:t;e.add(u.schedule(l,0,{value:r,subject:c}))}]))}catch(t){c.error(t)}}this.add(c.subscribe(r))}function l(t){var e=t.value,n=t.subject;n.next(e),n.complete()}},{"../Observable":"wbSE","../AsyncSubject":"Scvc","../operators/map":"dNh5","../util/canReportError":"wHmS","../util/isArray":"KeTG","../util/isScheduler":"VqoH"}],uTDa:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bindNodeCallback=function t(e,n,l){if(n){if(!(0,a.isScheduler)(n))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return t(e,l).apply(void 0,r).pipe((0,o.map)((function(t){return(0,u.isArray)(t)?n.apply(void 0,t):n(t)})))};l=n}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o={subject:void 0,args:t,callbackFunc:e,scheduler:l,context:this};return new r.Observable((function(n){var r=o.context,a=o.subject;if(l)return l.schedule(c,0,{params:o,subscriber:n,context:r});if(!a){a=o.subject=new i.AsyncSubject;try{e.apply(r,t.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();n?a.error(n):(a.next(t.length<=1?t[0]:t),a.complete())}]))}catch(t){(0,s.canReportError)(a)?a.error(t):console.warn(t)}}return a.subscribe(n)}))}};var r=t("../Observable"),i=t("../AsyncSubject"),o=t("../operators/map"),s=t("../util/canReportError"),a=t("../util/isScheduler"),u=t("../util/isArray");function c(t){var e=this,n=t.params,r=t.subscriber,o=t.context,s=n.callbackFunc,a=n.args,u=n.scheduler,c=n.subject;if(!c){c=n.subject=new i.AsyncSubject;try{s.apply(o,a.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.shift();if(r)e.add(u.schedule(h,0,{err:r,subject:c}));else{var i=t.length<=1?t[0]:t;e.add(u.schedule(l,0,{value:i,subject:c}))}}]))}catch(t){this.add(u.schedule(h,0,{err:t,subject:c}))}}this.add(c.subscribe(r))}function l(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function h(t){var e=t.err;t.subject.error(e)}},{"../Observable":"wbSE","../AsyncSubject":"Scvc","../operators/map":"dNh5","../util/canReportError":"wHmS","../util/isScheduler":"VqoH","../util/isArray":"KeTG"}],hZYI:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OuterSubscriber=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(t("./Subscriber").Subscriber);n.OuterSubscriber=o},{tslib:"vCxL","./Subscriber":"RaFB"}],aQbR:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.InnerSubscriber=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(t("tslib"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}var o=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return r.__extends(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(t("./Subscriber").Subscriber);n.InnerSubscriber=o},{tslib:"vCxL","./Subscriber":"RaFB"}],eggw:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeToPromise=void 0;var r=t("./hostReportError");n.subscribeToPromise=function(t){return function(e){return t.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,r.hostReportError),e}}},{"./hostReportError":"JfKC"}],AqTP:[function(t,e,n){"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}Object.defineProperty(n,"__esModule",{value:!0}),n.getSymbolIterator=r,n.$$iterator=n.iterator=void 0;var i=r();n.iterator=i;var o=i;n.$$iterator=o},{}],QEdH:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeToIterable=void 0;var r=t("../symbol/iterator");n.subscribeToIterable=function(t){return function(e){for(var n=t[r.iterator]();;){var i=n.next();if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e}}},{"../symbol/iterator":"AqTP"}],buzG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeToObservable=void 0;var r=t("../symbol/observable");n.subscribeToObservable=function(t){return function(e){var n=t[r.observable]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)}}},{"../symbol/observable":"tjV3"}],LS84:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isArrayLike=void 0,n.isArrayLike=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t}},{}],Ok8F:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}},{}],vq9L:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeTo=void 0;var r=t("./subscribeToArray"),i=t("./subscribeToPromise"),o=t("./subscribeToIterable"),s=t("./subscribeToObservable"),a=t("./isArrayLike"),u=t("./isPromise"),c=t("./isObject"),l=t("../symbol/iterator"),h=t("../symbol/observable");n.subscribeTo=function(t){if(t&&"function"==typeof t[h.observable])return(0,s.subscribeToObservable)(t);if((0,a.isArrayLike)(t))return(0,r.subscribeToArray)(t);if((0,u.isPromise)(t))return(0,i.subscribeToPromise)(t);if(t&&"function"==typeof t[l.iterator])return(0,o.subscribeToIterable)(t);var e=(0,c.isObject)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},{"./subscribeToArray":"lrFe","./subscribeToPromise":"eggw","./subscribeToIterable":"QEdH","./subscribeToObservable":"buzG","./isArrayLike":"LS84","./isPromise":"Ok8F","./isObject":"nU7r","../symbol/iterator":"AqTP","../symbol/observable":"tjV3"}],JM7e:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeToResult=function(t,e,n,s,a){if(void 0===a&&(a=new r.InnerSubscriber(t,n,s)),!a.closed)return e instanceof o.Observable?e.subscribe(a):(0,i.subscribeTo)(e)(a)};var r=t("../InnerSubscriber"),i=t("./subscribeTo"),o=t("../Observable")},{"../InnerSubscriber":"aQbR","./subscribeTo":"vq9L","../Observable":"wbSE"}],omVc:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.combineLatest=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null,r=null;return(0,i.isScheduler)(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&(0,o.isArray)(t[0])&&(t=t[0]),(0,u.fromArray)(t,r).lift(new h(n))},n.CombineLatestSubscriber=n.CombineLatestOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../util/isScheduler"),o=t("../util/isArray"),s=t("../OuterSubscriber"),a=t("../util/subscribeToResult"),u=t("./fromArray");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l={},h=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new f(t,this.resultSelector))},t}();n.CombineLatestOperator=h;var f=function(t){function e(e,n){var r=t.call(this,e)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.__extends(e,t),e.prototype._next=function(t){this.values.push(l),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add((0,a.subscribeToResult)(this,r,r,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,i){var o=this.values,s=o[n],a=this.toRespond?s===l?--this.toRespond:this.toRespond:0;o[n]=e,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.OuterSubscriber);n.CombineLatestSubscriber=f},{tslib:"vCxL","../util/isScheduler":"VqoH","../util/isArray":"KeTG","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e","./fromArray":"PJGF"}],lgBy:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.scheduleObservable=function(t,e){return new r.Observable((function(n){var r=new i.Subscription;return r.add(e.schedule((function(){var i=t[o.observable]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))};var r=t("../Observable"),i=t("../Subscription"),o=t("../symbol/observable")},{"../Observable":"wbSE","../Subscription":"I8KM","../symbol/observable":"tjV3"}],aPE6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.schedulePromise=function(t,e){return new r.Observable((function(n){var r=new i.Subscription;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))};var r=t("../Observable"),i=t("../Subscription")},{"../Observable":"wbSE","../Subscription":"I8KM"}],XzIO:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.scheduleIterable=function(t,e){if(!t)throw new Error("Iterable cannot be null");return new r.Observable((function(n){var r,s=new i.Subscription;return s.add((function(){r&&"function"==typeof r.return&&r.return()})),s.add(e.schedule((function(){r=t[o.iterator](),s.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),s}))};var r=t("../Observable"),i=t("../Subscription"),o=t("../symbol/iterator")},{"../Observable":"wbSE","../Subscription":"I8KM","../symbol/iterator":"AqTP"}],CTP2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isInteropObservable=function(t){return t&&"function"==typeof t[r.observable]};var r=t("../symbol/observable")},{"../symbol/observable":"tjV3"}],NjuQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isIterable=function(t){return t&&"function"==typeof t[r.iterator]};var r=t("../symbol/iterator")},{"../symbol/iterator":"AqTP"}],mNZE:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.scheduled=function(t,e){if(null!=t){if((0,a.isInteropObservable)(t))return(0,r.scheduleObservable)(t,e);if((0,u.isPromise)(t))return(0,i.schedulePromise)(t,e);if((0,c.isArrayLike)(t))return(0,o.scheduleArray)(t,e);if((0,l.isIterable)(t)||"string"==typeof t)return(0,s.scheduleIterable)(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")};var r=t("./scheduleObservable"),i=t("./schedulePromise"),o=t("./scheduleArray"),s=t("./scheduleIterable"),a=t("../util/isInteropObservable"),u=t("../util/isPromise"),c=t("../util/isArrayLike"),l=t("../util/isIterable")},{"./scheduleObservable":"lgBy","./schedulePromise":"aPE6","./scheduleArray":"ZGwk","./scheduleIterable":"XzIO","../util/isInteropObservable":"CTP2","../util/isPromise":"Ok8F","../util/isArrayLike":"LS84","../util/isIterable":"NjuQ"}],WXUl:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.from=function(t,e){return e?(0,o.scheduled)(t,e):t instanceof r.Observable?t:new r.Observable((0,i.subscribeTo)(t))};var r=t("../Observable"),i=t("../util/subscribeTo"),o=t("../scheduled/scheduled")},{"../Observable":"wbSE","../util/subscribeTo":"vq9L","../scheduled/scheduled":"mNZE"}],nFsM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mergeMap=function t(e,n,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof n?function(i){return i.pipe(t((function(t,r){return(0,u.from)(e(t,r)).pipe((0,a.map)((function(e,i){return n(t,e,r,i)})))}),r))}:("number"==typeof n&&(r=n),function(t){return t.lift(new l(e,r))})},n.MergeMapSubscriber=n.MergeMapOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../util/subscribeToResult"),o=t("../OuterSubscriber"),s=t("../InnerSubscriber"),a=t("./map"),u=t("../observable/from");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.project,this.concurrent))},t}();n.MergeMapOperator=l;var h=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return r.__extends(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=new s.InnerSubscriber(this,void 0,void 0);this.destination.add(r),(0,i.subscribeToResult)(this,t,e,n,r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(o.OuterSubscriber);n.MergeMapSubscriber=h},{tslib:"vCxL","../util/subscribeToResult":"JM7e","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR","./map":"dNh5","../observable/from":"WXUl"}],Nkv4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mergeAll=function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),(0,r.mergeMap)(i.identity,t)};var r=t("./mergeMap"),i=t("../util/identity")},{"./mergeMap":"nFsM","../util/identity":"LXph"}],Yxey:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.concatAll=function(){return(0,r.mergeAll)(1)};var r=t("./mergeAll")},{"./mergeAll":"Nkv4"}],CsdO:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,i.concatAll)()(r.of.apply(void 0,t))};var r=t("./of"),i=t("../operators/concatAll")},{"./of":"wZuk","../operators/concatAll":"Yxey"}],w9G6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.defer=function(t){return new r.Observable((function(e){var n;try{n=t()}catch(t){return void e.error(t)}return(n?(0,i.from)(n):(0,o.empty)()).subscribe(e)}))};var r=t("../Observable"),i=t("./from"),o=t("./empty")},{"../Observable":"wbSE","./from":"WXUl","./empty":"XsKQ"}],R2GC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.forkJoin=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var n=t[0];if((0,i.isArray)(n))return c(n,null);if((0,s.isObject)(n)&&!(0,a.isObservable)(n)){var r=Object.keys(n);return c(r.map((function(t){return n[t]})),r)}}if("function"==typeof t[t.length-1]){var u=t.pop();return c(t=1===t.length&&(0,i.isArray)(t[0])?t[0]:t,null).pipe((0,o.map)((function(t){return u.apply(void 0,t)})))}return c(t,null)};var r=t("../Observable"),i=t("../util/isArray"),o=t("../operators/map"),s=t("../util/isObject"),a=t("../util/isObservable"),u=t("./from");function c(t,e){return new r.Observable((function(n){var r=t.length;if(0!==r)for(var i=new Array(r),o=0,s=0,a=function(a){var c=(0,u.from)(t[a]),l=!1;n.add(c.subscribe({next:function(t){l||(l=!0,s++),i[a]=t},error:function(t){return n.error(t)},complete:function(){++o!==r&&l||(s===r&&n.next(e?e.reduce((function(t,e,n){return t[e]=i[n],t}),{}):i),n.complete())}}))},c=0;c<r;c++)a(c);else n.complete()}))}},{"../Observable":"wbSE","../util/isArray":"KeTG","../operators/map":"dNh5","../util/isObject":"nU7r","../util/isObservable":"cUXi","./from":"WXUl"}],ZHZV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fromEvent=function t(e,n,u,c){return(0,o.isFunction)(u)&&(c=u,u=void 0),c?t(e,n,u).pipe((0,s.map)((function(t){return(0,i.isArray)(t)?c.apply(void 0,t):c(t)}))):new r.Observable((function(t){a(e,n,(function(e){arguments.length>1?t.next(Array.prototype.slice.call(arguments)):t.next(e)}),t,u)}))};var r=t("../Observable"),i=t("../util/isArray"),o=t("../util/isFunction"),s=t("../operators/map");function a(t,e,n,r,i){var o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,n,i),o=function(){return s.removeEventListener(e,n,i)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var u=t;t.on(e,n),o=function(){return u.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var c=t;t.addListener(e,n),o=function(){return c.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var l=0,h=t.length;l<h;l++)a(t[l],e,n,r,i)}r.add(o)}Object.prototype.toString},{"../Observable":"wbSE","../util/isArray":"KeTG","../util/isFunction":"Qnsq","../operators/map":"dNh5"}],HFE7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fromEventPattern=function t(e,n,a){return a?t(e,n).pipe((0,s.map)((function(t){return(0,i.isArray)(t)?a.apply(void 0,t):a(t)}))):new r.Observable((function(t){var r,i=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1===e.length?e[0]:e)};try{r=e(i)}catch(e){return void t.error(e)}if((0,o.isFunction)(n))return function(){return n(i,r)}}))};var r=t("../Observable"),i=t("../util/isArray"),o=t("../util/isFunction"),s=t("../operators/map")},{"../Observable":"wbSE","../util/isArray":"KeTG","../util/isFunction":"Qnsq","../operators/map":"dNh5"}],xNZb:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.generate=function(t,e,n,a,u){var c,l;if(1==arguments.length){var h=t;l=h.initialState,e=h.condition,n=h.iterate,c=h.resultSelector||i.identity,u=h.scheduler}else void 0===a||(0,o.isScheduler)(a)?(l=t,c=i.identity,u=a):(l=t,c=a);return new r.Observable((function(t){var r=l;if(u)return u.schedule(s,0,{subscriber:t,iterate:n,condition:e,resultSelector:c,state:r});for(;;){if(e){var i=void 0;try{i=e(r)}catch(e){return void t.error(e)}if(!i){t.complete();break}}var o=void 0;try{o=c(r)}catch(e){return void t.error(e)}if(t.next(o),t.closed)break;try{r=n(r)}catch(e){return void t.error(e)}}}))};var r=t("../Observable"),i=t("../util/identity"),o=t("../util/isScheduler");function s(t){var e=t.subscriber,n=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(t){return void e.error(t)}else t.needIterate=!0;if(n){var r=void 0;try{r=n(t.state)}catch(t){return void e.error(t)}if(!r)return void e.complete();if(e.closed)return}var i;try{i=t.resultSelector(t.state)}catch(t){return void e.error(t)}if(!e.closed&&(e.next(i),!e.closed))return this.schedule(t)}}},{"../Observable":"wbSE","../util/identity":"LXph","../util/isScheduler":"VqoH"}],SXp5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.iif=function(t,e,n){return void 0===e&&(e=i.EMPTY),void 0===n&&(n=i.EMPTY),(0,r.defer)((function(){return t()?e:n}))};var r=t("./defer"),i=t("./empty")},{"./defer":"w9G6","./empty":"XsKQ"}],wBpm:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isNumeric=function(t){return!(0,r.isArray)(t)&&t-parseFloat(t)+1>=0};var r=t("./isArray")},{"./isArray":"KeTG"}],QHLS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.interval=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=i.async),(!(0,o.isNumeric)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=i.async),new r.Observable((function(n){return n.add(e.schedule(s,t,{subscriber:n,counter:0,period:t})),n}))};var r=t("../Observable"),i=t("../scheduler/async"),o=t("../util/isNumeric");function s(t){var e=t.subscriber,n=t.counter,r=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}},{"../Observable":"wbSE","../scheduler/async":"jun6","../util/isNumeric":"wBpm"}],DQig:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,a=null,u=t[t.length-1];return(0,i.isScheduler)(u)?(a=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof u&&(n=t.pop()),null===a&&1===t.length&&t[0]instanceof r.Observable?t[0]:(0,o.mergeAll)(n)((0,s.fromArray)(t,a))};var r=t("../Observable"),i=t("../util/isScheduler"),o=t("../operators/mergeAll"),s=t("./fromArray")},{"../Observable":"wbSE","../util/isScheduler":"VqoH","../operators/mergeAll":"Nkv4","./fromArray":"PJGF"}],TBTl:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.never=function(){return o},n.NEVER=void 0;var r=t("../Observable"),i=t("../util/noop"),o=new r.Observable(i.noop);n.NEVER=o},{"../Observable":"wbSE","../util/noop":"rXfM"}],VCq5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.onErrorResumeNext=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(0===e.length)return s.EMPTY;var a=e[0],u=e.slice(1);return 1===e.length&&(0,o.isArray)(a)?t.apply(void 0,a):new r.Observable((function(e){var n=function(){return e.add(t.apply(void 0,u).subscribe(e))};return(0,i.from)(a).subscribe({next:function(t){e.next(t)},error:n,complete:n})}))};var r=t("../Observable"),i=t("./from"),o=t("../util/isArray"),s=t("./empty")},{"../Observable":"wbSE","./from":"WXUl","../util/isArray":"KeTG","./empty":"XsKQ"}],QHfc:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pairs=function(t,e){return e?new r.Observable((function(n){var r=Object.keys(t),s=new i.Subscription;return s.add(e.schedule(o,0,{keys:r,index:0,subscriber:n,subscription:s,obj:t})),s})):new r.Observable((function(e){for(var n=Object.keys(t),r=0;r<n.length&&!e.closed;r++){var i=n[r];t.hasOwnProperty(i)&&e.next([i,t[i]])}e.complete()}))},n.dispatch=o;var r=t("../Observable"),i=t("../Subscription");function o(t){var e=t.keys,n=t.index,r=t.subscriber,i=t.subscription,o=t.obj;if(!r.closed)if(n<e.length){var s=e[n];r.next([s,o[s]]),i.add(this.schedule({keys:e,index:n+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}},{"../Observable":"wbSE","../Subscription":"I8KM"}],nij6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.not=function(t,e){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=t,n.thisArg=e,n}},{}],HKzi:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filter=function(t,e){return function(n){return n.lift(new s(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.thisArg))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return r.__extends(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],wJ9V:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.partition=function(t,e,n){return[(0,o.filter)(e,n)(new s.Observable((0,i.subscribeTo)(t))),(0,o.filter)((0,r.not)(e,n))(new s.Observable((0,i.subscribeTo)(t)))]};var r=t("../util/not"),i=t("../util/subscribeTo"),o=t("../operators/filter"),s=t("../Observable")},{"../util/not":"nij6","../util/subscribeTo":"vq9L","../operators/filter":"HKzi","../Observable":"wbSE"}],bwYX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.race=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){if(!(0,i.isArray)(t[0]))return t[0];t=t[0]}return(0,o.fromArray)(t,void 0).lift(new c)},n.RaceSubscriber=n.RaceOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../util/isArray"),o=t("./fromArray"),s=t("../OuterSubscriber"),a=t("../util/subscribeToResult");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var c=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new l(t))},t}();n.RaceOperator=c;var l=function(t){function e(e){var n=t.call(this,e)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return r.__extends(e,t),e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var n=0;n<e&&!this.hasFirst;n++){var r=t[n],i=(0,a.subscribeToResult)(this,r,r,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},e.prototype.notifyNext=function(t,e,n,r,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==n){var s=this.subscriptions[o];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(e)},e}(s.OuterSubscriber);n.RaceSubscriber=l},{tslib:"vCxL","../util/isArray":"KeTG","./fromArray":"PJGF","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],N84r:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.range=function(t,e,n){return void 0===t&&(t=0),new r.Observable((function(r){void 0===e&&(e=t,t=0);var o=0,s=t;if(n)return n.schedule(i,0,{index:o,count:e,start:t,subscriber:r});for(;;){if(o++>=e){r.complete();break}if(r.next(s++),r.closed)break}}))},n.dispatch=i;var r=t("../Observable");function i(t){var e=t.start,n=t.index,r=t.count,i=t.subscriber;n>=r?i.complete():(i.next(e),i.closed||(t.index=n+1,t.start=e+1,this.schedule(t)))}},{"../Observable":"wbSE"}],RPvN:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.timer=function(t,e,n){void 0===t&&(t=0);var u=-1;return(0,o.isNumeric)(e)?u=Number(e)<1?1:Number(e):(0,s.isScheduler)(e)&&(n=e),(0,s.isScheduler)(n)||(n=i.async),new r.Observable((function(e){var r=(0,o.isNumeric)(t)?t:+t-n.now();return n.schedule(a,r,{index:0,period:u,subscriber:e})}))};var r=t("../Observable"),i=t("../scheduler/async"),o=t("../util/isNumeric"),s=t("../util/isScheduler");function a(t){var e=t.index,n=t.period,r=t.subscriber;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}},{"../Observable":"wbSE","../scheduler/async":"jun6","../util/isNumeric":"wBpm","../util/isScheduler":"VqoH"}],gc1W:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.using=function(t,e){return new r.Observable((function(n){var r,s;try{r=t()}catch(t){return void n.error(t)}try{s=e(r)}catch(t){return void n.error(t)}var a=(s?(0,i.from)(s):o.EMPTY).subscribe(n);return function(){a.unsubscribe(),r&&r.unsubscribe()}}))};var r=t("../Observable"),i=t("./from"),o=t("./empty")},{"../Observable":"wbSE","./from":"WXUl","./empty":"XsKQ"}],ff2A:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.zip=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return"function"==typeof n&&t.pop(),(0,i.fromArray)(t,void 0).lift(new h(n))},n.ZipSubscriber=n.ZipOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("./fromArray"),o=t("../util/isArray"),s=t("../Subscriber"),a=t("../OuterSubscriber"),u=t("../util/subscribeToResult"),c=t("../../internal/symbol/iterator");function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}var h=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new f(t,this.resultSelector))},t}();n.ZipOperator=h;var f=function(t){function e(e,n,r){void 0===r&&(r=Object.create(null));var i=t.call(this,e)||this;return i.iterators=[],i.active=0,i.resultSelector="function"==typeof n?n:null,i.values=r,i}return r.__extends(e,t),e.prototype._next=function(t){var e=this.iterators;(0,o.isArray)(t)?e.push(new d(t)):"function"==typeof t[c.iterator]?e.push(new p(t[c.iterator]())):e.push(new y(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var n=0;n<e;n++){var r=t[n];r.stillUnsubscribed?this.destination.add(r.subscribe(r,n)):this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,n=this.destination,r=0;r<e;r++)if("function"==typeof(s=t[r]).hasValue&&!s.hasValue())return;var i=!1,o=[];for(r=0;r<e;r++){var s,a=(s=t[r]).next();if(s.hasCompleted()&&(i=!0),a.done)return void n.complete();o.push(a.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},e.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.Subscriber);n.ZipSubscriber=f;var p=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),d=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[c.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,n=this.array;return e<this.length?{value:n[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),y=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return r.__extends(e,t),e.prototype[c.iterator]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,i){this.buffer.push(e),this.parent.checkIterators()},e.prototype.subscribe=function(t,e){return(0,u.subscribeToResult)(this,this.observable,this,e)},e}(a.OuterSubscriber)},{tslib:"vCxL","./fromArray":"PJGF","../util/isArray":"KeTG","../Subscriber":"RaFB","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e","../../internal/symbol/iterator":"AqTP"}],iRqj:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Observable",{enumerable:!0,get:function(){return r.Observable}}),Object.defineProperty(n,"ConnectableObservable",{enumerable:!0,get:function(){return i.ConnectableObservable}}),Object.defineProperty(n,"GroupedObservable",{enumerable:!0,get:function(){return o.GroupedObservable}}),Object.defineProperty(n,"observable",{enumerable:!0,get:function(){return s.observable}}),Object.defineProperty(n,"Subject",{enumerable:!0,get:function(){return a.Subject}}),Object.defineProperty(n,"BehaviorSubject",{enumerable:!0,get:function(){return u.BehaviorSubject}}),Object.defineProperty(n,"ReplaySubject",{enumerable:!0,get:function(){return c.ReplaySubject}}),Object.defineProperty(n,"AsyncSubject",{enumerable:!0,get:function(){return l.AsyncSubject}}),Object.defineProperty(n,"asapScheduler",{enumerable:!0,get:function(){return h.asap}}),Object.defineProperty(n,"asyncScheduler",{enumerable:!0,get:function(){return f.async}}),Object.defineProperty(n,"queueScheduler",{enumerable:!0,get:function(){return p.queue}}),Object.defineProperty(n,"animationFrameScheduler",{enumerable:!0,get:function(){return d.animationFrame}}),Object.defineProperty(n,"VirtualTimeScheduler",{enumerable:!0,get:function(){return y.VirtualTimeScheduler}}),Object.defineProperty(n,"VirtualAction",{enumerable:!0,get:function(){return y.VirtualAction}}),Object.defineProperty(n,"Scheduler",{enumerable:!0,get:function(){return v.Scheduler}}),Object.defineProperty(n,"Subscription",{enumerable:!0,get:function(){return g.Subscription}}),Object.defineProperty(n,"Subscriber",{enumerable:!0,get:function(){return b.Subscriber}}),Object.defineProperty(n,"Notification",{enumerable:!0,get:function(){return m.Notification}}),Object.defineProperty(n,"NotificationKind",{enumerable:!0,get:function(){return m.NotificationKind}}),Object.defineProperty(n,"pipe",{enumerable:!0,get:function(){return w.pipe}}),Object.defineProperty(n,"noop",{enumerable:!0,get:function(){return _.noop}}),Object.defineProperty(n,"identity",{enumerable:!0,get:function(){return S.identity}}),Object.defineProperty(n,"isObservable",{enumerable:!0,get:function(){return O.isObservable}}),Object.defineProperty(n,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return E.ArgumentOutOfRangeError}}),Object.defineProperty(n,"EmptyError",{enumerable:!0,get:function(){return A.EmptyError}}),Object.defineProperty(n,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return C.ObjectUnsubscribedError}}),Object.defineProperty(n,"UnsubscriptionError",{enumerable:!0,get:function(){return I.UnsubscriptionError}}),Object.defineProperty(n,"TimeoutError",{enumerable:!0,get:function(){return T.TimeoutError}}),Object.defineProperty(n,"bindCallback",{enumerable:!0,get:function(){return x.bindCallback}}),Object.defineProperty(n,"bindNodeCallback",{enumerable:!0,get:function(){return k.bindNodeCallback}}),Object.defineProperty(n,"combineLatest",{enumerable:!0,get:function(){return P.combineLatest}}),Object.defineProperty(n,"concat",{enumerable:!0,get:function(){return N.concat}}),Object.defineProperty(n,"defer",{enumerable:!0,get:function(){return B.defer}}),Object.defineProperty(n,"empty",{enumerable:!0,get:function(){return D.empty}}),Object.defineProperty(n,"EMPTY",{enumerable:!0,get:function(){return D.EMPTY}}),Object.defineProperty(n,"forkJoin",{enumerable:!0,get:function(){return R.forkJoin}}),Object.defineProperty(n,"from",{enumerable:!0,get:function(){return j.from}}),Object.defineProperty(n,"fromEvent",{enumerable:!0,get:function(){return M.fromEvent}}),Object.defineProperty(n,"fromEventPattern",{enumerable:!0,get:function(){return L.fromEventPattern}}),Object.defineProperty(n,"generate",{enumerable:!0,get:function(){return F.generate}}),Object.defineProperty(n,"iif",{enumerable:!0,get:function(){return U.iif}}),Object.defineProperty(n,"interval",{enumerable:!0,get:function(){return V.interval}}),Object.defineProperty(n,"merge",{enumerable:!0,get:function(){return z.merge}}),Object.defineProperty(n,"never",{enumerable:!0,get:function(){return q.never}}),Object.defineProperty(n,"NEVER",{enumerable:!0,get:function(){return q.NEVER}}),Object.defineProperty(n,"of",{enumerable:!0,get:function(){return W.of}}),Object.defineProperty(n,"onErrorResumeNext",{enumerable:!0,get:function(){return G.onErrorResumeNext}}),Object.defineProperty(n,"pairs",{enumerable:!0,get:function(){return H.pairs}}),Object.defineProperty(n,"partition",{enumerable:!0,get:function(){return Y.partition}}),Object.defineProperty(n,"race",{enumerable:!0,get:function(){return K.race}}),Object.defineProperty(n,"range",{enumerable:!0,get:function(){return Q.range}}),Object.defineProperty(n,"throwError",{enumerable:!0,get:function(){return J.throwError}}),Object.defineProperty(n,"timer",{enumerable:!0,get:function(){return X.timer}}),Object.defineProperty(n,"using",{enumerable:!0,get:function(){return Z.using}}),Object.defineProperty(n,"zip",{enumerable:!0,get:function(){return $.zip}}),Object.defineProperty(n,"scheduled",{enumerable:!0,get:function(){return tt.scheduled}}),Object.defineProperty(n,"config",{enumerable:!0,get:function(){return et.config}});var r=t("./internal/Observable"),i=t("./internal/observable/ConnectableObservable"),o=t("./internal/operators/groupBy"),s=t("./internal/symbol/observable"),a=t("./internal/Subject"),u=t("./internal/BehaviorSubject"),c=t("./internal/ReplaySubject"),l=t("./internal/AsyncSubject"),h=t("./internal/scheduler/asap"),f=t("./internal/scheduler/async"),p=t("./internal/scheduler/queue"),d=t("./internal/scheduler/animationFrame"),y=t("./internal/scheduler/VirtualTimeScheduler"),v=t("./internal/Scheduler"),g=t("./internal/Subscription"),b=t("./internal/Subscriber"),m=t("./internal/Notification"),w=t("./internal/util/pipe"),_=t("./internal/util/noop"),S=t("./internal/util/identity"),O=t("./internal/util/isObservable"),E=t("./internal/util/ArgumentOutOfRangeError"),A=t("./internal/util/EmptyError"),C=t("./internal/util/ObjectUnsubscribedError"),I=t("./internal/util/UnsubscriptionError"),T=t("./internal/util/TimeoutError"),x=t("./internal/observable/bindCallback"),k=t("./internal/observable/bindNodeCallback"),P=t("./internal/observable/combineLatest"),N=t("./internal/observable/concat"),B=t("./internal/observable/defer"),D=t("./internal/observable/empty"),R=t("./internal/observable/forkJoin"),j=t("./internal/observable/from"),M=t("./internal/observable/fromEvent"),L=t("./internal/observable/fromEventPattern"),F=t("./internal/observable/generate"),U=t("./internal/observable/iif"),V=t("./internal/observable/interval"),z=t("./internal/observable/merge"),q=t("./internal/observable/never"),W=t("./internal/observable/of"),G=t("./internal/observable/onErrorResumeNext"),H=t("./internal/observable/pairs"),Y=t("./internal/observable/partition"),K=t("./internal/observable/race"),Q=t("./internal/observable/range"),J=t("./internal/observable/throwError"),X=t("./internal/observable/timer"),Z=t("./internal/observable/using"),$=t("./internal/observable/zip"),tt=t("./internal/scheduled/scheduled"),et=t("./internal/config")},{"./internal/Observable":"wbSE","./internal/observable/ConnectableObservable":"kkfD","./internal/operators/groupBy":"dNgG","./internal/symbol/observable":"tjV3","./internal/Subject":"r9t1","./internal/BehaviorSubject":"MPU6","./internal/ReplaySubject":"Cp6P","./internal/AsyncSubject":"Scvc","./internal/scheduler/asap":"ZqYc","./internal/scheduler/async":"jun6","./internal/scheduler/queue":"HGOP","./internal/scheduler/animationFrame":"zUKp","./internal/scheduler/VirtualTimeScheduler":"RuMO","./internal/Scheduler":"QglZ","./internal/Subscription":"I8KM","./internal/Subscriber":"RaFB","./internal/Notification":"n7Mc","./internal/util/pipe":"HQCS","./internal/util/noop":"rXfM","./internal/util/identity":"LXph","./internal/util/isObservable":"cUXi","./internal/util/ArgumentOutOfRangeError":"Qh4I","./internal/util/EmptyError":"vsl0","./internal/util/ObjectUnsubscribedError":"xQEi","./internal/util/UnsubscriptionError":"pMaL","./internal/util/TimeoutError":"SZK7","./internal/observable/bindCallback":"lxDK","./internal/observable/bindNodeCallback":"uTDa","./internal/observable/combineLatest":"omVc","./internal/observable/concat":"CsdO","./internal/observable/defer":"w9G6","./internal/observable/empty":"XsKQ","./internal/observable/forkJoin":"R2GC","./internal/observable/from":"WXUl","./internal/observable/fromEvent":"ZHZV","./internal/observable/fromEventPattern":"HFE7","./internal/observable/generate":"xNZb","./internal/observable/iif":"SXp5","./internal/observable/interval":"QHLS","./internal/observable/merge":"DQig","./internal/observable/never":"TBTl","./internal/observable/of":"wZuk","./internal/observable/onErrorResumeNext":"VCq5","./internal/observable/pairs":"QHfc","./internal/observable/partition":"wJ9V","./internal/observable/race":"bwYX","./internal/observable/range":"N84r","./internal/observable/throwError":"FdIu","./internal/observable/timer":"RPvN","./internal/observable/using":"gc1W","./internal/observable/zip":"ff2A","./internal/scheduled/scheduled":"mNZE","./internal/config":"Q3iD"}],Pdg2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.audit=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.durationSelector))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r}return r.__extends(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(t){return this.destination.error(t)}var n=(0,o.subscribeToResult)(this,e);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,n,r){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],jcYn:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.auditTime=function(t,e){return void 0===e&&(e=r.async),(0,i.audit)((function(){return(0,o.timer)(t,e)}))};var r=t("../scheduler/async"),i=t("./audit"),o=t("../observable/timer")},{"../scheduler/async":"jun6","./audit":"Pdg2","../observable/timer":"RPvN"}],mG6b:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.buffer=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.closingNotifier))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.buffer=[],r.add((0,o.subscribeToResult)(r,n)),r}return r.__extends(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(t,e,n,r,i){var o=this.buffer;this.buffer=[],this.destination.next(o)},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],f9IP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bufferCount=function(t,e){return void 0===e&&(e=null),function(n){return n.lift(new s(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?u:a}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.bufferSize=n,r.buffer=[],r}return r.__extends(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(i.Subscriber),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.bufferSize=n,i.startBufferEvery=r,i.buffers=[],i.count=0,i}return r.__extends(e,t),e.prototype._next=function(t){var e=this.bufferSize,n=this.startBufferEvery,r=this.buffers,i=this.count;this.count++,i%n==0&&r.push([]);for(var o=r.length;o--;){var s=r[o];s.push(t),s.length===e&&(r.splice(o,1),this.destination.next(s))}},e.prototype._complete=function(){for(var e=this.buffers,n=this.destination;e.length>0;){var r=e.shift();r.length>0&&n.next(r)}t.prototype._complete.call(this)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],Axj2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bufferTime=function(t){var e=arguments.length,n=i.async;(0,s.isScheduler)(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],e--);var r=null;e>=2&&(r=arguments[1]);var o=Number.POSITIVE_INFINITY;return e>=3&&(o=arguments[2]),function(e){return e.lift(new u(t,r,o,n))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../scheduler/async"),o=t("../Subscriber"),s=t("../util/isScheduler");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t,e,n,r){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),c=function(){this.buffer=[]},l=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;s.bufferTimeSpan=n,s.bufferCreationInterval=r,s.maxBufferSize=i,s.scheduler=o,s.contexts=[];var a=s.openContext();if(s.timespanOnly=null==r||r<0,s.timespanOnly){var u={subscriber:s,context:a,bufferTimeSpan:n};s.add(a.closeAction=o.schedule(h,n,u))}else{var c={subscriber:s,context:a},l={bufferTimeSpan:n,bufferCreationInterval:r,subscriber:s,scheduler:o};s.add(a.closeAction=o.schedule(p,n,c)),s.add(o.schedule(f,r,l))}return s}return r.__extends(e,t),e.prototype._next=function(t){for(var e,n=this.contexts,r=n.length,i=0;i<r;i++){var o=n[i],s=o.buffer;s.push(t),s.length==this.maxBufferSize&&(e=o)}e&&this.onBufferFull(e)},e.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts,n=this.destination;e.length>0;){var r=e.shift();n.next(r.buffer)}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var n=this.bufferTimeSpan,r={subscriber:this,context:t,bufferTimeSpan:n};this.add(t.closeAction=this.scheduler.schedule(h,n,r))}},e.prototype.openContext=function(){var t=new c;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;(e?e.indexOf(t):-1)>=0&&e.splice(e.indexOf(t),1)},e}(o.Subscriber);function h(t){var e=t.subscriber,n=t.context;n&&e.closeContext(n),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function f(t){var e=t.bufferCreationInterval,n=t.bufferTimeSpan,r=t.subscriber,i=t.scheduler,o=r.openContext();r.closed||(r.add(o.closeAction=i.schedule(p,n,{subscriber:r,context:o})),this.schedule(t,e))}function p(t){var e=t.subscriber,n=t.context;e.closeContext(n)}},{tslib:"vCxL","../scheduler/async":"jun6","../Subscriber":"RaFB","../util/isScheduler":"VqoH"}],ZTTP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bufferToggle=function(t,e){return function(n){return n.lift(new u(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscription"),o=t("../util/subscribeToResult"),s=t("../OuterSubscriber");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.openings,this.closingSelector))},t}(),c=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add((0,o.subscribeToResult)(i,n)),i}return r.__extends(e,t),e.prototype._next=function(t){for(var e=this.contexts,n=e.length,r=0;r<n;r++)e[r].buffer.push(t)},e.prototype._error=function(e){for(var n=this.contexts;n.length>0;){var r=n.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var n=e.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,n,r,i){t?this.closeBuffer(t):this.openBuffer(e)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(t){this._error(t)}},e.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var n=t.buffer,r=t.subscription;this.destination.next(n),e.splice(e.indexOf(t),1),this.remove(r),r.unsubscribe()}},e.prototype.trySubscribe=function(t){var e=this.contexts,n=new i.Subscription,r={buffer:[],subscription:n};e.push(r);var s=(0,o.subscribeToResult)(this,t,r);!s||s.closed?this.closeBuffer(r):(s.context=r,this.add(s),n.add(s))},e}(s.OuterSubscriber)},{tslib:"vCxL","../Subscription":"I8KM","../util/subscribeToResult":"JM7e","../OuterSubscriber":"hZYI"}],Ul3A:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bufferWhen=function(t){return function(e){return e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscription"),o=t("../OuterSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.closingSelector))},t}(),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.closingSelector=n,r.subscribing=!1,r.openBuffer(),r}return r.__extends(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},e.prototype.notifyNext=function(t,e,n,r,i){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{e=(0,this.closingSelector)()}catch(t){return this.error(t)}t=new i.Subscription,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add((0,s.subscribeToResult)(this,e)),this.subscribing=!1},e}(o.OuterSubscriber)},{tslib:"vCxL","../Subscription":"I8KM","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],THoY:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.catchError=function(t){return function(e){var n=new u(t),r=e.lift(n);return n.caught=r}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../InnerSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.selector,this.caught))},t}(),c=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.selector=n,i.caught=r,i}return r.__extends(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var r=new o.InnerSubscriber(this,void 0,void 0);this.add(r),(0,s.subscribeToResult)(this,n,void 0,void 0,r)}},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR","../util/subscribeToResult":"JM7e"}],TMFF:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.combineAll=function(t){return function(e){return e.lift(new r.CombineLatestOperator(t))}};var r=t("../observable/combineLatest")},{"../observable/combineLatest":"omVc"}],DJQm:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.combineLatest=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&(0,r.isArray)(t[0])&&(t=t[0].slice()),function(e){return e.lift.call((0,o.from)([e].concat(t)),new i.CombineLatestOperator(n))}};var r=t("../util/isArray"),i=t("../observable/combineLatest"),o=t("../observable/from")},{"../util/isArray":"KeTG","../observable/combineLatest":"omVc","../observable/from":"WXUl"}],ZHmI:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(r.concat.apply(void 0,[e].concat(t)))}};var r=t("../observable/concat")},{"../observable/concat":"CsdO"}],DoUK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.concatMap=function(t,e){return(0,r.mergeMap)(t,e,1)};var r=t("./mergeMap")},{"./mergeMap":"nFsM"}],APQq:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.concatMapTo=function(t,e){return(0,r.concatMap)((function(){return t}),e)};var r=t("./concatMap")},{"./concatMap":"DoUK"}],U1Ln:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.count=function(t){return function(e){return e.lift(new s(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.source))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.source=r,i.count=0,i.index=0,i}return r.__extends(e,t),e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],y9EZ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.debounce=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.durationSelector))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r.durationSubscription=null,r}return r.__extends(e,t),e.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,e){var n=this.durationSubscription;this.value=t,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=(0,o.subscribeToResult)(this,e))&&!n.closed&&this.add(this.durationSubscription=n)},e.prototype.notifyNext=function(t,e,n,r,i){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var e=this.value,n=this.durationSubscription;n&&(this.durationSubscription=null,n.unsubscribe(),this.remove(n)),this.value=null,this.hasValue=!1,t.prototype._next.call(this,e)}},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],KBFO:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.debounceTime=function(t,e){return void 0===e&&(e=o.async),function(n){return n.lift(new a(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../scheduler/async");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.dueTime,this.scheduler))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return r.__extends(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(c,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(i.Subscriber);function c(t){t.debouncedNext()}},{tslib:"vCxL","../Subscriber":"RaFB","../scheduler/async":"jun6"}],YBdz:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.defaultIfEmpty=function(t){return void 0===t&&(t=null),function(e){return e.lift(new s(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.defaultValue))},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return r.__extends(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],rxSS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isDate=function(t){return t instanceof Date&&!isNaN(+t)}},{}],zkgx:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.delay=function(t,e){void 0===e&&(e=i.async);var n=(0,o.isDate)(t)?+t-e.now():Math.abs(t);return function(t){return t.lift(new c(n,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../scheduler/async"),o=t("../util/isDate"),s=t("../Subscriber"),a=t("../Notification");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var c=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.delay,this.scheduler))},t}(),l=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return r.__extends(e,t),e.dispatch=function(t){for(var e=t.source,n=e.queue,r=t.scheduler,i=t.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(t,o)}else this.unsubscribe(),e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.destination.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,n=new h(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(a.Notification.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(a.Notification.createComplete()),this.unsubscribe()},e}(s.Subscriber),h=function(t,e){this.time=t,this.notification=e}},{tslib:"vCxL","../scheduler/async":"jun6","../util/isDate":"rxSS","../Subscriber":"RaFB","../Notification":"n7Mc"}],iVuv:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.delayWhen=function(t,e){return e?function(n){return new h(n,e).lift(new c(t))}:function(e){return e.lift(new c(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../Observable"),s=t("../OuterSubscriber"),a=t("../util/subscribeToResult");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var c=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.delayDurationSelector))},t}(),l=function(t){function e(e,n){var r=t.call(this,e)||this;return r.delayDurationSelector=n,r.completed=!1,r.delayNotifierSubscriptions=[],r.index=0,r}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(t),this.removeSubscription(i),this.tryComplete()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},e.prototype._next=function(t){var e=this.index++;try{var n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},e.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},e.prototype.tryDelay=function(t,e){var n=(0,a.subscribeToResult)(this,t,e);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))},e.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},e}(s.OuterSubscriber),h=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subscriptionDelay=n,r}return r.__extends(e,t),e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new f(t,this.source))},e}(o.Observable),f=function(t){function e(e,n){var r=t.call(this)||this;return r.parent=e,r.source=n,r.sourceSubscribed=!1,r}return r.__extends(e,t),e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../Observable":"wbSE","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],v6b5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.dematerialize=function(){return function(t){return t.lift(new s)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new a(t))},t}(),a=function(t){function e(e){return t.call(this,e)||this}return r.__extends(e,t),e.prototype._next=function(t){t.observe(this.destination)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],H608:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.distinct=function(t,e){return function(n){return n.lift(new a(t,e))}},n.DistinctSubscriber=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.keySelector,this.flushes))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.keySelector=n,i.values=new Set,r&&i.add((0,o.subscribeToResult)(i,r)),i}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.values.clear()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(t){return void n.error(t)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},e}(i.OuterSubscriber);n.DistinctSubscriber=u},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],hFX7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.distinctUntilChanged=function(t,e){return function(n){return n.lift(new s(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.compare,this.keySelector))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return r.__extends(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(t){return this.destination.error(t)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],Egbr:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.distinctUntilKeyChanged=function(t,e){return(0,r.distinctUntilChanged)((function(n,r){return e?e(n[t],r[t]):n[t]===r[t]}))};var r=t("./distinctUntilChanged")},{"./distinctUntilChanged":"hFX7"}],D7Ma:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.throwIfEmpty=function(t){return void 0===t&&(t=c),function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../util/EmptyError"),o=t("../Subscriber");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.errorFactory))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.errorFactory=n,r.hasValue=!1,r}return r.__extends(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(o.Subscriber);function c(){return new i.EmptyError}},{tslib:"vCxL","../util/EmptyError":"vsl0","../Subscriber":"RaFB"}],JVEz:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.take=function(t){return function(e){return 0===t?(0,s.empty)():e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../util/ArgumentOutOfRangeError"),s=t("../observable/empty");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){if(this.total=t,this.total<0)throw new o.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.total))},t}(),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return r.__extends(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../util/ArgumentOutOfRangeError":"Qh4I","../observable/empty":"XsKQ"}],TbZV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.elementAt=function(t,e){if(t<0)throw new r.ArgumentOutOfRangeError;var n=arguments.length>=2;return function(u){return u.pipe((0,i.filter)((function(e,n){return n===t})),(0,a.take)(1),n?(0,s.defaultIfEmpty)(e):(0,o.throwIfEmpty)((function(){return new r.ArgumentOutOfRangeError})))}};var r=t("../util/ArgumentOutOfRangeError"),i=t("./filter"),o=t("./throwIfEmpty"),s=t("./defaultIfEmpty"),a=t("./take")},{"../util/ArgumentOutOfRangeError":"Qh4I","./filter":"HKzi","./throwIfEmpty":"D7Ma","./defaultIfEmpty":"YBdz","./take":"JVEz"}],loee:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.endWith=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return r.concat.apply(void 0,[e].concat(t))}};var r=t("../observable/concat")},{"../observable/concat":"CsdO"}],eEZZ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.every=function(t,e){return function(n){return n.lift(new s(t,e,n))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.thisArg,this.source))},t}(),a=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||o,o}return r.__extends(e,t),e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],ifNj:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.exhaust=function(){return function(t){return t.lift(new a)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new u(t))},t}(),u=function(t){function e(e){var n=t.call(this,e)||this;return n.hasCompleted=!1,n.hasSubscription=!1,n}return r.__extends(e,t),e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add((0,o.subscribeToResult)(this,t)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],DGWU:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.exhaustMap=function t(e,n){return n?function(r){return r.pipe(t((function(t,r){return(0,u.from)(e(t,r)).pipe((0,a.map)((function(e,i){return n(t,e,r,i)})))})))}:function(t){return t.lift(new l(e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../InnerSubscriber"),s=t("../util/subscribeToResult"),a=t("./map"),u=t("../observable/from");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.project))},t}(),h=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return r.__extends(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.hasSubscription=!0,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=new o.InnerSubscriber(this,void 0,void 0);this.destination.add(r),(0,s.subscribeToResult)(this,t,e,n,r)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR","../util/subscribeToResult":"JM7e","./map":"dNh5","../observable/from":"WXUl"}],iYcS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.expand=function(t,e,n){return void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=void 0),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(r){return r.lift(new a(t,e,n))}},n.ExpandSubscriber=n.ExpandOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e,n){this.project=t,this.concurrent=e,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.project,this.concurrent,this.scheduler))},t}();n.ExpandOperator=a;var u=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.project=n,o.concurrent=r,o.scheduler=i,o.index=0,o.active=0,o.hasCompleted=!1,r<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return r.__extends(e,t),e.dispatch=function(t){var e=t.subscriber,n=t.result,r=t.value,i=t.index;e.subscribeToProjection(n,r,i)},e.prototype._next=function(t){var n=this.destination;if(n.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){n.next(t);try{var i=(0,this.project)(t,r);if(this.scheduler){var o={subscriber:this,result:i,value:t,index:r};this.destination.add(this.scheduler.schedule(e.dispatch,0,o))}else this.subscribeToProjection(i,t,r)}catch(t){n.error(t)}}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,n){this.active++,this.destination.add((0,o.subscribeToResult)(this,t,e,n))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){this._next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.destination.remove(t),this.active--,e&&e.length>0&&this._next(e.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(i.OuterSubscriber);n.ExpandSubscriber=u},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],x5qu:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.finalize=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../Subscription");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.callback))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.add(new o.Subscription(n)),r}return r.__extends(e,t),e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../Subscription":"I8KM"}],t6rP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.find=function(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(n){return n.lift(new s(t,n,!1,e))}},n.FindValueSubscriber=n.FindValueOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e,n,r){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=r}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}();n.FindValueOperator=s;var a=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.predicate=n,s.source=r,s.yieldIndex=i,s.thisArg=o,s.index=0,s}return r.__extends(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},e.prototype._next=function(t){var e=this.predicate,n=this.thisArg,r=this.index++;try{e.call(n||this,t,r,this.source)&&this.notifyComplete(this.yieldIndex?r:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(i.Subscriber);n.FindValueSubscriber=a},{tslib:"vCxL","../Subscriber":"RaFB"}],GIlo:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.findIndex=function(t,e){return function(n){return n.lift(new r.FindValueOperator(t,n,!0,e))}};var r=t("../operators/find")},{"../operators/find":"t6rP"}],f9sd:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.first=function(t,e){var n=arguments.length>=2;return function(c){return c.pipe(t?(0,i.filter)((function(e,n){return t(e,n,c)})):u.identity,(0,o.take)(1),n?(0,s.defaultIfEmpty)(e):(0,a.throwIfEmpty)((function(){return new r.EmptyError})))}};var r=t("../util/EmptyError"),i=t("./filter"),o=t("./take"),s=t("./defaultIfEmpty"),a=t("./throwIfEmpty"),u=t("../util/identity")},{"../util/EmptyError":"vsl0","./filter":"HKzi","./take":"JVEz","./defaultIfEmpty":"YBdz","./throwIfEmpty":"D7Ma","../util/identity":"LXph"}],P82l:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ignoreElements=function(){return function(t){return t.lift(new s)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new a(t))},t}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype._next=function(t){},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],LqVv:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isEmpty=function(){return function(t){return t.lift(new s)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new a(t))},t}(),a=function(t){function e(e){return t.call(this,e)||this}return r.__extends(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],FbHg:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.takeLast=function(t){return function(e){return 0===t?(0,s.empty)():e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../util/ArgumentOutOfRangeError"),s=t("../observable/empty");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){if(this.total=t,this.total<0)throw new o.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.total))},t}(),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.ring=new Array,r.count=0,r}return r.__extends(e,t),e.prototype._next=function(t){var e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=e++%n;t.next(r[o])}t.complete()},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../util/ArgumentOutOfRangeError":"Qh4I","../observable/empty":"XsKQ"}],xu0X:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.last=function(t,e){var n=arguments.length>=2;return function(c){return c.pipe(t?(0,i.filter)((function(e,n){return t(e,n,c)})):u.identity,(0,o.takeLast)(1),n?(0,a.defaultIfEmpty)(e):(0,s.throwIfEmpty)((function(){return new r.EmptyError})))}};var r=t("../util/EmptyError"),i=t("./filter"),o=t("./takeLast"),s=t("./throwIfEmpty"),a=t("./defaultIfEmpty"),u=t("../util/identity")},{"../util/EmptyError":"vsl0","./filter":"HKzi","./takeLast":"FbHg","./throwIfEmpty":"D7Ma","./defaultIfEmpty":"YBdz","../util/identity":"LXph"}],yJbZ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mapTo=function(t){return function(e){return e.lift(new s(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.value))},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.value=n,r}return r.__extends(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],ZwCH:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.materialize=function(){return function(t){return t.lift(new a)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../Notification");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new u(t))},t}(),u=function(t){function e(e){return t.call(this,e)||this}return r.__extends(e,t),e.prototype._next=function(t){this.destination.next(o.Notification.createNext(t))},e.prototype._error=function(t){var e=this.destination;e.next(o.Notification.createError(t)),e.complete()},e.prototype._complete=function(){var t=this.destination;t.next(o.Notification.createComplete()),t.complete()},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../Notification":"n7Mc"}],U785:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.scan=function(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new s(t,e,n))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e,n){void 0===n&&(n=!1),this.accumulator=t,this.seed=e,this.hasSeed=n}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.accumulator,this.seed,this.hasSeed))},t}(),a=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return r.__extends(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],BORG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.reduce=function(t,e){return arguments.length>=2?function(n){return(0,s.pipe)((0,r.scan)(t,e),(0,i.takeLast)(1),(0,o.defaultIfEmpty)(e))(n)}:function(e){return(0,s.pipe)((0,r.scan)((function(e,n,r){return t(e,n,r+1)})),(0,i.takeLast)(1))(e)}};var r=t("./scan"),i=t("./takeLast"),o=t("./defaultIfEmpty"),s=t("../util/pipe")},{"./scan":"U785","./takeLast":"FbHg","./defaultIfEmpty":"YBdz","../util/pipe":"HQCS"}],BgD2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.max=function(t){var e="function"==typeof t?function(e,n){return t(e,n)>0?e:n}:function(t,e){return t>e?t:e};return(0,r.reduce)(e)};var r=t("./reduce")},{"./reduce":"BORG"}],sbfV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(r.merge.apply(void 0,[e].concat(t)))}};var r=t("../observable/merge")},{"../observable/merge":"DQig"}],S3q6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mergeMapTo=function(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?(0,r.mergeMap)((function(){return t}),e,n):("number"==typeof e&&(n=e),(0,r.mergeMap)((function(){return t}),n))};var r=t("./mergeMap")},{"./mergeMap":"nFsM"}],wQne:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mergeScan=function(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return r.lift(new u(t,e,n))}},n.MergeScanSubscriber=n.MergeScanOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../util/subscribeToResult"),o=t("../OuterSubscriber"),s=t("../InnerSubscriber");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t,e,n){this.accumulator=t,this.seed=e,this.concurrent=n}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.accumulator,this.seed,this.concurrent))},t}();n.MergeScanOperator=u;var c=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.accumulator=n,o.acc=r,o.concurrent=i,o.hasValue=!1,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return r.__extends(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,n=this.destination,r=void 0;try{r=(0,this.accumulator)(this.acc,t,e)}catch(t){return n.error(t)}this.active++,this._innerSub(r,t,e)}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,n){var r=new s.InnerSubscriber(this,void 0,void 0);this.destination.add(r),(0,i.subscribeToResult)(this,t,e,n,r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){var o=this.destination;this.acc=e,this.hasValue=!0,o.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.destination.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e}(o.OuterSubscriber);n.MergeScanSubscriber=c},{tslib:"vCxL","../util/subscribeToResult":"JM7e","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR"}],bAWd:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.min=function(t){var e="function"==typeof t?function(e,n){return t(e,n)<0?e:n}:function(t,e){return t<e?t:e};return(0,r.reduce)(e)};var r=t("./reduce")},{"./reduce":"BORG"}],M6Em:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.multicast=function(t,e){return function(n){var o;if(o="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new i(o,e));var s=Object.create(n,r.connectableObservableDescriptor);return s.source=n,s.subjectFactory=o,s}},n.MulticastOperator=void 0;var r=t("../observable/ConnectableObservable"),i=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i},t}();n.MulticastOperator=i},{"../observable/ConnectableObservable":"kkfD"}],S4UH:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.onErrorResumeNext=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length&&(0,o.isArray)(t[0])&&(t=t[0]),function(e){return e.lift(new l(t))}},n.onErrorResumeNextStatic=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n;return 1===t.length&&(0,o.isArray)(t[0])&&(t=t[0]),n=t.shift(),(0,i.from)(n,null).lift(new l(t))};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../observable/from"),o=t("../util/isArray"),s=t("../OuterSubscriber"),a=t("../InnerSubscriber"),u=t("../util/subscribeToResult");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.nextSources))},t}(),h=function(t){function e(e,n){var r=t.call(this,e)||this;return r.destination=e,r.nextSources=n,r}return r.__extends(e,t),e.prototype.notifyError=function(t,e){this.subscribeToNextSource()},e.prototype.notifyComplete=function(t){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource(),this.unsubscribe()},e.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();if(t){var e=new a.InnerSubscriber(this,void 0,void 0);this.destination.add(e),(0,u.subscribeToResult)(this,t,void 0,void 0,e)}else this.destination.complete()},e}(s.OuterSubscriber)},{tslib:"vCxL","../observable/from":"WXUl","../util/isArray":"KeTG","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR","../util/subscribeToResult":"JM7e"}],u6OS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pairwise=function(){return function(t){return t.lift(new s)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new a(t))},t}(),a=function(t){function e(e){var n=t.call(this,e)||this;return n.hasPrev=!1,n}return r.__extends(e,t),e.prototype._next=function(t){this.hasPrev?this.destination.next([this.prev,t]):this.hasPrev=!0,this.prev=t},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],jvG2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.partition=function(t,e){return function(n){return[(0,i.filter)(t,e)(n),(0,i.filter)((0,r.not)(t,e))(n)]}};var r=t("../util/not"),i=t("./filter")},{"../util/not":"nij6","./filter":"HKzi"}],TdE4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pluck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(e){return(0,r.map)(i(t,n))(e)}};var r=t("./map");function i(t,e){return function(n){for(var r=n,i=0;i<e;i++){var o=r[t[i]];if(void 0===o)return;r=o}return r}}},{"./map":"dNh5"}],TQAB:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.publish=function(t){return t?(0,i.multicast)((function(){return new r.Subject}),t):(0,i.multicast)(new r.Subject)};var r=t("../Subject"),i=t("./multicast")},{"../Subject":"r9t1","./multicast":"M6Em"}],fUyM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.publishBehavior=function(t){return function(e){return(0,i.multicast)(new r.BehaviorSubject(t))(e)}};var r=t("../BehaviorSubject"),i=t("./multicast")},{"../BehaviorSubject":"MPU6","./multicast":"M6Em"}],fQ7S:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.publishLast=function(){return function(t){return(0,i.multicast)(new r.AsyncSubject)(t)}};var r=t("../AsyncSubject"),i=t("./multicast")},{"../AsyncSubject":"Scvc","./multicast":"M6Em"}],aqWk:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.publishReplay=function(t,e,n,o){n&&"function"!=typeof n&&(o=n);var s="function"==typeof n?n:void 0,a=new r.ReplaySubject(t,e,o);return function(t){return(0,i.multicast)((function(){return a}),s)(t)}};var r=t("../ReplaySubject"),i=t("./multicast")},{"../ReplaySubject":"Cp6P","./multicast":"M6Em"}],EAaA:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.race=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return 1===t.length&&(0,r.isArray)(t[0])&&(t=t[0]),e.lift.call(i.race.apply(void 0,[e].concat(t)))}};var r=t("../util/isArray"),i=t("../observable/race")},{"../util/isArray":"KeTG","../observable/race":"bwYX"}],Fbxf:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.repeat=function(t){return void 0===t&&(t=-1),function(e){return 0===t?(0,o.empty)():t<0?e.lift(new a(-1,e)):e.lift(new a(t-1,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../observable/empty");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.count,this.source))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return r.__extends(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.complete.call(this);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../observable/empty":"XsKQ"}],CT9q:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.repeatWhen=function(t){return function(e){return e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../OuterSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.notifier,e))},t}(),c=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.notifier=n,i.source=r,i.sourceIsBeingSubscribedTo=!0,i}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(e){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return t.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},e.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,t.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},e.prototype.subscribeToRetries=function(){var e;this.notifications=new i.Subject;try{e=(0,this.notifier)(this.notifications)}catch(e){return t.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=(0,s.subscribeToResult)(this,e)},e}(o.OuterSubscriber)},{tslib:"vCxL","../Subject":"r9t1","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],ZHEI:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.retry=function(t){return void 0===t&&(t=-1),function(e){return e.lift(new s(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.count,this.source))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return r.__extends(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.source,r=this.count;if(0===r)return t.prototype.error.call(this,e);r>-1&&(this.count=r-1),n.subscribe(this._unsubscribeAndRecycle())}},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],GHe2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.retryWhen=function(t){return function(e){return e.lift(new u(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../OuterSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.notifier,this.source))},t}(),c=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.notifier=n,i.source=r,i}return r.__extends(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.errors,r=this.retries,o=this.retriesSubscription;if(r)this.errors=null,this.retriesSubscription=null;else{n=new i.Subject;try{r=(0,this.notifier)(n)}catch(e){return t.prototype.error.call(this,e)}o=(0,s.subscribeToResult)(this,r)}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=o,n.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype.notifyNext=function(t,e,n,r,i){var o=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=o,this.source.subscribe(this)},e}(o.OuterSubscriber)},{tslib:"vCxL","../Subject":"r9t1","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],Rd9o:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sample=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new u(t),r=e.subscribe(n);return r.add((0,o.subscribeToResult)(n,this.notifier)),r},t}(),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return r.__extends(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(t,e,n,r,i){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],nb45:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sampleTime=function(t,e){return void 0===e&&(e=o.async),function(n){return n.lift(new a(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../scheduler/async");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.period,this.scheduler))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.period=n,i.scheduler=r,i.hasValue=!1,i.add(r.schedule(c,n,{subscriber:i,period:n})),i}return r.__extends(e,t),e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(i.Subscriber);function c(t){var e=t.subscriber,n=t.period;e.notifyNext(),this.schedule(t,n)}},{tslib:"vCxL","../Subscriber":"RaFB","../scheduler/async":"jun6"}],PMGC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sequenceEqual=function(t,e){return function(n){return n.lift(new s(t,e))}},n.SequenceEqualSubscriber=n.SequenceEqualOperator=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.compareTo=t,this.comparator=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.compareTo,this.comparator))},t}();n.SequenceEqualOperator=s;var a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.compareTo=n,i.comparator=r,i._a=[],i._b=[],i._oneComplete=!1,i.destination.add(n.subscribe(new u(e,i))),i}return r.__extends(e,t),e.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},e.prototype.checkValues=function(){for(var t=this._a,e=this._b,n=this.comparator;t.length>0&&e.length>0;){var r=t.shift(),i=e.shift(),o=!1;try{o=n?n(r,i):r===i}catch(t){this.destination.error(t)}o||this.emit(!1)}},e.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},e.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},e}(i.Subscriber);n.SequenceEqualSubscriber=a;var u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.parent=n,r}return r.__extends(e,t),e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],KBGh:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.share=function(){return function(t){return(0,i.refCount)()((0,r.multicast)(s)(t))}};var r=t("./multicast"),i=t("./refCount"),o=t("../Subject");function s(){return new o.Subject}},{"./multicast":"M6Em","./refCount":"vT9o","../Subject":"r9t1"}],xsrM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shareReplay=function(t,e,n){var r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(i(r))}};var r=t("../ReplaySubject");function i(t){var e,n,i=t.bufferSize,o=void 0===i?Number.POSITIVE_INFINITY:i,s=t.windowTime,a=void 0===s?Number.POSITIVE_INFINITY:s,u=t.refCount,c=t.scheduler,l=0,h=!1,f=!1;return function(t){l++,e&&!h||(h=!1,e=new r.ReplaySubject(o,a,c),n=t.subscribe({next:function(t){e.next(t)},error:function(t){h=!0,e.error(t)},complete:function(){f=!0,e.complete()}}));var i=e.subscribe(this);this.add((function(){l--,i.unsubscribe(),n&&!f&&u&&0===l&&(n.unsubscribe(),n=void 0,e=void 0)}))}}},{"../ReplaySubject":"Cp6P"}],angX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.single=function(t){return function(e){return e.lift(new a(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../util/EmptyError");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.predicate,this.source))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.source=r,i.seenValue=!1,i.index=0,i}return r.__extends(e,t),e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},e.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new o.EmptyError)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../util/EmptyError":"vsl0"}],vMIz:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.skip=function(t){return function(e){return e.lift(new s(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.total))},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return r.__extends(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],iB53:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.skipLast=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../util/ArgumentOutOfRangeError");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new o.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new i.Subscriber(t)):e.subscribe(new u(t,this._skipCount))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r._skipCount=n,r._count=0,r._ring=new Array(n),r}return r.__extends(e,t),e.prototype._next=function(t){var e=this._skipCount,n=this._count++;if(n<e)this._ring[n]=t;else{var r=n%e,i=this._ring,o=i[r];i[r]=t,this.destination.next(o)}},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../util/ArgumentOutOfRangeError":"Qh4I"}],xmsT:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.skipUntil=function(t){return function(e){return e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../InnerSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.notifier))},t}(),c=function(t){function e(e,n){var r=t.call(this,e)||this;r.hasValue=!1;var i=new o.InnerSubscriber(r,void 0,void 0);return r.add(i),r.innerSubscription=i,(0,s.subscribeToResult)(r,n,void 0,void 0,i),r}return r.__extends(e,t),e.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},e.prototype.notifyNext=function(t,e,n,r,i){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},e.prototype.notifyComplete=function(){},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR","../util/subscribeToResult":"JM7e"}],qjDA:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.skipWhile=function(t){return function(e){return e.lift(new s(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate))},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.predicate=n,r.skipping=!0,r.index=0,r}return r.__extends(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],doo6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.startWith=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return(0,i.isScheduler)(n)?(t.pop(),function(e){return(0,r.concat)(t,e,n)}):function(e){return(0,r.concat)(t,e)}};var r=t("../observable/concat"),i=t("../util/isScheduler")},{"../observable/concat":"CsdO","../util/isScheduler":"VqoH"}],r9wA:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SubscribeOnObservable=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Observable"),o=t("../scheduler/asap"),s=t("../util/isNumeric");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(t){function e(e,n,r){void 0===n&&(n=0),void 0===r&&(r=o.asap);var i=t.call(this)||this;return i.source=e,i.delayTime=n,i.scheduler=r,(!(0,s.isNumeric)(n)||n<0)&&(i.delayTime=0),r&&"function"==typeof r.schedule||(i.scheduler=o.asap),i}return r.__extends(e,t),e.create=function(t,n,r){return void 0===n&&(n=0),void 0===r&&(r=o.asap),new e(t,n,r)},e.dispatch=function(t){var e=t.source,n=t.subscriber;return this.add(e.subscribe(n))},e.prototype._subscribe=function(t){var n=this.delayTime,r=this.source;return this.scheduler.schedule(e.dispatch,n,{source:r,subscriber:t})},e}(i.Observable);n.SubscribeOnObservable=u},{tslib:"vCxL","../Observable":"wbSE","../scheduler/asap":"ZqYc","../util/isNumeric":"wBpm"}],Et1l:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeOn=function(t,e){return void 0===e&&(e=0),function(n){return n.lift(new i(t,e))}};var r=t("../observable/SubscribeOnObservable"),i=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new r.SubscribeOnObservable(e,this.delay,this.scheduler).subscribe(t)},t}()},{"../observable/SubscribeOnObservable":"r9wA"}],g5Rk:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.switchMap=function t(e,n){return"function"==typeof n?function(r){return r.pipe(t((function(t,r){return(0,u.from)(e(t,r)).pipe((0,a.map)((function(e,i){return n(t,e,r,i)})))})))}:function(t){return t.lift(new l(e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../InnerSubscriber"),s=t("../util/subscribeToResult"),a=t("./map"),u=t("../observable/from");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.project))},t}(),h=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.index=0,r}return r.__extends(e,t),e.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new o.InnerSubscriber(this,void 0,void 0);this.destination.add(i),this.innerSubscription=(0,s.subscribeToResult)(this,t,e,n,i)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../InnerSubscriber":"aQbR","../util/subscribeToResult":"JM7e","./map":"dNh5","../observable/from":"WXUl"}],CBg8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.switchAll=function(){return(0,r.switchMap)(i.identity)};var r=t("./switchMap"),i=t("../util/identity")},{"./switchMap":"g5Rk","../util/identity":"LXph"}],Hs9S:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.switchMapTo=function(t,e){return e?(0,r.switchMap)((function(){return t}),e):(0,r.switchMap)((function(){return t}))};var r=t("./switchMap")},{"./switchMap":"g5Rk"}],qGSv:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.takeUntil=function(t){return function(e){return e.lift(new a(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new u(t),r=(0,o.subscribeToResult)(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n},t}(),u=function(t){function e(e){var n=t.call(this,e)||this;return n.seenValue=!1,n}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],EYJX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.takeWhile=function(t,e){return void 0===e&&(e=!1),function(n){return n.lift(new s(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}var s=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.inclusive))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return r.__extends(e,t),e.prototype._next=function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void n.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB"}],okAI:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tap=function(t,e,n){return function(r){return r.lift(new u(t,e,n))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../util/noop"),s=t("../util/isFunction");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.nextOrObserver,this.error,this.complete))},t}(),c=function(t){function e(e,n,r,i){var a=t.call(this,e)||this;return a._tapNext=o.noop,a._tapError=o.noop,a._tapComplete=o.noop,a._tapError=r||o.noop,a._tapComplete=i||o.noop,(0,s.isFunction)(n)?(a._context=a,a._tapNext=n):n&&(a._context=n,a._tapNext=n.next||o.noop,a._tapError=n.error||o.noop,a._tapComplete=n.complete||o.noop),a}return r.__extends(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../util/noop":"rXfM","../util/isFunction":"Qnsq"}],Yoo8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.throttle=function(t,e){return void 0===e&&(e=a),function(n){return n.lift(new u(t,e.leading,e.trailing))}},n.defaultThrottleConfig=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a={leading:!0,trailing:!1};n.defaultThrottleConfig=a;var u=function(){function t(t,e,n){this.durationSelector=t,this.leading=e,this.trailing=n}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.durationSelector,this.leading,this.trailing))},t}(),c=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.destination=e,o.durationSelector=n,o._leading=r,o._trailing=i,o._hasValue=!1,o}return r.__extends(e,t),e.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},e.prototype.send=function(){var t=this._hasValue,e=this._sendValue;t&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=null},e.prototype.throttle=function(t){var e=this.tryDurationSelector(t);e&&this.add(this._throttled=(0,o.subscribeToResult)(this,e))},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(t){return this.destination.error(t),null}},e.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=null,e&&this.send()},e.prototype.notifyNext=function(t,e,n,r,i){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],v3FQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.throttleTime=function(t,e,n){return void 0===e&&(e=o.async),void 0===n&&(n=s.defaultThrottleConfig),function(r){return r.lift(new u(t,e,n.leading,n.trailing))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../scheduler/async"),s=t("./throttle");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t,e,n,r){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),c=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.duration=n,s.scheduler=r,s.leading=i,s.trailing=o,s._hasTrailingValue=!1,s._trailingValue=null,s}return r.__extends(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(l,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(i.Subscriber);function l(t){t.subscriber.clearThrottle()}},{tslib:"vCxL","../Subscriber":"RaFB","../scheduler/async":"jun6","./throttle":"Yoo8"}],n6SK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.timeInterval=function(t){return void 0===t&&(t=r.async),function(e){return(0,o.defer)((function(){return e.pipe((0,i.scan)((function(e,n){var r=e.current;return{value:n,current:t.now(),last:r}}),{current:t.now(),value:void 0,last:void 0}),(0,s.map)((function(t){var e=t.current,n=t.last,r=t.value;return new a(r,e-n)})))}))}},n.TimeInterval=void 0;var r=t("../scheduler/async"),i=t("./scan"),o=t("../observable/defer"),s=t("./map"),a=function(t,e){this.value=t,this.interval=e};n.TimeInterval=a},{"../scheduler/async":"jun6","./scan":"U785","../observable/defer":"w9G6","./map":"dNh5"}],L72b:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.timeoutWith=function(t,e,n){return void 0===n&&(n=i.async),function(r){var i=(0,o.isDate)(t),s=i?+t-n.now():Math.abs(t);return r.lift(new c(s,i,e,n))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../scheduler/async"),o=t("../util/isDate"),s=t("../OuterSubscriber"),a=t("../util/subscribeToResult");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var c=function(){function t(t,e,n,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),l=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.absoluteTimeout=n,s.waitFor=r,s.withObservable=i,s.scheduler=o,s.action=null,s.scheduleTimeout(),s}return r.__extends(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add((0,a.subscribeToResult)(t,e))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},e}(s.OuterSubscriber)},{tslib:"vCxL","../scheduler/async":"jun6","../util/isDate":"rxSS","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],Cp8V:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.timeout=function(t,e){return void 0===e&&(e=r.async),(0,o.timeoutWith)(t,(0,s.throwError)(new i.TimeoutError),e)};var r=t("../scheduler/async"),i=t("../util/TimeoutError"),o=t("./timeoutWith"),s=t("../observable/throwError")},{"../scheduler/async":"jun6","../util/TimeoutError":"SZK7","./timeoutWith":"L72b","../observable/throwError":"FdIu"}],pXuq:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.timestamp=function(t){return void 0===t&&(t=r.async),(0,i.map)((function(e){return new o(e,t.now())}))},n.Timestamp=void 0;var r=t("../scheduler/async"),i=t("./map"),o=function(t,e){this.value=t,this.timestamp=e};n.Timestamp=o},{"../scheduler/async":"jun6","./map":"dNh5"}],LA40:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toArray=function(){return(0,r.reduce)(i,[])};var r=t("./reduce");function i(t,e,n){return 0===n?[e]:(t.push(e),t)}},{"./reduce":"BORG"}],Iygx:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.window=function(t){return function(e){return e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../OuterSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var n=new c(t),r=e.subscribe(n);return r.closed||n.add((0,s.subscribeToResult)(n,this.windowBoundaries)),r},t}(),c=function(t){function e(e){var n=t.call(this,e)||this;return n.window=new i.Subject,e.next(n.window),n}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.openWindow()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,n=this.window=new i.Subject;e.next(n)},e}(o.OuterSubscriber)},{tslib:"vCxL","../Subject":"r9t1","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],GYT2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.windowCount=function(t,e){return void 0===e&&(e=0),function(n){return n.lift(new a(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subscriber"),o=t("../Subject");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.windowSize,this.startWindowEvery))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.destination=e,i.windowSize=n,i.startWindowEvery=r,i.windows=[new o.Subject],i.count=0,e.next(i.windows[0]),i}return r.__extends(e,t),e.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,n=this.destination,r=this.windowSize,i=this.windows,s=i.length,a=0;a<s&&!this.closed;a++)i[a].next(t);var u=this.count-r+1;if(u>=0&&u%e==0&&!this.closed&&i.shift().complete(),++this.count%e==0&&!this.closed){var c=new o.Subject;i.push(c),n.next(c)}},e.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(i.Subscriber)},{tslib:"vCxL","../Subscriber":"RaFB","../Subject":"r9t1"}],Okss:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.windowTime=function(t){var e=o.async,n=null,r=Number.POSITIVE_INFINITY;return(0,u.isScheduler)(arguments[3])&&(e=arguments[3]),(0,u.isScheduler)(arguments[2])?e=arguments[2]:(0,a.isNumeric)(arguments[2])&&(r=arguments[2]),(0,u.isScheduler)(arguments[1])?e=arguments[1]:(0,a.isNumeric)(arguments[1])&&(n=arguments[1]),function(i){return i.lift(new l(t,n,r,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../scheduler/async"),s=t("../Subscriber"),a=t("../util/isNumeric"),u=t("../util/isScheduler");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}var l=function(){function t(t,e,n,r){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new f(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return r.__extends(e,t),e.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(i.Subject),f=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;s.destination=e,s.windowTimeSpan=n,s.windowCreationInterval=r,s.maxWindowSize=i,s.scheduler=o,s.windows=[];var a=s.openWindow();if(null!==r&&r>=0){var u={subscriber:s,window:a,context:null},c={windowTimeSpan:n,windowCreationInterval:r,subscriber:s,scheduler:o};s.add(o.schedule(y,n,u)),s.add(o.schedule(d,r,c))}else{var l={subscriber:s,window:a,windowTimeSpan:n};s.add(o.schedule(p,n,l))}return s}return r.__extends(e,t),e.prototype._next=function(t){for(var e=this.windows,n=e.length,r=0;r<n;r++){var i=e[r];i.closed||(i.next(t),i.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(i))}},e.prototype._error=function(t){for(var e=this.windows;e.length>0;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new h;return this.windows.push(t),this.destination.next(t),t},e.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},e}(s.Subscriber);function p(t){var e=t.subscriber,n=t.windowTimeSpan,r=t.window;r&&e.closeWindow(r),t.window=e.openWindow(),this.schedule(t,n)}function d(t){var e=t.windowTimeSpan,n=t.subscriber,r=t.scheduler,i=t.windowCreationInterval,o=n.openWindow(),s={action:this,subscription:null},a={subscriber:n,window:o,context:s};s.subscription=r.schedule(y,e,a),this.add(s.subscription),this.schedule(t,i)}function y(t){var e=t.subscriber,n=t.window,r=t.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),e.closeWindow(n)}},{tslib:"vCxL","../Subject":"r9t1","../scheduler/async":"jun6","../Subscriber":"RaFB","../util/isNumeric":"wBpm","../util/isScheduler":"VqoH"}],JiQj:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.windowToggle=function(t,e){return function(n){return n.lift(new c(t,e))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../Subscription"),s=t("../OuterSubscriber"),a=t("../util/subscribeToResult");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}var c=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.openings,this.closingSelector))},t}(),l=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(i.openSubscription=(0,a.subscribeToResult)(i,n,n)),i}return r.__extends(e,t),e.prototype._next=function(t){var e=this.contexts;if(e)for(var n=e.length,r=0;r<n;r++)e[r].window.next(t)},e.prototype._error=function(e){var n=this.contexts;if(this.contexts=null,n)for(var r=n.length,i=-1;++i<r;){var o=n[i];o.window.error(e),o.subscription.unsubscribe()}t.prototype._error.call(this,e)},e.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,r=-1;++r<n;){var i=e[r];i.window.complete(),i.subscription.unsubscribe()}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,n=-1;++n<e;){var r=t[n];r.window.unsubscribe(),r.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,e,n,r,s){if(t===this.openings){var u=void 0;try{u=(0,this.closingSelector)(e)}catch(t){return this.error(t)}var c=new i.Subject,l=new o.Subscription,h={window:c,subscription:l};this.contexts.push(h);var f=(0,a.subscribeToResult)(this,u,h);f.closed?this.closeWindow(this.contexts.length-1):(f.context=h,l.add(f)),this.destination.next(c)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,n=e[t],r=n.window,i=n.subscription;e.splice(t,1),r.complete(),i.unsubscribe()}},e}(s.OuterSubscriber)},{tslib:"vCxL","../Subject":"r9t1","../Subscription":"I8KM","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],YaG1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.windowWhen=function(t){return function(e){return e.lift(new u(t))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../Subject"),o=t("../OuterSubscriber"),s=t("../util/subscribeToResult");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var u=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.closingSelector))},t}(),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.destination=e,r.closingSelector=n,r.openWindow(),r}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.openWindow(i)},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var n,r=this.window=new i.Subject;this.destination.next(r);try{n=(0,this.closingSelector)()}catch(t){return this.destination.error(t),void this.window.error(t)}this.add(this.closingNotification=(0,s.subscribeToResult)(this,n))},e}(o.OuterSubscriber)},{tslib:"vCxL","../Subject":"r9t1","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],JDwQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.withLatestFrom=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"==typeof t[t.length-1]&&(n=t.pop());var r=t;return e.lift(new a(r,n))}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("tslib")),i=t("../OuterSubscriber"),o=t("../util/subscribeToResult");function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}var a=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.observables,this.project))},t}(),u=function(t){function e(e,n,r){var i=t.call(this,e)||this;i.observables=n,i.project=r,i.toRespond=[];var s=n.length;i.values=new Array(s);for(var a=0;a<s;a++)i.toRespond.push(a);for(a=0;a<s;a++){var u=n[a];i.add((0,o.subscribeToResult)(i,u,u,a))}return i}return r.__extends(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.values[n]=e;var o=this.toRespond;if(o.length>0){var s=o.indexOf(n);-1!==s&&o.splice(s,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(i.OuterSubscriber)},{tslib:"vCxL","../OuterSubscriber":"hZYI","../util/subscribeToResult":"JM7e"}],UwLD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.zip=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(r.zip.apply(void 0,[e].concat(t)))}};var r=t("../observable/zip")},{"../observable/zip":"ff2A"}],DmwP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.zipAll=function(t){return function(e){return e.lift(new r.ZipOperator(t))}};var r=t("../observable/zip")},{"../observable/zip":"ff2A"}],cVrl:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"audit",{enumerable:!0,get:function(){return r.audit}}),Object.defineProperty(n,"auditTime",{enumerable:!0,get:function(){return i.auditTime}}),Object.defineProperty(n,"buffer",{enumerable:!0,get:function(){return o.buffer}}),Object.defineProperty(n,"bufferCount",{enumerable:!0,get:function(){return s.bufferCount}}),Object.defineProperty(n,"bufferTime",{enumerable:!0,get:function(){return a.bufferTime}}),Object.defineProperty(n,"bufferToggle",{enumerable:!0,get:function(){return u.bufferToggle}}),Object.defineProperty(n,"bufferWhen",{enumerable:!0,get:function(){return c.bufferWhen}}),Object.defineProperty(n,"catchError",{enumerable:!0,get:function(){return l.catchError}}),Object.defineProperty(n,"combineAll",{enumerable:!0,get:function(){return h.combineAll}}),Object.defineProperty(n,"combineLatest",{enumerable:!0,get:function(){return f.combineLatest}}),Object.defineProperty(n,"concat",{enumerable:!0,get:function(){return p.concat}}),Object.defineProperty(n,"concatAll",{enumerable:!0,get:function(){return d.concatAll}}),Object.defineProperty(n,"concatMap",{enumerable:!0,get:function(){return y.concatMap}}),Object.defineProperty(n,"concatMapTo",{enumerable:!0,get:function(){return v.concatMapTo}}),Object.defineProperty(n,"count",{enumerable:!0,get:function(){return g.count}}),Object.defineProperty(n,"debounce",{enumerable:!0,get:function(){return b.debounce}}),Object.defineProperty(n,"debounceTime",{enumerable:!0,get:function(){return m.debounceTime}}),Object.defineProperty(n,"defaultIfEmpty",{enumerable:!0,get:function(){return w.defaultIfEmpty}}),Object.defineProperty(n,"delay",{enumerable:!0,get:function(){return _.delay}}),Object.defineProperty(n,"delayWhen",{enumerable:!0,get:function(){return S.delayWhen}}),Object.defineProperty(n,"dematerialize",{enumerable:!0,get:function(){return O.dematerialize}}),Object.defineProperty(n,"distinct",{enumerable:!0,get:function(){return E.distinct}}),Object.defineProperty(n,"distinctUntilChanged",{enumerable:!0,get:function(){return A.distinctUntilChanged}}),Object.defineProperty(n,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return C.distinctUntilKeyChanged}}),Object.defineProperty(n,"elementAt",{enumerable:!0,get:function(){return I.elementAt}}),Object.defineProperty(n,"endWith",{enumerable:!0,get:function(){return T.endWith}}),Object.defineProperty(n,"every",{enumerable:!0,get:function(){return x.every}}),Object.defineProperty(n,"exhaust",{enumerable:!0,get:function(){return k.exhaust}}),Object.defineProperty(n,"exhaustMap",{enumerable:!0,get:function(){return P.exhaustMap}}),Object.defineProperty(n,"expand",{enumerable:!0,get:function(){return N.expand}}),Object.defineProperty(n,"filter",{enumerable:!0,get:function(){return B.filter}}),Object.defineProperty(n,"finalize",{enumerable:!0,get:function(){return D.finalize}}),Object.defineProperty(n,"find",{enumerable:!0,get:function(){return R.find}}),Object.defineProperty(n,"findIndex",{enumerable:!0,get:function(){return j.findIndex}}),Object.defineProperty(n,"first",{enumerable:!0,get:function(){return M.first}}),Object.defineProperty(n,"groupBy",{enumerable:!0,get:function(){return L.groupBy}}),Object.defineProperty(n,"ignoreElements",{enumerable:!0,get:function(){return F.ignoreElements}}),Object.defineProperty(n,"isEmpty",{enumerable:!0,get:function(){return U.isEmpty}}),Object.defineProperty(n,"last",{enumerable:!0,get:function(){return V.last}}),Object.defineProperty(n,"map",{enumerable:!0,get:function(){return z.map}}),Object.defineProperty(n,"mapTo",{enumerable:!0,get:function(){return q.mapTo}}),Object.defineProperty(n,"materialize",{enumerable:!0,get:function(){return W.materialize}}),Object.defineProperty(n,"max",{enumerable:!0,get:function(){return G.max}}),Object.defineProperty(n,"merge",{enumerable:!0,get:function(){return H.merge}}),Object.defineProperty(n,"mergeAll",{enumerable:!0,get:function(){return Y.mergeAll}}),Object.defineProperty(n,"mergeMap",{enumerable:!0,get:function(){return K.mergeMap}}),Object.defineProperty(n,"flatMap",{enumerable:!0,get:function(){return K.mergeMap}}),Object.defineProperty(n,"mergeMapTo",{enumerable:!0,get:function(){return Q.mergeMapTo}}),Object.defineProperty(n,"mergeScan",{enumerable:!0,get:function(){return J.mergeScan}}),Object.defineProperty(n,"min",{enumerable:!0,get:function(){return X.min}}),Object.defineProperty(n,"multicast",{enumerable:!0,get:function(){return Z.multicast}}),Object.defineProperty(n,"observeOn",{enumerable:!0,get:function(){return $.observeOn}}),Object.defineProperty(n,"onErrorResumeNext",{enumerable:!0,get:function(){return tt.onErrorResumeNext}}),Object.defineProperty(n,"pairwise",{enumerable:!0,get:function(){return et.pairwise}}),Object.defineProperty(n,"partition",{enumerable:!0,get:function(){return nt.partition}}),Object.defineProperty(n,"pluck",{enumerable:!0,get:function(){return rt.pluck}}),Object.defineProperty(n,"publish",{enumerable:!0,get:function(){return it.publish}}),Object.defineProperty(n,"publishBehavior",{enumerable:!0,get:function(){return ot.publishBehavior}}),Object.defineProperty(n,"publishLast",{enumerable:!0,get:function(){return st.publishLast}}),Object.defineProperty(n,"publishReplay",{enumerable:!0,get:function(){return at.publishReplay}}),Object.defineProperty(n,"race",{enumerable:!0,get:function(){return ut.race}}),Object.defineProperty(n,"reduce",{enumerable:!0,get:function(){return ct.reduce}}),Object.defineProperty(n,"repeat",{enumerable:!0,get:function(){return lt.repeat}}),Object.defineProperty(n,"repeatWhen",{enumerable:!0,get:function(){return ht.repeatWhen}}),Object.defineProperty(n,"retry",{enumerable:!0,get:function(){return ft.retry}}),Object.defineProperty(n,"retryWhen",{enumerable:!0,get:function(){return pt.retryWhen}}),Object.defineProperty(n,"refCount",{enumerable:!0,get:function(){return dt.refCount}}),Object.defineProperty(n,"sample",{enumerable:!0,get:function(){return yt.sample}}),Object.defineProperty(n,"sampleTime",{enumerable:!0,get:function(){return vt.sampleTime}}),Object.defineProperty(n,"scan",{enumerable:!0,get:function(){return gt.scan}}),Object.defineProperty(n,"sequenceEqual",{enumerable:!0,get:function(){return bt.sequenceEqual}}),Object.defineProperty(n,"share",{enumerable:!0,get:function(){return mt.share}}),Object.defineProperty(n,"shareReplay",{enumerable:!0,get:function(){return wt.shareReplay}}),Object.defineProperty(n,"single",{enumerable:!0,get:function(){return _t.single}}),Object.defineProperty(n,"skip",{enumerable:!0,get:function(){return St.skip}}),Object.defineProperty(n,"skipLast",{enumerable:!0,get:function(){return Ot.skipLast}}),Object.defineProperty(n,"skipUntil",{enumerable:!0,get:function(){return Et.skipUntil}}),Object.defineProperty(n,"skipWhile",{enumerable:!0,get:function(){return At.skipWhile}}),Object.defineProperty(n,"startWith",{enumerable:!0,get:function(){return Ct.startWith}}),Object.defineProperty(n,"subscribeOn",{enumerable:!0,get:function(){return It.subscribeOn}}),Object.defineProperty(n,"switchAll",{enumerable:!0,get:function(){return Tt.switchAll}}),Object.defineProperty(n,"switchMap",{enumerable:!0,get:function(){return xt.switchMap}}),Object.defineProperty(n,"switchMapTo",{enumerable:!0,get:function(){return kt.switchMapTo}}),Object.defineProperty(n,"take",{enumerable:!0,get:function(){return Pt.take}}),Object.defineProperty(n,"takeLast",{enumerable:!0,get:function(){return Nt.takeLast}}),Object.defineProperty(n,"takeUntil",{enumerable:!0,get:function(){return Bt.takeUntil}}),Object.defineProperty(n,"takeWhile",{enumerable:!0,get:function(){return Dt.takeWhile}}),Object.defineProperty(n,"tap",{enumerable:!0,get:function(){return Rt.tap}}),Object.defineProperty(n,"throttle",{enumerable:!0,get:function(){return jt.throttle}}),Object.defineProperty(n,"throttleTime",{enumerable:!0,get:function(){return Mt.throttleTime}}),Object.defineProperty(n,"throwIfEmpty",{enumerable:!0,get:function(){return Lt.throwIfEmpty}}),Object.defineProperty(n,"timeInterval",{enumerable:!0,get:function(){return Ft.timeInterval}}),Object.defineProperty(n,"timeout",{enumerable:!0,get:function(){return Ut.timeout}}),Object.defineProperty(n,"timeoutWith",{enumerable:!0,get:function(){return Vt.timeoutWith}}),Object.defineProperty(n,"timestamp",{enumerable:!0,get:function(){return zt.timestamp}}),Object.defineProperty(n,"toArray",{enumerable:!0,get:function(){return qt.toArray}}),Object.defineProperty(n,"window",{enumerable:!0,get:function(){return Wt.window}}),Object.defineProperty(n,"windowCount",{enumerable:!0,get:function(){return Gt.windowCount}}),Object.defineProperty(n,"windowTime",{enumerable:!0,get:function(){return Ht.windowTime}}),Object.defineProperty(n,"windowToggle",{enumerable:!0,get:function(){return Yt.windowToggle}}),Object.defineProperty(n,"windowWhen",{enumerable:!0,get:function(){return Kt.windowWhen}}),Object.defineProperty(n,"withLatestFrom",{enumerable:!0,get:function(){return Qt.withLatestFrom}}),Object.defineProperty(n,"zip",{enumerable:!0,get:function(){return Jt.zip}}),Object.defineProperty(n,"zipAll",{enumerable:!0,get:function(){return Xt.zipAll}});var r=t("../internal/operators/audit"),i=t("../internal/operators/auditTime"),o=t("../internal/operators/buffer"),s=t("../internal/operators/bufferCount"),a=t("../internal/operators/bufferTime"),u=t("../internal/operators/bufferToggle"),c=t("../internal/operators/bufferWhen"),l=t("../internal/operators/catchError"),h=t("../internal/operators/combineAll"),f=t("../internal/operators/combineLatest"),p=t("../internal/operators/concat"),d=t("../internal/operators/concatAll"),y=t("../internal/operators/concatMap"),v=t("../internal/operators/concatMapTo"),g=t("../internal/operators/count"),b=t("../internal/operators/debounce"),m=t("../internal/operators/debounceTime"),w=t("../internal/operators/defaultIfEmpty"),_=t("../internal/operators/delay"),S=t("../internal/operators/delayWhen"),O=t("../internal/operators/dematerialize"),E=t("../internal/operators/distinct"),A=t("../internal/operators/distinctUntilChanged"),C=t("../internal/operators/distinctUntilKeyChanged"),I=t("../internal/operators/elementAt"),T=t("../internal/operators/endWith"),x=t("../internal/operators/every"),k=t("../internal/operators/exhaust"),P=t("../internal/operators/exhaustMap"),N=t("../internal/operators/expand"),B=t("../internal/operators/filter"),D=t("../internal/operators/finalize"),R=t("../internal/operators/find"),j=t("../internal/operators/findIndex"),M=t("../internal/operators/first"),L=t("../internal/operators/groupBy"),F=t("../internal/operators/ignoreElements"),U=t("../internal/operators/isEmpty"),V=t("../internal/operators/last"),z=t("../internal/operators/map"),q=t("../internal/operators/mapTo"),W=t("../internal/operators/materialize"),G=t("../internal/operators/max"),H=t("../internal/operators/merge"),Y=t("../internal/operators/mergeAll"),K=t("../internal/operators/mergeMap"),Q=t("../internal/operators/mergeMapTo"),J=t("../internal/operators/mergeScan"),X=t("../internal/operators/min"),Z=t("../internal/operators/multicast"),$=t("../internal/operators/observeOn"),tt=t("../internal/operators/onErrorResumeNext"),et=t("../internal/operators/pairwise"),nt=t("../internal/operators/partition"),rt=t("../internal/operators/pluck"),it=t("../internal/operators/publish"),ot=t("../internal/operators/publishBehavior"),st=t("../internal/operators/publishLast"),at=t("../internal/operators/publishReplay"),ut=t("../internal/operators/race"),ct=t("../internal/operators/reduce"),lt=t("../internal/operators/repeat"),ht=t("../internal/operators/repeatWhen"),ft=t("../internal/operators/retry"),pt=t("../internal/operators/retryWhen"),dt=t("../internal/operators/refCount"),yt=t("../internal/operators/sample"),vt=t("../internal/operators/sampleTime"),gt=t("../internal/operators/scan"),bt=t("../internal/operators/sequenceEqual"),mt=t("../internal/operators/share"),wt=t("../internal/operators/shareReplay"),_t=t("../internal/operators/single"),St=t("../internal/operators/skip"),Ot=t("../internal/operators/skipLast"),Et=t("../internal/operators/skipUntil"),At=t("../internal/operators/skipWhile"),Ct=t("../internal/operators/startWith"),It=t("../internal/operators/subscribeOn"),Tt=t("../internal/operators/switchAll"),xt=t("../internal/operators/switchMap"),kt=t("../internal/operators/switchMapTo"),Pt=t("../internal/operators/take"),Nt=t("../internal/operators/takeLast"),Bt=t("../internal/operators/takeUntil"),Dt=t("../internal/operators/takeWhile"),Rt=t("../internal/operators/tap"),jt=t("../internal/operators/throttle"),Mt=t("../internal/operators/throttleTime"),Lt=t("../internal/operators/throwIfEmpty"),Ft=t("../internal/operators/timeInterval"),Ut=t("../internal/operators/timeout"),Vt=t("../internal/operators/timeoutWith"),zt=t("../internal/operators/timestamp"),qt=t("../internal/operators/toArray"),Wt=t("../internal/operators/window"),Gt=t("../internal/operators/windowCount"),Ht=t("../internal/operators/windowTime"),Yt=t("../internal/operators/windowToggle"),Kt=t("../internal/operators/windowWhen"),Qt=t("../internal/operators/withLatestFrom"),Jt=t("../internal/operators/zip"),Xt=t("../internal/operators/zipAll")},{"../internal/operators/audit":"Pdg2","../internal/operators/auditTime":"jcYn","../internal/operators/buffer":"mG6b","../internal/operators/bufferCount":"f9IP","../internal/operators/bufferTime":"Axj2","../internal/operators/bufferToggle":"ZTTP","../internal/operators/bufferWhen":"Ul3A","../internal/operators/catchError":"THoY","../internal/operators/combineAll":"TMFF","../internal/operators/combineLatest":"DJQm","../internal/operators/concat":"ZHmI","../internal/operators/concatAll":"Yxey","../internal/operators/concatMap":"DoUK","../internal/operators/concatMapTo":"APQq","../internal/operators/count":"U1Ln","../internal/operators/debounce":"y9EZ","../internal/operators/debounceTime":"KBFO","../internal/operators/defaultIfEmpty":"YBdz","../internal/operators/delay":"zkgx","../internal/operators/delayWhen":"iVuv","../internal/operators/dematerialize":"v6b5","../internal/operators/distinct":"H608","../internal/operators/distinctUntilChanged":"hFX7","../internal/operators/distinctUntilKeyChanged":"Egbr","../internal/operators/elementAt":"TbZV","../internal/operators/endWith":"loee","../internal/operators/every":"eEZZ","../internal/operators/exhaust":"ifNj","../internal/operators/exhaustMap":"DGWU","../internal/operators/expand":"iYcS","../internal/operators/filter":"HKzi","../internal/operators/finalize":"x5qu","../internal/operators/find":"t6rP","../internal/operators/findIndex":"GIlo","../internal/operators/first":"f9sd","../internal/operators/groupBy":"dNgG","../internal/operators/ignoreElements":"P82l","../internal/operators/isEmpty":"LqVv","../internal/operators/last":"xu0X","../internal/operators/map":"dNh5","../internal/operators/mapTo":"yJbZ","../internal/operators/materialize":"ZwCH","../internal/operators/max":"BgD2","../internal/operators/merge":"sbfV","../internal/operators/mergeAll":"Nkv4","../internal/operators/mergeMap":"nFsM","../internal/operators/mergeMapTo":"S3q6","../internal/operators/mergeScan":"wQne","../internal/operators/min":"bAWd","../internal/operators/multicast":"M6Em","../internal/operators/observeOn":"ezNs","../internal/operators/onErrorResumeNext":"S4UH","../internal/operators/pairwise":"u6OS","../internal/operators/partition":"jvG2","../internal/operators/pluck":"TdE4","../internal/operators/publish":"TQAB","../internal/operators/publishBehavior":"fUyM","../internal/operators/publishLast":"fQ7S","../internal/operators/publishReplay":"aqWk","../internal/operators/race":"EAaA","../internal/operators/reduce":"BORG","../internal/operators/repeat":"Fbxf","../internal/operators/repeatWhen":"CT9q","../internal/operators/retry":"ZHEI","../internal/operators/retryWhen":"GHe2","../internal/operators/refCount":"vT9o","../internal/operators/sample":"Rd9o","../internal/operators/sampleTime":"nb45","../internal/operators/scan":"U785","../internal/operators/sequenceEqual":"PMGC","../internal/operators/share":"KBGh","../internal/operators/shareReplay":"xsrM","../internal/operators/single":"angX","../internal/operators/skip":"vMIz","../internal/operators/skipLast":"iB53","../internal/operators/skipUntil":"xmsT","../internal/operators/skipWhile":"qjDA","../internal/operators/startWith":"doo6","../internal/operators/subscribeOn":"Et1l","../internal/operators/switchAll":"CBg8","../internal/operators/switchMap":"g5Rk","../internal/operators/switchMapTo":"Hs9S","../internal/operators/take":"JVEz","../internal/operators/takeLast":"FbHg","../internal/operators/takeUntil":"qGSv","../internal/operators/takeWhile":"EYJX","../internal/operators/tap":"okAI","../internal/operators/throttle":"Yoo8","../internal/operators/throttleTime":"v3FQ","../internal/operators/throwIfEmpty":"D7Ma","../internal/operators/timeInterval":"n6SK","../internal/operators/timeout":"Cp8V","../internal/operators/timeoutWith":"L72b","../internal/operators/timestamp":"pXuq","../internal/operators/toArray":"LA40","../internal/operators/window":"Iygx","../internal/operators/windowCount":"GYT2","../internal/operators/windowTime":"Okss","../internal/operators/windowToggle":"JiQj","../internal/operators/windowWhen":"YaG1","../internal/operators/withLatestFrom":"JDwQ","../internal/operators/zip":"UwLD","../internal/operators/zipAll":"DmwP"}],f2sD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.__extends=function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n.__rest=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},n.__decorate=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},n.__param=function(t,e){return function(n,r){e(n,r,t)}},n.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},n.__awaiter=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},n.__generator=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},n.__createBinding=function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]},n.__exportStar=function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])},n.__values=o,n.__read=s,n.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},n.__spreadArrays=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r},n.__await=a,n.__asyncGenerator=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||u(t,e)}))})}function u(t,e){try{(n=i[t](e)).value instanceof a?Promise.resolve(n.value.v).then(c,l):h(o[0][2],n)}catch(t){h(o[0][3],t)}var n}function c(t){u("next",t)}function l(t){u("throw",t)}function h(t,e){t(e),o.shift(),o.length&&u(o[0][0],o[0][1])}},n.__asyncDelegator=function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:a(t[r](e)),done:"return"===r}:i?i(e):e}:i}},n.__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=o(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}},n.__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},n.__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},n.__importDefault=function(t){return t&&t.__esModule?t:{default:t}},n.__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},n.__classPrivateFieldSet=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n},n.__assign=void 0;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},i=function(){return n.__assign=i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)};function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(t){return this instanceof a?(this.v=t,this):new a(t)}n.__assign=i},{}],xA6u:[function(t,e,n){var r=arguments[3];Object.defineProperty(n,"__esModule",{value:!0});var i=t("tslib"),o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},s=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},u=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},c=function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):c(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var l=s<<4&240|a>>2;if(r.push(l),64!==u){var h=a<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){var e=u(t);return l.encodeByteArray(e,!0)},f=function(t){try{return l.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function p(t){return d(void 0,t)}function d(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=d(t[n],e[n]));return t}var y=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function g(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function b(){try{return"[object process]"===Object.prototype.toString.call(r.process)}catch(t){return!1}}function m(){return"object"==typeof self&&self.self===self}function w(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function S(){return v().indexOf("Electron/")>=0}function O(){var t=v();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E(){return v().indexOf("MSAppHost/")>=0}function A(){return!0===o.NODE_CLIENT||!0===o.NODE_ADMIN}function C(){return!b()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function I(){return"indexedDB"in self&&null!=indexedDB}function T(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function x(){return!(!navigator||!navigator.cookieEnabled)}var k="FirebaseError",P=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=k,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,N.prototype.create),i}return i.__extends(e,t),e}(Error),N=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?B(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new P(i,a),c=0,l=Object.keys(r);c<l.length;c++){var h=l[c];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},t}();function B(t,e){return t.replace(D,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var D=/\{\$([^}]+)}/g;function R(t){return JSON.parse(t)}function j(t){return JSON.stringify(t)}var M=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=R(f(o[0])||""),n=R(f(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},L=function(t){var e=M(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},F=function(t){var e=M(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},U=function(t){var e=M(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},V=function(t){var e=M(t).claims;return"object"==typeof e&&!0===e.admin};function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function q(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function W(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function G(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function H(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function Y(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e}var K=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=l^u&(c^l),s=1518500249):(o=u^c^l,s=1859775393):r<60?(o=u&c|l&(u|c),s=2400959708):(o=u^c^l,s=3395469782),i=(a<<5|a>>>27)+o+h+s+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=a,a=i;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function Q(t,e){var n=new J(t,e);return n.subscribe.bind(n)}var J=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=Z(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=$),void 0===r.error&&(r.error=$),void 0===r.complete&&(r.complete=$);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function X(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function Z(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}function $(){}var tt=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function et(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}function nt(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(et(t,e,r)+"must be a valid firebase namespace.")}function rt(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(et(t,e,r)+"must be a valid function.")}function it(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(et(t,e,r)+"must be a valid context object.")}var ot=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;s(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},st=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},at=1e3,ut=2,ct=144e5,lt=.5;function ht(t,e,n){void 0===e&&(e=at),void 0===n&&(n=ut);var r=e*Math.pow(n,t),i=Math.round(lt*r*(Math.random()-.5)*2);return Math.min(ct,r+i)}n.CONSTANTS=o,n.Deferred=y,n.ErrorFactory=N,n.FirebaseError=P,n.MAX_VALUE_MILLIS=ct,n.RANDOM_FACTOR=lt,n.Sha1=K,n.areCookiesEnabled=x,n.assert=s,n.assertionError=a,n.async=X,n.base64=l,n.base64Decode=f,n.base64Encode=h,n.calculateBackoffMillis=ht,n.contains=z,n.createSubscribe=Q,n.decode=M,n.deepCopy=p,n.deepExtend=d,n.errorPrefix=et,n.getUA=v,n.isAdmin=V,n.isBrowser=m,n.isBrowserExtension=w,n.isElectron=S,n.isEmpty=W,n.isIE=O,n.isIndexedDBAvailable=I,n.isMobileCordova=g,n.isNode=b,n.isNodeSdk=A,n.isReactNative=_,n.isSafari=C,n.isUWP=E,n.isValidFormat=U,n.isValidTimestamp=L,n.issuedAtTime=F,n.jsonEval=R,n.map=G,n.querystring=H,n.querystringDecode=Y,n.safeGet=q,n.stringLength=st,n.stringToByteArray=ot,n.stringify=j,n.validateArgCount=tt,n.validateCallback=rt,n.validateContextObject=it,n.validateIndexedDBOpenable=T,n.validateNamespace=nt},{tslib:"f2sD"}],nzQs:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("tslib"),i=t("@firebase/util"),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=s);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:s,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var a=this.getOrInitializeService(o);if(!a){if(i)return null;throw Error("Service "+this.name+" is not available")}return a}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(s)}catch(t){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=r.__read(o.value,2),u=a[0],c=a[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService(l);c.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=s),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(r.__spread(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===s?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:s:t},t}(),u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();n.Component=o,n.ComponentContainer=u,n.Provider=a},{tslib:"f2sD","@firebase/util":"xA6u"}],TUpU:[function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var i;Object.defineProperty(n,"__esModule",{value:!0}),n.setLogLevel=function(t){s.forEach((function(e){e.setLogLevel(t)}))},n.setUserLogHandler=function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var a=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=s;r<i.length;r++)n(i[r])},n.Logger=n.LogLevel=void 0;var o,s=[];n.LogLevel=o,function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(n.LogLevel=o={}));var a={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=c[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,s.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();n.Logger=h},{}],dP58:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i,o=t("tslib"),s=t("@firebase/util"),a=t("@firebase/component"),u=t("@firebase/logger"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new s.ErrorFactory("app","Firebase",c),h="@firebase/app",f="[DEFAULT]",p=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),d=new u.Logger("@firebase/app"),y=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=s.deepCopy(t),this.container=new a.ComponentContainer(e.name),this._addComponent(new a.Component("app",(function(){return u}),"PUBLIC"));try{for(var c=o.__values(this.firebase_.INTERNAL.components.values()),l=c.next();!l.done;l=c.next()){var h=l.value;this._addComponent(h)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=f),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();y.prototype.name&&y.prototype.options||y.prototype.delete||console.log("dc");var v=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),("object"!=typeof i||null===i)&&(i={name:i});var o=i;void 0===o.name&&(o.name=f);var a=o.name;if("string"!=typeof a||!a)throw l.create("bad-app-name",{appName:String(a)});if(s.contains(e,a))throw l.create("duplicate-app",{appName:a});var u=new t(n,o,r);return e[a]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=p[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void d.warn(u.join(" "))}c(new a.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument",{appName:name});u.setUserLogHandler(t,e)},apps:null,SDK_VERSION:"7.20.0",INTERNAL:{registerComponent:c,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!s.contains(e,t))throw l.create("no-app",{appName:t});return e[t]}function c(a){var u,c,h=a.name;if(n.has(h))return d.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===a.type?r[h]:null;if(n.set(h,a),"PUBLIC"===a.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw l.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==a.serviceProps&&s.deepExtend(f,a.serviceProps),r[h]=f,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,h).apply(this,a.multipleInstances?t:[])}}try{for(var p=o.__values(Object.keys(e)),y=p.next();!y.done;y=p.next()){var v=y.value;e[v]._addComponent(a)}}catch(t){u={error:t}}finally{try{y&&!y.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return"PUBLIC"===a.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(y);return e.INTERNAL=o.__assign(o.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){s.deepExtend(e,t)},createSubscribe:s.createSubscribe,ErrorFactory:s.ErrorFactory,deepExtend:s.deepExtend}),e}(),g=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(s.isBrowser()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var b=self.firebase.SDK_VERSION;b&&b.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var m=v.initializeApp;v.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.isNode()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),m.apply(void 0,t)};var w=v;(function(t,e){t.INTERNAL.registerComponent(new a.Component("platform-logger",(function(t){return new g(t)}),"PRIVATE")),t.registerVersion(h,"0.6.11",void 0),t.registerVersion("fire-js","")})(w),n.default=w,n.firebase=w},{tslib:"f2sD","@firebase/util":"xA6u","@firebase/component":"nzQs","@firebase/logger":"TUpU"}],ZUoI:[function(t,e,n){"use strict";var r,i=(r=t("@firebase/app"))&&"object"==typeof r&&"default"in r?r:{default:r};i.default.registerVersion("firebase","7.24.0","app"),e.exports=i.default},{"@firebase/app":"dP58"}],pBGv:[function(t,e,n){var r,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function c(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var l,h=[],f=!1,p=-1;function d(){f&&l&&(f=!1,l.length?h=l.concat(h):p=-1,h.length&&y())}function y(){if(!f){var t=u(d);f=!0;for(var e=h.length;e;){for(l=h,h=[];++p<e;)l&&l[p].run();p=-1,e=h.length}l=null,f=!1,c(t)}}function v(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new v(t,e)),1!==h.length||f||u(y)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],vmMz:[function(t,e,n){t("process");var r=t("process");Object.defineProperty(n,"__esModule",{value:!0});var i=t("@firebase/app"),o=t("tslib"),s=t("@firebase/util"),a=t("@firebase/logger"),u=t("@firebase/component"),c=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(i),l=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),s.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:s.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),h=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return s.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),f=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new l(e)}}catch(t){}return new h},p=f("localStorage"),d=f("sessionStorage"),y=new a.Logger("@firebase/database"),v=function(){var t=1;return function(){return t++}}(),g=function(t){var e=s.stringToByteArray(t),n=new s.Sha1;n.update(e);var r=n.digest();return s.base64.encodeByteArray(r)},b=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=b.apply(null,i):n+="object"==typeof i?s.stringify(i):i,n+=" "}return n},m=null,w=!0,_=function(t,e){s.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(y.logLevel=a.LogLevel.VERBOSE,m=y.log.bind(y),e&&d.set("logging_enabled",!0)):"function"==typeof t?m=t:(m=null,d.remove("logging_enabled"))},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===w&&(w=!1,null===m&&!0===d.get("logging_enabled")&&_(!0)),m){var n=b.apply(null,t);m(n)}},O=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];S.apply(void 0,o.__spread([t],e))}},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+b.apply(void 0,o.__spread(t));y.error(n)},A=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+b.apply(void 0,o.__spread(t));throw y.error(n),new Error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+b.apply(void 0,o.__spread(t));y.warn(n)},I=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},T=function(t){if(s.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}},x="[MIN_NAME]",k="[MAX_NAME]",P=function(t,e){if(t===e)return 0;if(t===x||e===k)return-1;if(e===x||t===k)return 1;var n=F(t),r=F(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},N=function(t,e){return t===e?0:t<e?-1:1},B=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+s.stringify(e))},D=function(t){if("object"!=typeof t||null===t)return s.stringify(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=s.stringify(e[i]),r+=":",r+=D(t[e[i]]);return r+"}"},R=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function j(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var M=function(t){var e,n,r,i,o;s.assert(!I(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();var u=a.join(""),c="";for(o=0;o<64;o+=8){var l=parseInt(u.substr(o,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},L=new RegExp("^-?(0*)\\d{1,10}$"),F=function(t){if(L.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},U=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw C("Exception was thrown by user callback.",e),t}),Math.floor(0))}},V=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},z=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!1,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=P(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),q=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=s.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=s.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=s.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),W="firebaseio.com",G="websocket",H="long_polling",Y=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=p.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&p.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(s.assert("string"==typeof t,"typeof type must == string"),s.assert("object"==typeof e,"typeof params must == object"),t===G)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==H)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return j(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();function K(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=o.__values(t.split("&")),s=i.next();!s.done;s=i.next()){var a=s.value;if(0!==a.length){var u=a.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):C("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}var Q,J,X,Z,$,tt,et,nt=function(t,e){var n=rt(t),r=n.namespace;"firebase.com"===n.domain&&A(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||A("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Y(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new z(n.pathString)}},rt=function(t){var e="",n="",r="",i="",o="",s=!0,a="https",u=443;if("string"==typeof t){var c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));var l=t.indexOf("/");-1===l&&(l=t.length);var h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(l,h)),l<h&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(l,h)));var f=K(t.substring(Math.min(t.length,h)));(c=e.indexOf(":"))>=0?(s="https"===a||"wss"===a,u=parseInt(e.substring(c+1),10)):c=e.length;var p=e.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var d=e.indexOf(".");r=e.substring(0,d).toLowerCase(),n=e.substring(d+1),o=r}"ns"in f&&(o=f.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}},it=/[\[\].#$\/\u0000-\u001F\u007F]/,ot=/[\[\].#$\u0000-\u001F\u007F]/,st=10485760,at=function(t){return"string"==typeof t&&0!==t.length&&!it.test(t)},ut=function(t){return"string"==typeof t&&0!==t.length&&!ot.test(t)},ct=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!I(t)||t&&"object"==typeof t&&s.contains(t,".sv")},lt=function(t,e,n,r,i){i&&void 0===n||ht(s.errorPrefix(t,e,i),n,r)},ht=function(t,e,n){var r=n instanceof z?new q(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(I(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>st/3&&s.stringLength(e)>st)throw new Error(t+"contains a string greater than "+st+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(j(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!at(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),ht(t,n,r),r.pop()})),i&&o)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},ft=function(t,e,n,r,i){if(!i||void 0!==n){var o=s.errorPrefix(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];j(n,(function(t,e){var n=new z(t);if(ht(o,e,r.child(n)),".priority"===n.getBack()&&!ct(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!at(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(z.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(o,a)}},pt=function(t,e,n,r){if(!r||void 0!==n){if(I(n))throw new Error(s.errorPrefix(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ct(n))throw new Error(s.errorPrefix(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},dt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(s.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},yt=function(t,e,n,r){if(!(r&&void 0===n||at(n)))throw new Error(s.errorPrefix(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},vt=function(t,e,n,r){if(!(r&&void 0===n||ut(n)))throw new Error(s.errorPrefix(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},gt=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),vt(t,e,n,r)},bt=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},mt=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!at(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ut(t)}(r))throw new Error(s.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},wt=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(s.errorPrefix(t,e,r)+"must be a boolean.")},_t=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){s.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),s.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new s.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){s.validateArgCount("OnDisconnect.remove",0,1,arguments.length),bt("OnDisconnect.remove",this.path_),s.validateCallback("OnDisconnect.remove",1,t,!0);var e=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){s.validateArgCount("OnDisconnect.set",1,2,arguments.length),bt("OnDisconnect.set",this.path_),lt("OnDisconnect.set",1,t,this.path_,!1),s.validateCallback("OnDisconnect.set",2,e,!0);var n=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){s.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),bt("OnDisconnect.setWithPriority",this.path_),lt("OnDisconnect.setWithPriority",1,t,this.path_,!1),pt("OnDisconnect.setWithPriority",2,e,!1),s.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new s.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(s.validateArgCount("OnDisconnect.update",1,2,arguments.length),bt("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ft("OnDisconnect.update",1,t,this.path_,!1),s.validateCallback("OnDisconnect.update",2,e,!0);var i=new s.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),St=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return s.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Ot=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(r){var i,o=r===e;e=r;var a=new Array(8);for(i=7;i>=0;i--)a[i]=t.charAt(r%64),r=Math.floor(r/64);s.assert(0===r,"Cannot push at time == 0");var u=a.join("");if(o){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)u+=t.charAt(n[i]);return s.assert(20===u.length,"nextPushId: Length should be 20."),u}}(),Et=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),At=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Et(x,t),r=new Et(x,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Et.MIN},t}(),Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Q},set:function(t){Q=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return P(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw s.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Et.MIN},e.prototype.maxPost=function(){return new Et(k,Q)},e.prototype.makePost=function(t,e){return s.assert("string"==typeof t,"KeyIndex indexValue must always be a string."),new Et(t,Q)},e.prototype.toString=function(){return".key"},e}(At),It=new Ct,Tt=function(t){return"number"==typeof t?"number:"+M(t):"string:"+t},xt=function(t){if(t.isLeafNode()){var e=t.val();s.assert("string"==typeof e||"number"==typeof e||"object"==typeof e&&s.contains(e,".sv"),"Priority must be a string or number.")}else s.assert(t===J||t.isEmpty(),"priority of unexpected type.");s.assert(t===J||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},kt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,s.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),xt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return X},set:function(t){X=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(s.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Tt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?M(this.value_):this.value_,this.lazyHash_=g(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(s.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return s.assert(i>=0,"Unknown leaf type: "+n),s.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Pt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?P(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Et.MIN},e.prototype.maxPost=function(){return new Et(k,new kt("[PRIORITY-POST]",$))},e.prototype.makePost=function(t,e){var n=Z(t);return new Et(e,new kt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(At)),Nt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Bt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Rt.EMPTY_NODE,this.right=null!=o?o:Rt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Rt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Rt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Dt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Bt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Rt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Bt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Bt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Nt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Nt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Nt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Nt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Dt,t}(),jt=Math.log(2),Mt=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/jt,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Lt=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new Bt(s,o.node,Bt.BLACK,null,null);var u=parseInt(a/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],s=n?n(o):o,new Bt(s,o.node,Bt.BLACK,c,l)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var c=i(o+1,a),l=t[o],h=n?n(l):l;u(new Bt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?a(h,Bt.BLACK):(a(h,Bt.BLACK),a(h,Bt.RED))}return o}(new Mt(t.length));return new Rt(r||e,o)},Ft={},Ut=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return s.assert(Ft&&Pt,"ChildrenNode.ts has not been loaded"),tt=tt||new t({".priority":Ft},{".priority":Pt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=s.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Rt?e:null},t.prototype.hasIndex=function(t){return s.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){s.assert(e!==It,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,u=n.getIterator(Et.Wrap),c=u.getNext();c;)a=a||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=a?Lt(i,e.getCompare()):Ft;var l=e.toString(),h=o.__assign({},this.indexSet_);h[l]=e;var f=o.__assign({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(s.map(this.indexes_,(function(t,i){var o=s.safeGet(r.indexSet_,i);if(s.assert(o,"Missing index implementation for "+i),t===Ft){if(o.isDefinedOn(e.node)){for(var a=[],u=n.getIterator(Et.Wrap),c=u.getNext();c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Lt(a,o.getCompare())}return Ft}var l=n.get(e.name),h=t;return l&&(h=h.remove(new Et(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(s.map(this.indexes_,(function(t){if(t===Ft)return t;var r=n.get(e.name);return r?t.remove(new Et(e.name,r)):t})),this.indexSet_)},t}();function Vt(t,e){return P(t.name,e.name)}function zt(t,e){return P(t,e)}var qt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&xt(this.priorityNode_),this.children_.isEmpty()&&s.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return et||(et=new t(new Rt(zt),null,Ut.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||et},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?et:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(s.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Et(e,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?et:this.priorityNode_;return new t(i,a,o)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;s.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Pt,(function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1})),!e&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Tt(this.getPriority().val())+":"),this.forEachChild(Pt,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":g(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Et(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Et(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Et(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Et.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Et.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Wt?-1:0},t.prototype.withIndex=function(e){if(e===It||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===It||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Pt),r=e.getIterator(Pt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===It?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Wt=new(function(t){function e(){return t.call(this,new Rt(zt),qt.EMPTY_NODE,Ut.Default)||this}return o.__extends(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return qt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(qt));function Gt(t,e){if(void 0===e&&(e=null),null===t)return qt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),s.assert(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new kt(t,Gt(e));if(t instanceof Array){var n=qt.EMPTY_NODE;return j(t,(function(e,r){if(s.contains(t,e)&&"."!==e.substring(0,1)){var i=Gt(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(Gt(e))}var r=[],i=!1;if(j(t,(function(t,e){if("."!==t.substring(0,1)){var n=Gt(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Et(t,n)))}})),0===r.length)return qt.EMPTY_NODE;var o=Lt(r,Vt,(function(t){return t.name}),zt);if(i){var a=Lt(r,Pt.getCompare());return new qt(o,Gt(e),new Ut({".priority":a},{".priority":Pt}))}return new qt(o,Gt(e),Ut.Default)}Object.defineProperties(Et,{MIN:{value:new Et(x,qt.EMPTY_NODE)},MAX:{value:new Et(k,Wt)}}),Ct.__EMPTY_NODE=qt.EMPTY_NODE,kt.__childrenNodeConstructor=qt,function(t){J=t}(Wt),function(t){$=t}(Wt),function(t){Z=t}(Gt);var Ht,Yt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?P(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Et.MIN},e.prototype.maxPost=function(){return Et.MAX},e.prototype.makePost=function(t,e){var n=Gt(t);return new Et(e,n)},e.prototype.toString=function(){return".value"},e}(At)),Kt=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,s.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return o.__extends(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?P(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=Gt(t),r=qt.EMPTY_NODE.updateChild(this.indexPath_,n);return new Et(e,r)},e.prototype.maxPost=function(){var t=qt.EMPTY_NODE.updateChild(this.indexPath_,Wt);return new Et(k,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(At),Qt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return s.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return s.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return s.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return s.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){s.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),vt("DataSnapshot.child",1,e,!1);var n=new z(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,Pt)},t.prototype.hasChild=function(t){s.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),vt("DataSnapshot.hasChild",1,t,!1);var e=new z(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return s.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;return s.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),s.validateCallback("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),Pt))}))},t.prototype.hasChildren=function(){return s.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return s.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return s.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Jt=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+s.stringify(this.snapshot.exportVal())},t}(),Xt=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Zt=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Jt("value",this,new Qt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Xt(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),$t=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,s.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Xt(this,t,e):null},t.prototype.createEvent=function(t,e){s.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Jt(t.type,this,new Qt(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var s=r[0],a=i[0];return!(a!==s||e.callbacks_[s]&&this.callbacks_[a]&&e.callbacks_[s]!==this.callbacks_[a])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),te=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return s.assert(Ht,"Reference.ts has not been loaded"),Ht},set:function(t){Ht=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===It){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==x)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==k)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Pt){if(null!=e&&!ct(e)||null!=n&&!ct(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(s.assert(t.getIndex()instanceof Kt||t.getIndex()===Yt,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return s.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){s.validateArgCount("Query.on",2,4,arguments.length),dt("Query.on",1,e,!1),s.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new Zt(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new $t(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){s.validateArgCount("Query.off",0,3,arguments.length),dt("Query.off",1,t,!0),s.validateCallback("Query.off",2,e,!0),s.validateContextObject("Query.off",3,n,!0);var r=null,i=null;"value"===t?r=new Zt(e||null,null,n||null):t&&(e&&((i={})[t]=e),r=new $t(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;s.validateArgCount("Query.once",1,4,arguments.length),dt("Query.once",1,e,!1),s.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new s.Deferred;c.promise.catch((function(){}));var l=function(t){u&&(u=!1,o.off(e,l),n&&n.bind(a.context)(t),c.resolve(t))};return this.on(e,l,(function(t){o.off(e,l),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)})),c.promise},t.prototype.limitToFirst=function(e){if(s.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(s.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(s.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');vt("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new z(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Kt(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){s.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(It);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){s.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Pt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){s.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Yt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),s.validateArgCount("Query.startAt",0,2,arguments.length),lt("Query.startAt",1,e,this.path,!0),yt("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),s.validateArgCount("Query.endAt",0,2,arguments.length),lt("Query.endAt",1,e,this.path,!0),yt("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(s.validateArgCount("Query.equalTo",1,2,arguments.length),lt("Query.equalTo",1,t,this.path,!1),yt("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return s.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return s.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=D(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(s.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var n=this.repo===e.repo,r=this.path.equals(e.path),i=this.queryIdentifier()===e.queryIdentifier();return n&&r&&i},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,s.validateCallback(t,3,r.cancel,!0),r.context=n,s.validateContextObject(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(s.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),ee=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),ne=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=this.path_.child(e);return new t(this.syncTree_,n)},t.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},t}(),re=function(t,e,n){return t&&"object"==typeof t?(s.assert(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?ie(t[".sv"],e,n):"object"==typeof t[".sv"]?oe(t[".sv"],e):void s.assert(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},ie=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:s.assert(!1,"Unexpected server value: "+t)}},oe=function(t,e,n){t.hasOwnProperty("increment")||s.assert(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&s.assert(!1,"Unexpected increment value: "+r);var i=e.node();if(s.assert(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},se=function(t,e,n,r){return ue(e,new ne(n,t),r)},ae=function(t,e,n){return ue(t,new ee(e),n)};function ue(t,e,n){var r,i=t.getPriority().val(),o=re(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var s=t,a=re(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new kt(a,Gt(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new kt(o))),u.forEachChild(Pt,(function(t,i){var o=ue(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var ce,le=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(Pt,(function(t,e){n.remember(new z(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();return t=t.popFront(),this.children.has(r)&&this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new z(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}();!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ce||(ce={}));var he,fe,pe=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,s.assert(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),de=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=ce.ACK_USER_WRITE,this.source=pe.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return s.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new z(e));return new t(z.Empty,n,this.revert)}return s.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),ye=function(){function t(t,e){void 0===e&&(he||(he=new Rt(N)),e=he),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return j(e,(function(t,e){n=n.set(new z(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:z.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new z(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(z.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,z.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,z.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(z.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),ve=function(){function t(t,e){this.source=t,this.path=e,this.type=ce.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,z.Empty):new t(this.source,this.path.popFront())},t}(),ge=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=ce.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,z.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),be=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=ce.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new z(e));return n.isEmpty()?null:n.value?new ge(this.source,z.Empty,n.value):new t(this.source,z.Empty,n)}return s.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),me=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),we=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new me(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new me(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new me(qt.EMPTY_NODE,!1,!1),new me(qt.EMPTY_NODE,!1,!1)),t}(),_e=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),Se=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){s.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(_e.childRemovedChange(e,a)):s.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(_e.childAddedChange(e,n)):o.trackChildChange(_e.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Pt,(function(t,r){e.hasChild(t)||n.trackChildChange(_e.childRemovedChange(t,r))})),e.isLeafNode()||e.forEachChild(Pt,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(_e.childChangedChange(e,r,i))}else n.trackChildChange(_e.childAddedChange(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?qt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Oe=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;s.assert(e===_e.CHILD_ADDED||e===_e.CHILD_CHANGED||e===_e.CHILD_REMOVED,"Only child changes supported for tracking"),s.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e===_e.CHILD_ADDED&&i===_e.CHILD_REMOVED)this.changeMap.set(n,_e.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e===_e.CHILD_REMOVED&&i===_e.CHILD_ADDED)this.changeMap.delete(n);else if(e===_e.CHILD_REMOVED&&i===_e.CHILD_CHANGED)this.changeMap.set(n,_e.childRemovedChange(n,r.oldSnap));else if(e===_e.CHILD_CHANGED&&i===_e.CHILD_ADDED)this.changeMap.set(n,_e.childAddedChange(n,t.snapshotNode));else{if(e!==_e.CHILD_CHANGED||i!==_e.CHILD_CHANGED)throw s.assertionError("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,_e.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Ee=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Ae=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new me(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),Ce=function(t,e){this.viewCache=t,this.changes=e},Ie=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){s.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),s.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,a,u=new Oe;if(n.type===ce.OVERWRITE){var c=n;c.source.fromUser?o=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(s.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),o=this.applyServerOverwrite_(e,c.path,c.snap,r,i,a,u))}else if(n.type===ce.MERGE){var l=n;l.source.fromUser?o=this.applyUserMerge_(e,l.path,l.children,r,i,u):(s.assert(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,l.path,l.children,r,i,a,u))}else if(n.type===ce.ACK_USER_WRITE){var h=n;o=h.revert?this.revertUserWrite_(e,h.path,r,i,u):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==ce.LISTEN_COMPLETE)throw s.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,u)}var f=u.getChanges();return t.maybeAddValueEvent_(e,o,f),new Ce(o,f)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(_e.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,u=void 0;if(e.isEmpty())if(s.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),l=c instanceof qt?c:qt.EMPTY_NODE,h=n.calcCompleteEventChildren(l);a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),f,i)}else{var p=e.getFront();if(".priority"===p){s.assert(1===e.getLength(),"Can't have a priority with additional path components");var d=o.getNode();u=t.getServerCache().getNode();var y=n.calcEventCacheAfterServerOverwrite(e,d,u);a=null!=y?this.filter_.updatePriority(d,y):o.getNode()}else{var v=e.popFront(),g=void 0;if(o.isCompleteForChild(p)){u=t.getServerCache().getNode();var b=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),u);g=null!=b?o.getNode().getImmediateChild(p).updateChild(v,b):o.getNode().getImmediateChild(p)}else g=n.calcCompleteChild(p,t.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),p,g,v,r,i):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),p=u.getNode().getImmediateChild(h).updateChild(f,n);a=".priority"===h?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),h,p,f,Ee,null)}var d=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),y=new Ae(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,y,s)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new Ae(r,t,i);if(e.isEmpty())a=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)a=this.filter_.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(l),p=void 0;if(h.isEmpty())p=n;else{var d=c.getCompleteChild(l);p=null!=d?".priority"===h.getBack()&&d.getChild(h.parent()).isEmpty()?d:d.updateChild(h,n):qt.EMPTY_NODE}if(f.equals(p))s=t;else{var y=this.filter_.updateChild(u.getNode(),l,p,h,c,o);s=t.updateEventSnap(y,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,s){var a=this,u=e;return r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=a.applyUserOverwrite_(u,l,c,i,o,s))})),r.foreach((function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=a.applyUserOverwrite_(u,l,c,i,o,s))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,s){var a=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:ye.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=a.applyMerge_(u,n);c=a.applyServerOverwrite_(c,new z(e),h,r,i,o,s)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),f=a.applyMerge_(h,n);c=a.applyServerOverwrite_(c,new z(e),f,r,i,o,s)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,a.getNode().getChild(e),r,i,s,o);if(e.isEmpty()){var u=ye.Empty;return a.getNode().forEachChild(It,(function(t,e){u=u.set(new z(t),e)})),this.applyServerMerge_(t,e,u,r,i,s,o)}return t}var c=ye.Empty;return n.foreach((function(t,n){var r=e.child(t);a.isCompleteForPath(r)&&(c=c.set(t,a.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,s,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,Ee,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var a=new Ae(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var l=void 0;if(t.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();s.assert(h instanceof qt,"serverChildren would be complete if leaf node"),l=n.calcCompleteEventChildren(h)}l=l,c=this.filter_.updateFullNode(u,l,i)}else{var f=e.getFront(),p=n.calcCompleteChild(f,t.getServerCache());null==p&&t.getServerCache().isCompleteForChild(f)&&(p=u.getImmediateChild(f)),(c=null!=p?this.filter_.updateChild(u,f,p,e.popFront(),a,i):t.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,qt.EMPTY_NODE,e.popFront(),a,i):u).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(z.Empty),t.updateEventSnap(c,o,this.filter_.filtersNodes())},t}(),Te=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){t.type===_e.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(_e.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(i,_e.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,_e.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,_e.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,_e.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,_e.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,s=n.filter((function(t){return t.type===e}));s.sort(this.compareChanges_.bind(this)),s.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw s.assertionError("Should only compare child_ events.");var n=new Et(t.childName,t.snapshotNode),r=new Et(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),xe=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Se(n.getIndex()),i=n.getNodeFilter();this.processor_=new Ie(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(qt.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(qt.EMPTY_NODE,s.getNode(),null),c=new me(a,o.isFullyInitialized(),r.filtersNodes()),l=new me(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new we(l,c),this.eventGenerator_=new Te(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){s.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)}))}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===ce.MERGE&&null!==t.source.queryId&&(s.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),s.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),s.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(Pt,(function(t,e){n.push(_e.childAddedChange(t,e))})),e.isFullyInitialized()&&n.push(_e.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),ke=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return s.assert(fe,"Reference.ts has not been loaded"),fe},set:function(t){s.assert(!fe,"__referenceConstructor has already been defined"),fe=t},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,i,a=t.source.queryId;if(null!==a){var u=this.views.get(a);return s.assert(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var l=o.__values(this.views.values()),h=l.next();!h.done;h=l.next())u=h.value,c=c.concat(u.applyOperation(t,e,n))}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return c},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=this.views.get(o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;a?u=!0:r instanceof qt?(a=n.calcCompleteEventChildren(r),u=!1):(a=qt.EMPTY_NODE,u=!1);var c=new we(new me(a,u,!1),new me(r,i,!1));s=new xe(t,c),this.views.set(o,s)}return s.addEventRegistration(e),s.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i,s,a=e.queryIdentifier(),u=[],c=[],l=this.hasCompleteView();if("default"===a)try{for(var h=o.__values(this.views.entries()),f=h.next();!f.done;f=h.next()){var p=o.__read(f.value,2),d=p[0],y=p[1];c=c.concat(y.removeEventRegistration(n,r)),y.isEmpty()&&(this.views.delete(d),y.getQuery().getQueryParams().loadsAllData()||u.push(y.getQuery()))}}catch(t){i={error:t}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}else(y=this.views.get(a))&&(c=c.concat(y.removeEventRegistration(n,r)),y.isEmpty()&&(this.views.delete(a),y.getQuery().getQueryParams().loadsAllData()||u.push(y.getQuery())));return l&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=o.__values(this.views.values()),i=r.next();!i.done;i=r.next()){var s=i.value;s.getQuery().getQueryParams().loadsAllData()||n.push(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var i=o.__values(this.views.values()),s=i.next();!s.done;s=i.next()){var a=s.value;r=r||a.getCompleteServerCache(t)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=o.__values(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Pe=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new ye(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=z.relativePath(i,e);return o=o.updateChild(s,n),new t(this.writeTree_.set(i,o))}var a=new ye(n);return new t(this.writeTree_.setTree(e,a))},t.prototype.addWrites=function(t,e){var n=this;return j(e,(function(e,r){n=n.addWrite(t.child(e),r)})),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,ye.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(z.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Pt,(function(e,n){t.push(new Et(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Et(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new ye(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return Ne(z.Empty,this.writeTree_,t)},t.Empty=new t(new ye(null)),t}();function Ne(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?(s.assert(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ne(t.child(e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(t.child(".priority"),r)),n}var Be=function(){function t(){this.visibleWrites_=Pe.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new De(t,this)},t.prototype.addOverwrite=function(t,e,n,r){s.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){s.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));s.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(o=!0)),a--}return!!i&&(o?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):j(r.children,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))})),!0))},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(z.Empty)){var s=t.layerTree_(this.allWrites_,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e);return c=n||qt.EMPTY_NODE,s.apply(c)}return null}var a=this.visibleWrites_.getCompleteNode(e);if(null!=a)return a;var u=this.visibleWrites_.childCompoundWrite(e);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(z.Empty)){var c=n||qt.EMPTY_NODE;return u.apply(c)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=qt.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(Pt,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(Pt,(function(t,e){var r=i.childCompoundWrite(new z(t)).apply(e);n=n.updateImmediateChild(t,r)})),i.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){s.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=this.visibleWrites_.childCompoundWrite(t),u=a.getCompleteNode(z.Empty);if(null!=u)s=u;else{if(null==e)return[];s=a.apply(e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),f=h.getNext();f&&c.length<r;)0!==l(f,n)&&c.push(f),f=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,z.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Pe.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,u=void 0;if(o.snap)n.contains(a)?(u=z.relativePath(n,a),r=r.addWrite(u,o.snap)):a.contains(n)&&(u=z.relativePath(a,n),r=r.addWrite(z.Empty,o.snap.getChild(u)));else{if(!o.children)throw s.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))u=z.relativePath(n,a),r=r.addWrites(u,o.children);else if(a.contains(n))if((u=z.relativePath(a,n)).isEmpty())r=r.addWrites(z.Empty,o.children);else{var c=s.safeGet(o.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite(z.Empty,l)}}}}}return r},t}(),De=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Re=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=ye.Empty,this.pendingWriteTree_=new Be,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new ge(pe.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=ye.fromObject(e);return this.applyOperationToSyncPoints_(new be(pe.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=ye.Empty;return null!=n.snap?r=r.set(z.Empty,!0):j(n.children,(function(t,e){r=r.set(new z(t),e)})),this.applyOperationToSyncPoints_(new de(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new ge(pe.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=ye.fromObject(e);return this.applyOperationToSyncPoints_(new be(pe.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new ve(pe.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=z.relativePath(s,e),c=new ge(pe.forServerTaggedQuery(a),u,n);return this.applyTaggedOperation_(s,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=z.relativePath(s,e),c=ye.fromObject(n),l=new be(pe.forServerTaggedQuery(a),u,c);return this.applyTaggedOperation_(s,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,s=i.queryId,a=z.relativePath(o,e),u=new ve(pe.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=z.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()}));var a,u=this.syncPointTree_.get(r);u?(o=o||u.hasCompleteView(),i=i||u.getCompleteServerCache(z.Empty)):(u=new ke,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i?a=!0:(a=!1,i=qt.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=e.getCompleteServerCache(z.Empty);n&&(i=i.updateImmediateChild(t,n))})));var c=u.viewExistsForQuery(e);if(!c&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);s.assert(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap.set(l,h),this.tagToQueryMap.set(h,l)}var f=this.pendingWriteTree_.childWrites(r),p=u.addEventRegistration(e,n,f,i,a);if(!c&&!o){var d=u.viewForQuery(e);p=p.concat(this.setupListener_(e,d))}return p},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===e.queryIdentifier()||s.viewExistsForQuery(e))){var u=s.removeEventRegistration(e,n,r);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;a=u.events;var l=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),h=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var y=p[d],v=y.getQuery(),g=this.createListenerForView_(y);this.listenProvider_.startListening(t.queryForListening_(v),this.tagForQuery_(v),g.hashFn,g.onComplete)}}!h&&c.length>0&&!r&&(l?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}))),this.removeTags_(c)}return a},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,(function(e,n){var r=z.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),j(n,(function(t,e){r=r.concat(e)})),r}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),u=this.syncPointTree_.subtree(r);if(i)s.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),j(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||qt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return s.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new z(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);s.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(z.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(z.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(z.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,l=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(z.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(z.Empty));var s=[];return e.children.inorderTraversal((function(e,o){var a=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(s=s.concat(i.applyOperationDescendantsHelper_(c,o,a,u)))})),o&&(s=s.concat(o.applyOperation(t,r,n))),s},t.nextQueryTag_=1,t}(),je=function(){function t(){this.rootNode_=qt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Me=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),s.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return s.deepCopy(this.counters_)},t}(),Le=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Me),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),Fe=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=o.__assign({},t);return this.last_&&j(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Ue=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Fe(t);var n=1e4+2e4*Math.random();V(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;j(e,(function(e,i){i>0&&s.contains(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),V(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Ve=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new ze(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),ze=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();m&&S("event: "+e.toString()),U(n)}}},t.prototype.getPath=function(){return this.path_},t}(),qe=function(){function t(t){this.allowedEvents_=t,this.listeners_={},s.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=o.__spread(this.listeners_[t]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){s.assert(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),We=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return o.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return s.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(qe),Ge=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||s.isMobileCordova()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return o.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return s.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(qe),He=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&U((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Ye="start",Ke="close",Qe=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=O(t),this.stats_=Le.getCollection(e),this.urlFn=function(t){return e.connectionURL(H,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new He(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),T((function(){if(!n.isClosed_){n.scriptTagHolder=new Je((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=o.__read(t,5),i=r[0],s=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===Ye)n.id=s,n.password=a;else{if(i!==Ke)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=o.__read(t,2),i=r[0],s=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,s)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(W)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(s.isNodeSdk()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=s.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=s.base64Encode(e),r=R(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!s.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=s.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Je=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,s.isNodeSdk())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(t){S("frame writing exception"),t.stack&&S(t.stack),S(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||S("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;s.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){S("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),Xe="",Ze=null;"undefined"!=typeof MozWebSocket?Ze=MozWebSocket:"undefined"!=typeof WebSocket&&(Ze=WebSocket);var $e=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=O(this.connId),this.stats_=Le.getCollection(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!s.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(W)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(G,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,p.set("previous_websocket_failure",!0);try{if(s.isNodeSdk()){var i=this.nodeAdmin?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/5/"+Xe+"/"+r.platform+"/"+i,"X-Firebase-GMPID":this.applicationId||""}},a=r.env,u=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;u&&(o.proxy={origin:u}),this.mySock=new Ze(this.connURL,[],o)}else o={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new Ze(this.connURL,[],o)}catch(t){this.log_("Error instantiating WebSocket.");var c=t.message||t.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Ze&&!t.forceDisallow_},t.previouslyFailed=function(){return p.isInMemoryStorage||!0===p.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){p.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=s.jsonEval(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(s.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=s.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=R(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),tn=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Qe,$e]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=$e&&$e.isAvailable(),s=i&&!$e.previouslyFailed();if(e.webSocketOnly&&(i||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[$e];else{var a=this.transports_=[];try{for(var u=o.__values(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&a.push(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),en=function(){function t(t,e,n,r,i,o,s,a){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=O("c:"+this.id+":"),this.transportManager_=new tn(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=V((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=B("t",t),n=B("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=B("t",t),n=B("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=B("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?E("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),V((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):V((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(p.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),nn=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),rn=1e3,on=function(t){function e(n,r,i,o,a,u,c){var l=t.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=o,l.onServerInfoUpdate_=a,l.authTokenProvider_=u,l.authOverride_=c,l.id=e.nextPersistentConnectionId_++,l.log_=O("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingPutCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=rn,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!s.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),We.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&Ge.getInstance().on("online",l.onOnline_,l),l}return o.__extends(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r,a:t,b:e};this.log_(s.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};t.tag&&(s.q=r.queryObject(),s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,(function(s){var a=s.d,u=s.s;e.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,a))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&s.contains(t,"w")){var n=s.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();C("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||s.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=s.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+s.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+s.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=rn,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=rn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=rn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+e.nextConnectionId_++,a=this,u=this.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,i())};this.realtime_={close:h,sendRequest:function(t){s.assert(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(t){c?S("getToken() completed but was canceled"):(S("getToken() completed. Creating connection."),a.authToken_=t&&t.accessToken,l=new en(o,a.repoInfo_,a.applicationId_,n,r,i,(function(t){C(t+" ("+a.repoInfo_.toString()+")"),a.interrupt("server_kill")}),u))})).then(null,(function(e){a.log_("Failed to get token: "+e),c||(t.repoInfo_.nodeAdmin&&C(e),h())}))}},e.prototype.interrupt=function(t){S("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){S("Resuming connection for reason: "+t),delete this.interruptReasons_[t],s.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=rn,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return D(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new z(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){S("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=o.__values(this.listens.values()),s=i.next();!s.done;s=i.next()){var a=s.value;try{for(var u=(n=void 0,o.__values(a.values())),c=u.next();!c.done;c=u.next()){var l=c.value;this.sendListen_(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";s.isNodeSdk()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+Xe.replace(/\./g,"-")]=1,s.isMobileCordova()?t["framework.cordova"]=1:s.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=Ge.getInstance().currentlyOnline();return s.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(nn),sn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=O("p:rest:"),i.listens_={},i}return o.__extends(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(s.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),s.safeGet(o.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var o=i&&i.accessToken;o&&(e.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+s.querystring(e);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=s.jsonEval(u.responseText)}catch(t){C("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&C("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()}))},e}(nn),an="repo_interrupt",un=function(){function t(t,e,n,r){var i=this;if(this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ve,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new le,this.persistentConnection_=null,this.stats_=Le.getCollection(t),e||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new sn(this.repoInfo_,this.onDataUpdate_.bind(this),r),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{s.stringify(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new on(this.repoInfo_,n.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),r,o),this.server_=this.persistentConnection_}r.addTokenChangeListener((function(t){i.server_.refreshAuthToken(t)})),this.statsReporter_=Le.getOrCreateReporter(t,(function(){return new Ue(i.stats_,i.server_)})),this.transactionsInit_(),this.infoData_=new je,this.infoSyncTree_=new Re({startListening:function(t,e,n,r){var o=[],s=i.infoData_.getNode(t.path);return s.isEmpty()||(o=i.infoSyncTree_.applyServerOverwrite(t.path,s),setTimeout((function(){r("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Re({startListening:function(t,e,n,r){return i.server_.listen(t,n,e,(function(e,n){var o=r(e,n);i.eventQueue_.raiseEventsForChangedPath(t.path,o)})),[]},stopListening:function(t,e){i.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new z(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t}({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new z(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var a=s.map(e,(function(t){return Gt(t)}));o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=Gt(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=s.map(e,(function(t){return Gt(t)}));o=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=Gt(e);o=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;j(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new z("/.info/"+t),r=Gt(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),s=Gt(e,n),a=this.serverSyncTree_.calcCompleteEventCache(t),u=ae(s,a,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(t.toString(),s.val(!0),(function(e,n){var o="ok"===e;o||C("set at "+t+" failed: "+e);var s=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,s),i.callOnCompleteCallback(r,e,n)}));var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),s={};if(j(e,(function(e,n){i=!1,s[e]=se(t.child(e),Gt(n),r.serverSyncTree_,o)})),i)S("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var a=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,s,a);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||C("update at "+t+" failed: "+e);var s=r.serverSyncTree_.ackUserWrite(a,!o),u=s.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,s),r.callOnCompleteCallback(n,e,i)})),j(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=new le;this.onDisconnect_.forEachTree(z.Empty,(function(r,i){var o=se(r,i,t.serverSyncTree_,e);n.remember(r,o)}));var r=[];n.forEachTree(z.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new le,this.eventQueue_.raiseEventsForChangedPath(z.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=Gt(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=Gt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(s.isEmpty(e))return S("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&j(e,(function(e,n){var i=Gt(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(an)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(an)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new Fe(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);j(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),S.apply(void 0,o.__spread([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&U((function(){if("ok"===e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new wn(this))},enumerable:!1,configurable:!0}),t}(),cn=function(){function t(e){this.indexedFilter_=new Se(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Et(e,n))||(n=qt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=qt.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(qt.EMPTY_NODE);var i=this;return e.forEachChild(Pt,(function(t,e){i.matches(new Et(t,e))||(r=r.updateImmediateChild(t,qt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),ln=function(){function t(t){this.rangedFilter_=new cn(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Et(e,n))||(n=qt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=qt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=qt.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(qt.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)s=i.getNext(),!h&&c(a,s)<=0&&(h=!0),h&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,qt.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var u=t;s.assert(u.numChildren()===this.limit_,"");var c=new Et(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),p=r.getChildAfterChild(this.index_,l,this.reverse_);null!=p&&(p.name===e||u.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:o(p,c);if(h&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(_e.childChangedChange(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(_e.childRemovedChange(e,f));var y=u.updateImmediateChild(e,qt.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(_e.childAddedChange(p.name,p.node)),y.updateImmediateChild(p.name,p.node)):y}return n.isEmpty()?t:h&&o(l,c)>=0?(null!=i&&(i.trackChildChange(_e.childRemovedChange(l.name,l.node)),i.trackChildChange(_e.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,qt.EMPTY_NODE)):t},t}(),hn=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Pt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:x},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:k},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return s.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==Pt&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Pt},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new Se(this.getIndex()):this.hasLimit()?new ln(this):new cn(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()||(this.index_===Pt?e=n.PRIORITY_INDEX:this.index_===Yt?e=n.VALUE_INDEX:this.index_===It?e=n.KEY_INDEX:(s.assert(this.index_ instanceof Kt,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=s.stringify(e),this.startSet_&&(r[n.START_AT]=s.stringify(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+s.stringify(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=s.stringify(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+s.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_)),r},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),fn=function(t){function e(e,n){if(!(e instanceof un))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,hn.DEFAULT,!1)||this}return o.__extends(e,t),e.prototype.getKey=function(){return s.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return s.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof z||(null===this.path.getFront()?gt("Reference.child",1,t,!1):vt("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){s.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){s.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){s.validateArgCount("Reference.set",1,2,arguments.length),bt("Reference.set",this.path),lt("Reference.set",1,t,this.path,!1),s.validateCallback("Reference.set",2,e,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(s.validateArgCount("Reference.update",1,2,arguments.length),bt("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ft("Reference.update",1,t,this.path,!1),s.validateCallback("Reference.update",2,e,!0);var i=new s.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(s.validateArgCount("Reference.setWithPriority",2,3,arguments.length),bt("Reference.setWithPriority",this.path),lt("Reference.setWithPriority",1,t,this.path,!1),pt("Reference.setWithPriority",2,e,!1),s.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new s.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return s.validateArgCount("Reference.remove",0,1,arguments.length),bt("Reference.remove",this.path),s.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(s.validateArgCount("Reference.transaction",1,3,arguments.length),bt("Reference.transaction",this.path),s.validateCallback("Reference.transaction",1,t,!1),s.validateCallback("Reference.transaction",2,e,!0),wt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new s.Deferred;return"function"==typeof e&&r.promise.catch((function(){})),this.repo.startTransaction(this.path,t,(function(t,n,i){t?r.reject(t):r.resolve(new St(n,i)),"function"==typeof e&&e(t,n,i)}),n),r.promise},e.prototype.setPriority=function(t,e){s.validateArgCount("Reference.setPriority",1,2,arguments.length),bt("Reference.setPriority",this.path),pt("Reference.setPriority",1,t,!1),s.validateCallback("Reference.setPriority",2,e,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){s.validateArgCount("Reference.push",0,2,arguments.length),bt("Reference.push",this.path),lt("Reference.push",1,t,this.path,!0),s.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=Ot(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),o},e.prototype.onDisconnect=function(){return bt("Reference.onDisconnect",this.path),new _t(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(te);te.__referenceConstructor=fn,ke.__referenceConstructor=fn;var pn,dn=function(){this.children={},this.childCount=0,this.value=null},yn=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new dn),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n=e instanceof z?e:new z(e),r=this,i=n.getFront();null!==i;)r=new t(i,r,s.safeGet(r.node_.children,i)||new dn),i=(n=n.popFront()).getFront();return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){s.assert(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;j(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new z(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=s.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(pn||(pn={})),un.MAX_TRANSACTION_RETRIES_=25,un.prototype.transactionsInit_=function(){this.transactionQueueTree_=new yn},un.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new fn(this,t);o.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:v(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(t);a.currentInputSnapshot=u;var c=a.update(u.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new Qt(a.currentInputSnapshot,new fn(this,a.path),Pt);a.onComplete(null,!1,l)}}else{ht("transaction failed: Data returned ",c,a.path),a.status=pn.RUN;var h=this.transactionQueueTree_.subTree(t),f=h.getValue()||[];f.push(a),h.setValue(f);var p=void 0;"object"==typeof c&&null!==c&&s.contains(c,".priority")?(p=s.safeGet(c,".priority"),s.assert(ct(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(this.serverSyncTree_.calcCompleteEventCache(t)||qt.EMPTY_NODE).getPriority().val(),p=p;var d=this.generateServerValues(),y=Gt(c,p),g=ae(y,u,d);a.currentOutputSnapshotRaw=y,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_();var b=this.serverSyncTree_.applyUserOverwrite(t,g,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,b),this.sendReadyTransactions_()}},un.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||qt.EMPTY_NODE},un.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);s.assert(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===pn.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},un.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),o=i,a=i.hash(),u=0;u<e.length;u++){var c=e[u];s.assert(c.status===pn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=pn.SENT,c.retryCount++;var l=z.relativePath(t,c.path);o=o.updateChild(l,c.currentOutputSnapshotRaw)}var h=o.val(!0),f=t;this.server_.put(f.toString(),h,(function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<e.length;s++){if(e[s].status=pn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[s].currentWriteId)),e[s].onComplete){var a=e[s].currentOutputSnapshotResolved,u=new fn(n,e[s].path),c=new Qt(a,u,Pt);o.push(e[s].onComplete.bind(null,null,!0,c))}e[s].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),s=0;s<o.length;s++)U(o[s])}else{if("datastale"===r)for(s=0;s<e.length;s++)e[s].status===pn.SENT_NEEDS_ABORT?e[s].status=pn.NEEDS_ABORT:e[s].status=pn.RUN;else for(C("transaction at "+f.toString()+" failed: "+r),s=0;s<e.length;s++)e[s].status=pn.NEEDS_ABORT,e[s].abortReason=r;n.rerunTransactions_(t)}}),a)},un.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},un.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter((function(t){return t.status===pn.RUN})).map((function(t){return t.currentWriteId})),a=0;a<t.length;a++){var u=t[a],c=z.relativePath(e,u.path),l=!1,h=void 0;if(s.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===pn.NEEDS_ABORT)l=!0,h=u.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else if(u.status===pn.RUN)if(u.retryCount>=un.MAX_TRANSACTION_RETRIES_)l=!0,h="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else{var f=this.getLatestState_(u.path,o);u.currentInputSnapshot=f;var p=t[a].update(f.val());if(void 0!==p){ht("transaction failed: Data returned ",p,u.path);var d=Gt(p);"object"==typeof p&&null!=p&&s.contains(p,".priority")||(d=d.updatePriority(f.getPriority()));var y=u.currentWriteId,v=this.generateServerValues(),g=ae(d,f,v);u.currentOutputSnapshotRaw=d,u.currentOutputSnapshotResolved=g,u.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(y),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(u.path,g,u.currentWriteId,u.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(y,!0))}else l=!0,h="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],l&&(t[a].status=pn.COMPLETED,n=t[a].unwatcher,setTimeout(n,Math.floor(0)),t[a].onComplete))if("nodata"===h){var b=new fn(this,t[a].path),m=t[a].currentInputSnapshot,w=new Qt(m,b,Pt);r.push(t[a].onComplete.bind(null,null,!1,w))}else r.push(t[a].onComplete.bind(null,new Error(h),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),a=0;a<r.length;a++)U(r[a]);this.sendReadyTransactions_()}},un.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},un.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},un.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},un.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==pn.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},un.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},un.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)e[o].status===pn.SENT_NEEDS_ABORT||(e[o].status===pn.SENT?(s.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,e[o].status=pn.SENT_NEEDS_ABORT,e[o].abortReason="set"):(s.assert(e[o].status===pn.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete&&n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),o=0;o<n.length;o++)U(n[o])}};var vn,gn=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(S("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(t)},t}(),bn=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),mn=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return vn||(vn=new t),vn},t.prototype.interrupt=function(){var t,e,n,r;try{for(var i=o.__values(Object.keys(this.repos_)),s=i.next();!s.done;s=i.next()){var a=s.value;try{for(var u=(n=void 0,o.__values(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next()){var l=c.value;this.repos_[a][l].interrupt()}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.resume=function(){var t,e,n,r;try{for(var i=o.__values(Object.keys(this.repos_)),s=i.next();!s.done;s=i.next()){var a=s.value;try{for(var u=(n=void 0,o.__values(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next()){var l=c.value;this.repos_[a][l].resume()}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.databaseFromApp=function(t,e,n,i){var o=n||t.options.databaseURL;void 0===o&&(t.options.projectId||A("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),S("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var s,a=nt(o,i),u=a.repoInfo,c=void 0;void 0!==r&&(c=r.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(s=!0,o="http://"+c+"?ns="+u.namespace,u=(a=nt(o,i)).repoInfo):s=!a.repoInfo.secure;var l=i&&s?new bn:new gn(t,e);return mt("Invalid Firebase Database URL",1,a),a.path.isEmpty()||A("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(u,t,l).database},t.prototype.deleteRepo=function(t){var e=s.safeGet(this.repos_,t.app.name);e&&s.safeGet(e,t.repoInfo_.toURLString())===t||A("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e,n){var r=s.safeGet(this.repos_,e.name);r||(r={},this.repos_[e.name]=r);var i=s.safeGet(r,t.toURLString());return i&&A("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new un(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),wn=function(){function t(t){this.repo_=t,t instanceof un||A("Don't call new Database() directly - please use firebase.database()."),this.root_=new fn(t,z.Empty),this.INTERNAL=new _n(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),s.validateArgCount("database.ref",0,1,arguments.length),t instanceof fn?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),s.validateArgCount(e,1,1,arguments.length);var n=nt(t,this.repo_.repoInfo_.nodeAdmin);mt(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&A(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&A("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){s.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){s.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}(),_n=function(){function t(t){this.database=t}return t.prototype.delete=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this.database.checkDeleted_("delete"),mn.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]}))}))},t}(),Sn=Object.freeze({__proto__:null,forceLongPolling:function(){$e.forceDisallow(),Qe.forceAllow()},forceWebSockets:function(){Qe.forceDisallow()},isWebSocketsAvailable:function(){return $e.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)}}),On=on;on.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},on.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var En=en,An=Y,Cn=Object.freeze({__proto__:null,DataConnection:On,RealTimeConnection:En,hijackHash:function(t){var e=on.prototype.put;return on.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){on.prototype.put=e}},ConnectionTarget:An,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){mn.getInstance().forceRestClient(t)}}),In=wn.ServerValue;function Tn(t){!function(t){Xe=t}(t.SDK_VERSION);var n=t.INTERNAL.registerComponent(new u.Component("database",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return mn.getInstance().databaseFromApp(n,r,e)}),"PUBLIC").setServiceProps({Reference:fn,Query:te,Database:wn,DataSnapshot:Qt,enableLogging:_,INTERNAL:Sn,ServerValue:In,TEST_ACCESS:Cn}).setMultipleInstances(!0));t.registerVersion("@firebase/database","0.6.13"),s.isNodeSdk()&&(e.exports=n)}Tn(c.default),n.DataSnapshot=Qt,n.Database=wn,n.OnDisconnect=_t,n.Query=te,n.Reference=fn,n.ServerValue=In,n.enableLogging=_,n.registerDatabase=Tn},{"@firebase/app":"dP58",tslib:"f2sD","@firebase/util":"xA6u","@firebase/logger":"TUpU","@firebase/component":"nzQs",process:"pBGv"}],Uuoh:[function(t,e,n){"use strict";t("@firebase/database")},{"@firebase/database":"vmMz"}],RJVP:[function(t,e,n){var r=arguments[3];(function(){var e,n=t("@firebase/app").default,i="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},o=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof r&&r,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function s(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:s(t)}}!function(t,e){if(e){var n=o;t=t.split(".");for(var r=0;r<t.length-1;r++){var s=t[r];s in n||(n[s]={}),n=n[s]}(e=e(r=n[t=t[t.length-1]]))!=r&&null!=e&&i(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var i=o.setTimeout;n.prototype.c=function(t){i(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.v),reject:t(this.g)}},e.prototype.v=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.h(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.o=function(t){var e=this.f();t.Pa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,s=new e((function(t,e){i=t,o=e}));return this.Pa(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Pa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Pa(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){s[e]=n,0==--a&&t(s)}}var s=[],a=0;do{s.push(void 0),a++,r(i.value).Pa(o(s.length-1),e),i=n.next()}while(!i.done)}))},e}));var u=u||{},c=this||self,l=/^[\w+/_-]+[=]{0,2}$/,h=null;function f(){}function p(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function d(t){var e=p(t);return"array"==e||"object"==e&&"number"==typeof t.length}function y(t){return"function"==p(t)}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function g(t){return Object.prototype.hasOwnProperty.call(t,b)&&t[b]||(t[b]=++m)}var b="closure_uid_"+(1e9*Math.random()>>>0),m=0;function w(t,e,n){return t.call.apply(t.bind,arguments)}function _(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function S(t,e,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:_).apply(null,arguments)}function O(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now||function(){return+new Date};function A(t,e){function n(){}n.prototype=e.prototype,t.$a=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t,e,n){this.code=x+t,this.message=e||k[t]||"",this.a=n||null}function I(t){var e=t&&t.code;return e?new C(e.substring(x.length),t.message,t.serverResponse):null}A(C,Error),C.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},C.prototype.toJSON=function(){return this.w()};var T,x="auth/",k={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},P={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function N(t){for(var e in P)if(P[e].id===t)return{firebaseEndpoint:(t=P[e]).Sa,secureTokenEndpoint:t.Ya,identityPlatformEndpoint:t.Va};return null}function B(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function D(t){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function R(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");D.call(this,n+t[r])}function j(t,e){throw new R("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function M(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function L(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function F(){this.b=this.a=null}T=N("__EID__")?"__EID__":void 0,A(D,Error),D.prototype.name="CustomError",A(R,D),R.prototype.name="AssertionError",M.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var U=new M((function(){return new z}),(function(t){t.reset()}));function V(){var t=ge,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function z(){this.next=this.b=this.a=null}F.prototype.add=function(t,e){var n=U.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},z.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},z.prototype.reset=function(){this.next=this.b=this.a=null};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},G=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,s=0;s<n;s++)if(s in o){var a=o[s];e.call(void 0,a,s,t)&&(r[i++]=a)}return r},H=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},Y=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function K(t,e){return 0<=q(t,e)}function Q(t,e){var n;return(n=0<=(e=q(t,e)))&&Array.prototype.splice.call(t,e,1),n}function J(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length}))}function X(t){return Array.prototype.concat.apply([],arguments)}function Z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var $,tt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},et=/&/g,nt=/</g,rt=/>/g,it=/"/g,ot=/'/g,st=/\x00/g,at=/[\x00&<>"']/;function ut(t,e){return-1!=t.indexOf(e)}function ct(t,e){return t<e?-1:t>e?1:0}t:{var lt=c.navigator;if(lt){var ht=lt.userAgent;if(ht){$=ht;break t}}$=""}function ft(t){return ut($,t)}function pt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function dt(t){for(var e in t)return!1;return!0}function yt(t){var e,n={};for(e in t)n[e]=t[e];return n}var vt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function gt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<vt.length;o++)n=vt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||c).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(v(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;j("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function mt(t,e){this.a=t===St&&e||"",this.b=_t}function wt(t){return t instanceof mt&&t.constructor===mt&&t.b===_t?t.a:(j("expected object of type Const, got '"+t+"'"),"type_error:Const")}mt.prototype.sa=!0,mt.prototype.ra=function(){return this.a},mt.prototype.toString=function(){return"Const{"+this.a+"}"};var _t={},St={},Ot=new mt(St,"");function Et(t,e){this.a=t===kt&&e||"",this.b=xt}function At(t){return t instanceof Et&&t.constructor===Et&&t.b===xt?t.a:(j("expected object of type TrustedResourceUrl, got '"+t+"' of type "+p(t)),"type_error:TrustedResourceUrl")}function Ct(t,e){var n=wt(t);if(!Tt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(It,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof mt?wt(t):encodeURIComponent(String(t))})),new Et(kt,t)}Et.prototype.sa=!0,Et.prototype.ra=function(){return this.a.toString()},Et.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var It=/%{(\w+)}/g,Tt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,xt={},kt={};function Pt(t,e){this.a=t===jt&&e||"",this.b=Rt}function Nt(t){return t instanceof Pt&&t.constructor===Pt&&t.b===Rt?t.a:(j("expected object of type SafeUrl, got '"+t+"' of type "+p(t)),"type_error:SafeUrl")}Pt.prototype.sa=!0,Pt.prototype.ra=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Bt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Dt(t){return t instanceof Pt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Bt.test(t)||(t="about:invalid#zClosurez"),new Pt(jt,t))}var Rt={},jt={};function Mt(){this.a="",this.b=Ft}function Lt(t){return t instanceof Mt&&t.constructor===Mt&&t.b===Ft?t.a:(j("expected object of type SafeHtml, got '"+t+"' of type "+p(t)),"type_error:SafeHtml")}Mt.prototype.sa=!0,Mt.prototype.ra=function(){return this.a.toString()},Mt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ft={};function Ut(t){var e=new Mt;return e.a=t,e}Ut("<!DOCTYPE html>");var Vt=Ut("");function zt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function qt(t){return at.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(et,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(nt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(rt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(it,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(ot,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(st,"&#0;"))),t}function Wt(t){return Wt[" "](t),t}Ut("<br>"),Wt[" "]=f;var Gt,Ht,Yt=ft("Opera"),Kt=ft("Trident")||ft("MSIE"),Qt=ft("Edge"),Jt=Qt||Kt,Xt=ft("Gecko")&&!(ut($.toLowerCase(),"webkit")&&!ft("Edge"))&&!(ft("Trident")||ft("MSIE"))&&!ft("Edge"),Zt=ut($.toLowerCase(),"webkit")&&!ft("Edge");function $t(){var t=c.document;return t?t.documentMode:void 0}t:{var te="",ee=(Ht=$,Xt?/rv:([^\);]+)(\)|;)/.exec(Ht):Qt?/Edge\/([\d\.]+)/.exec(Ht):Kt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ht):Zt?/WebKit\/(\S+)/.exec(Ht):Yt?/(?:Version)[ \/]?(\S+)/.exec(Ht):void 0);if(ee&&(te=ee?ee[1]:""),Kt){var ne=$t();if(null!=ne&&ne>parseFloat(te)){Gt=String(ne);break t}}Gt=te}var re,ie={};function oe(t){return function(t,e){var n=ie;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=tt(String(Gt)).split("."),r=tt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=ct(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ct(0==s[2].length,0==a[2].length)||ct(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}re=c.document&&Kt?$t():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Ht){}var se=!Kt||9<=Number(re);function ae(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function ue(t,e){pt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:he.hasOwnProperty(n)?t.setAttribute(he[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var ce,le,he={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function fe(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function pe(t){if(t&&"number"==typeof t.length){if(v(t))return"function"==typeof t.item||"string"==typeof t.item;if(y(t))return"function"==typeof t.item}return!1}function de(t){c.setTimeout((function(){throw t}),0)}function ye(t,e){le||function(){if(c.Promise&&c.Promise.resolve){var t=c.Promise.resolve(void 0);le=function(){t.then(be)}}else le=function(){var t=be;!y(c.setImmediate)||c.Window&&c.Window.prototype&&!ft("Edge")&&c.Window.prototype.setImmediate==c.setImmediate?(ce||(ce=function(){var t=c.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ft("Presto")&&(t=function(){var t,e,n=fe(document,"IFRAME");n.style.display="none",t=n,e=new Et(kt,wt(Ot)),bt(t,"HTMLIFrameElement"),t.src=At(e).toString(),document.documentElement.appendChild(n);var r=n.contentWindow;(n=r.document).open(),n.write(Lt(Vt)),n.close();var i="callImmediate"+Math.random(),o="file:"==r.location.protocol?"*":r.location.protocol+"//"+r.location.host;n=S((function(t){"*"!=o&&t.origin!=o||t.data!=i||this.port1.onmessage()}),this),r.addEventListener("message",n,!1),this.port1={},this.port2={postMessage:function(){r.postMessage(i,o)}}}),void 0!==t&&!ft("Trident")&&!ft("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Fb;n.Fb=null,t()}},function(t){r.next={Fb:t},r=r.next,e.port2.postMessage(0)}}return function(t){c.setTimeout(t,0)}}()),ce(t)):c.setImmediate(t)}}(),ve||(le(),ve=!0),ge.add(t,e)}var ve=!1,ge=new F;function be(){for(var t;t=V();){try{t.a.call(t.b)}catch(t){de(t)}L(U,t)}ve=!1}function me(t,e){if(this.a=we,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Ne(n,_e,t)}),(function(t){if(!(t instanceof Fe))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Ne(n,Se,t)}))}catch(t){Ne(this,Se,t)}}var we=0,_e=2,Se=3;function Oe(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Oe.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ee=new M((function(){return new Oe}),(function(t){t.reset()}));function Ae(t,e,n){var r=Ee.get();return r.g=t,r.b=e,r.f=n,r}function Ce(t){if(t instanceof me)return t;var e=new me(f);return Ne(e,_e,t),e}function Ie(t){return new me((function(e,n){n(t)}))}function Te(t,e,n){Be(t,e,n,null)||ye(O(e,t))}function xe(t){return new me((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Ob:!0,value:o}:{Ob:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Te(t[o],O(i,o,!0),O(i,o,!1));else e(r)}))}function ke(t,e){t.b||t.a!=_e&&t.a!=Se||De(t),t.f?t.f.next=e:t.b=e,t.f=e}function Pe(t,e,n,r){var i=Ae(null,null,null);return i.a=new me((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Fe?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,ke(t,i),i.a}function Ne(t,e,n){t.a==we&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Be(n,t.Zc,t.$c,t)||(t.i=n,t.a=e,t.c=null,De(t),e!=Se||n instanceof Fe||function(t,e){t.g=!0,ye((function(){t.g&&Le.call(null,e)}))}(t,n)))}function Be(t,e,n,r){if(t instanceof me)return ke(t,Ae(e||f,n||null,r)),!0;if(B(t))return t.then(e,n,r),!0;if(v(t))try{var i=t.then;if(y(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}var s=!1;try{e.call(t,(function(t){s||(s=!0,n.call(i,t))}),o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function De(t){t.h||(t.h=!0,ye(t.fc,t))}function Re(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function je(t,e,n,r){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Me(e,n,r);else try{e.c?e.g.call(e.f):Me(e,n,r)}catch(t){Le.call(null,t)}L(Ee,e)}function Me(t,e,n){e==_e?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}me.prototype.then=function(t,e,n){return Pe(this,y(t)?t:null,y(e)?e:null,n)},me.prototype.$goog_Thenable=!0,(e=me.prototype).na=function(t,e){return(t=Ae(t,t,e)).c=!0,ke(this,t),this},e.s=function(t,e){return Pe(this,null,t,e)},e.cancel=function(t){if(this.a==we){var e=new Fe(t);ye((function(){!function t(e,n){if(e.a==we)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,s=null,a=r.b;a&&(a.c||(i++,a.a==e&&(o=a),!(o&&1<i)));a=a.next)o||(s=a);o&&(r.a==we&&1==i?t(r,n):(s?((i=s).next==r.f&&(r.f=i),i.next=i.next.next):Re(r),je(r,o,Se,n)))}e.c=null}else Ne(e,Se,n)}(this,e)}),this)}},e.Zc=function(t){this.a=we,Ne(this,_e,t)},e.$c=function(t){this.a=we,Ne(this,Se,t)},e.fc=function(){for(var t;t=Re(this);)je(this,t,this.a,this.i);this.h=!1};var Le=de;function Fe(t){D.call(this,t)}function Ue(){0!=Ve&&(ze[g(this)]=this),this.xa=this.xa,this.oa=this.oa}A(Fe,D),Fe.prototype.name="cancel";var Ve=0,ze={};function qe(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=Ve)){var e=g(t);if(0!=Ve&&t.oa&&0<t.oa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[e]}}Ue.prototype.xa=!1,Ue.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var We=Object.freeze||function(t){return t},Ge=!Kt||9<=Number(re),He=Kt&&!oe("9"),Ye=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",f,e),c.removeEventListener("test",f,e)}catch(t){}return t}();function Ke(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Qe(t,e){if(Ke.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{Wt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Je[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ke.prototype.preventDefault=function(){this.defaultPrevented=!0},A(Qe,Ke);var Je=We({2:"touch",3:"pen",4:"mouse"});Qe.prototype.preventDefault=function(){Qe.$a.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,He)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Qe.prototype.g=function(){return this.a};var Xe="closure_listenable_"+(1e6*Math.random()|0),Ze=0;function $e(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ua=i,this.key=++Ze,this.va=this.Oa=!1}function tn(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Ua=null}function en(t){this.src=t,this.a={},this.b=0}function nn(t,e){var n=e.type;n in t.a&&Q(t.a[n],e)&&(tn(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function rn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Ua==r)return i}return-1}en.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=rn(t,e,r,i);return-1<s?(e=t[s],n||(e.Oa=!1)):((e=new $e(e,this.src,o,!!r,i)).Oa=n,t.push(e)),e};var on="closure_lm_"+(1e6*Math.random()|0),sn={};function an(t,e,n,r,i){if(r&&r.once)cn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)an(t,e[o],n,r,i);else n=bn(n),t&&t[Xe]?wn(t,e,n,v(r)?!!r.capture:!!r,i):un(t,e,n,!1,r,i)}function un(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=v(i)?!!i.capture:!!i,a=vn(t);if(a||(t[on]=a=new en(t)),!(n=a.add(e,n,r,s,o)).proxy)if(r=function(){var t=yn,e=Ge?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ye||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(fn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function cn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)cn(t,e[o],n,r,i);else n=bn(n),t&&t[Xe]?_n(t,e,n,v(r)?!!r.capture:!!r,i):un(t,e,n,!0,r,i)}function ln(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ln(t,e[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=bn(n),t&&t[Xe]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=rn(o=t.a[e],n,r,i))&&(tn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=vn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=rn(e,n,r,i)),(n=-1<t?e[t]:null)&&hn(n))}function hn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[Xe])nn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=vn(e))?(nn(n,t),0==n.b&&(n.src=null,e[on]=null)):tn(t)}}}function fn(t){return t in sn?sn[t]:sn[t]="on"+t}function pn(t,e,n,r){var i=!0;if((t=vn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=dn(o,r),i=i&&!1!==o)}return i}function dn(t,e){var n=t.listener,r=t.Ua||t.src;return t.Oa&&hn(t),n.call(r,e)}function yn(t,e){if(t.va)return!0;if(!Ge){if(!e)t:{e=["window","event"];for(var n=c,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Qe(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=pn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=pn(r[i],t,!1,e),n=n&&o}return n}return dn(t,new Qe(e,this))}function vn(t){return(t=t[on])instanceof en?t:null}var gn="__closure_events_fn_"+(1e9*Math.random()>>>0);function bn(t){return y(t)?t:(t[gn]||(t[gn]=function(e){return t.handleEvent(e)}),t[gn])}function mn(){Ue.call(this),this.v=new en(this),this.$b=this,this.fb=null}function wn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function _n(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Sn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.va&&s.capture==n){var a=s.listener,u=s.Ua||s.src;s.Oa&&nn(t.v,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}function On(t,e,n){if(y(t))n&&(t=S(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=S(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function En(t){var e=null;return new me((function(n,r){-1==(e=On((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).s((function(t){throw c.clearTimeout(e),t}))}function An(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Cn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.V||"function"!=typeof t.V){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function In(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof In)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Tn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];xn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)xn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function xn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}A(mn,Ue),mn.prototype[Xe]=!0,mn.prototype.addEventListener=function(t,e,n,r){an(this,t,e,n,r)},mn.prototype.removeEventListener=function(t,e,n,r){ln(this,t,e,n,r)},mn.prototype.dispatchEvent=function(t){var e,n=this.fb;if(n)for(e=[];n;n=n.fb)e.push(n);n=this.$b;var r=t.type||t;if("string"==typeof t)t=new Ke(t,n);else if(t instanceof Ke)t.target=t.target||n;else{var i=t;gt(t=new Ke(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=Sn(s,r,!0,t)&&i}if(i=Sn(s=t.b=n,r,!0,t)&&i,i=Sn(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Sn(s=t.b=e[o],r,!1,t)&&i;return i},mn.prototype.Da=function(){if(mn.$a.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)tn(n[r]);delete e.a[t],e.b--}}this.fb=null},(e=In.prototype).V=function(){Tn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.Y=function(){return Tn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return xn(this.b,t)?this.b[t]:e},e.set=function(t,e){xn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var kn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pn(t,e){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,t instanceof Pn?(this.i=void 0!==e?e:t.i,Nn(this,t.f),this.l=t.l,this.a=t.a,Bn(this,t.g),this.c=t.c,Dn(this,$n(t.b)),this.h=t.h):t&&(n=String(t).match(kn))?(this.i=!!e,Nn(this,n[1]||"",!0),this.l=Fn(n[2]||""),this.a=Fn(n[3]||"",!0),Bn(this,n[4]),this.c=Fn(n[5]||"",!0),Dn(this,n[6]||"",!0),this.h=Fn(n[7]||"")):(this.i=!!e,this.b=new Yn(null,this.i))}function Nn(t,e,n){t.f=n?Fn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Bn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Dn(t,e,n){e instanceof Yn?(t.b=e,function(t,e){e&&!t.f&&(Kn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Jn(this,e),Zn(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Un(e,Gn)),t.b=new Yn(e,t.i))}function Rn(t,e,n){t.b.set(e,n)}function jn(t,e){return t.b.get(e)}function Mn(t){return t instanceof Pn?new Pn(t):new Pn(t,void 0)}function Ln(t,e,n,r){var i=new Pn(null,void 0);return t&&Nn(i,t),e&&(i.a=e),n&&Bn(i,n),r&&(i.c=r),i}function Fn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Vn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Vn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Un(e,zn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Un(e,zn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Un(n,"/"==n.charAt(0)?Wn:qn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Un(n,Hn)),t.join("")},Pn.prototype.resolve=function(t){var e=new Pn(this),n=!!t.f;n?Nn(e,t.f):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.c;if(n)Bn(e,t.g);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.a&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ut(i,"./")||ut(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.b.toString(),n?Dn(e,$n(t.b)):n=!!t.h,n&&(e.h=t.h),e};var zn=/[#\/\?@]/g,qn=/[#\?:]/g,Wn=/[#\?]/g,Gn=/[#\?@]/g,Hn=/#/g;function Yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Kn(t){t.a||(t.a=new In,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Qn(t){var e=Cn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Yn(null,void 0);t=An(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?Zn(n,i,o):n.add(i,o)}return n}function Jn(t,e){Kn(t),e=tr(t,e),xn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,xn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Tn(t)))}function Xn(t,e){return Kn(t),e=tr(t,e),xn(t.a.b,e)}function Zn(t,e,n){Jn(t,e),0<n.length&&(t.c=null,t.a.set(tr(t,e),Z(n)),t.b+=n.length)}function $n(t){var e=new Yn;return e.c=t.c,t.a&&(e.a=new In(t.a),e.b=t.b),e}function tr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function er(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),t(e,i[s],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(s=n[i])&&(r.push(o),or(i,r),r.push(":"),t(e,s,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":or(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new nr,t,e),e.join("")}function nr(){}(e=Yn.prototype).add=function(t,e){Kn(this),this.c=null,t=tr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){Kn(this),this.a.forEach((function(n,r){W(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.Y=function(){Kn(this);for(var t=this.a.V(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.V=function(t){Kn(this);var e=[];if("string"==typeof t)Xn(this,t)&&(e=X(e,this.a.get(tr(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=X(e,t[n])}return e},e.set=function(t,e){return Kn(this),this.c=null,Xn(this,t=tr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.V(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var rr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},ir=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function or(t,e){e.push('"',t.replace(ir,(function(t){var e=rr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),rr[t]=e),e})),'"')}function sr(){var t=Ar();return Kt&&!!re&&11==re||/Edge\/\d+/.test(t)}function ar(){return c.window&&c.window.location.href||self&&self.location&&self.location.href||""}function ur(t,e){e=e||c.window;var n="about:blank";t&&(n=Nt(Dt(t))),e.location.href=n}function cr(t){return!!((t=(t||Ar()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function lr(t){t=t||c.window;try{t.close()}catch(t){}}function hr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Ar().toLowerCase(),r&&(e.target=r,ut(n,"crios/")&&(e.target="_blank")),Sr(Ar())==wr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Pt?n:Dt(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((ft("iPhone")&&!ft("iPod")&&!ft("iPad")||ft("iPad")||ft("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(bt(s=fe(document,"A"),"HTMLAnchorElement"),e instanceof Pt||e instanceof Pt||(e="object"==typeof e&&e.sa?e.ra():String(e),Bt.test(e)||(e="about:invalid#zClosurez"),e=new Pt(jt,e)),s.href=Nt(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=Nt(e),s&&(Jt&&ut(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t=Ut('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+qt(t)+'">'),r=s.document)&&(r.write(Lt(t)),r.close())):(s=r.open(Nt(e),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var fr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pr=/^[^@]+@[^@]+$/;function dr(){var t=null;return new me((function(e){"complete"==c.document.readyState?e():(t=function(){e()},cn(window,"load",t))})).s((function(e){throw ln(window,"load",t),e}))}function yr(t){return t=t||Ar(),!("file:"!==kr()&&"ionic:"!==kr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function vr(){var t=c.window;try{return!(!t||t==t.top)}catch(t){return!1}}function gr(){return void 0!==c.WorkerGlobalScope&&"function"==typeof c.importScripts}function br(){return n.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":n.INTERNAL.hasOwnProperty("node")?"Node":gr()?"Worker":"Browser"}function mr(){var t=br();return"ReactNative"===t||"Node"===t}var wr="Firefox",_r="Chrome";function Sr(t){var e=t.toLowerCase();return ut(e,"opera/")||ut(e,"opr/")||ut(e,"opios/")?"Opera":ut(e,"iemobile")?"IEMobile":ut(e,"msie")||ut(e,"trident/")?"IE":ut(e,"edge/")?"Edge":ut(e,"firefox/")?wr:ut(e,"silk/")?"Silk":ut(e,"blackberry")?"Blackberry":ut(e,"webos")?"Webos":!ut(e,"safari/")||ut(e,"chrome/")||ut(e,"crios/")||ut(e,"android")?!ut(e,"chrome/")&&!ut(e,"crios/")||ut(e,"edge/")?ut(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":_r:"Safari"}var Or={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function Er(t,e){e=e||[];var n,r=[],i={};for(n in Or)i[Or[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=br())?r=Sr(i=Ar()):"Worker"===r&&(r=Sr(i=Ar())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Ar(){return c.navigator&&c.navigator.userAgent||""}function Cr(t,e){t=t.split("."),e=e||c;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Ir(){try{var t=c.localStorage,e=Rr();if(t)return t.setItem(e,"1"),t.removeItem(e),!sr()||!!c.indexedDB}catch(t){return gr()&&!!c.indexedDB}return!1}function Tr(){return(xr()||"chrome-extension:"===kr()||yr())&&!mr()&&Ir()&&!gr()}function xr(){return"http:"===kr()||"https:"===kr()}function kr(){return c.location&&c.location.protocol||null}function Pr(t){return!cr(t=t||Ar())&&Sr(t)!=wr}function Nr(t){return void 0===t?null:er(t)}function Br(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Dr(t){if(null!==t)return JSON.parse(t)}function Rr(t){return t||Math.floor(1e9*Math.random()).toString()}function jr(t){return"Safari"!=Sr(t=t||Ar())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Mr(){var t=c.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Lr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Ar(),e=br(),this.b=cr(t)||"ReactNative"===e}function Fr(){var t=c.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Ur(t){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t)}function Vr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zr(){return!(!Cr("fireauth.oauthhelper",c)&&!Cr("fireauth.iframe",c))}Lr.prototype.get=function(){var t=c.navigator;return!t||"boolean"!=typeof t.onLine||!xr()&&"chrome-extension:"!==kr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var qr,Wr={};function Gr(t){Wr[t]||(Wr[t]=!0,Ur(t))}try{var Hr={};Object.defineProperty(Hr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Hr,"abcd",{configurable:!0,enumerable:!0,value:2}),qr=2==Hr.abcd}catch(Ht){qr=!1}function Yr(t,e,n){qr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Kr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Yr(t,n,e[n])}function Qr(t){var e={};return Kr(e,t),e}function Jr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Yr(e,n,Jr(t[n]));return e}function Xr(t){var e=t&&(t[ni]?"phone":null);if(!(e&&t&&t[ei]))throw new C("internal-error","Internal assert: invalid MultiFactorInfo object");Yr(this,"uid",t[ei]),Yr(this,"displayName",t[$r]||null);var n=null;t[ti]&&(n=new Date(t[ti]).toUTCString()),Yr(this,"enrollmentTime",n),Yr(this,"factorId",e)}function Zr(t){try{var e=new ri(t)}catch(t){e=null}return e}Xr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var $r="displayName",ti="enrolledAt",ei="mfaEnrollmentId",ni="phoneInfo";function ri(t){Xr.call(this,t),Yr(this,"phoneNumber",t[ni])}function ii(t){var e={},n=t[ui],r=t[li],i=t[hi];if(t=Zr(t[ci]),!i||i!=si&&i!=ai&&!n||i==ai&&!r||i==oi&&!t)throw Error("Invalid checkActionCode response!");i==ai?(e[pi]=n||null,e[yi]=n||null,e[fi]=r):(e[pi]=r||null,e[yi]=r||null,e[fi]=n||null),e[di]=t||null,Yr(this,gi,i),Yr(this,vi,Jr(e))}A(ri,Xr),ri.prototype.w=function(){var t=ri.$a.w.call(this);return t.phoneNumber=this.phoneNumber,t};var oi="REVERT_SECOND_FACTOR_ADDITION",si="EMAIL_SIGNIN",ai="VERIFY_AND_CHANGE_EMAIL",ui="email",ci="mfaInfo",li="newEmail",hi="requestType",fi="email",pi="fromEmail",di="multiFactorInfo",yi="previousEmail",vi="data",gi="operation";function bi(t){var e=jn(t=Mn(t),mi)||null,n=jn(t,wi)||null,r=jn(t,Oi)||null;if(r=r&&Ai[r]||null,!e||!n||!r)throw new C("argument-error",mi+", "+wi+"and "+Oi+" are required in a valid action code URL.");Kr(this,{apiKey:e,operation:r,code:n,continueUrl:jn(t,_i)||null,languageCode:jn(t,Si)||null,tenantId:jn(t,Ei)||null})}var mi="apiKey",wi="oobCode",_i="continueUrl",Si="languageCode",Oi="mode",Ei="tenantId",Ai={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:oi,signIn:si,verifyAndChangeEmail:ai,verifyEmail:"VERIFY_EMAIL"};function Ci(t){try{return new bi(t)}catch(t){return null}}function Ii(t){var e=t[Ni];if(void 0===e)throw new C("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new C("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Ti];if(n&&"object"==typeof n){e=n[Ri];var r=n[Bi];if(n=n[Di],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new C("argument-error",Bi+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new C("argument-error",Di+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new C("argument-error",Ri+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new C("missing-android-pkg-name")}}else if(void 0!==n)throw new C("argument-error",Ti+" property must be a non null object when specified.");if(this.f=null,(e=t[Pi])&&"object"==typeof e){if("string"==typeof(e=e[ji])&&e.length)this.f=e;else if(void 0!==e)throw new C("argument-error",ji+" property must be a non empty string when specified.")}else if(void 0!==e)throw new C("argument-error",Pi+" property must be a non null object when specified.");if(void 0!==(e=t[ki])&&"boolean"!=typeof e)throw new C("argument-error",ki+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[xi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new C("argument-error",xi+" property must be a non empty string when specified.");this.i=t||null}var Ti="android",xi="dynamicLinkDomain",ki="handleCodeInApp",Pi="iOS",Ni="url",Bi="installApp",Di="minimumVersion",Ri="packageName",ji="bundleId";function Mi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Li=null;function Fi(t){var e=Vi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,E(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Ui(t){try{return new Fi(t)}catch(t){return null}}function Vi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Li[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Li){Li={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Li[o]&&(Li[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}(t,(function(t){e+=String.fromCharCode(t)})),e}(t))}catch(t){}return null}Fi.prototype.S=function(){return this.f},Fi.prototype.i=function(){return this.b},Fi.prototype.toString=function(){return this.g};var zi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),qi=["client_id","response_type","scope","redirect_uri","state"],Wi={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:qi},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:qi},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:qi},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:zi},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function Gi(t){for(var e in Wi)if(Wi[e].fa==t)return Wi[e];return null}function Hi(t){var e={};e["facebook.com"]=Xi,e["google.com"]=$i,e["github.com"]=Zi,e["twitter.com"]=to;var n=t&&t[Ki];try{if(n)return e[n]?new e[n](t):new Ji(t);if(void 0!==t[Yi])return new Qi(t)}catch(t){}return null}var Yi="idToken",Ki="providerId";function Qi(t){var e=t[Ki];if(!e&&t[Yi]){var n=Ui(t[Yi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Yr(this,"providerId",e),Yr(this,"isNewUser",n)}function Ji(t){Qi.call(this,t),Yr(this,"profile",Jr((t=Dr(t.rawUserInfo||"{}"))||{}))}function Xi(t){if(Ji.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Zi(t){if(Ji.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Yr(this,"username",this.profile&&this.profile.login||null)}function $i(t){if(Ji.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function to(t){if(Ji.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Yr(this,"username",t.screenName||null)}function eo(t){var e=Mn(t),n=jn(e,"link"),r=jn(Mn(n),"link");return e=jn(e,"deep_link_id"),jn(Mn(e),"link")||e||r||n||t}function no(t,e){if(!t&&!e)throw new C("internal-error","Internal assert: no raw session string available");if(t&&e)throw new C("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?ro:io}A(Ji,Qi),A(Xi,Ji),A(Zi,Ji),A($i,Ji),A(to,Ji);var ro="enroll",io="signin";function oo(){}function so(t,e){return t.then((function(t){if(t[Ys]){var n=Ui(t[Ys]);if(!n||e!=n.h)throw new C("user-mismatch");return t}throw new C("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==x+"user-not-found"?new C("user-mismatch"):t}))}function ao(t,e){if(!e)throw new C("internal-error","failed to construct a credential");this.a=e,Yr(this,"providerId",t),Yr(this,"signInMethod",t)}function uo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function co(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new ao(t.providerId,t.pendingToken)}catch(t){}return null}function lo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Yr(this,"idToken",e.idToken),e.accessToken&&Yr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Yr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new C("internal-error","failed to construct a credential");Yr(this,"accessToken",e.oauthToken),Yr(this,"secret",e.oauthTokenSecret)}Yr(this,"providerId",t),Yr(this,"signInMethod",n)}function ho(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Qn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function fo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new lo(t.providerId,e,t.signInMethod)}catch(t){}}return null}function po(t,e){this.Pc=e||[],Kr(this,{providerId:t,isOAuthProvider:!0}),this.Hb={},this.ob=(Gi(t)||{}).Ja||null,this.nb=null}function yo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new C("argument-error",'SAML provider IDs must be prefixed with "saml."');po.call(this,t,[])}function vo(t){po.call(this,t,qi),this.a=[]}function go(){vo.call(this,"facebook.com")}function bo(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new go).credential({accessToken:e})}function mo(){vo.call(this,"github.com")}function wo(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new mo).credential({accessToken:e})}function _o(){vo.call(this,"google.com"),this.Ca("profile")}function So(t,e){var n=t;return v(t)&&(n=t.idToken,e=t.accessToken),(new _o).credential({idToken:n,accessToken:e})}function Oo(){po.call(this,"twitter.com",zi)}function Eo(t,e){var n=t;if(v(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new C("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new lo("twitter.com",n,"twitter.com")}function Ao(t,e,n){this.a=t,this.f=e,Yr(this,"providerId","password"),Yr(this,"signInMethod",n===Io.EMAIL_LINK_SIGN_IN_METHOD?Io.EMAIL_LINK_SIGN_IN_METHOD:Io.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Co(t){return t&&t.email&&t.password?new Ao(t.email,t.password,t.signInMethod):null}function Io(){Kr(this,{providerId:"password",isOAuthProvider:!1})}function To(t,e){if(!(e=xo(e)))throw new C("argument-error","Invalid email link!");return new Ao(t,e.code,Io.EMAIL_LINK_SIGN_IN_METHOD)}function xo(t){return(t=Ci(t=eo(t)))&&t.operation===si?t:null}function ko(t){if(!(t.cb&&t.bb||t.La&&t.ea))throw new C("internal-error");this.a=t,Yr(this,"providerId","phone"),this.fa="phone",Yr(this,"signInMethod","phone")}function Po(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return W(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new ko(e)}return null}function No(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.cb,code:t.a.bb}}function Bo(t){try{this.a=t||n.auth()}catch(t){throw new C("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Kr(this,{providerId:"phone",isOAuthProvider:!1})}function Do(t,e){if(!t)throw new C("missing-verification-id");if(!e)throw new C("missing-verification-code");return new ko({cb:t,bb:e})}function Ro(t){if(t.temporaryProof&&t.phoneNumber)return new ko({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return So(o,n);case"facebook.com":return bo(n);case"github.com":return wo(n);case"twitter.com":return Eo(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new ao(e,s):new lo(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new vo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function jo(t){if(!t.isOAuthProvider)throw new C("invalid-oauth-provider")}function Mo(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,!this.g&&!this.a)throw new C("invalid-auth-event");if(this.g&&this.a)throw new C("invalid-auth-event");if(this.g&&!this.f)throw new C("invalid-auth-event")}function Lo(t){return(t=t||{}).type?new Mo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&I(t.error),t.postBody,t.tenantId):null}function Fo(){this.b=null,this.a=[]}no.prototype.Ha=function(){return this.a?Ce(this.a):Ce(this.b)},no.prototype.w=function(){return this.type==ro?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},oo.prototype.ja=function(){},oo.prototype.b=function(){},oo.prototype.c=function(){},oo.prototype.w=function(){},ao.prototype.ja=function(t){return da(t,uo(this))},ao.prototype.b=function(t,e){var n=uo(this);return n.idToken=e,ya(t,n)},ao.prototype.c=function(t,e){return so(va(t,uo(this)),e)},ao.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},lo.prototype.ja=function(t){return da(t,ho(this))},lo.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,ya(t,n)},lo.prototype.c=function(t,e){return so(va(t,ho(this)),e)},lo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},po.prototype.Ka=function(t){return this.Hb=yt(t),this},A(yo,po),A(vo,po),vo.prototype.Ca=function(t){return K(this.a,t)||this.a.push(t),this},vo.prototype.Pb=function(){return Z(this.a)},vo.prototype.credential=function(t,e){var n;if(!(n=v(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new C("argument-error","credential failed: must provide the ID token and/or the access token.");return new lo(this.providerId,n,this.providerId)},A(go,vo),Yr(go,"PROVIDER_ID","facebook.com"),Yr(go,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),A(mo,vo),Yr(mo,"PROVIDER_ID","github.com"),Yr(mo,"GITHUB_SIGN_IN_METHOD","github.com"),A(_o,vo),Yr(_o,"PROVIDER_ID","google.com"),Yr(_o,"GOOGLE_SIGN_IN_METHOD","google.com"),A(Oo,po),Yr(Oo,"PROVIDER_ID","twitter.com"),Yr(Oo,"TWITTER_SIGN_IN_METHOD","twitter.com"),Ao.prototype.ja=function(t){return this.signInMethod==Io.EMAIL_LINK_SIGN_IN_METHOD?Xa(t,Ea,{email:this.a,oobCode:this.f}):Xa(t,Ha,{email:this.a,password:this.f})},Ao.prototype.b=function(t,e){return this.signInMethod==Io.EMAIL_LINK_SIGN_IN_METHOD?Xa(t,Aa,{idToken:e,email:this.a,oobCode:this.f}):Xa(t,La,{idToken:e,email:this.a,password:this.f})},Ao.prototype.c=function(t,e){return so(this.ja(t),e)},Ao.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Kr(Io,{PROVIDER_ID:"password"}),Kr(Io,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Kr(Io,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),ko.prototype.ja=function(t){return t.eb(No(this))},ko.prototype.b=function(t,e){var n=No(this);return n.idToken=e,Xa(t,Ka,n)},ko.prototype.c=function(t,e){var n=No(this);return n.operation="REAUTH",so(t=Xa(t,Qa,n),e)},ko.prototype.w=function(){var t={providerId:"phone"};return this.a.cb&&(t.verificationId=this.a.cb),this.a.bb&&(t.verificationCode=this.a.bb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Bo.prototype.eb=function(t,e){var n=this.a.a;return Ce(e.verify()).then((function(r){if("string"!=typeof r)throw new C("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=v(t)?t.session:null,o=v(t)?t.phoneNumber:t;return(i&&i.type==ro?i.Ha().then((function(t){return Xa(n,Ua,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}}).then((function(t){return t.phoneSessionInfo.sessionInfo}))})):i&&i.type==io?i.Ha().then((function(e){return function(t,e){return Xa(t,Va,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return Xa(t,ja,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new C("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Kr(Bo,{PROVIDER_ID:"phone"}),Kr(Bo,{PHONE_SIGN_IN_METHOD:"phone"}),Mo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Mo.prototype.S=function(){return this.h},Mo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Uo,Vo=null;function zo(t){var e="unauthorized-domain",n=void 0,r=Mn(t);t=r.a,"chrome-extension"==(r=r.f)?n=zt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=zt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",C.call(this,e,n)}function qo(t,e,n){C.call(this,t,n),(t=e||{}).Ib&&Yr(this,"email",t.Ib),t.ea&&Yr(this,"phoneNumber",t.ea),t.credential&&Yr(this,"credential",t.credential),t.Yb&&Yr(this,"tenantId",t.Yb)}function Wo(t){if(t.code){var e=t.code||"";0==e.indexOf(x)&&(e=e.substring(x.length));var n={credential:Ro(t),Yb:t.tenantId};if(t.email)n.Ib=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new C(e,t.message||void 0);return new qo(e,n,t.message)}return null}function Go(){}function Ho(t){return t.c||(t.c=t.b())}function Yo(){}function Ko(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Qo(){}function Jo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=S(this.pc,this),this.a.onerror=S(this.Rb,this),this.a.onprogress=S(this.qc,this),this.a.ontimeout=S(this.uc,this)}function Xo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Zo(t,e,n){this.reset(t,e,n,void 0,void 0)}function $o(t){this.f=t,this.b=this.c=this.a=null}function ts(t,e){this.name=t,this.value=e}A(zo,C),A(qo,C),qo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&gt(t,e),t},qo.prototype.toJSON=function(){return this.w()},Go.prototype.c=null,A(Yo,Go),Yo.prototype.a=function(){var t=Ko(this);return t?new ActiveXObject(t):new XMLHttpRequest},Yo.prototype.b=function(){var t={};return Ko(this)&&(t[0]=!0,t[1]=!0),t},Uo=new Yo,A(Qo,Go),Qo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Jo;throw Error("Unsupported browser")},Qo.prototype.b=function(){return{}},(e=Jo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Xo(this,4)},e.Rb=function(){this.status=500,this.response=this.responseText="",Xo(this,4)},e.uc=function(){this.Rb()},e.qc=function(){this.status=200,Xo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Zo.prototype.a=null,Zo.prototype.reset=function(t,e,n,r,i){r||E(),delete this.a},ts.prototype.toString=function(){return this.name};var es=new ts("SEVERE",1e3),ns=new ts("WARNING",900),rs=new ts("CONFIG",700),is=new ts("FINE",500);$o.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(j("Root logger has no level set."),null)}(this).value)for(y(e)&&(e=e()),t=new Zo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var os={},ss=null;function as(t){var e;if(ss||(ss=new $o(""),os[""]=ss,ss.c=rs),!(e=os[t])){e=new $o(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=as(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,os[t]=e}return e}function us(t,e){t&&t.log(is,e,void 0)}function cs(t){this.f=t}function ls(t){mn.call(this),this.o=t,this.readyState=hs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=as("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}A(cs,Go),cs.prototype.a=function(){return new ls(this.f)},cs.prototype.b=function(t){return function(){return t}}({}),A(ls,mn);var hs=0;function fs(t){t.c.read().then(t.oc.bind(t)).catch(t.Ta.bind(t))}function ps(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,ds(t)}function ds(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ys(t){mn.call(this),this.headers=new In,this.O=t||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.o=null,this.m=vs,this.u=this.R=!1}(e=ls.prototype).open=function(t,e){if(this.readyState!=hs)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,ds(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.tc.bind(this),this.Ta.bind(this))},e.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ps(this,!1)),this.readyState=hs},e.tc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,ds(this)),this.a&&(this.readyState=3,ds(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==c.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,fs(this)):t.text().then(this.sc.bind(this),this.Ta.bind(this)))))},e.oc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ps(this,!0):ds(this),3==this.readyState&&fs(this)}},e.sc=function(t){this.a&&(this.response=this.responseText=t,ps(this,!0))},e.rc=function(t){this.a&&(this.response=t,ps(this,!0))},e.Ta=function(t){var e=this.h;e&&e.log(ns,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&ps(this,!0)},e.setRequestHeader=function(t,e){this.i.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(ns,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(ns,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},A(ys,mn);var vs="";ys.prototype.b=as("goog.net.XhrIo");var gs=/^https?$/i,bs=["POST","PUT"];function ms(t){return"content-type"==t.toLowerCase()}function ws(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,_s(t),Os(t)}function _s(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ss(t){if(t.c&&void 0!==u)if(t.A[1]&&4==As(t)&&2==Cs(t))us(t.b,Is(t,"Local request error detected and ignored"));else if(t.i&&4==As(t))On(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==As(t)){us(t.b,Is(t,"Request complete")),t.c=!1;try{var e,n=Cs(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(kn)[1]||null;if(!o&&c.self&&c.self.location){var s=c.self.location.protocol;o=s.substr(0,s.length-1)}i=!gs.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var a=2<As(t)?t.a.statusText:""}catch(e){us(t.b,"Can not get status: "+e.message),a=""}t.h=a+" ["+Cs(t)+"]",_s(t)}}finally{Os(t)}}}function Os(t,e){if(t.a){Es(t);var n=t.a,r=t.A[0]?f:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(es,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Es(t){t.a&&t.u&&(t.a.ontimeout=null),t.o&&(c.clearTimeout(t.o),t.o=null)}function As(t){return t.a?t.a.readyState:0}function Cs(t){try{return 2<As(t)?t.a.status:-1}catch(t){return-1}}function Is(t,e){return e+" ["+t.P+" "+t.l+" "+Cs(t)+"]"}function Ts(t){var e=Fs;this.g=[],this.u=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function xs(t,e,n){t.a=!0,t.c=n,t.f=!e,Bs(t)}function ks(t){if(t.a){if(!t.m)throw new Ds(t);t.m=!1}}function Ps(t,e,n,r){t.g.push([e,n,r]),t.a&&Bs(t)}function Ns(t){return Y(t.g,(function(t){return y(t[1])}))}function Bs(t){if(t.h&&t.a&&Ns(t)){var e=t.h,n=Ms[e];n&&(c.clearTimeout(n.a),delete Ms[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var a=o.call(i||t.o,e);void 0!==a&&(t.f=t.f&&(a==e||a instanceof Error),t.c=e=a),(B(e)||"function"==typeof c.Promise&&e instanceof c.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,Ns(t)||(n=!0)}}t.c=e,r&&(a=S(t.v,t,!0),r=S(t.v,t,!1),e instanceof Ts?(Ps(e,a,r),e.A=!0):e.then(a,r)),n&&(e=new js(e),Ms[e.a]=e,t.h=e.a)}function Ds(){D.call(this)}function Rs(){D.call(this)}function js(t){this.a=c.setTimeout(S(this.c,this),0),this.b=t}(e=ys.prototype).Ma=function(){void 0!==u&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",us(this.b,Is(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(us(this.b,Is(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Os(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Os(this,!0)),ys.$a.Da.call(this)},e.Ub=function(){this.xa||(this.N||this.i||this.f?Ss(this):this.Ic())},e.Ic=function(){Ss(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case vs:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(es,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return us(this.b,"Can not get response: "+t.message),null}},Ts.prototype.cancel=function(t){if(this.a)this.c instanceof Ts&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.o,this):this.m=!0,this.a||(t=new Rs(this),ks(this),xs(this,!1,t))}},Ts.prototype.v=function(t,e){this.i=!1,xs(this,t,e)},Ts.prototype.then=function(t,e,n){var r,i,o=new me((function(t,e){r=t,i=e}));return Ps(this,r,(function(t){t instanceof Rs?o.cancel():i(t)})),o.then(t,e,n)},Ts.prototype.$goog_Thenable=!0,A(Ds,D),Ds.prototype.message="Deferred has already fired",Ds.prototype.name="AlreadyCalledError",A(Rs,D),Rs.prototype.message="Deferred was canceled",Rs.prototype.name="CanceledError",js.prototype.c=function(){throw delete Ms[this.a],this.b};var Ms={};function Ls(t){var e={},n=e.document||document,r=At(t).toString(),i=fe(document,"SCRIPT"),o={Vb:i,Ma:void 0},s=new Ts(o),a=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(a=window.setTimeout((function(){Us(i,!0);var t=new qs(zs,"Timeout reached for loading script "+r);ks(s),xs(s,!1,t)}),u),o.Ma=a),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Us(i,e.wd||!1,a),ks(s),xs(s,!0,null))},i.onerror=function(){Us(i,!0,a);var t=new qs(Vs,"Error while loading script "+r);ks(s),xs(s,!1,t)},gt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),ue(i,o),function(t,e){bt(t,"HTMLScriptElement"),t.src=At(e),null===h&&(h=(e=(e=c.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&l.test(e)?e:""),(e=h)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),s}function Fs(){if(this&&this.Vb){var t=this.Vb;t&&"SCRIPT"==t.tagName&&Us(t,!0,this.Ma)}}function Us(t,e,n){null!=n&&c.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Vs=0,zs=1;function qs(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),D.call(this,n),this.code=t}function Ws(t){this.f=t}function Gs(t,e,r){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=t.secureTokenTimeout||Ks,this.g=yt(t.secureTokenHeaders||Qs),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=t.firebaseTimeout||Js,this.a=yt(t.firebaseHeaders||Xs),r&&(this.a["X-Client-Version"]=r,this.g["X-Client-Version"]=r),r="Node"==br(),!(r=c.XMLHttpRequest||r&&n.INTERNAL.node&&n.INTERNAL.node.XMLHttpRequest)&&!gr())throw new C("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,gr()?this.f=new cs(self):mr()?this.f=new Ws(r):this.f=new Qo,this.b=null}A(qs,D),A(Ws,Go),Ws.prototype.a=function(){return new this.f},Ws.prototype.b=function(){return{}};var Hs,Ys="idToken",Ks=new Lr(3e4,6e4),Qs={"Content-Type":"application/x-www-form-urlencoded"},Js=new Lr(3e4,6e4),Xs={"Content-Type":"application/json"};function Zs(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function $s(t,e){e&&(t.l=ta("https://securetoken.googleapis.com/v1/token",e),t.h=ta("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=ta("https://identitytoolkit.googleapis.com/v2/",e))}function ta(t,e){return t=Mn(t),e=Mn(e.url),t.c=t.a+t.c,Nn(t,e.f),t.a=e.a,Bn(t,e.g),t.toString()}function ea(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function na(t,e,n,r,i,o,s){(function(){var t=Ar();return!((t=Sr(t)!=_r?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Kt&&re&&!(9<re))})()||gr()?t=S(t.u,t):(Hs||(Hs=new me((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(c[ia]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Ps(t,null,e,void 0)}(Ls(Ct(ra,{onload:ia})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=S(t.o,t)),t(e,n,r,i,o,s)}Gs.prototype.S=function(){return this.b},Gs.prototype.u=function(t,e,n,r,i,o){if(gr()&&(void 0===c.fetch||void 0===c.Headers||void 0===c.Request))throw new C("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new ys(this.f);if(o){s.g=Math.max(0,o);var a=setTimeout((function(){s.dispatchEvent("timeout")}),o)}wn(s,"complete",(function(){a&&clearTimeout(a);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return us(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),_n(s,"ready",(function(){a&&clearTimeout(a),qe(this)})),_n(s,"timeout",(function(){a&&clearTimeout(a),qe(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.G=!1,t.c=!0,t.a=t.O?t.O.a():Uo.a(),t.A=t.O?Ho(t.O):Ho(Uo),t.a.onreadystatechange=S(t.Ub,t);try{us(t.b,Is(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){return us(t.b,Is(t,"Error opening Xhr: "+e.message)),void ws(t,e)}e=r||"";var o=new In(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)W(t,e,void 0);else for(var n=Cn(t),r=An(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=ms,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=c.FormData&&e instanceof c.FormData,!K(bs,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{Es(t),0<t.g&&(t.u=function(t){return Kt&&oe(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),us(t.b,Is(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=S(t.Ma,t)):t.o=On(t.Ma,t.g,t)),us(t.b,Is(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){us(t.b,Is(t,"Send error: "+e.message)),ws(t,e)}}(s,t,n,r,i)};var ra=new mt(St,"https://apis.google.com/js/client.js?onload=%{onload}"),ia="__fcb"+Math.floor(1e6*Math.random()).toString();function oa(t){if("string"!=typeof(t=t.email)||!pr.test(t))throw new C("invalid-email")}function sa(t){"email"in t&&oa(t)}function aa(t){if(!t[Ys]){if(t.mfaPendingCredential)throw new C("multi-factor-auth-required",null,yt(t));throw new C("internal-error")}}function ua(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new C("internal-error")}else{if(!t.sessionInfo)throw new C("missing-verification-id");if(!t.code)throw new C("missing-verification-code")}}Gs.prototype.o=function(t,e,n,r,i){var o=this;Hs.then((function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Gs.prototype.yb=function(){return Xa(this,Fa,{})},Gs.prototype.Ab=function(t,e){return Xa(this,Ma,{idToken:t,email:e})},Gs.prototype.Bb=function(t,e){return Xa(this,La,{idToken:t,password:e})};var ca={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function la(t){if(!t.phoneVerificationInfo)throw new C("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new C("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new C("missing-verification-code")}function ha(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new C("internal-error")}function fa(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Xn(t=new Yn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function pa(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Wo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Wo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Wo(t)):t.errorMessage&&(e=Za(t.errorMessage)),e)throw e;aa(t)}function da(t,e){return e.returnIdpCredential=!0,Xa(t,za,e)}function ya(t,e){return e.returnIdpCredential=!0,Xa(t,Wa,e)}function va(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Xa(t,qa,e)}function ga(t){if(!t.oobCode)throw new C("invalid-action-code")}(e=Gs.prototype).Cb=function(t,e){var n={idToken:t},r=[];return pt(ca,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Xa(this,Ma,n)},e.ub=function(t,e){return gt(t={requestType:"PASSWORD_RESET",email:t},e),Xa(this,Na,t)},e.vb=function(t,e){return gt(t={requestType:"EMAIL_SIGNIN",email:t},e),Xa(this,xa,t)},e.tb=function(t,e){return gt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Xa(this,ka,t)},e.Db=function(t,e,n){return gt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Xa(this,Pa,t)},e.eb=function(t){return Xa(this,Ya,t)},e.mb=function(t,e){return Xa(this,Ra,{oobCode:t,newPassword:e})},e.Qa=function(t){return Xa(this,ma,{oobCode:t})},e.ib=function(t){return Xa(this,ba,{oobCode:t})};var ba={endpoint:"setAccountInfo",B:ga,Z:"email",C:!0},ma={endpoint:"resetPassword",B:ga,F:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new C("internal-error")},C:!0},wa={endpoint:"signupNewUser",B:function(t){if(oa(t),!t.password)throw new C("weak-password")},F:aa,U:!0,C:!0},_a={endpoint:"createAuthUri",C:!0},Sa={endpoint:"deleteAccount",M:["idToken"]},Oa={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(t){if("array"!=p(t.deleteProvider))throw new C("internal-error")}},Ea={endpoint:"emailLinkSignin",M:["email","oobCode"],B:oa,F:aa,U:!0,C:!0},Aa={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:oa,F:aa,U:!0},Ca={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:la,F:aa,C:!0,Na:!0},Ia={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:la,F:aa,C:!0,Na:!0},Ta={endpoint:"getAccountInfo"},xa={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new C("internal-error");oa(t)},Z:"email",C:!0},ka={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",C:!0},Pa={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",C:!0},Na={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new C("internal-error");oa(t)},Z:"email",C:!0},Ba={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Da={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(t){if(!t.recaptchaSiteKey)throw new C("internal-error")}},Ra={endpoint:"resetPassword",B:ga,Z:"email",C:!0},ja={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},Ma={endpoint:"setAccountInfo",M:["idToken"],B:sa,U:!0},La={endpoint:"setAccountInfo",M:["idToken"],B:function(t){if(sa(t),!t.password)throw new C("weak-password")},F:aa,U:!0},Fa={endpoint:"signupNewUser",F:aa,U:!0,C:!0},Ua={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(t){if(!t.phoneEnrollmentInfo)throw new C("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new C("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new C("missing-app-credential")},F:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new C("internal-error")},C:!0,Na:!0},Va={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new C("missing-app-credential")},F:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new C("internal-error")},C:!0,Na:!0},za={endpoint:"verifyAssertion",B:ha,Xa:fa,F:pa,U:!0,C:!0},qa={endpoint:"verifyAssertion",B:ha,Xa:fa,F:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new C("user-not-found");if(t.errorMessage)throw Za(t.errorMessage);aa(t)},U:!0,C:!0},Wa={endpoint:"verifyAssertion",B:function(t){if(ha(t),!t.idToken)throw new C("internal-error")},Xa:fa,F:pa,U:!0},Ga={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new C("invalid-custom-token")},F:aa,U:!0,C:!0},Ha={endpoint:"verifyPassword",B:function(t){if(oa(t),!t.password)throw new C("wrong-password")},F:aa,U:!0,C:!0},Ya={endpoint:"verifyPhoneNumber",B:ua,F:aa,C:!0},Ka={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new C("internal-error");ua(t)},F:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Wo(t);aa(t)}},Qa={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:ua,F:aa,C:!0},Ja={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(t){if(!!t[Ys]^!!t.refreshToken)throw new C("internal-error")},C:!0,Na:!0};function Xa(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.M))return Ie(new C("internal-error"));var r,i=!!e.Na,o=e.Tb||"POST";return Ce(n).then(e.B).then((function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,s){var a=Mn(e+n);Rn(a,"key",t.c),s&&Rn(a,"cb",E().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Rn(a,c,i[c]);return new me((function(e,n){na(t,a.toString(),(function(t){t?t.error?n($a(t,o||{})):e(t):n(new C("network-request-failed"))}),r,u?void 0:er(Br(i)),t.a,t.m.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Gb,e.kb||!1)})).then((function(t){return r=t,e.Xa?e.Xa(n,r):r})).then(e.F).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new C("internal-error");return r[e.Z]}))}function Za(t){return $a({error:{errors:[{message:t}],code:400,message:t}})}function $a(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new C(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",gt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new C(r[i],e);return!e&&t&&(e=Nr(t)),new C("internal-error",e)}function tu(t){this.b=t,this.a=null,this.qb=function(t){return(iu||(iu=new me((function(t,e){function n(){Mr(),Cr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Mr(),e(Error("Network Error"))},timeout:nu.get()})}if(Cr("gapi.iframes.Iframe"))t();else if(Cr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();c[r]=function(){Cr("gapi.load")?n():e(Error("Network Error"))},Ce(Ls(r=Ct(eu,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw iu=null,t})))).then((function(){return new me((function(e,n){Cr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),ru.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var eu=new mt(St,"https://apis.google.com/js/api.js?onload=%{onload}"),nu=new Lr(3e4,6e4),ru=new Lr(5e3,15e3),iu=null;function ou(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Ln((t=Mn(this.g.url)).f,t.a,t.g,"/emulator/auth/iframe"):Ln("https",this.l,null,"/__/auth/iframe"),this.a=t,Rn(this.a,"apiKey",this.h),Rn(this.a,"appName",this.i),this.b=null,this.c=[]}function su(t,e,n,r,i,o){this.u=t,this.o=e,this.c=n,this.v=r,this.m=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function au(t){try{return n.app(t).auth().Ga()}catch(t){return[]}}function uu(t,e,n,r,i,o){this.o=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function cu(t){var e=ar();return function(t){return Xa(t,Ba,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Mn(e),r=n.f;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=Mn(o).a==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:fr.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){t=!0;break t}}t=!1}if(!t)throw new zo(ar())}))}function lu(t){return t.v||(t.v=dr().then((function(){if(!t.u){var e=t.c,n=t.i,r=au(t.b),i=new ou(t.o,t.g,t.b,t.f);i.f=e,i.b=n,i.c=Z(r||[]),t.u=i.toString()}t.m=new tu(t.u),function(t){if(!t.m)throw Error("IfcHandler must be initialized!");!function(t,e){t.qb.then((function(){t.a.register("authEvent",e,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.m,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Lo(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ce(n)}return n.status="ERROR",Ce(n)}))}(t)}))),t.v}function hu(t){return t.l||(t.A=t.c?Er(t.c,au(t.b)):null,t.l=new Gs(t.g,N(t.i),t.A),t.f&&$s(t.l,t.f)),t.l}function fu(t,e,n,r,i,o,s,a,u,c,l,h){return(t=new su(t,e,n,r,i,h)).l=o,t.g=s,t.i=a,t.b=yt(u||null),t.f=c,t.xb(l).toString()}function pu(t){if(this.a=t||n.INTERNAL.reactNative&&n.INTERNAL.reactNative.AsyncStorage,!this.a)throw new C("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function du(t){this.b=t,this.a={},this.f=S(this.c,this)}ou.prototype.toString=function(){return this.f?Rn(this.a,"v",this.f):Jn(this.a.b,"v"),this.b?Rn(this.a,"eid",this.b):Jn(this.a.b,"eid"),this.c.length?Rn(this.a,"fw",this.c.join(",")):Jn(this.a.b,"fw"),this.a.toString()},su.prototype.xb=function(t){return this.h=t,this},su.prototype.toString=function(){if(this.m){var t=Mn(this.m.url);t=Ln(t.f,t.a,t.g,"/emulator/auth/handler")}else t=Ln("https",this.u,null,"/__/auth/handler");if(Rn(t,"apiKey",this.o),Rn(t,"appName",this.c),Rn(t,"authType",this.v),this.a.isOAuthProvider){var e=this.a;try{var r=n.app(this.c).auth().ka()}catch(t){r=null}for(var i in e.nb=r,Rn(t,"providerId",this.a.providerId),e=Br((r=this.a).Hb))e[i]=e[i].toString();i=r.Pc,e=yt(e);for(var o=0;o<i.length;o++){var s=i[o];s in e&&delete e[s]}r.ob&&r.nb&&!e[r.ob]&&(e[r.ob]=r.nb),dt(e)||Rn(t,"customParameters",Nr(e))}if("function"==typeof this.a.Pb&&(r=this.a.Pb()).length&&Rn(t,"scopes",r.join(",")),this.l?Rn(t,"redirectUrl",this.l):Jn(t.b,"redirectUrl"),this.g?Rn(t,"eventId",this.g):Jn(t.b,"eventId"),this.i?Rn(t,"v",this.i):Jn(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!jn(t,a)&&Rn(t,a,this.b[a]);return this.h?Rn(t,"tid",this.h):Jn(t.b,"tid"),this.f?Rn(t,"eid",this.f):Jn(t.b,"eid"),(a=au(this.c)).length&&Rn(t,"fw",a.join(",")),t.toString()},(e=uu.prototype).Nb=function(t,e,n){var r=new C("popup-closed-by-user"),i=new C("web-storage-unsupported"),o=this,s=!1;return this.la().then((function(){(function(t){var e={type:"webStorageSupport"};return lu(t).then((function(){return function(t,e){return t.qb.then((function(){return new me((function(n){t.a.send(e.type,e,n,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.m,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&lr(t),e(i),s=!0)}))})).s((function(){})).then((function(){if(!s)return function(t){return new me((function(e){return function n(){En(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!s)return En(n).then((function(){e(r)}))}))},e.Wb=function(){var t=Ar();return!Pr(t)&&!jr(t)},e.Sb=function(){return!1},e.Lb=function(t,e,n,r,i,o,s,a){if(!t)return Ie(new C("popup-blocked"));if(s&&!Pr())return this.la().s((function(e){lr(t),i(e)})),r(),Ce();this.a||(this.a=cu(hu(this)));var u=this;return this.a.then((function(){var e=u.la().s((function(e){throw lr(t),i(e),e}));return r(),e})).then((function(){jo(n),s||ur(fu(u.o,u.g,u.b,e,n,null,o,u.c,void 0,u.i,a,u.f),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},e.Mb=function(t,e,n,r){this.a||(this.a=cu(hu(this)));var i=this;return this.a.then((function(){jo(e),ur(fu(i.o,i.g,i.b,t,e,ar(),n,i.c,void 0,i.i,r,i.f))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},e.la=function(){var t=this;return lu(this).then((function(){return t.m.qb})).s((function(){throw t.a=null,new C("network-request-failed")}))},e.Zb=function(){return!0},e.Ea=function(t){this.h.push(t)},e.Ra=function(t){J(this.h,(function(e){return e==t}))},(e=pu.prototype).get=function(t){return Ce(this.a.getItem(t)).then((function(t){return t&&Dr(t)}))},e.set=function(t,e){return Ce(this.a.setItem(t,Nr(e)))},e.T=function(t){return Ce(this.a.removeItem(t))},e.ca=function(){},e.ia=function(){};var yu,vu=[];function gu(t,e,n){dt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function bu(t){this.a=t}function mu(t){this.c=t,this.b=!1,this.a=[]}function wu(t,e,n,r){var i,o,s,a,u=n||{},c=null;if(t.b)return Ie(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new me((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),s=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return _u(t,c),e})).s((function(e){throw _u(t,c),e}))}function _u(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),J(t.a,(function(t){return t==e}))}}function Su(){if(!Au())throw new C("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=c.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;gr()&&self?(this.l=function(){var t=gr()?self:null;if(W(vu,(function(n){n.b==t&&(e=n)})),!e){var e=new du(t);vu.push(e)}return e}(),gu(this.l,"keyChanged",(function(e,n){return ku(t).then((function(e){return 0<e.length&&W(t.a,(function(t){t(e)})),{keyProcessed:K(e,n.key)}}))})),gu(this.l,"ping",(function(){return Ce(["keyChanged"])}))):function(){var t=c.navigator;return t&&t.serviceWorker?Ce().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):Ce(null)}().then((function(e){(t.h=e)&&(t.g=new mu(new bu(e)),wu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&K(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function Ou(t){return new me((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new me((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Ou(t)})).then((function(t){e(t)})).s((function(t){n(t)}))}}))}function Eu(t){return t.v||(t.v=Ou(t)),t.v}function Au(){try{return!!c.indexedDB}catch(t){return!1}}function Cu(t){return t.objectStore("firebaseLocalStorage")}function Iu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Tu(t){return new me((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function xu(t,e){return t.g&&t.h&&function(){var t=c.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?wu(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):Ce()}function ku(t){return Eu(t).then((function(t){var e=Cu(Iu(t,!1));return e.getAll?Tu(e.getAll()):new me((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function Pu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Nu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ce().then((function(){if(Au()){var t=Rr(),r="__sak"+t;return yu||(yu=new Su),(n=yu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){W(e.a,(function(e){e(t)}))})),t}))}function Bu(){this.a={},this.type="inMemory"}function Du(){if(!function(){var t="Node"==br();if(!(t=Ru()||t&&n.INTERNAL.node&&n.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==br())throw new C("internal-error","The LocalStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Ru()||n.INTERNAL.node.localStorage,this.type="localStorage"}function Ru(){try{var t=c.localStorage,e=Rr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function ju(){this.type="nullStorage"}function Mu(){if(!function(){var t="Node"==br();if(!(t=Lu()||t&&n.INTERNAL.node&&n.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==br())throw new C("internal-error","The SessionStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Lu()||n.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Lu(){try{var t=c.sessionStorage,e=Rr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Fu(){var t={};t.Browser=zu,t.Node=qu,t.ReactNative=Wu,t.Worker=Gu,this.a=t[br()]}du.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];W(r,(function(e){i.push(Ce().then((function(){return e(t.origin,t.data.data)})))})),xe(i).then((function(r){var i=[];W(r,(function(t){i.push({fulfilled:t.Ob,value:t.value,reason:t.reason?t.reason.message:void 0})})),W(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},bu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},mu.prototype.close=function(){for(;0<this.a.length;)_u(this,this.a[0]);this.b=!0},(e=Su.prototype).set=function(t,e){var n,r=!1,i=this;return Eu(this).then((function(e){return Tu((e=Cu(Iu(n=e,!0))).get(t))})).then((function(o){var s=Cu(Iu(n,!0));return o?(o.value=e,Tu(s.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Tu(s.add(o)))})).then((function(){return i.c[t]=e,xu(i,t)})).na((function(){r&&i.b--}))},e.get=function(t){return Eu(this).then((function(e){return Tu(Cu(Iu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},e.T=function(t){var e=!1,n=this;return Eu(this).then((function(r){return e=!0,n.b++,Tu(Cu(Iu(r,!0)).delete(t))})).then((function(){return delete n.c[t],xu(n,t)})).na((function(){e&&n.b--}))},e.ca=function(t){0==this.a.length&&function(t){Pu(t),function e(){t.f=setTimeout((function(){t.i=ku(t).then((function(e){0<e.length&&W(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},e.ia=function(t){J(this.a,(function(e){return e==t})),0==this.a.length&&Pu(this)},(e=Nu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},e.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},e.T=function(t){return this.b.then((function(e){return e.T(t)}))},e.ca=function(t){this.a.push(t)},e.ia=function(t){J(this.a,(function(e){return e==t}))},(e=Bu.prototype).get=function(t){return Ce(this.a[t])},e.set=function(t,e){return this.a[t]=e,Ce()},e.T=function(t){return delete this.a[t],Ce()},e.ca=function(){},e.ia=function(){},(e=Du.prototype).get=function(t){var e=this;return Ce().then((function(){return Dr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Ce().then((function(){var r=Nr(e);null===r?n.T(t):n.a.setItem(t,r)}))},e.T=function(t){var e=this;return Ce().then((function(){e.a.removeItem(t)}))},e.ca=function(t){c.window&&an(c.window,"storage",t)},e.ia=function(t){c.window&&ln(c.window,"storage",t)},(e=ju.prototype).get=function(){return Ce(null)},e.set=function(){return Ce()},e.T=function(){return Ce()},e.ca=function(){},e.ia=function(){},(e=Mu.prototype).get=function(t){var e=this;return Ce().then((function(){return Dr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Ce().then((function(){var r=Nr(e);null===r?n.T(t):n.a.setItem(t,r)}))},e.T=function(t){var e=this;return Ce().then((function(){e.a.removeItem(t)}))},e.ca=function(){},e.ia=function(){};var Uu,Vu,zu={D:Du,ab:Mu},qu={D:Du,ab:Mu},Wu={D:pu,ab:ju},Gu={D:Du,ab:ju},Hu={qd:"local",NONE:"none",sd:"session"};function Yu(){var t=!(jr(Ar())||!vr()),e=Pr(),n=Ir();this.v=t,this.h=e,this.l=n,this.a={},Uu||(Uu=new Fu),t=Uu;try{this.g=!sr()&&zr()||!c.indexedDB?new t.a.D:new Nu(gr()?new Bu:new t.a.D)}catch(t){this.g=new Bu,this.h=!0}try{this.i=new t.a.ab}catch(t){this.i=new Bu}this.m=new Bu,this.f=S(this.Xb,this),this.b={}}function Ku(){return Vu||(Vu=new Yu),Vu}function Qu(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g}}function Ju(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Xu(t,e,n){return n=Ju(e,n),"local"==e.D&&(t.b[n]=null),Qu(t,e.D).T(n)}function Zu(t){t.c&&(clearInterval(t.c),t.c=null)}function $u(t){this.a=t,this.b=Ku()}(e=Yu.prototype).get=function(t,e){return Qu(this,t.D).get(Ju(t,e))},e.set=function(t,e,n){var r=Ju(t,n),i=this,o=Qu(this,t.D);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.D&&(i.b[r]=e)}))},e.addListener=function(t,e,n){t=Ju(t,e),this.l&&(this.b[t]=c.localStorage.getItem(t)),dt(this.a)&&(Qu(this,"local").ca(this.f),this.h||(sr()||!zr())&&c.indexedDB||!this.l||function(t){Zu(t),t.c=setInterval((function(){for(var e in t.a){var n=c.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Qe({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Xb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=Ju(t,e),this.a[t]&&(J(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),dt(this.a)&&(Qu(this,"local").ia(this.f),Zu(this))},e.Xb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=c.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Qu(this,"local").ia(this.f):Zu(this),this.v)if(n=c.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?c.localStorage.setItem(e,r):c.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===c.localStorage.getItem(e)||(o.b[e]=c.localStorage.getItem(e),o.lb(e))},Kt&&re&&10==re&&c.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else W(t,S(this.lb,this))},e.lb=function(t){this.a[t]&&W(this.a[t],(function(t){t()}))};var tc,ec={name:"authEvent",D:"local"};function nc(){this.a=Ku()}function rc(t,e){this.b=ic,this.f=c.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=c.Int32Array?new Int32Array(64):Array(64),void 0===tc&&(tc=c.Int32Array?new Int32Array(hc):hc),this.reset()}A(rc,(function(){this.b=-1}));for(var ic=64,oc=ic-1,sc=[],ac=0;ac<oc;ac++)sc[ac]=0;var uc=X(128,sc);function cc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&l^~c&h)+(0|tc[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+s|0,u=a,a=i,i=r,r=s+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function lc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(cc(t),i=0);else{if(!d(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(cc(t),i=0)}}t.c=i,t.g+=n}rc.prototype.reset=function(){this.g=this.c=0,this.a=c.Int32Array?new Int32Array(this.h):Z(this.h)};var hc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function fc(){rc.call(this,8,pc)}A(fc,rc);var pc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function dc(t,e,n,r,i,o){this.m=t,this.i=e,this.l=n,this.v=r||null,this.u=i||null,this.o=o,this.h=e+":"+n,this.A=new nc,this.g=new $u(this.h),this.f=null,this.b=[],this.a=this.c=null}function yc(t){return new C("invalid-cordova-configuration",t)}function vc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function gc(t){return t.f||(t.f=t.la().then((function(){return new me((function(e){t.Ea((function n(r){return e(r),t.Ra(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),bc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=eo(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Dr(jn(o=Mn(i),"firebaseError")||null))?I(o):null)?new Mo(r.c,r.b,null,null,o,null,r.S()):new Mo(r.c,r.b,i,r.f,null,null,r.S())),i=o||n}vc(t,i)}))}var n=new Mo("unknown",null,null,null,new C("no-auth-event")),r=!1,i=En(500).then((function(){return bc(t).then((function(){r||vc(t,n)}))})),o=c.handleOpenURL;c.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Cr("BuildInfo.packageName",c).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Vo||(Vo=new Fo),function(t){var e=Vo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Cr("universalLinks.subscribe",c))&&t(null,e.b))}(e)}(t)}))}))),t.f}function bc(t){var e=null;return function(t){return t.b.get(ec,t.a).then((function(t){return Lo(t)}))}(t.g).then((function(n){return e=n,Xu((n=t.g).b,ec,n.a)})).then((function(){return e}))}function mc(t){this.a=t,this.b=Ku()}(e=dc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(yr(void 0)?dr().then((function(){return new me((function(t,e){var n=c.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Ie(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Cr("universalLinks.subscribe",c))throw yc("cordova-universal-links-plugin-fix is not installed");if(void 0===Cr("BuildInfo.packageName",c))throw yc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Cr("cordova.plugins.browsertab.openUrl",c))throw yc("cordova-plugin-browsertab is not installed");if("function"!=typeof Cr("cordova.InAppBrowser.open",c))throw yc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new C("cordova-not-ready")}))},e.Nb=function(t,e){return e(new C("operation-not-supported-in-this-environment")),Ce()},e.Lb=function(){return Ie(new C("operation-not-supported-in-this-environment"))},e.Zb=function(){return!1},e.Wb=function(){return!0},e.Sb=function(){return!0},e.Mb=function(t,e,n,r){if(this.c)return Ie(new C("redirect-operation-pending"));var i=this,o=c.document,s=null,a=null,u=null,l=null;return this.c=Ce().then((function(){return jo(e),gc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Mo(e,r,null,o,new C("no-auth-event"),null,i),a=Cr("BuildInfo.packageName",c);if("string"!=typeof a)throw new C("invalid-cordova-configuration");var u=Cr("BuildInfo.displayName",c),l={};if(Ar().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=a;else{if(!Ar().toLowerCase().match(/android/))return Ie(new C("operation-not-supported-in-this-environment"));l.apn=a}u&&(l.appDisplayName=u),o=function(t){var e=new fc;lc(e,t),t=[];var n=8*e.g;56>e.c?lc(e,uc,56-e.c):lc(e,uc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(cc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return H(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),l.sessionId=o;var h=fu(t.m,t.i,t.l,e,n,null,r,t.v,l,t.u,i,t.o);return t.la().then((function(){var e=t.h;return t.A.a.set(ec,s.w(),e)})).then((function(){var e=Cr("cordova.plugins.browsertab.isAvailable",c);if("function"!=typeof e)throw new C("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Cr("cordova.plugins.browsertab.openUrl",c)))throw new C("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Cr("cordova.InAppBrowser.open",c)))throw new C("invalid-cordova-configuration");e=Ar(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new me((function(t,e){a=function(){var e=Cr("cordova.plugins.browsertab.close",c);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(a),u=function(){s||(s=En(2e3).then((function(){e(new C("redirect-cancelled-by-user"))})))},l=function(){Fr()&&u()},o.addEventListener("resume",u,!1),Ar().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).s((function(t){return bc(i).then((function(){throw t}))}))})).na((function(){u&&o.removeEventListener("resume",u,!1),l&&o.removeEventListener("visibilitychange",l,!1),s&&s.cancel(),a&&i.Ra(a),i.c=null}))},e.Ea=function(t){this.b.push(t),gc(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Mo("unknown",null,null,null,new C("no-auth-event")),t(e))}))},e.Ra=function(t){J(this.b,(function(e){return e==t}))};var wc={name:"pendingRedirect",D:"session"};function _c(t){return Xu(t.b,wc,t.a)}function Sc(t,e,n,r){this.i={},this.u=0,this.O=t,this.m=e,this.v=n,this.G=r,this.h=[],this.f=!1,this.l=S(this.o,this),this.b=new Mc,this.A=new zc,this.g=new mc(Rc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=Oc(this.O,this.m,this.v,T,this.G)}function Oc(t,e,r,i,o){var s=n.SDK_VERSION||null;return yr()?new dc(t,e,r,s,i,o):new uu(t,e,r,s,i,o)}function Ec(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.la().s((function(n){throw t.a==e&&t.reset(),n}))}function Ac(t){t.a.Wb()&&Ec(t).s((function(e){var n=new Mo("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Pc(e)&&t.o(n)})),t.a.Sb()||Lc(t.b)}function Cc(t,e){K(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(wc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?_c(t.g).then((function(){Ec(t).s((function(e){var n=new Mo("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Pc(e)&&t.o(n)}))})):Ac(t)})).s((function(){Ac(t)}))}function Ic(t,e){J(t.h,(function(t){return t==e}))}Sc.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=Oc(this.O,this.m,this.v,null,this.G),this.i={}},Sc.prototype.o=function(t){if(!t)throw new C("invalid-auth-event");if(6e5<=E()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Eb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=E())),e=!0;break}}return Lc(this.b),e};var Tc=new Lr(2e3,1e4),xc=new Lr(3e4,6e4);function kc(t,e,n,r,i,o,s){return t.a.Lb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,s)}function Pc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Nc(t,e,n,r,i){var o;return function(t){return t.b.set(wc,"pending",t.a)}(t.g).then((function(){return t.a.Mb(e,n,r,i).s((function(e){if(Pc(e))throw new C("operation-not-supported-in-this-environment");return o=e,_c(t.g).then((function(){throw o}))})).then((function(){return t.a.Zb()?new me((function(){})):_c(t.g).then((function(){return t.qa()})).then((function(){})).s((function(){}))}))}))}function Bc(t,e,n,r,i){return t.a.Nb(r,(function(t){e.ma(n,null,t,i)}),Tc.get())}Sc.prototype.qa=function(){return this.b.qa()};var Dc={};function Rc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function jc(t,e,n,r){var i=Rc(e,n,r);return Dc[i]||(Dc[i]=new Sc(t,e,n,r)),Dc[i]}function Mc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Lc(t){t.g||(t.g=!0,Vc(t,!1,null,null))}function Fc(t){t.g&&!t.i&&Vc(t,!1,null,null)}function Uc(t,e){if(t.b=function(){return Ce(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Vc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Ie(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Uc(t,n):Uc(t,{user:null}),t.f=[],t.c=[]}function zc(){}function qc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(t){this.hb=t},enumerable:!1})}function Wc(t,e){this.a=e,Yr(this,"verificationId",t)}function Gc(t,e,n,r){return new Bo(t).eb(e,n).then((function(t){return new Wc(t,r)}))}function Hc(t){var e=Vi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new C("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Kr(this,{token:t,expirationTime:Vr(1e3*e.exp),authTime:Vr(1e3*e.auth_time),issuedAtTime:Vr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Yc(t,e,n){var r=e&&e[Qc];if(!r)throw new C("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=yt(e),this.g=n,this.c=new no(null,r),this.b=[];var i=this;W(e[Kc]||[],(function(t){(t=Zr(t))&&i.b.push(t)})),Yr(this,"auth",this.a),Yr(this,"session",this.c),Yr(this,"hints",this.b)}Mc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Mc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Vc(this,!0,null,t.a),Ce()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,s=e.S(),a=!!e.c.match(/Redirect$/);n(r,i,s,o).then((function(e){Vc(t,a,e,null)})).s((function(e){Vc(t,a,null,e)}))}(this,t,e):Ie(new C("invalid-auth-event")):(Vc(this,!1,null,null),Ce())}else Ie(new C("invalid-auth-event"))},Mc.prototype.qa=function(){var t=this;return new me((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new C("timeout");t.a&&t.a.cancel(),t.a=En(xc.get()).then((function(){t.b||(t.g=!0,Vc(t,!0,null,e))}))}(t))}))},zc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ma(t.c,null,t.a,t.b),Ce()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.S(),t.i).then((function(t){e.ma(r,t,null,n)})).s((function(t){e.ma(r,null,t,n)}))}(t,e):Ie(new C("invalid-auth-event"))}else Ie(new C("invalid-auth-event"))},Wc.prototype.confirm=function(t){return t=Do(this.verificationId,t),this.a(t)};var Kc="mfaInfo",Qc="mfaPendingCredential";function Jc(t,e,n,r){C.call(this,"multi-factor-auth-required",r,e),this.b=new Yc(t,e,n),Yr(this,"resolver",this.b)}function Xc(t,e,n){if(t&&v(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Jc(e,t.serverResponse,n,t.message)}catch(t){}return null}function Zc(){}function $c(t){Yr(this,"factorId",t.fa),this.a=t}function tl(t){if($c.call(this,t),this.a.fa!=Bo.PROVIDER_ID)throw new C("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function el(t,e){for(var n in Ke.call(this,t),e)this[n]=e[n]}function nl(t,e){this.a=t,this.b=[],this.c=S(this.xc,this),an(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&W(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ei]=t.uid),t.displayName&&(r[$r]=t.displayName),t.enrollmentTime&&(r[ti]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ni]=t.phoneNumber);try{e=new ri(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),rl(this,n)}function rl(t,e){t.b=e,Yr(t,"enrolledFactors",e)}function il(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ol(t){this.c=t,this.b=this.a=null}function sl(t){return t.b&&1e3*t.b.c||0}function al(t,e){var n=e.refreshToken;t.b=Ui(e[Ys]||""),t.a=n}function ul(t,e){this.a=t||null,this.b=e||null,Kr(this,{lastSignInTime:Vr(e||null),creationTime:Vr(t||null)})}function cl(t,e,n,r,i,o){Kr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ll(t,e,r){this.G=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null;var i=n.SDK_VERSION?Er(n.SDK_VERSION):null;this.a=new Gs(this.l,N(T),i),t.emulatorConfig&&$s(this.a,t.emulatorConfig),this.b=new ol(this.a),bl(this,e[Ys]),al(this.b,e),Yr(this,"refreshToken",this.b.a),_l(this,r||{}),mn.call(this),this.P=!1,this.o&&Tr()&&(this.i=jc(this.o,this.l,this.m)),this.R=[],this.f=null,this.u=function(t){return new il((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=sl(t.b)-E()-3e5;return 0<e?e:0}))}(this),this.$=S(this.gb,this);var o=this;this.pa=null,this.Ba=function(t){o.wa(t.h)},this.ba=null,this.za=function(t){$s(o.a,t.c)},this.W=null,this.X=[],this.Aa=function(t){pl(o,t.f)},this.aa=null,this.N=new nl(this,r),Yr(this,"multiFactor",this.N)}function hl(t,e){t.ba&&ln(t.ba,"languageCodeChanged",t.Ba),(t.ba=e)&&an(e,"languageCodeChanged",t.Ba)}function fl(t,e){t.W&&ln(t.W,"emulatorConfigChanged",t.za),(t.W=e)&&an(e,"emulatorConfigChanged",t.za)}function pl(t,e){t.X=e,ea(t.a,n.SDK_VERSION?Er(n.SDK_VERSION,t.X):null)}function dl(t,e){t.aa&&ln(t.aa,"frameworkChanged",t.Aa),(t.aa=e)&&an(e,"frameworkChanged",t.Aa)}function yl(t){try{return n.app(t.m).auth()}catch(e){throw new C("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function vl(t){t.A||t.u.b||(t.u.start(),ln(t,"tokenChanged",t.$),an(t,"tokenChanged",t.$))}function gl(t){ln(t,"tokenChanged",t.$),t.u.stop()}function bl(t,e){t.ya=e,Yr(t,"_lat",e)}function ml(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return xe(e).then((function(){return t}))}function wl(t){t.i&&!t.P&&(t.P=!0,Cc(t.i,t))}function _l(t,e){Kr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new ul(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Sl(){}function Ol(t){return Ce().then((function(){if(t.A)throw new C("app-deleted")}))}function El(t){return H(t.providerData,(function(t){return t.providerId}))}function Al(t,e){e&&(Cl(t,e.providerId),t.providerData.push(e))}function Cl(t,e){J(t.providerData,(function(t){return t.providerId==e}))}function Il(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Yr(t,e,n)}function Tl(t,e){t!=e&&(Kr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Yr(t,"metadata",function(t){return new ul(t.a,t.b)}(e.metadata)):Yr(t,"metadata",new ul),W(e.providerData,(function(e){Al(t,e)})),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),Yr(t,"refreshToken",t.b.a),rl(t.N,e.N.b))}function xl(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return Xa(t.a,Ta,{idToken:e}).then(S(t.Jc,t))}(t,e).then((function(){return n||Il(t,"isAnonymous",!1),e}))}))}function kl(t,e){e[Ys]&&t.ya!=e[Ys]&&(al(t.b,e),t.dispatchEvent(new el("tokenChanged")),bl(t,e[Ys]),Il(t,"refreshToken",t.b.a))}function Pl(t,e){return xl(t).then((function(){if(K(El(t),e))return ml(t).then((function(){throw new C("provider-already-linked")}))}))}function Nl(t,e,n){return Qr({user:t,credential:Ro(e),additionalUserInfo:e=Hi(e),operationType:n})}function Bl(t,e){return kl(t,e),t.reload().then((function(){return t}))}function Dl(t,e,r,i,o){if(!Tr())return Ie(new C("operation-not-supported-in-this-environment"));if(t.f&&!o)return Ie(t.f);var s=Gi(r.providerId),a=Rr(t.uid+":::"),u=null;(!Pr()||vr())&&t.o&&r.isOAuthProvider&&(u=fu(t.o,t.l,t.m,e,r,null,a,n.SDK_VERSION||null,null,null,t.tenantId));var c=hr(u,s&&s.ua,s&&s.ta);return i=i().then((function(){if(jl(t),!o)return t.I().then((function(){}))})).then((function(){return kc(t.i,c,e,r,a,!!u,t.tenantId)})).then((function(){return new me((function(n,r){t.ma(e,null,new C("cancelled-popup-request"),t.h||null),t.g=n,t.O=r,t.h=a,t.c=Bc(t.i,t,e,c,a)}))})).then((function(t){return c&&lr(c),t?Qr(t):null})).s((function(t){throw c&&lr(c),t})),Ml(t,i,o)}function Rl(t,e,n,r,i){if(!Tr())return Ie(new C("operation-not-supported-in-this-environment"));if(t.f&&!i)return Ie(t.f);var o=null,s=Rr(t.uid+":::");return r=r().then((function(){if(jl(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=s,ml(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Ul,t.w(),e.a)),e})).then((function(){return Nc(t.i,e,n,s,t.tenantId)})).s((function(e){if(o=e,t.ha)return Vl(t.ha);throw o})).then((function(){if(o)throw o})),Ml(t,r,i)}function jl(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new C("internal-error");throw new C("auth-domain-config-required")}}function Ml(t,e,n){var r=function(t,e,n){return t.f&&!n?(e.cancel(),Ie(t.f)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.f||t.dispatchEvent(new el("userInvalidated")),t.f=e),e}))}(t,e,n);return t.G.push(r),r.na((function(){Q(t.G,r)})),r.s((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Xc(e.w(),yl(t),S(t.ic,t))),n||e}))}function Ll(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ys]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=new ll(e,n,t);return t.providerData&&W(t.providerData,(function(t){t&&Al(r,Qr(t))})),t.redirectEventId&&(r.ga=t.redirectEventId),r}function Fl(t){this.a=t,this.b=Ku()}Yc.prototype.Qc=function(t){var e=this;return t.rb(this.a.a,this.c).then((function(t){var n=yt(e.f);return delete n[Kc],delete n[Qc],gt(n,t),e.g(n)}))},A(Jc,C),Zc.prototype.rb=function(t,e,n){return e.type==ro?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),gt(n,{phoneVerificationInfo:No(t.a)}),Xa(e,Ca,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return gt(n={mfaPendingCredential:n},{phoneVerificationInfo:No(t.a)}),Xa(e,Ia,n)}))}(this,t,e)},A($c,Zc),A(tl,$c),A(el,Ke),(e=nl.prototype).xc=function(t){rl(this,function(t){var e=[];return W(t.mfaInfo||[],(function(t){(t=Zr(t))&&e.push(t)})),e}(t.gd))},e.Qb=function(){return this.a.I().then((function(t){return new no(t,null)}))},e.ec=function(t,e){var n=this,r=this.a.a;return this.Qb().then((function(n){return t.rb(r,n,e)})).then((function(t){return kl(n.a,t),n.a.reload()}))},e.ad=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return Xa(r,Ja,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=G(e.b,(function(t){return t.uid!=n}));return rl(e,r),kl(e.a,t),e.a.reload().s((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},e.w=function(){return{multiFactor:{enrolledFactors:H(this.b,(function(t){return t.w()}))}}},il.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=En(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return t=c.document,e=null,Fr()||!t?Ce():new me((function(n){e=function(){Fr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}));var t,e})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},il.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ol.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:sl(this)}},ol.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Ie(new C("user-token-expired")):t||!this.b||E()>sl(this)-3e4?this.a?function(t,e){return function(t,e){return new me((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?na(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r($a(t)):t.access_token&&t.refresh_token?n(t):r(new C("internal-error")):r(new C("network-request-failed"))}),"POST",Qn(e).toString(),t.g,t.v.get()):r(new C("internal-error"))}))}(t.c,e).then((function(e){return t.b=Ui(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Ce(null):Ce({accessToken:this.b.toString(),refreshToken:this.a})},ul.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},A(ll,mn),ll.prototype.wa=function(t){this.pa=t,Zs(this.a,t)},ll.prototype.ka=function(){return this.pa},ll.prototype.Ga=function(){return Z(this.X)},ll.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},Yr(ll.prototype,"providerId","firebase"),(e=ll.prototype).reload=function(){var t=this;return Ml(this,Ol(this).then((function(){return xl(t).then((function(){return ml(t)})).then(Sl)})))},e.nc=function(t){return this.I(t).then((function(t){return new Hc(t)}))},e.I=function(t){var e=this;return Ml(this,Ol(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new C("internal-error");return t.accessToken!=e.ya&&(bl(e,t.accessToken),e.dispatchEvent(new el("tokenChanged"))),Il(e,"refreshToken",t.refreshToken),t.accessToken})))},e.Jc=function(t){if(!(t=t.users)||!t.length)throw new C("internal-error");_l(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?H(t,(function(t){return new cl(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Al(this,e[n]);Il(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new el("userReloaded",{gd:t}))},e.Kc=function(t){return Gr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(t)},e.sb=function(t){var e=this,n=null;return Ml(this,t.c(this.a,this.uid).then((function(t){return kl(e,t),n=Nl(e,t,"reauthenticate"),e.f=null,e.reload()})).then((function(){return n})),!0)},e.Bc=function(t){return Gr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(t)},e.pb=function(t){var e=this,n=null;return Ml(this,Pl(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Nl(e,t,"link"),Bl(e,t)})).then((function(){return n})))},e.Cc=function(t,e){var n=this;return Ml(this,Pl(this,"phone").then((function(){return Gc(yl(n),t,e,S(n.pb,n))})))},e.Lc=function(t,e){var n=this;return Ml(this,Ce().then((function(){return Gc(yl(n),t,e,S(n.sb,n))})),!0)},e.Ab=function(t){var e=this;return Ml(this,this.I().then((function(n){return e.a.Ab(n,t)})).then((function(t){return kl(e,t),e.reload()})))},e.dd=function(t){var e=this;return Ml(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return kl(e,t),e.reload()})))},e.Bb=function(t){var e=this;return Ml(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return kl(e,t),e.reload()})))},e.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ol(this);var e=this;return Ml(this,this.I().then((function(n){return e.a.Cb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return kl(e,t),Il(e,"displayName",t.displayName||null),Il(e,"photoURL",t.photoUrl||null),W(e.providerData,(function(t){"password"===t.providerId&&(Yr(t,"displayName",e.displayName),Yr(t,"photoURL",e.photoURL))})),ml(e)})).then(Sl))},e.bd=function(t){var e=this;return Ml(this,xl(this).then((function(n){return K(El(e),t)?function(t,e,n){return Xa(t,Oa,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return W(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),W(El(e),(function(t){n[t]||Cl(e,t)})),n[Bo.PROVIDER_ID]||Yr(e,"phoneNumber",null),ml(e)})):ml(e).then((function(){throw new C("no-such-provider")}))})))},e.delete=function(){var t=this;return Ml(this,this.I().then((function(e){return Xa(t.a,Sa,{idToken:e})})).then((function(){t.dispatchEvent(new el("userDeleted"))}))).then((function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");hl(t,null),fl(t,null),dl(t,null),t.G=[],t.A=!0,gl(t),Yr(t,"refreshToken",null),t.i&&Ic(t.i,t)}))},e.Eb=function(t,e){return!!("linkViaPopup"==t&&(this.h||null)==e&&this.g||"reauthViaPopup"==t&&(this.h||null)==e&&this.g||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},e.ma=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.h||null)||(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.h||null)?S(this.Jb,this):"reauthViaPopup"==t&&e==(this.h||null)?S(this.Kb,this):"linkViaRedirect"==t&&(this.ga||null)==e?S(this.Jb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?S(this.Kb,this):null},e.Dc=function(t){var e=this;return Dl(this,"linkViaPopup",t,(function(){return Pl(e,t.providerId).then((function(){return ml(e)}))}),!1)},e.Mc=function(t){return Dl(this,"reauthViaPopup",t,(function(){return Ce()}),!0)},e.Ec=function(t){var e=this;return Rl(this,"linkViaRedirect",t,(function(){return Pl(e,t.providerId)}),!1)},e.Nc=function(t){return Rl(this,"reauthViaRedirect",t,(function(){return Ce()}),!0)},e.Jb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Ml(this,this.I().then((function(n){return ya(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Nl(i,t,"link"),Bl(i,t)})).then((function(){return o})))},e.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Ml(this,Ce().then((function(){return so(va(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Nl(i,t,"reauthenticate"),kl(i,t),i.f=null,i.reload()})).then((function(){return o})),!0)},e.tb=function(t){var e=this,n=null;return Ml(this,this.I().then((function(e){return n=e,void 0===t||dt(t)?{}:Mi(new Ii(t))})).then((function(t){return e.a.tb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},e.Db=function(t,e){var n=this,r=null;return Ml(this,this.I().then((function(t){return r=t,void 0===e||dt(e)?{}:Mi(new Ii(e))})).then((function(e){return n.a.Db(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},e.ic=function(t){var e=null,n=this;return Ml(this,t=so(Ce(t),n.uid).then((function(t){return e=Nl(n,t,"reauthenticate"),kl(n,t),n.f=null,n.reload()})).then((function(){return e})),!0)},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&gt(t,this.metadata.w()),W(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),gt(t,this.N.w()),t};var Ul={name:"redirectUser",D:"session"};function Vl(t){return Xu(t.b,Ul,t.a)}function zl(t){this.a=t,this.b=Ku(),this.c=null,this.f=function(t){var e=Gl("local"),n=Gl("session"),r=Gl("none");return function(t,e,n){var r=Ju(e,n),i=Qu(t,e.D);return t.get(e,n).then((function(o){var s=null;try{s=Dr(c.localStorage.getItem(r))}catch(t){}if(s&&!o)return c.localStorage.removeItem(r),t.set(e,s,n);s&&o&&"localStorage"!=i.type&&c.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Wl,t.a).then((function(t){return t?Gl(t):e}))}))}))})).then((function(e){return t.c=e,ql(t,e.D)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Gl("local"),this.a,S(this.g,this))}function ql(t,e){var n,r=[];for(n in Hu)Hu[n]!==e&&r.push(Xu(t.b,Gl(Hu[n]),t.a));return r.push(Xu(t.b,Wl,t.a)),function(t){return new me((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},a=0;a<t.length;a++)Te(t[a],O(o,a),s);else e(i)}))}(r)}zl.prototype.g=function(){var t=this,e=Gl("local");Ql(this,(function(){return Ce().then((function(){return t.c&&"local"!=t.c.D?t.b.get(e,t.a):null})).then((function(n){if(n)return ql(t,"local").then((function(){t.c=e}))}))}))};var Wl={name:"persistence",D:"session"};function Gl(t){return{name:"authUser",D:t}}function Hl(t,e){return Ql(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function Yl(t){return Ql(t,(function(){return Xu(t.b,t.c,t.a)}))}function Kl(t,e,n){return Ql(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Ll(t||{})}))}))}function Ql(t,e){return t.f=t.f.then(e,e),t.f}function Jl(t){if(this.m=!1,Yr(this,"settings",new qc),Yr(this,"app",t),!ih(this).options||!ih(this).options.apiKey)throw new C("invalid-api-key");t=n.SDK_VERSION?Er(n.SDK_VERSION):null,this.a=new Gs(ih(this).options&&ih(this).options.apiKey,N(T),t),this.R=[],this.u=[],this.P=[],this.ac=n.INTERNAL.createSubscribe(S(this.yc,this)),this.X=void 0,this.bc=n.INTERNAL.createSubscribe(S(this.zc,this)),nh(this,null),this.l=new zl(ih(this).options.apiKey+":"+ih(this).name),this.G=new Fl(ih(this).options.apiKey+":"+ih(this).name),this.$=uh(this,function(t){var e=ih(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Ul,t.a).then((function(t){return t&&e&&(t.authDomain=e),Ll(t||{})}))}(t.G,ih(t).options.authDomain).then((function(e){return(t.o=e)&&(e.ha=t.G),Vl(t.G)}));return uh(t,e)}(t).then((function(){return Kl(t.l,e,t.f)})).then((function(e){return e?(e.ha=t.G,t.o&&(t.o.ga||null)==(e.ga||null)?e:e.reload().then((function(){return Hl(t.l,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:Yl(t.l)}))):null})).then((function(e){nh(t,e||null)}));return uh(t,n)}(this)),this.i=uh(this,function(t){return t.$.then((function(){return eh(t)})).s((function(){})).then((function(){if(!t.m)return t.pa()})).s((function(){})).then((function(){if(!t.m){t.ba=!0;var e=t.l;e.b.addListener(Gl("local"),e.a,t.pa)}}))}(this)),this.ba=!1,this.pa=S(this.Yc,this),this.Ba=S(this.da,this),this.ya=S(this.kc,this),this.za=S(this.vc,this),this.Aa=S(this.wc,this),this.b=null,function(t){var e=ih(t).options.authDomain,n=ih(t).options.apiKey;e&&Tr()&&(t.gb=t.$.then((function(){if(!t.m){if(t.b=jc(e,n,ih(t).name,t.f),Cc(t.b,t),oh(t)&&wl(oh(t)),t.o){wl(t.o);var r=t.o;r.wa(t.ka()),hl(r,t),pl(r=t.o,t.N),dl(r,t),$s((r=t.o).a,t.f),fl(r,t),t.o=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=S(this.delete,this),this.INTERNAL.logFramework=S(this.Fc,this),this.A=0,mn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ka()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.xb(t)},enumerable:!1}),t.W=null}(this),this.N=[],this.f=null}function Xl(t){Ke.call(this,"languageCodeChanged"),this.h=t}function Zl(t){Ke.call(this,"emulatorConfigChanged"),this.c=t}function $l(t){Ke.call(this,"frameworkChanged"),this.f=t}function th(t){return t.gb||Ie(new C("auth-domain-config-required"))}function eh(t){if(!Tr())return Ie(new C("operation-not-supported-in-this-environment"));var e=th(t).then((function(){return t.b.qa()})).then((function(t){return t?Qr(t):null}));return uh(t,e)}function nh(t,e){oh(t)&&(function(t,e){J(t.R,(function(t){return t==e}))}(oh(t),t.Ba),ln(oh(t),"tokenChanged",t.ya),ln(oh(t),"userDeleted",t.za),ln(oh(t),"userInvalidated",t.Aa),gl(oh(t))),e&&(e.R.push(t.Ba),an(e,"tokenChanged",t.ya),an(e,"userDeleted",t.za),an(e,"userInvalidated",t.Aa),0<t.A&&vl(e)),Yr(t,"currentUser",e),e&&(e.wa(t.ka()),hl(e,t),pl(e,t.N),dl(e,t),$s(e.a,t.f),fl(e,t))}function rh(t,e){var n=null,r=null;return uh(t,e.then((function(e){return n=Ro(e),r=Hi(e),function(t,e){var n={};return n.apiKey=ih(t).options.apiKey,n.authDomain=ih(t).options.authDomain,n.appName=ih(t).name,t.f&&(n.emulatorConfig=t.f),t.$.then((function(){return function(t,e,n,r){var i=new ll(t,e);return n&&(i.ha=n),r&&pl(i,r),i.reload().then((function(){return i}))}(n,e,t.G,t.Ga())})).then((function(e){return oh(t)&&e.uid==oh(t).uid?(Tl(oh(t),e),t.da(e)):(nh(t,e),wl(e),t.da(e))})).then((function(){ah(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Xc(e.w(),t,S(t.jc,t))),n||e})).then((function(){return Qr({user:oh(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function ih(t){return t.app}function oh(t){return t.currentUser}function sh(t){return oh(t)&&oh(t)._lat||null}function ah(t){if(t.ba){for(var e=0;e<t.u.length;e++)t.u[e]&&t.u[e](sh(t));if(t.X!==t.getUid()&&t.P.length)for(t.X=t.getUid(),e=0;e<t.P.length;e++)t.P[e]&&t.P[e](sh(t))}}function uh(t,e){return t.R.push(e),e.na((function(){Q(t.R,e)})),e}function ch(){}function lh(){this.a={},this.b=1e12}zl.prototype.wb=function(t){var e=null,n=this;return function(t){var e=new C("invalid-persistence-type"),n=new C("unsupported-persistence-type");t:{for(r in Hu)if(Hu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(br()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Au()&&"none"!==t)throw n;break;default:if(!Ir()&&"none"!==t)throw n}}(t),Ql(this,(function(){return t!=n.c.D?n.b.get(n.c,n.a).then((function(r){return e=r,ql(n,t)})).then((function(){if(n.c=Gl(t),e)return n.b.set(n.c,e,n.a)})):Ce()}))},A(Jl,mn),A(Xl,Ke),A(Zl,Ke),A($l,Ke),(e=Jl.prototype).wb=function(t){return uh(this,t=this.l.wb(t))},e.wa=function(t){this.aa===t||this.m||(this.aa=t,Zs(this.a,this.aa),this.dispatchEvent(new Xl(this.ka())))},e.ka=function(){return this.aa},e.ed=function(){var t=c.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.fd=function(t){if(!this.f){if(!/^https?:\/\//.test(t))throw new C("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Ur("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),c.document&&dr().then((function(){var t=c.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),c.document.body.appendChild(t)})),this.f={url:t},this.settings.hb=!0,$s(this.a,this.f),this.dispatchEvent(new Zl(this.f))}},e.Fc=function(t){this.N.push(t),ea(this.a,n.SDK_VERSION?Er(n.SDK_VERSION,this.N):null),this.dispatchEvent(new $l(this.N))},e.Ga=function(){return Z(this.N)},e.xb=function(t){this.W===t||this.m||(this.W=t,this.a.b=this.W)},e.S=function(){return this.W},e.toJSON=function(){return{apiKey:ih(this).options.apiKey,authDomain:ih(this).options.authDomain,appName:ih(this).name,currentUser:oh(this)&&oh(this).w()}},e.Eb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==e&&!!this.g;default:return!1}},e.ma=function(t,e,n,r){"signInViaPopup"==t&&this.h==r&&(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.h==e&&this.g?S(this.hc,this):null},e.hc=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return rh(i,da(i.a,o))}))},e.Wc=function(t){if(!Tr())return Ie(new C("operation-not-supported-in-this-environment"));var e=this,r=Gi(t.providerId),i=Rr(),o=null;(!Pr()||vr())&&ih(this).options.authDomain&&t.isOAuthProvider&&(o=fu(ih(this).options.authDomain,ih(this).options.apiKey,ih(this).name,"signInViaPopup",t,null,i,n.SDK_VERSION||null,null,null,this.S(),this.f));var s=hr(o,r&&r.ua,r&&r.ta);return uh(this,r=th(this).then((function(n){return kc(n,s,"signInViaPopup",t,i,!!o,e.S())})).then((function(){return new me((function(t,n){e.ma("signInViaPopup",null,new C("cancelled-popup-request"),e.h),e.g=t,e.O=n,e.h=i,e.c=Bc(e.b,e,"signInViaPopup",s,i)}))})).then((function(t){return s&&lr(s),t?Qr(t):null})).s((function(t){throw s&&lr(s),t})))},e.Xc=function(t){if(!Tr())return Ie(new C("operation-not-supported-in-this-environment"));var e=this;return uh(this,th(this).then((function(){return Ql(t=e.l,(function(){return t.b.set(Wl,t.c.D,t.a)}));var t})).then((function(){return Nc(e.b,"signInViaRedirect",t,void 0,e.S())})))},e.qa=function(){var t=this;return eh(this).then((function(e){return t.b&&Fc(t.b.b),e})).s((function(e){throw t.b&&Fc(t.b.b),e}))},e.cd=function(t){if(!t)return Ie(new C("null-user"));if(this.W!=t.tenantId)return Ie(new C("tenant-id-mismatch"));var e=this,n={};n.apiKey=ih(this).options.apiKey,n.authDomain=ih(this).options.authDomain,n.appName=ih(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Ys]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new ll(e||{apiKey:t.l,authDomain:t.o,appName:t.m},o),n&&(e.ha=n),r&&pl(e,r),Tl(e,t),e}(t,n,e.G,e.Ga());return uh(this,this.i.then((function(){if(ih(e).options.apiKey!=t.l)return r.reload()})).then((function(){return oh(e)&&t.uid==oh(e).uid?(Tl(oh(e),t),e.da(t)):(nh(e,r),wl(r),e.da(r))})).then((function(){ah(e)})))},e.zb=function(){var t=this;return uh(this,this.i.then((function(){return t.b&&Fc(t.b.b),oh(t)?(nh(t,null),Yl(t.l).then((function(){ah(t)}))):Ce()})))},e.Yc=function(){var t=this;return Kl(this.l,ih(this).options.authDomain).then((function(e){if(!t.m){var n;if(n=oh(t)&&e){n=oh(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Tl(oh(t),e),oh(t).I();(oh(t)||e)&&(nh(t,e),e&&(wl(e),e.ha=t.G),t.b&&Cc(t.b,t),ah(t))}}))},e.da=function(t){return Hl(this.l,t)},e.kc=function(){ah(this),this.da(oh(this))},e.vc=function(){this.zb()},e.wc=function(){this.zb()},e.jc=function(t){var e=this;return this.i.then((function(){return rh(e,Ce(t))}))},e.yc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(oh(e))}))},e.zc=function(t){var e=this;!function(t,e){t.P.push(e),uh(t,t.i.then((function(){!t.m&&K(t.P,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(sh(t)))})))}(this,(function(){t.next(oh(e))}))},e.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(oh(r)):"function"==typeof t.next&&t.next(oh(r))})),this.ac(t,e,n)},e.Gc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(oh(r)):"function"==typeof t.next&&t.next(oh(r))})),this.bc(t,e,n)},e.mc=function(t){var e=this;return uh(this,this.i.then((function(){return oh(e)?oh(e).I(t).then((function(t){return{accessToken:t}})):null})))},e.Sc=function(t){var e=this;return this.i.then((function(){return rh(e,Xa(e.a,Ga,{token:t}))})).then((function(t){var n=t.user;return Il(n,"isAnonymous",!1),e.da(n),t}))},e.Tc=function(t,e){var n=this;return this.i.then((function(){return rh(n,Xa(n.a,Ha,{email:t,password:e}))}))},e.dc=function(t,e){var n=this;return this.i.then((function(){return rh(n,Xa(n.a,wa,{email:t,password:e}))}))},e.Za=function(t){var e=this;return this.i.then((function(){return rh(e,t.ja(e.a))}))},e.Rc=function(t){return Gr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(t)},e.yb=function(){var t=this;return this.i.then((function(){var e=oh(t);if(e&&e.isAnonymous){var n=Qr({providerId:null,isNewUser:!1});return Qr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return rh(t,t.a.yb()).then((function(e){var n=e.user;return Il(n,"isAnonymous",!0),t.da(n),e}))}))},e.getUid=function(){return oh(this)&&oh(this).uid||null},e.cc=function(t){this.addAuthTokenListener(t),this.A++,0<this.A&&oh(this)&&vl(oh(this))},e.Oc=function(t){var e=this;W(this.u,(function(n){n==t&&e.A--})),0>this.A&&(this.A=0),0==this.A&&oh(this)&&gl(oh(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.u.push(t),uh(this,this.i.then((function(){e.m||K(e.u,t)&&t(sh(e))})))},e.removeAuthTokenListener=function(t){J(this.u,(function(e){return e==t}))},e.delete=function(){this.m=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.l&&(t=this.l).b.removeListener(Gl("local"),t.a,this.pa),this.b&&(Ic(this.b,this),Fc(this.b.b)),Promise.resolve()},e.gc=function(t){return uh(this,function(t,e){return Xa(t,_a,{identifier:e,continueUri:xr()?ar():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},e.Ac=function(t){return!!xo(t)},e.vb=function(t,e){var n=this;return uh(this,Ce().then((function(){var t=new Ii(e);if(!t.c)throw new C("argument-error",ki+" must be true when sending sign in link to email");return Mi(t)})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},e.hd=function(t){return this.Qa(t).then((function(t){return t.data.email}))},e.mb=function(t,e){return uh(this,this.a.mb(t,e).then((function(){})))},e.Qa=function(t){return uh(this,this.a.Qa(t).then((function(t){return new ii(t)})))},e.ib=function(t){return uh(this,this.a.ib(t).then((function(){})))},e.ub=function(t,e){var n=this;return uh(this,Ce().then((function(){return void 0===e||dt(e)?{}:Mi(new Ii(e))})).then((function(e){return n.a.ub(t,e)})).then((function(){})))},e.Vc=function(t,e){return uh(this,Gc(this,t,e,S(this.Za,this)))},e.Uc=function(t,e){var n=this;return uh(this,Ce().then((function(){var r=e||ar(),i=To(t,r);if(!(r=xo(r)))throw new C("argument-error","Invalid email link!");if(r.tenantId!==n.S())throw new C("tenant-id-mismatch");return n.Za(i)})))},ch.prototype.render=function(){},ch.prototype.reset=function(){},ch.prototype.getResponse=function(){},ch.prototype.execute=function(){};var hh=null;function fh(t,e){return(e=ph(e))&&t.a[e]||null}function ph(t){return(t=void 0===t?1e12:t)?t.toString():null}function dh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ae(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():an(this.f,"click",this.i)}function yh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function vh(){}function gh(){}lh.prototype.render=function(t,e){return this.a[this.b.toString()]=new dh(t,e),this.b++},lh.prototype.reset=function(t){var e=fh(this,t);t=ph(t),e&&t&&(e.delete(),delete this.a[t])},lh.prototype.getResponse=function(t){return(t=fh(this,t))?t.getResponse():null},lh.prototype.execute=function(t){(t=fh(this,t))&&t.execute()},dh.prototype.getResponse=function(){return yh(this),this.b},dh.prototype.execute=function(){yh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},dh.prototype.delete=function(){yh(this),this.g=!0,clearTimeout(this.a),this.a=null,ln(this.f,"click",this.i)},Yr(vh,"FACTOR_ID","phone"),gh.prototype.g=function(){return hh||(hh=new lh),Ce(hh)},gh.prototype.c=function(){};var bh=null;function mh(){this.b=c.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var wh=new mt(St,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),_h=new Lr(3e4,6e4);mh.prototype.g=function(t){var e=this;return new me((function(n,r){var i=setTimeout((function(){r(new C("network-request-failed"))}),_h.get());!c.grecaptcha||t!==e.f&&!e.b?(c[e.a]=function(){if(c.grecaptcha){e.f=t;var o=c.grecaptcha.render;c.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(c.grecaptcha)}else clearTimeout(i),r(new C("internal-error"));delete c[e.a]},Ce(Ls(Ct(wh,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(i),r(new C("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(c.grecaptcha))}))},mh.prototype.c=function(){this.b--};var Sh=null;function Oh(t,e,n,r,i,o,s){if(Yr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=e,this.g=null,s?(bh||(bh=new gh),s=bh):(Sh||(Sh=new mh),s=Sh),this.v=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Ch])throw new C("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Ih],!c.document)throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ae(e)||!this.i&&ae(e).hasChildNodes())throw new C("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Gs(t,o||null,i||null),this.u=r||function(){return null};var a=this;this.l=[];var u=this.a[Eh];this.a[Eh]=function(t){if(Th(a,t),"function"==typeof u)u(t);else if("string"==typeof u){var e=Cr(u,c);"function"==typeof e&&e(t)}};var l=this.a[Ah];this.a[Ah]=function(){if(Th(a,null),"function"==typeof l)l();else if("string"==typeof l){var t=Cr(l,c);"function"==typeof t&&t()}}}var Eh="callback",Ah="expired-callback",Ch="sitekey",Ih="size";function Th(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function xh(t,e){return t.h.push(e),e.na((function(){Q(t.h,e)})),e}function kh(t){if(t.A)throw new C("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ph(t,e,r){var i=!1;try{this.b=r||n.app()}catch(t){throw new C("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new C("invalid-api-key");r=this.b.options.apiKey;var o=this,s=null;try{s=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}s=n.SDK_VERSION?Er(n.SDK_VERSION,s):null,Oh.call(this,r,t,e,(function(){try{var t=o.b.auth().ka()}catch(e){t=null}return t}),s,N(T),i)}function Nh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new C("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].K(n[i])&&!o){if(e=e[i],0>i||i>=Bh.length)throw new C("internal-error","Argument validator received an unsupported number of arguments.");n=Bh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.J+".";break t}r=null}}if(r)throw new C("argument-error",t+" failed: "+r)}(e=Oh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=xh(this,Ce().then((function(){if(xr()&&!gr())return dr();throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.v.g(t.u())})).then((function(e){return t.g=e,Xa(t.o,Da,{})})).then((function(e){t.a[Ch]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},e.render=function(){kh(this);var t=this;return xh(this,this.Ia().then((function(){if(null===t.c){var e=t.m;if(!t.i){var n=ae(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!se&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',qt(s.name),'"'),s.type){o.push(' type="',qt(s.type),'"');var a={};gt(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=fe(i,o),s&&("string"==typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):ue(o,s)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!d(o)||v(o)&&0<o.nodeType?r(o):W(pe(o)?Z(o):o,r)}}(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},e.verify=function(){kh(this);var t=this;return xh(this,this.render().then((function(e){return new me((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){J(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},e.reset=function(){kh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){kh(this),this.A=!0,this.v.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ae(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},A(Ph,Oh);var Bh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Dh(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Rh(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function jh(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:v}}function Mh(t,e){return{name:t||"",J:"a function",optional:!!e,K:function(t){return"function"==typeof t}}}function Lh(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Fh(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ja||!n)}}}function Uh(t,e){return v(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Vh(t){return v(t)&&"string"==typeof t.uid}function zh(t,e,n,r){return{name:n||"",J:t.J+" or "+e.J,optional:!!r,K:function(n){return t.K(n)||e.K(n)}}}function qh(t,e){for(var n in e){var r=e[n].name;t[r]=Hh(r,t[n],e[n].j)}}function Wh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:O((function(t){return this[t]}),n),set:O((function(t,e,n,r){Nh(t,[n],[r],!0),this[e]=r}),r,n,e[n].jb),enumerable:!0})}}function Gh(t,e,n,r){t[e]=Hh(e,n,r)}function Hh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Nh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}qh(Jl.prototype,{ib:{name:"applyActionCode",j:[Dh("code")]},Qa:{name:"checkActionCode",j:[Dh("code")]},mb:{name:"confirmPasswordReset",j:[Dh("code"),Dh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Dh("email"),Dh("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Dh("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Dh("emailLink")]},Gc:{name:"onAuthStateChanged",j:[zh(jh(),Mh(),"nextOrObserver"),Mh("opt_error",!0),Mh("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[zh(jh(),Mh(),"nextOrObserver"),Mh("opt_error",!0),Mh("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Dh("email"),zh(jh("opt_actionCodeSettings",!0),Lh(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Dh("email"),jh("actionCodeSettings")]},wb:{name:"setPersistence",j:[Dh("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Fh()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Fh()]},Sc:{name:"signInWithCustomToken",j:[Dh("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Dh("email"),Dh("password")]},Uc:{name:"signInWithEmailLink",j:[Dh("email"),Dh("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Dh("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Wc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Xc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},cd:{name:"updateCurrentUser",j:[zh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof ll)}},Lh(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Dh(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Dh("url")]},hd:{name:"verifyPasswordResetCode",j:[Dh("code")]}}),Wh(Jl.prototype,{lc:{name:"languageCode",jb:zh(Dh(),Lh(),"languageCode")},ti:{name:"tenantId",jb:zh(Dh(),Lh(),"tenantId")}}),Jl.Persistence=Hu,Jl.Persistence.LOCAL="local",Jl.Persistence.SESSION="session",Jl.Persistence.NONE="none",qh(ll.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Rh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Rh("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Fh()]},pb:{name:"linkWithCredential",j:[Fh()]},Cc:{name:"linkWithPhoneNumber",j:[Dh("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Dc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ec:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Fh()]},sb:{name:"reauthenticateWithCredential",j:[Fh()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Dh("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Mc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[zh(jh("opt_actionCodeSettings",!0),Lh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Dh(null,!0)]},bd:{name:"unlink",j:[Dh("provider")]},Ab:{name:"updateEmail",j:[Dh("email")]},Bb:{name:"updatePassword",j:[Dh("password")]},dd:{name:"updatePhoneNumber",j:[Fh("phone")]},Cb:{name:"updateProfile",j:[jh("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Dh("email"),zh(jh("opt_actionCodeSettings",!0),Lh(null,!0),"opt_actionCodeSettings",!0)]}}),qh(lh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),qh(ch.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),qh(me.prototype,{na:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Wh(qc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Rh("appVerificationDisabledForTesting")}}),qh(Wc.prototype,{confirm:{name:"confirm",j:[Dh("verificationCode")]}}),Gh(oo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[fo,Co,Po,co],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[zh(Dh(),jh(),"json")]),Gh(Io,"credential",(function(t,e){return new Ao(t,e)}),[Dh("email"),Dh("password")]),qh(Ao.prototype,{w:{name:"toJSON",j:[Dh(null,!0)]}}),qh(go.prototype,{Ca:{name:"addScope",j:[Dh("scope")]},Ka:{name:"setCustomParameters",j:[jh("customOAuthParameters")]}}),Gh(go,"credential",bo,[zh(Dh(),jh(),"token")]),Gh(Io,"credentialWithLink",To,[Dh("email"),Dh("emailLink")]),qh(mo.prototype,{Ca:{name:"addScope",j:[Dh("scope")]},Ka:{name:"setCustomParameters",j:[jh("customOAuthParameters")]}}),Gh(mo,"credential",wo,[zh(Dh(),jh(),"token")]),qh(_o.prototype,{Ca:{name:"addScope",j:[Dh("scope")]},Ka:{name:"setCustomParameters",j:[jh("customOAuthParameters")]}}),Gh(_o,"credential",So,[zh(Dh(),zh(jh(),Lh()),"idToken"),zh(Dh(),Lh(),"accessToken",!0)]),qh(Oo.prototype,{Ka:{name:"setCustomParameters",j:[jh("customOAuthParameters")]}}),Gh(Oo,"credential",Eo,[zh(Dh(),jh(),"token"),Dh("secret",!0)]),qh(vo.prototype,{Ca:{name:"addScope",j:[Dh("scope")]},credential:{name:"credential",j:[zh(Dh(),zh(jh(),Lh()),"optionsOrIdToken"),zh(Dh(),Lh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[jh("customOAuthParameters")]}}),qh(lo.prototype,{w:{name:"toJSON",j:[Dh(null,!0)]}}),qh(ao.prototype,{w:{name:"toJSON",j:[Dh(null,!0)]}}),Gh(Bo,"credential",Do,[Dh("verificationId"),Dh("verificationCode")]),qh(Bo.prototype,{eb:{name:"verifyPhoneNumber",j:[zh(Dh(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Uh(t.session,ro)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Uh(t.session,io)&&Vh(t.multiFactorHint):t.session&&t.multiFactorUid?Uh(t.session,io)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),qh(ko.prototype,{w:{name:"toJSON",j:[Dh(null,!0)]}}),qh(C.prototype,{toJSON:{name:"toJSON",j:[Dh(null,!0)]}}),qh(qo.prototype,{toJSON:{name:"toJSON",j:[Dh(null,!0)]}}),qh(zo.prototype,{toJSON:{name:"toJSON",j:[Dh(null,!0)]}}),qh(Jc.prototype,{toJSON:{name:"toJSON",j:[Dh(null,!0)]}}),qh(Yc.prototype,{Qc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}}]}}),qh(nl.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}},Dh("displayName",!0)]},ad:{name:"unenroll",j:[zh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Vh},Dh(),"multiFactorInfoIdentifier")]}}),qh(Ph.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Gh(bi,"parseLink",Ci,[Dh("link")]),Gh(vh,"assertion",(function(t){return new tl(t)}),[Fh("phone")]),function(){if(void 0===n||!n.INTERNAL||!n.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:si,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:oi,VERIFY_AND_CHANGE_EMAIL:ai,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Jl,AuthCredential:oo,Error:C};Gh(t,"EmailAuthProvider",Io,[]),Gh(t,"FacebookAuthProvider",go,[]),Gh(t,"GithubAuthProvider",mo,[]),Gh(t,"GoogleAuthProvider",_o,[]),Gh(t,"TwitterAuthProvider",Oo,[]),Gh(t,"OAuthProvider",vo,[Dh("providerId")]),Gh(t,"SAMLAuthProvider",yo,[Dh("providerId")]),Gh(t,"PhoneAuthProvider",Bo,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof Jl)}}]),Gh(t,"RecaptchaVerifier",Ph,[zh(Dh(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),jh("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof n.app.App)}}]),Gh(t,"ActionCodeURL",bi,[]),Gh(t,"PhoneMultiFactorGenerator",vh,[]),n.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Jl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),n.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:S((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:S(t.mc,t),addAuthTokenListener:S(t.cc,t),removeAuthTokenListener:S(t.Oc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),n.registerVersion("@firebase/auth","0.15.0"),n.INTERNAL.extendNamespace({User:ll})}()}).apply(void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@firebase/app":"dP58"}],zKjx:[function(t,e,n){"use strict";t("@firebase/auth")},{"@firebase/auth":"RJVP"}],Xc75:[function(t,e,n){"use strict";var r=t("@firebase/app"),i=t("tslib"),o=t("@firebase/component"),s=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(r),a={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},u=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return i.__extends(e,t),e}(Error);function c(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var c=s.status;if("string"==typeof c){if(!a[c])return new u("internal","internal");r=a[c],i=c}var l=s.message;"string"==typeof l&&(i=l),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new u(r,i,o)}var l=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e;return i.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function h(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var f=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return h(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?h(t,(function(t){return e.decode(t)})):t},t}(),p=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new f,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new l(e,n),this.cancelAllRequests=new Promise((function(t){o.deleteService=function(){return t()}}));try{var s=new URL(r);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o;return i.__generator(this,(function(i){switch(i.label){case 0:n["Content-Type"]="application/json",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=i.sent(),[3,4];case 3:return i.sent(),[2,{status:0,json:null}];case 4:o=null,i.label=5;case 5:return i.trys.push([5,7,,8]),[4,r.json()];case 6:return o=i.sent(),[3,8];case 7:return i.sent(),[3,8];case 8:return[2,{status:r.status,json:o}]}}))}))},t.prototype.call=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,a,l,h,f,p,y,v,g;return i.__generator(this,(function(i){switch(i.label){case 0:return r=this._url(t),e=this.serializer.encode(e),o={data:e},s={},[4,this.contextProvider.getContext()];case 1:return(a=i.sent()).authToken&&(s.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(s["Firebase-Instance-ID-Token"]=a.instanceIdToken),l=n.timeout||7e4,h=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new u("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(l),f=h.timer,p=h.promise,[4,Promise.race([d(f,this.postJSON(r,o,s)),p,d(f,this.cancelAllRequests)])];case 2:if(!(y=i.sent()))throw new u("cancelled","Firebase Functions instance was deleted.");if(v=c(y.status,y.json,this.serializer))throw v;if(!y.json)throw new u("internal","Response is not valid JSON object.");if(void 0===(g=y.json.data)&&(g=y.json.result),void 0===g)throw new u("internal","Response is missing data field.");return[2,{data:this.serializer.decode(g)}]}}))}))},t}();function d(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}(function(t,e){var n={Functions:p};t.INTERNAL.registerComponent(new o.Component("functions",(function(t,n){var r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("messaging");return new p(r,i,o,n,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))})(s.default,fetch.bind(self)),s.default.registerVersion("@firebase/functions","0.5.1")},{"@firebase/app":"dP58",tslib:"f2sD","@firebase/component":"nzQs"}],a7Bh:[function(t,e,n){"use strict";t("@firebase/functions")},{"@firebase/functions":"Xc75"}],ueHA:[function(t,e,n){var r=arguments[3];Object.defineProperty(n,"__esModule",{value:!0}),n.createWebChannelTransport=n.XhrIo=n.WebChannel=n.EventType=n.ErrorCode=n.default=void 0;var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var a,u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{},c=c||{},l=u||self;function h(){}function f(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function y(t){return Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++g)}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:m).apply(null,arguments)}function _(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var S=Date.now;function O(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function E(){this.j=this.j,this.i=this.i}var A=0;E.prototype.j=!1,E.prototype.ja=function(){this.j||(this.j=!0,this.G(),0==A)||y(this)},E.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var C=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function T(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}function x(t){return Array.prototype.concat.apply([],arguments)}function k(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function P(t){return/^[\s\xa0]*$/.test(t)}var N,B=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function D(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var j=l.navigator;if(j){var M=j.userAgent;if(M){N=M;break t}}N=""}function L(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function F(t){var e={};for(var n in t)e[n]=t[n];return e}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<U.length;o++)n=U[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function z(t){return z[" "](t),t}function q(t,e){var n=nt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}z[" "]=h;var W,G=D(N,"Opera"),H=D(N,"Trident")||D(N,"MSIE"),Y=D(N,"Edge"),K=Y||H,Q=D(N,"Gecko")&&!(D(N.toLowerCase(),"webkit")&&!D(N,"Edge"))&&!(D(N,"Trident")||D(N,"MSIE"))&&!D(N,"Edge"),J=D(N.toLowerCase(),"webkit")&&!D(N,"Edge");function X(){var t=l.document;return t?t.documentMode:void 0}t:{var Z="",$=function(){var t=N;return Q?/rv:([^\);]+)(\)|;)/.exec(t):Y?/Edge\/([\d\.]+)/.exec(t):H?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):J?/WebKit\/(\S+)/.exec(t):G?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if($&&(Z=$?$[1]:""),H){var tt=X();if(null!=tt&&tt>parseFloat(Z)){W=String(tt);break t}}W=Z}var et,nt={};function rt(t){return q(t,(function(){for(var e=0,n=B(String(W)).split("."),r=B(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=R(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||R(0==s[2].length,0==a[2].length)||R(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(l.document&&H){var it=X();et=it||parseInt(W,10)||void 0}else et=void 0;var ot=et,st=!H||9<=Number(ot),at=H&&!rt("9"),ut=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{l.addEventListener("test",h,e),l.removeEventListener("test",h,e)}catch(t){}return t}();function ct(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function lt(t,e){if(ct.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Q){t:{try{z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ht[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ct.prototype.b=function(){this.defaultPrevented=!0},O(lt,ct);var ht={2:"touch",3:"pen",4:"mouse"};lt.prototype.b=function(){lt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,at)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ft="closure_listenable_"+(1e6*Math.random()|0),pt=0;function dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++pt,this.Y=this.Z=!1}function yt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function vt(t){this.src=t,this.a={},this.b=0}function gt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=C(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(yt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function bt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}vt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=bt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var mt="closure_lm_"+(1e6*Math.random()|0),wt={};function _t(t,e,n,r,i){if(r&&r.once)return Et(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)_t(t,e[o],n,r,i);return null}return n=Nt(n),t&&t[ft]?t.va(e,n,d(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=d(i)?!!i.capture:!!i;if(s&&!st)return null;var a=kt(t);if(a||(t[mt]=a=new vt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=Ot(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ut||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(It(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(){var t=xt,e=st?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function Et(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Et(t,e[o],n,r,i);return null}return n=Nt(n),t&&t[ft]?t.wa(e,n,d(r)?!!r.capture:!!r,i):St(t,e,n,!0,r,i)}function At(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)At(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=Nt(n),t&&t[ft]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=bt(o=t.a[e],n,r,i))&&(yt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=kt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=bt(e,n,r,i)),(n=-1<t?e[t]:null)&&Ct(n))}function Ct(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ft])gt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(It(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=kt(e))?(gt(n,t),0==n.b&&(n.src=null,e[mt]=null)):yt(t)}}}function It(t){return t in wt?wt[t]:wt[t]="on"+t}function Tt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function xt(t,e){if(t.Y)return!0;if(!st){if(!e)t:{e=["window","event"];for(var n=l,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Tt(t,e=new lt(e,this))}return Tt(t,new lt(e,this))}function kt(t){return(t=t[mt])instanceof vt?t:null}var Pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nt(t){return"function"==f(t)?t:(t[Pt]||(t[Pt]=function(e){return t.handleEvent(e)}),t[Pt])}function Bt(){E.call(this),this.c=new vt(this),this.J=this,this.C=null}function Dt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&gt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}O(Bt,E),Bt.prototype[ft]=!0,(a=Bt.prototype).addEventListener=function(t,e,n,r){_t(this,t,e,n,r)},a.removeEventListener=function(t,e,n,r){At(this,t,e,n,r)},a.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new ct(t,n);else if(t instanceof ct)t.target=t.target||n;else{var i=t;V(t=new ct(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Dt(s,r,!0,t)&&i}if(i=Dt(s=t.a=n,r,!0,t)&&i,i=Dt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Dt(s=t.a=e[o],r,!1,t)&&i;return i},a.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)yt(n[r]);delete e.a[t],e.b--}}this.C=null},a.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},a.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Rt=l.JSON.stringify;function jt(){this.b=this.a=null}var Mt,Lt=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ut}),(function(t){t.reset()}),100);function Ft(){var t=Gt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ut(){this.next=this.b=this.a=null}function Vt(t){l.setTimeout((function(){throw t}),0)}function zt(t,e){Mt||qt(),Wt||(Mt(),Wt=!0),Gt.add(t,e)}function qt(){var t=l.Promise.resolve(void 0);Mt=function(){t.then(Ht)}}jt.prototype.add=function(t,e){var n=Lt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ut.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ut.prototype.reset=function(){this.next=this.b=this.a=null};var Wt=!1,Gt=new jt;function Ht(){for(var t;t=Ft();){try{t.a.call(t.b)}catch(t){Vt(t)}var e=Lt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Wt=!1}function Yt(t,e){Bt.call(this),this.b=t||1,this.a=e||l,this.f=w(this.Ya,this),this.g=S()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Qt(t,e,n){if("function"==f(t))n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:l.setTimeout(t,e||0)}function Jt(t){t.a=Qt((function(){t.a=null,t.c&&(t.c=!1,Jt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}O(Yt,Bt),(a=Yt.prototype).aa=!1,a.M=null,a.Ya=function(){if(this.aa){var t=S()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Kt(this),this.start()))}},a.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=S())},a.G=function(){Yt.S.G.call(this),Kt(this),delete this.a};var Xt=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return o(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Jt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(l.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(E);function Zt(t){E.call(this),this.b=t,this.a={}}O(Zt,E);var $t=[];function te(t,e,n,r){Array.isArray(n)||(n&&($t[0]=n.toString()),n=$t);for(var i=0;i<n.length;i++){var o=_t(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ee(t){L(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Ct(t)}),t),t.a={}}function ne(){this.a=!0}function re(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}function ie(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}function oe(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+ae(t,n)+(r?" "+r:"")}))}function se(t,e){t.info((function(){return"TIMEOUT: "+e}))}function ae(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Rt(n)}catch(t){return e}}Zt.prototype.G=function(){Zt.S.G.call(this),ee(this)},Zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ne.prototype.info=function(){};var ue=null;function ce(){return ue=ue||new Bt}function le(t){ct.call(this,"serverreachability",t)}function he(t){var e=ce();e.dispatchEvent(new le(e,t))}function fe(t){ct.call(this,"statevent",t)}function pe(t){var e=ce();e.dispatchEvent(new fe(e,t))}function de(t){ct.call(this,"timingevent",t)}function ye(t,e){if("function"!=f(t))throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){t()}),e)}O(le,ct),O(fe,ct),O(de,ct);var ve={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ge={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function be(){}function me(t){var e;return(e=t.a)||(e=t.a={}),e}function we(){}be.prototype.a=null;var _e,Se={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){ct.call(this,"d")}function Ee(){ct.call(this,"c")}function Ae(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new Zt(this),this.P=Ie,t=K?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}O(Oe,ct),O(Ee,ct),O(Ae,be),_e=new Ae;var Ie=45e3,Te={},xe={};function ke(t,e,n){t.H=1,t.i=tn(Ke(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=S(),De(t),t.l=Ke(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=yr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Xt(w(t.Ca,t,t.a),t.O)),te(t.J,t.a,"readystatechange",t.Wa),e=t.B?F(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),he(1),re(t.c,t.m,t.l,t.f,t.T,t.j)}function Ne(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Be(t,n);if(i==xe){4==e&&(t.h=4,pe(14),r=!1),oe(t.c,t.f,null,"[Incomplete Response]");break}if(i==Te){t.h=4,pe(15),oe(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}oe(t.c,t.f,i,null),Fe(t,i)}4==e&&0==n.length&&(t.h=1,pe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ar(e),e.F=!0)):(oe(t.c,t.f,n,"[Invalid Chunked Response]"),Le(t),Me(t))}function Be(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?xe:(n=Number(e.substring(n,r)),isNaN(n)?Te:(r+=1)+n>e.length?xe:(e=e.substr(r,n),t.D=r+n,e))}function De(t){t.U=S()+t.P,Re(t,t.P)}function Re(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ye(w(t.Ua,t),e)}function je(t){t.o&&(l.clearTimeout(t.o),t.o=null)}function Me(t){0==t.g.v||t.A||lr(t.g,t)}function Le(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Kt(t.R),ee(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||En(n.b,t)))if(n.I=t.N,!t.C&&En(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;cr(n),Xn(n)}sr(n),pe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ye(w(n.Ra,n),6e3));if(1>=On(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else fr(n,11)}else if((t.C||n.a==t)&&cr(n),!P(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(D(l,"spdy")||D(l,"quic")||D(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(An(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,$e(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=S()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=dr(u,u.C?u.ga:null,u.fa),p.C){Cn(u.b,p);var d=p,y=u.D;y&&d.setTimeout(y),d.o&&(je(d),De(d)),u.a=p}else or(u);0<n.g.length&&tr(n)}else"stop"!=i[0]&&"close"!=i[0]||fr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?fr(n,7):Jn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);he(4)}catch(t){}}function Ue(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Ve(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)I(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(p(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=Ue(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)We(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(a=Ce.prototype).setTimeout=function(t){this.P=t},a.Wa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},a.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!K&&!this.a.$())){this.A||4!=e||7==n||he(8==n||0>=r?3:2),je(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,ie(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,pe(12),Le(this),Me(this);break t}oe(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,u)}this.I?(Ne(this,e,o),K&&this.b&&3==e&&(te(this.J,this.R,"tick",this.Va),this.R.start())):(oe(this.c,this.f,o,null),Fe(this,o)),4==e&&Le(this),this.b&&!this.A&&(4==e?lr(this.g,this):(this.b=!1,De(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,pe(12)):(this.h=0,pe(13)),Le(this),Me(this)}}}catch(t){}},a.Va=function(){if(this.a){var t=Gn(this.a),e=this.a.$();this.D<e.length&&(je(this),Ne(this,t,e),this.b&&4!=t&&De(this))}},a.cancel=function(){this.A=!0,Le(this)},a.Ua=function(){this.o=null;var t=S();0<=t-this.U?(se(this.c,this.l),2!=this.H&&(he(3),pe(17)),Le(this),this.h=2,Me(this)):Re(this,this.U-t)},(a=ze.prototype).K=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},a.L=function(){return qe(this),this.a.concat()},a.get=function(t,e){return We(this.b,t)?this.b[t]:e},a.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},a.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ye(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye){this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),Xe(this,t.h),this.g=t.g,e=t.b;var n=new fn;n.c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i}else t&&(n=String(t).match(Ge))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),Xe(this,n[4]),this.g=rn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ke(t){return new Ye(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function Xe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){e instanceof fn?(t.b=e,bn(t.b,t.a)):(n||(e=on(e,ln)),t.b=new fn(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function tn(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^S()).toString(36)),t}function en(t){return t instanceof Ye?Ke(t):new Ye(t,void 0)}function nn(t,e,n,r){var i=new Ye(null,void 0);return t&&Qe(i,t),e&&Je(i,e),n&&Xe(i,n),r&&(i.g=r),i}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,an,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(on(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,hn)),t.join("")};var an=/[#\/\?@]/g,un=/[#\?:]/g,cn=/[#\?]/g,ln=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(t){t.a||(t.a=new ze,t.b=0,t.c&&He(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function dn(t,e){pn(t),e=gn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function yn(t,e){return pn(t),e=gn(t,e),We(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),k(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){e&&!t.f&&(pn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))}),t)),t.f=e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||_n,t=l.PerformanceNavigationTiming?0<(t=l.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(l.ia&&l.ia.ya&&l.ia.ya()&&l.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(a=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},a.forEach=function(t,e){pn(this),this.a.forEach((function(n,r){I(n,(function(n){t.call(e,n,r,this)}),this)}),this)},a.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},a.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=x(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=x(e,t[n])}return e},a.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},a.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},a.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var _n=10;function Sn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function On(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Cn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=s(t.a.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return k(t.c)}function Tn(){}function xn(){this.a=new Tn}function kn(t,e,n){var r=n||"";try{Ve(t,(function(t,n){var i=t;d(t)&&(i=Rt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Pn(t,e){var n=new ne;if(l.Image){var r=new Image;r.onload=_(Nn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=_(Nn,n,r,"TestLoadImage: error",!1,e),r.onabort=_(Nn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=_(Nn,n,r,"TestLoadImage: timeout",!1,e),l.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}function Nn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=s(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return l.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return l.JSON.parse(t,void 0)};var Bn=l.JSON.parse;function Dn(t){Bt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}O(Dn,Bt);var Rn="",jn=/^https?$/i,Mn=["POST","PUT"];function Ln(t){return H&&rt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Fn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),qn(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function zn(t){if(t.b&&void 0!==c&&(!t.s[1]||4!=Gn(t)||2!=t.X()))if(t.l&&4==Gn(t))Qt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ge)[1]||null;if(!o&&l.self&&l.self.location){var s=l.self.location.protocol;o=s.substr(0,s.length-1)}i=!jn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Gn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",Vn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Wn(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Wn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(l.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Hn(t){var e="";return L(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Yn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Hn(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Qn(t){this.pa=0,this.g=[],this.c=new ne,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Jn(t){if(Zn(t),3==t.v){var e=t.R++,n=Ke(t.B);$e(n,"SID",t.J),$e(n,"RID",e),$e(n,"TYPE","terminate"),rr(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=tn(Ke(n)),n=!1,l.navigator&&l.navigator.sendBeacon&&(n=l.navigator.sendBeacon(e.i.toString(),"")),!n&&l.Image&&((new Image).src=e.i,n=!0),n||(e.a=yr(e.g,null),e.a.ba(e.i)),e.u=S(),De(e)}pr(t)}function Xn(t){t.a&&(ar(t),t.a.cancel(),t.a=null)}function Zn(t){Xn(t),t.j&&(l.clearTimeout(t.j),t.j=null),cr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&l.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new mn(t.La++,e)),3==t.v&&tr(t)}function tr(t){Sn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function er(t,e){return!(On(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=ye(w(t.Ba,t,e),hr(t,t.u)),t.u++,0)))}function nr(t,e){var n;n=e?e.f:t.R++;var r=Ke(t.B);$e(r,"SID",t.J),$e(r,"RID",n),$e(r,"AID",t.P),rr(t,r),t.i&&t.l&&Yn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ir(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),ke(n,r,e)}function rr(t,e){t.f&&Ve({},(function(t,n){$e(e,n,t)}))}function ir(t,e,n){n=Math.min(t.g.length,n);var r=t.f?w(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{kn(l,s,"req"+c+"_")}catch(t){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function or(t){t.a||t.j||(t.U=1,zt(t.Aa,t),t.o=0)}function sr(t){return!(t.a||t.j||3<=t.o||(t.U++,t.j=ye(w(t.Aa,t),hr(t,t.o)),t.o++,0))}function ar(t){null!=t.s&&(l.clearTimeout(t.s),t.s=null)}function ur(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);$e(e,"RID","rpc"),$e(e,"SID",t.J),$e(e,"CI",t.H?"0":"1"),$e(e,"AID",t.P),rr(t,e),$e(e,"TYPE","xmlhttp"),t.i&&t.l&&Yn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Ke(e)),n.j=null,n.I=!0,Pe(n,t)}function cr(t){null!=t.m&&(l.clearTimeout(t.m),t.m=null)}function lr(t,e){var n=null;if(t.a==e){cr(t),ar(t),t.a=null;var r=2}else{if(!En(t.b,e))return;n=e.s,Cn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=S()-e.u;var i=t.u;(r=ce()).dispatchEvent(new de(r,n,e,i)),tr(t)}else or(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&er(t,e)||2==r&&sr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:fr(t,5);break;case 4:fr(t,10);break;case 3:fr(t,6);break;default:fr(t,2)}}function hr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function fr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=w(t.Xa,t);n||(n=new Ye("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Qe(n,"https"),tn(n)),Pn(n.toString(),r)}else pe(2);t.v=0,t.f&&t.f.ra(e),pr(t),Zn(t)}function pr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,k(t.g),t.g.length=0),t.f.qa())}function dr(t,e,n){var r=en(n);if(""!=r.c)e&&Je(r,e+"."+r.c),Xe(r,r.h);else{var i=l.location;r=nn(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&L(t.W,(function(t,e){$e(r,e,t)})),e=t.A,n=t.na,e&&n&&$e(r,e,n),$e(r,"VER",t.ha),rr(t,r),r}function yr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function vr(){}function gr(){if(H&&!(10<=Number(ot)))throw Error("Environmental error: no available transport.")}function br(t,e){Bt.call(this),this.a=new Qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!P(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!P(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new _r(this)}function mr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wr(){Ee.call(this),this.status=1}function _r(t){this.a=t}(a=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?me(this.H):me(_e),this.a.onreadystatechange=w(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i=new ze(this.headers);r&&Ve(r,(function(t,e){i.set(e,t)})),r=T(i.L()),n=l.FormData&&t instanceof l.FormData,!(0<=C(Mn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Wn(this),0<this.o&&((this.D=Ln(this.a))?(this.a.timeout=this.o,this.a.ontimeout=w(this.xa,this)):this.m=Qt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},a.xa=function(){void 0!==c&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},a.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},a.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Dn.S.G.call(this)},a.za=function(){this.j||(this.A||this.l||this.g?zn(this):this.Ta())},a.Ta=function(){zn(this)},a.X=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},a.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},a.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bn(e)}},a.ua=function(){return this.h},a.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(a=Qn.prototype).ha=8,a.v=1,a.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?V(r=F(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ir(this,n,e),$e(i=Ke(this.B),"RID",t),$e(i,"CVER",22),this.A&&$e(i,"X-HTTP-Session-Id",this.A),rr(this,i),this.i&&r&&Yn(i,this.i,r),An(this.b,n),this.Ga&&$e(i,"TYPE","init"),this.da?($e(i,"$req",e),$e(i,"SID","null"),n.V=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?nr(this,t):0==this.g.length||Sn(this.b)||nr(this))},a.Aa=function(){if(this.j=null,ur(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ye(w(this.Sa,this),t)}},a.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),ur(this))},a.Ra=function(){null!=this.m&&(this.m=null,Xn(this),sr(this),pe(19))},a.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),pe(2)):(this.c.info("Failed to ping google.com"),pe(1))},(a=vr.prototype).ta=function(){},a.sa=function(){},a.ra=function(){},a.qa=function(){},a.Ha=function(){},gr.prototype.a=function(t,e){return new br(t,e)},O(br,Bt),(a=br.prototype).addEventListener=function(t,e,n,r){br.S.addEventListener.call(this,t,e,n,r)},a.removeEventListener=function(t,e,n,r){br.S.removeEventListener.call(this,t,e,n,r)},a.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;pe(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=dr(t,null,t.fa),tr(t)},a.close=function(){Jn(this.a)},a.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,$n(this.a,e)}else this.g?((e={}).__data__=Rt(t),$n(this.a,e)):$n(this.a,t)},a.G=function(){this.a.f=null,delete this.f,Jn(this.a),delete this.a,br.S.G.call(this)},O(mr,Oe),O(wr,Ee),O(_r,vr),_r.prototype.ta=function(){this.a.dispatchEvent("a")},_r.prototype.sa=function(t){this.a.dispatchEvent(new mr(t))},_r.prototype.ra=function(t){this.a.dispatchEvent(new wr(t))},_r.prototype.qa=function(){this.a.dispatchEvent("b")},gr.prototype.createWebChannel=gr.prototype.a,br.prototype.send=br.prototype.Pa,br.prototype.open=br.prototype.Oa,br.prototype.close=br.prototype.close,ve.NO_ERROR=0,ve.TIMEOUT=8,ve.HTTP_ERROR=6,ge.COMPLETE="complete",we.EventType=Se,Se.OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var Sr=function(){return new gr};n.createWebChannelTransport=Sr;var Or=ve;n.ErrorCode=Or;var Er=ge;n.EventType=Er;var Ar=we;n.WebChannel=Ar;var Cr=Dn;n.XhrIo=Cr;var Ir={createWebChannelTransport:Sr,ErrorCode:Or,EventType:Er,WebChannel:Ar,XhrIo:Cr},Tr=Ir;n.default=Tr},{}],eA7g:[function(t,e,n){t("process");var r=t("process");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0});var o=t("tslib"),s=t("@firebase/app"),a=t("@firebase/logger"),u=t("@firebase/util"),c=t("@firebase/webchannel-wrapper"),l=t("@firebase/component"),h=function(t){return t&&"object"==i(t)&&"default"in t?t:{default:t}}(s),f={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},p=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return o.__extends(e,t),e}(Error),d=new a.Logger("@firebase/firestore");function y(){return d.logLevel}function v(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(d.logLevel<=a.LogLevel.DEBUG){var r=e.map(m);d.debug.apply(d,o.__spreadArrays(["Firestore (7.24.0): "+t],r))}}function g(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(d.logLevel<=a.LogLevel.ERROR){var r=e.map(m);d.error.apply(d,o.__spreadArrays(["Firestore (7.24.0): "+t],r))}}function b(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(d.logLevel<=a.LogLevel.WARN){var r=e.map(m);d.warn.apply(d,o.__spreadArrays(["Firestore (7.24.0): "+t],r))}}function m(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function w(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.24.0) INTERNAL ASSERTION FAILED: "+t;throw g(e),new Error(e)}function _(t,e){t||w()}function S(t,e){return t}function O(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function E(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function A(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var C=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&w(),void 0===n?n=t.length-e:n>t.length-e&&w(),this.segments=t,this.offset=e,this.t=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.i(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.o(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},t.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},t.prototype.l=function(){return this.segments[this.offset]},t.prototype._=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.m=function(){return 0===this.length},t.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},t.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.prototype.R=function(){return this.A().join("/")},e.prototype.toString=function(){return this.R()},e.g=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new p(f.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.P=function(){return new e([])},e}(C),T=/^[_a-zA-Z][_a-zA-Z0-9]*$/,x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.V=function(t){return T.test(t)},e.prototype.R=function(){return this.A().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.V(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.R()},e.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},e.v=function(){return new e(["__name__"])},e.S=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new p(f.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new p(f.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new p(f.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new p(f.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.P=function(){return new e([])},e}(C),k=function(){function t(t){this.path=t}return t.D=function(e){return new t(I.g(e))},t.C=function(e){return new t(I.g(e).u(5))},t.prototype.N=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===I.i(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.i=function(t,e){return I.i(t.path,e.path)},t.F=function(t){return t.length%2==0},t.$=function(e){return new t(new I(e.slice()))},t}();function P(t,e){if(0!==e.length)throw new p(f.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Q(e.length,"argument")+".")}function N(t,e,n){if(e.length!==n)throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires "+Q(n,"argument")+", but was called with "+Q(e.length,"argument")+".")}function B(t,e,n){if(e.length<n)throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Q(n,"argument")+", but was called with "+Q(e.length,"argument")+".")}function D(t,e,n,r){if(e.length<n||e.length>r)throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Q(e.length,"argument")+".")}function R(t,e,n,r){V(t,e,K(n)+" argument",r)}function j(t,e,n,r){void 0!==r&&R(t,e,n,r)}function M(t,e,n,r){V(t,e,n+" option",r)}function L(t,e,n,r){void 0!==r&&M(t,e,n,r)}function F(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s];if(u===r)return;o.push(q(u))}var c=q(r);throw new p(f.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function U(t,e,n,r){if(!e.some((function(t){return t===r})))throw new p(f.INVALID_ARGUMENT,"Invalid value "+q(r)+" provided to function "+t+"() for its "+K(n)+" argument. Acceptable values: "+e.join(", "));return r}function V(t,e,n,r){if(!("object"===e?z(r):"non-empty string"===e?"string"==typeof r&&""!==r:i(r)===e)){var o=q(r);throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+o)}}function z(t){return"object"==i(t)&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function q(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==i(t)){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":w()}function W(t,e,n){if(void 0===n)throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+K(e)+" argument, but it was undefined.")}function G(t,e,n){E(e,(function(e,r){if(n.indexOf(e)<0)throw new p(f.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function H(t,e,n,r){var i=q(r);return new p(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+K(n)+" argument to be a "+e+", but it was: "+i)}function Y(t,e,n){if(n<=0)throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+K(e)+" argument to be a positive number, but it was: "+n+".")}function K(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Q(t,e){return t+" "+e+(1===t?"":"s")}function J(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var X=function(){function t(){}return t.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=J(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Z(t,e){return t<e?-1:t>e?1:0}function $(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function tt(t){return t+"\0"}var et=function(){function t(t){this.M=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.M,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},t.prototype.O=function(){return 2*this.M.length},t.prototype.L=function(t){return Z(this.M,t.M)},t.prototype.isEqual=function(t){return this.M===t.M},t}();et.B=new et("");var nt=function(){function t(t){this.q=t}return t.fromBase64String=function(e){try{return new t(et.fromBase64String(e))}catch(e){throw new p(f.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(et.fromUint8Array(e))},t.prototype.toBase64=function(){return this.q.toBase64()},t.prototype.toUint8Array=function(){return this.q.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.q.isEqual(t.q)},t}();function rt(){if("undefined"==typeof Uint8Array)throw new p(f.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function it(){if("undefined"==typeof atob)throw new p(f.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.fromBase64String=function(t){N("Blob.fromBase64String",arguments,1),R("Blob.fromBase64String","string",1,t),it();try{return new e(et.fromBase64String(t))}catch(t){throw new p(f.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){if(N("Blob.fromUint8Array",arguments,1),rt(),!(t instanceof Uint8Array))throw H("Blob.fromUint8Array","Uint8Array",1,t);return new e(et.fromUint8Array(t))},e.prototype.toBase64=function(){return N("Blob.toBase64",arguments,0),it(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return N("Blob.toUint8Array",arguments,0),rt(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(nt),st=function(t,e,n,r,i,o){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.W=o},at=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.L=function(t){return Z(this.projectId,t.projectId)||Z(this.database,t.database)},t}(),ut=function(){function t(t,e){this.K=t,this.G=e,this.H={}}return t.prototype.get=function(t){var e=this.K(t),n=this.H[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.G(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.K(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.K(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){E(this.H,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.m=function(){return A(this.H)},t}(),ct=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new p(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new p(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new p(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new p(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.Y=function(t){return this.seconds===t.seconds?Z(this.nanoseconds,t.nanoseconds):Z(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),lt=function(){function t(t){this.timestamp=t}return t.J=function(e){return new t(e)},t.min=function(){return new t(new ct(0,0))},t.prototype.L=function(t){return this.timestamp.Y(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.Z=function(){return this.timestamp},t}();function ht(t){return null==t}function ft(t){return 0===t&&1/t==-1/0}function pt(t){return"number"==typeof t&&Number.isInteger(t)&&!ft(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var dt=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function yt(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new dt(t,e,n,r,i,o,s)}function vt(t){var e=S(t);if(null===e.tt){var n=e.path.R();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.R()+t.op.toString()+ae(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.R()+e.dir;var e})).join(","),ht(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=fr(e.startAt)),e.endAt&&(n+="|ub:",n+=fr(e.endAt)),e.tt=n}return e.tt}function gt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!gr(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!re(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dr(t.startAt,e.startAt)&&dr(t.endAt,e.endAt)}function bt(t){return k.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mt,wt,_t=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=lt.min()),void 0===o&&(o=lt.min()),void 0===s&&(s=et.B),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.st=function(e){return new t(this.target,this.targetId,this.et,e,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.it=function(e,n){return new t(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.rt=function(e){return new t(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,e,this.resumeToken)},t}(),St=function(t){this.count=t};function Ot(t){switch(t){case f.OK:return w();case f.CANCELLED:case f.UNKNOWN:case f.DEADLINE_EXCEEDED:case f.RESOURCE_EXHAUSTED:case f.INTERNAL:case f.UNAVAILABLE:case f.UNAUTHENTICATED:return!1;case f.INVALID_ARGUMENT:case f.NOT_FOUND:case f.ALREADY_EXISTS:case f.PERMISSION_DENIED:case f.FAILED_PRECONDITION:case f.ABORTED:case f.OUT_OF_RANGE:case f.UNIMPLEMENTED:case f.DATA_LOSS:return!0;default:return w()}}function Et(t){if(void 0===t)return g("GRPC error has no .code"),f.UNKNOWN;switch(t){case mt.OK:return f.OK;case mt.CANCELLED:return f.CANCELLED;case mt.UNKNOWN:return f.UNKNOWN;case mt.DEADLINE_EXCEEDED:return f.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return f.RESOURCE_EXHAUSTED;case mt.INTERNAL:return f.INTERNAL;case mt.UNAVAILABLE:return f.UNAVAILABLE;case mt.UNAUTHENTICATED:return f.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return f.INVALID_ARGUMENT;case mt.NOT_FOUND:return f.NOT_FOUND;case mt.ALREADY_EXISTS:return f.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return f.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return f.FAILED_PRECONDITION;case mt.ABORTED:return f.ABORTED;case mt.OUT_OF_RANGE:return f.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return f.UNIMPLEMENTED;case mt.DATA_LOSS:return f.DATA_LOSS;default:return w()}}(wt=mt||(mt={}))[wt.OK=0]="OK",wt[wt.CANCELLED=1]="CANCELLED",wt[wt.UNKNOWN=2]="UNKNOWN",wt[wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wt[wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wt[wt.NOT_FOUND=5]="NOT_FOUND",wt[wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",wt[wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",wt[wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",wt[wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wt[wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wt[wt.ABORTED=10]="ABORTED",wt[wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",wt[wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",wt[wt.INTERNAL=13]="INTERNAL",wt[wt.UNAVAILABLE=14]="UNAVAILABLE",wt[wt.DATA_LOSS=15]="DATA_LOSS";var At=function(){function t(t,e){this.i=t,this.root=e||It.EMPTY}return t.prototype.ot=function(e,n){return new t(this.i,this.root.ot(e,n,this.i).copy(null,null,It.at,null,null))},t.prototype.remove=function(e){return new t(this.i,this.root.remove(e,this.i).copy(null,null,It.at,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.m=function(){return this.root.m()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(){return this.root.ut()},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.forEach=function(t){this.ht((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ht((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.lt=function(t){return this.root.lt(t)},t.prototype._t=function(){return new Ct(this.root,null,this.i,!1)},t.prototype.ft=function(t){return new Ct(this.root,t,this.i,!1)},t.prototype.dt=function(){return new Ct(this.root,null,this.i,!0)},t.prototype.wt=function(t){return new Ct(this.root,t,this.i,!0)},t}(),Ct=function(){function t(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}return t.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},t.prototype.At=function(){return this.Et.length>0},t.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},t}(),It=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.m=function(){return!1},t.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},t.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},t.prototype.min=function(){return this.left.m()?this:this.left.min()},t.prototype.ct=function(){return this.min().key},t.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},t.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).gt()},t.prototype.Pt=function(){if(this.left.m())return t.EMPTY;var e=this;return e.left.yt()||e.left.left.yt()||(e=e.Vt()),(e=e.copy(null,null,null,e.left.Pt(),null)).gt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.m()||i.left.yt()||i.left.left.yt()||(i=i.Vt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.yt()&&(i=i.bt()),i.right.m()||i.right.yt()||i.right.left.yt()||(i=i.vt()),0===n(e,i.key)){if(i.right.m())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.gt()},t.prototype.yt=function(){return this.color},t.prototype.gt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},t.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},t.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},t.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw w();if(this.right.yt())throw w();var t=this.left.Nt();if(t!==this.right.Nt())throw w();return t+(this.yt()?0:1)},t}();It.EMPTY=null,It.RED=!0,It.at=!1,It.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw w()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ot=function(t,e,n){return new It(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.m=function(){return!0},t.prototype.ht=function(t){return!1},t.prototype.lt=function(t){return!1},t.prototype.ct=function(){return null},t.prototype.ut=function(){return null},t.prototype.yt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Nt=function(){return 0},t}());var Tt=function(){function t(t){this.i=t,this.data=new At(this.i)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ct()},t.prototype.last=function(){return this.data.ut()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ht((function(e,n){return t(e),!1}))},t.prototype.Ft=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(this.i(r.key,t[1])>=0)return;e(r.key)}},t.prototype.xt=function(t,e){var n;for(n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},t.prototype.$t=function(t){var e=this.data.ft(t);return e.At()?e.It().key:null},t.prototype._t=function(){return new xt(this.data._t())},t.prototype.ft=function(t){return new xt(this.data.ft(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.m=function(){return this.data.m()},t.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.i(i,o))return!1}return!0},t.prototype.A=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.i);return n.data=e,n},t}(),xt=function(){function t(t){this.Mt=t}return t.prototype.It=function(){return this.Mt.It().key},t.prototype.At=function(){return this.Mt.At()},t}(),kt=new At(k.i);function Pt(){return kt}function Nt(){return Pt()}var Bt=new At(k.i);function Dt(){return Bt}var Rt=new At(k.i),jt=new Tt(k.i);function Mt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=jt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Lt=new Tt(Z);function Ft(){return Lt}var Ut=function(){function t(t){this.i=t?function(e,n){return t(e,n)||k.i(e.key,n.key)}:function(t,e){return k.i(t.key,e.key)},this.Ot=Dt(),this.Lt=new At(this.i)}return t.Bt=function(e){return new t(e.i)},t.prototype.has=function(t){return null!=this.Ot.get(t)},t.prototype.get=function(t){return this.Ot.get(t)},t.prototype.first=function(){return this.Lt.ct()},t.prototype.last=function(){return this.Lt.ut()},t.prototype.m=function(){return this.Lt.m()},t.prototype.indexOf=function(t){var e=this.Ot.get(t);return e?this.Lt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Lt.ht((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.ot(t.key,t),e.Lt.ot(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Lt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Lt._t(),r=e.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.i=this.i,r.Ot=e,r.Lt=n,r},t}(),Vt=function(){function t(){this.qt=new At(k.i)}return t.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);n?0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):w():this.qt=this.qt.ot(e,t)},t.prototype.Ut=function(){var t=[];return this.qt.ht((function(e,n){t.push(n)})),t},t}(),zt=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.jt=s,this.Kt=a}return t.Gt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ut.Bt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Wt.m()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Wt.isEqual(t.Wt)&&Xn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),qt=function(){function t(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}return t.Xt=function(e,n){var r=new Map;return r.set(e,Wt.Zt(e,n)),new t(lt.min(),r,Ft(),Pt(),Mt())},t}(),Wt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}return t.Zt=function(e,n){return new t(et.B,n,Mt(),Mt(),Mt())},t}(),Gt=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Ht=function(t,e){this.targetId=t,this.oe=e},Yt=function(t,e,n,r){void 0===n&&(n=et.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Kt=function(){function t(){this.ae=0,this.ce=Xt(),this.ue=et.B,this.he=!1,this.le=!0}return Object.defineProperty(t.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),t.prototype.de=function(t){t.O()>0&&(this.le=!0,this.ue=t)},t.prototype.we=function(){var t=Mt(),e=Mt(),n=Mt();return this.ce.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:w()}})),new Wt(this.ue,this.he,t,e,n)},t.prototype.me=function(){this.le=!1,this.ce=Xt()},t.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},t.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},t.prototype.Ie=function(){this.ae+=1},t.prototype.Ae=function(){this.ae-=1},t.prototype.Re=function(){this.le=!0,this.he=!0},t}(),Qt=function(){function t(t){this.ge=t,this.Pe=new Map,this.ye=Pt(),this.Ve=Jt(),this.pe=new Tt(Z)}return t.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof Rn?this.ve(r,t.re):t.re instanceof jn&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},t.prototype.De=function(t){var e=this;this.Ce(t,(function(n){var r=e.Ne(n);switch(t.state){case 0:e.Fe(n)&&r.de(t.resumeToken);break;case 1:r.Ae(),r._e||r.me(),r.de(t.resumeToken);break;case 2:r.Ae(),r._e||e.removeTarget(n);break;case 3:e.Fe(n)&&(r.Re(),r.de(t.resumeToken));break;case 4:e.Fe(n)&&(e.xe(n),r.de(t.resumeToken));break;default:w()}}))},t.prototype.Ce=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach((function(t,r){n.Fe(r)&&e(r)}))},t.prototype.$e=function(t){var e=t.targetId,n=t.oe.count,r=this.ke(e);if(r){var i=r.target;if(bt(i))if(0===n){var o=new k(i.path);this.Se(e,o,new jn(o,lt.min()))}else _(1===n);else this.Me(e)!==n&&(this.xe(e),this.pe=this.pe.add(e))}},t.prototype.Oe=function(t){var e=this,n=new Map;this.Pe.forEach((function(r,i){var o=e.ke(i);if(o){if(r.te&&bt(o.target)){var s=new k(o.target.path);null!==e.ye.get(s)||e.Le(i,s)||e.Se(i,s,new jn(s,t))}r.fe&&(n.set(i,r.we()),r.me())}}));var r=Mt();this.Ve.forEach((function(t,n){var i=!0;n.xt((function(t){var n=e.ke(t);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new qt(t,n,this.pe,this.ye,r);return this.ye=Pt(),this.Ve=Jt(),this.pe=new Tt(Z),i},t.prototype.ve=function(t,e){if(this.Fe(t)){var n=this.Le(t,e.key)?2:0;this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t))}},t.prototype.Se=function(t,e,n){if(this.Fe(t)){var r=this.Ne(t);this.Le(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.Me=function(t){var e=this.Ne(t).we();return this.ge.qe(t).size+e.ee.size-e.se.size},t.prototype.Ie=function(t){this.Ne(t).Ie()},t.prototype.Ne=function(t){var e=this.Pe.get(t);return e||(e=new Kt,this.Pe.set(t,e)),e},t.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new Tt(Z),this.Ve=this.Ve.ot(t,e)),e},t.prototype.Fe=function(t){var e=null!==this.ke(t);return e||v("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ge.Ue(t)},t.prototype.xe=function(t){var e=this;this.Pe.set(t,new Kt),this.ge.qe(t).forEach((function(n){e.Se(t,n,null)}))},t.prototype.Le=function(t,e){return this.ge.qe(t).has(e)},t}();function Jt(){return new At(k.i)}function Xt(){return new At(k.i)}function Zt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function $t(t){var e=t.mapValue.fields.__previous_value__;return Zt(e)?$t(e):e}function te(t){var e=ce(t.mapValue.fields.__local_write_time__.timestampValue);return new ct(e.seconds,e.nanos)}var ee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ne(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zt(t)?4:10:w()}function re(t,e){var n=ne(t);if(n!==ne(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return te(t).isEqual(te(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ce(t.timestampValue),r=ce(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return he(t.bytesValue).isEqual(he(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return le(t.geoPointValue.latitude)===le(e.geoPointValue.latitude)&&le(t.geoPointValue.longitude)===le(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return le(t.integerValue)===le(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=le(t.doubleValue),r=le(e.doubleValue);return n===r?ft(n)===ft(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return $(t.arrayValue.values||[],e.arrayValue.values||[],re);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(O(n)!==O(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!re(n[i],r[i])))return!1;return!0}(t,e);default:return w()}}function ie(t,e){return void 0!==(t.values||[]).find((function(t){return re(t,e)}))}function oe(t,e){var n=ne(t),r=ne(e);if(n!==r)return Z(n,r);switch(n){case 0:return 0;case 1:return Z(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=le(t.integerValue||t.doubleValue),r=le(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return se(t.timestampValue,e.timestampValue);case 4:return se(te(t),te(e));case 5:return Z(t.stringValue,e.stringValue);case 6:return function(t,e){var n=he(t),r=he(e);return n.L(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Z(n[i],r[i]);if(0!==o)return o}return Z(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Z(le(t.latitude),le(e.latitude));return 0!==n?n:Z(le(t.longitude),le(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=oe(n[i],r[i]);if(o)return o}return Z(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Z(r[s],o[s]);if(0!==a)return a;var u=oe(n[r[s]],i[o[s]]);if(0!==u)return u}return Z(r.length,o.length)}(t.mapValue,e.mapValue);default:throw w()}}function se(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Z(t,e);var n=ce(t),r=ce(e),i=Z(n.seconds,r.seconds);return 0!==i?i:Z(n.nanos,r.nanos)}function ae(t){return ue(t)}function ue(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ce(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?he(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,k.C(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=ue(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+ue(t.fields[o])}return e+"}"}(t.mapValue):w();var e,n}function ce(t){if(_(!!t),"string"==typeof t){var e=0,n=ee.exec(t);if(_(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:le(t.seconds),nanos:le(t.nanos)}}function le(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function he(t){return"string"==typeof t?et.fromBase64String(t):et.fromUint8Array(t)}function fe(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function pe(t){return!!t&&"integerValue"in t}function de(t){return!!t&&"arrayValue"in t}function ye(t){return!!t&&"nullValue"in t}function ve(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ge(t){return!!t&&"mapValue"in t}var be={asc:"ASCENDING",desc:"DESCENDING"},me={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},we=function(t,e){this.U=t,this.Qe=e};function _e(t){return{integerValue:""+t}}function Se(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ft(e)?"-0":e}}function Oe(t,e){return pt(e)?_e(e):Se(t,e)}function Ee(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ae(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function Ce(t,e){return Ee(t,e.Z())}function Ie(t){return _(!!t),lt.J(function(t){var e=ce(t);return new ct(e.seconds,e.nanos)}(t))}function Te(t,e){return function(t){return new I(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).R()}function xe(t){var e=I.g(t);return _(Ze(e)),e}function ke(t,e){return Te(t.U,e.path)}function Pe(t,e){var n=xe(e);return _(n.get(1)===t.U.projectId),_(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new k(Re(n))}function Ne(t,e){return Te(t.U,e)}function Be(t){var e=xe(t);return 4===e.length?I.P():Re(e)}function De(t){return new I(["projects",t.U.projectId,"databases",t.U.database]).R()}function Re(t){return _(t.length>4&&"documents"===t.get(4)),t.u(5)}function je(t,e,n){return{name:ke(t,e),fields:n.proto.mapValue.fields}}function Me(t,e){var n;if(e instanceof On)n={update:je(t,e.key,e.value)};else if(e instanceof xn)n={delete:ke(t,e.key)};else if(e instanceof En)n={update:je(t,e.key,e.data),updateMask:Xe(e.We)};else if(e instanceof Cn)n={transform:{document:ke(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof rn)return{fieldPath:e.field.R(),setToServerValue:"REQUEST_TIME"};if(n instanceof on)return{fieldPath:e.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof an)return{fieldPath:e.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof cn)return{fieldPath:e.field.R(),increment:n.je};throw w()}(0,t)}))}};else{if(!(e instanceof kn))return w();n={verify:ke(t,e.key)}}return e.Ge.Ke||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ce(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:w()}(t,e.Ge)),n}function Le(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?yn.updateTime(Ie(t.updateTime)):void 0!==t.exists?yn.exists(t.exists):yn.ze()}(e.currentDocument):yn.ze();if(e.update){e.update.name;var r=Pe(t,e.update.name),i=new Pn({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new fn(e.map((function(t){return x.S(t)})))}(e.updateMask);return new En(r,i,o,n)}return new On(r,i,n)}if(e.delete){var s=Pe(t,e.delete);return new xn(s,n)}if(e.transform){var a=Pe(t,e.transform.document),u=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)_("REQUEST_TIME"===e.setToServerValue),n=new rn;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new on(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new an(i)}else"increment"in e?n=new cn(t,e.increment):w();var o=x.S(e.fieldPath);return new pn(o,n)}(t,e)}));return _(!0===n.exists),new Cn(a,u)}if(e.verify){var c=Pe(t,e.verify);return new kn(c,n)}return w()}function Fe(t,e){return{documents:[Ne(t,e.path)]}}function Ue(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ne(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ne(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(ve(t.value))return{unaryFilter:{field:Ye(t.field),op:"IS_NAN"}};if(ye(t.value))return{unaryFilter:{field:Ye(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ve(t.value))return{unaryFilter:{field:Ye(t.field),op:"IS_NOT_NAN"}};if(ye(t.value))return{unaryFilter:{field:Ye(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ye(t.field),op:He(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ye(t.field),direction:Ge(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Qe||ht(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=qe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=qe(e.endAt)),n}function Ve(t){var e=Be(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,o=null;if(r>0){_(1===r);var s=n.from[0];s.allDescendants?o=s.collectionId:e=e.child(s.collectionId)}var a=[];n.where&&(a=ze(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new yr(Ke(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var c=null;n.limit&&(c=function(t){var e;return ht(e="object"==i(t)?t.value:t)?null:e}(n.limit));var l=null;n.startAt&&(l=We(n.startAt));var h=null;return n.endAt&&(h=We(n.endAt)),Yn(Fn(e,o,u,a,c,"F",l,h))}function ze(t){return t?void 0!==t.unaryFilter?[Je(t)]:void 0!==t.fieldFilter?[Qe(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return ze(t)})).reduce((function(t,e){return t.concat(e)})):w():[]}function qe(t){return{before:t.before,values:t.position}}function We(t){var e=!!t.before,n=t.values||[];return new hr(n,e)}function Ge(t){return be[t]}function He(t){return me[t]}function Ye(t){return{fieldPath:t.R()}}function Ke(t){return x.S(t.fieldPath)}function Qe(t){return nr.create(Ke(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return w()}}(t.fieldFilter.op),t.fieldFilter.value)}function Je(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ke(t.unaryFilter.field);return nr.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ke(t.unaryFilter.field);return nr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ke(t.unaryFilter.field);return nr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ke(t.unaryFilter.field);return nr.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return w()}}function Xe(t){var e=[];return t.fields.forEach((function(t){return e.push(t.R())})),{fieldPaths:e}}function Ze(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var $e=function(){this.He=void 0};function tn(t,e,n){return t instanceof rn?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof on?sn(t,e):t instanceof an?un(t,e):function(t,e){var n=nn(t,e),r=ln(n)+ln(t.je);return pe(n)&&pe(t.je)?_e(r):Se(t.serializer,r)}(t,e)}function en(t,e,n){return t instanceof on?sn(t,e):t instanceof an?un(t,e):n}function nn(t,e){return t instanceof cn?pe(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var rn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e}($e),on=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return o.__extends(e,t),e}($e);function sn(t,e){for(var n=hn(e),r=function(t){n.some((function(e){return re(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var an=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return o.__extends(e,t),e}($e);function un(t,e){for(var n=hn(e),r=function(t){n=n.filter((function(e){return!re(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var cn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.je=n,r}return o.__extends(e,t),e}($e);function ln(t){return le(t.integerValue||t.doubleValue)}function hn(t){return de(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var fn=function(){function t(t){this.fields=t,t.sort(x.i)}return t.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},t.prototype.isEqual=function(t){return $(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),pn=function(t,e){this.field=t,this.transform=e},dn=function(t,e){this.version=t,this.transformResults=e},yn=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ze=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function vn(t,e){return void 0!==t.updateTime?e instanceof Rn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Rn}var gn=function(){};function bn(t,e,n){return t instanceof On?function(t,e,n){return new Rn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof En?function(t,e,n){if(!vn(t.Ge,e))return new Mn(t.key,n.version);var r=An(t,e);return new Rn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Cn?function(t,e,n){if(_(null!=n.transformResults),!vn(t.Ge,e))return new Mn(t.key,n.version);var r=In(0,e),i=function(t,e,n){var r=[];_(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof Rn&&(a=e.field(o.field)),r.push(en(s,a,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Tn(t,r.data(),i);return new Rn(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new jn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function mn(t,e,n,r){return t instanceof On?function(t,e){if(!vn(t.Ge,e))return e;var n=Sn(e);return new Rn(t.key,n,t.value,{Je:!0})}(t,e):t instanceof En?function(t,e){if(!vn(t.Ge,e))return e;var n=Sn(e),r=An(t,e);return new Rn(t.key,n,r,{Je:!0})}(t,e):t instanceof Cn?function(t,e,n,r){if(!vn(t.Ge,e))return e;var i=In(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=null;n instanceof Rn&&(c=n.field(a.field)),null===c&&r instanceof Rn&&(c=r.field(a.field)),i.push(tn(u,c,e))}return i}(t.fieldTransforms,n,e,r),s=Tn(t,i.data(),o);return new Rn(t.key,i.version,s,{Je:!0})}(t,e,r,n):function(t,e){return vn(t.Ge,e)?new jn(t.key,lt.min()):e}(t,e)}function wn(t,e){return t instanceof Cn?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Rn?e.field(o.field):void 0,a=nn(o.transform,s||null);null!=a&&(n=null==n?(new Nn).set(o.field,a):n.set(o.field,a))}return n?n.Xe():null}(t,e):null}function _n(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||$(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof on&&e instanceof on||t instanceof an&&e instanceof an?$(t.elements,e.elements,re):t instanceof cn&&e instanceof cn?re(t.je,e.je):t instanceof rn&&e instanceof rn}(t.transform,e.transform)}(t,e)})))}function Sn(t){return t instanceof Rn?t.version:lt.min()}var On=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ge=r,i.type=0,i}return o.__extends(e,t),e}(gn),En=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.We=r,o.Ge=i,o.type=1,o}return o.__extends(e,t),e}(gn);function An(t,e){return function(t,e){var n=new Nn(e);return t.We.fields.forEach((function(e){if(!e.m()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Xe()}(t,e instanceof Rn?e.data():Pn.empty())}var Cn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ge=yn.exists(!0),r}return o.__extends(e,t),e}(gn);function In(t,e){return e}function Tn(t,e,n){for(var r=new Nn(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var xn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=3,r}return o.__extends(e,t),e}(gn),kn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=4,r}return o.__extends(e,t),e}(gn),Pn=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ge(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},t.prototype.isEqual=function(t){return re(this.proto,t.proto)},t}(),Nn=function(){function t(t){void 0===t&&(t=Pn.empty()),this.Ze=t,this.tn=new Map}return t.prototype.set=function(t,e){return this.en(t,e),this},t.prototype.delete=function(t){return this.en(t,null),this},t.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ne(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t._(),e)},t.prototype.Xe=function(){var t=this.nn(x.P(),this.tn);return null!=t?new Pn(t):this.Ze},t.prototype.nn=function(t,e){var n=this,r=!1,i=this.Ze.field(t),o=ge(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.nn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Bn(t){var e=[];return E(t.fields||{},(function(t,n){var r=new x([t]);if(ge(n)){var i=Bn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new fn(e)}var Dn=function(t,e){this.key=t,this.version=e},Rn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).sn=r,o.Je=!!i.Je,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return o.__extends(e,t),e.prototype.field=function(t){return this.sn.field(t)},e.prototype.data=function(){return this.sn},e.prototype.rn=function(){return this.sn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Dn),jn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return o.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Dn),Mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Dn),Ln=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=a,this.cn=null,this.un=null,this.startAt,this.endAt};function Fn(t,e,n,r,i,o,s,a){return new Ln(t,e,n,r,i,o,s,a)}function Un(t){return new Ln(t)}function Vn(t){return!ht(t.limit)&&"F"===t.an}function zn(t){return!ht(t.limit)&&"L"===t.an}function qn(t){return t.on.length>0?t.on[0].field:null}function Wn(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Gn(t){return null!==t.collectionGroup}function Hn(t){var e=S(t);if(null===e.cn){e.cn=[];var n=Wn(e),r=qn(e);if(null!==n&&null===r)n.p()||e.cn.push(new yr(n)),e.cn.push(new yr(x.v(),"asc"));else{for(var i=!1,o=0,s=e.on;o<s.length;o++){var a=s[o];e.cn.push(a),a.field.p()&&(i=!0)}if(!i){var u=e.on.length>0?e.on[e.on.length-1].dir:"asc";e.cn.push(new yr(x.v(),u))}}}return e.cn}function Yn(t){var e=S(t);if(!e.un)if("F"===e.an)e.un=yt(e.path,e.collectionGroup,Hn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Hn(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new yr(o.field,s))}var a=e.endAt?new hr(e.endAt.position,!e.endAt.before):null,u=e.startAt?new hr(e.startAt.position,!e.startAt.before):null;e.un=yt(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.un}function Kn(t,e,n){return new Ln(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qn(t,e){return new Ln(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Jn(t,e){return new Ln(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Xn(t,e){return gt(Yn(t),Yn(e))&&t.an===e.an}function Zn(t){return vt(Yn(t))+"|lt:"+t.an}function $n(t){return"Query(target="+function(t){var e=t.path.R();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.R()+" "+e.op+" "+ae(e.value);var e})).join(", ")+"]"),ht(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.R()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+fr(t.startAt)),t.endAt&&(e+=", endAt: "+fr(t.endAt)),"Target("+e+")"}(Yn(t))+"; limitType="+t.an+")"}function tr(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.N(t.collectionGroup)&&t.path.T(n):k.F(t.path)?t.path.isEqual(n):t.path.I(n)}(t,e)&&function(t,e){for(var n=0,r=t.on;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!pr(t.startAt,Hn(t),e)||t.endAt&&pr(t.endAt,Hn(t),e))}(t,e)}function er(t){return function(e,n){for(var r=!1,i=0,o=Hn(t);i<o.length;i++){var s=o[i],a=vr(s,e,n);if(0!==a)return a;r=r||s.field.p()}return 0}}var nr=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return o.__extends(e,t),e.create=function(t,n,r){if(t.p())return"in"===n||"not-in"===n?this.ln(t,n,r):new rr(t,n,r);if(ye(r)){if("=="!==n&&"!="!==n)throw new p(f.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new e(t,n,r)}if(ve(r)){if("=="!==n&&"!="!==n)throw new p(f.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new e(t,n,r)}return"array-contains"===n?new ar(t,r):"in"===n?new ur(t,r):"not-in"===n?new cr(t,r):"array-contains-any"===n?new lr(t,r):new e(t,n,r)},e.ln=function(t,e,n){return"in"===e?new ir(t,n):new or(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this._n(oe(e,this.value)):null!==e&&ne(this.value)===ne(e)&&this._n(oe(e,this.value))},e.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return w()}},e.prototype.hn=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),rr=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=k.C(r.referenceValue),i}return o.__extends(e,t),e.prototype.matches=function(t){var e=k.i(t.key,this.key);return this._n(e)},e}(nr),ir=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=sr(0,n),r}return o.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(nr),or=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=sr(0,n),r}return o.__extends(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(nr);function sr(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return k.C(t.referenceValue)}))}var ar=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return o.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return de(e)&&ie(e.arrayValue,this.value)},e}(nr),ur=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return o.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ie(this.value.arrayValue,e)},e}(nr),cr=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return o.__extends(e,t),e.prototype.matches=function(t){if(ie(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ie(this.value.arrayValue,e)},e}(nr),lr=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return o.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!de(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ie(e.value.arrayValue,t)}))},e}(nr),hr=function(t,e){this.position=t,this.before=e};function fr(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ae(t)})).join(",")}function pr(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.p()?k.i(k.C(s.referenceValue),n.key):oe(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function dr(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!re(t.position[n],e.position[n]))return!1;return!0}var yr=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function vr(t,e,n){var r=t.field.p()?k.i(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?oe(r,i):w()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return w()}}function gr(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var br=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},mr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}return t.prototype.reset=function(){this.En=0},t.prototype.Rn=function(){this.En=this.Tn},t.prototype.gn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&v("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,(function(){return e.An=Date.now(),t()})),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},t.prototype.Vn=function(){null!==this.In&&(this.In.pn(),this.In=null)},t.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},t.prototype.Pn=function(){return(Math.random()-.5)*this.En},t}(),wr=function(){function t(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t((function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)}),(function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Dn&&w(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(e,this.result):new t((function(t,i){r.bn=function(n){r.Nn(e,n).next(t,i)},r.vn=function(e){r.Cn(n,e).next(t,i)}}))},t.prototype.Fn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.xn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Nn=function(e,n){return e?this.xn((function(){return e(n)})):t.resolve(n)},t.prototype.Cn=function(e,n){return e?this.xn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.$n=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.kn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.$n(r)},t}(),_r=function(){function t(e,n,r){this.name=e,this.version=n,this.Mn=r,12.2===t.On(u.getUA())&&g("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return v("SimpleDb","Removing database:",t),Ir(window.indexedDB.deleteDatabase(t)).Fn()},t.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(t.Bn())return!0;var e=u.getUA(),n=t.On(e),r=0<n&&n<10,i=t.qn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Bn=function(){var t;return void 0!==r&&"YES"===(null===(t=r.env)||void 0===t?void 0:t.Un)},t.Qn=function(t,e){return t.store(e)},t.On=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.qn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Wn=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n=this;return o.__generator(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(v("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Or(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new p(f.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Or(t,n))},i.onupgradeneeded=function(t){v("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Mn.createOrUpgrade(e,i.transaction,t.oldVersion,n.version).next((function(){v("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.jn&&(this.db.onversionchange=function(t){return n.jn(t)}),this.db)]}}))}))},t.prototype.Kn=function(t){this.jn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return o.__awaiter(this,void 0,void 0,(function(){var s,a,u,c,l;return o.__generator(this,(function(h){switch(h.label){case 0:s="readonly"===e,a=0,u=function(){var e,i,u,l,h;return o.__generator(this,(function(o){switch(o.label){case 0:++a,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,c.Wn(t)];case 2:return c.db=o.sent(),e=Ar.open(c.db,t,s?"readonly":"readwrite",n),i=r(e).catch((function(t){return e.abort(t),wr.reject(t)})).Fn(),u={},i.catch((function(){})),[4,e.Gn];case 3:return[2,(u.value=(o.sent(),i),u)];case 4:return l=o.sent(),h="FirebaseError"!==l.name&&a<3,v("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),c.close(),h?[3,5]:[2,{value:Promise.reject(l)}];case 5:return[2]}}))},c=this,h.label=1;case 1:return[5,u()];case 2:if("object"==i(l=h.sent()))return[2,l.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Sr=function(){function t(t){this.zn=t,this.Hn=!1,this.Yn=null}return Object.defineProperty(t.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Hn=!0},t.prototype.Xn=function(t){this.Yn=t},t.prototype.delete=function(){return Ir(this.zn.delete())},t}(),Or=function(t){function e(e,n){var r=this;return(r=t.call(this,f.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return o.__extends(e,t),e}(p);function Er(t){return"IndexedDbTransactionError"===t.name}var Ar=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Zn=new br,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){e.error?n.Zn.reject(new Or(t,e.error)):n.Zn.resolve()},this.transaction.onerror=function(e){var r=xr(e.target.error);n.Zn.reject(new Or(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Or(n,e)}},Object.defineProperty(t.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(v("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Cr(e)},t}(),Cr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(v("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(v("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ir(n)},t.prototype.add=function(t){return v("SimpleDb","ADD",this.store.name,t,t),Ir(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ir(this.store.get(t)).next((function(n){return void 0===n&&(n=null),v("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return v("SimpleDb","DELETE",this.store.name,t),Ir(this.store.delete(t))},t.prototype.count=function(){return v("SimpleDb","COUNT",this.store.name),Ir(this.store.count())},t.prototype.ts=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.es(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ns=function(t,e){v("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(t,e,n){return n.delete()}))},t.prototype.rs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.es(r,e)},t.prototype.os=function(t){var e=this.cursor({});return new wr((function(n,r){e.onerror=function(t){var e=xr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.es=function(t,e){var n=[];return new wr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Sr(i),s=e(i.primaryKey,i.value,o);if(s instanceof wr){var a=s.catch((function(t){return o.done(),wr.reject(t)}));n.push(a)}o.Sn?r():null===o.Jn?i.continue():i.continue(o.Jn)}else r()}})).next((function(){return wr.$n(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ir(t){return new wr((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=xr(t.target.error);n(e)}}))}var Tr=!1;function xr(t){var e=_r.On(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new p("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Tr||(Tr=!0,setTimeout((function(){throw r}),0)),r}}return t}function kr(){return"undefined"!=typeof window?window:null}function Pr(){return"undefined"!=typeof document?document:null}var Nr=function(){function t(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new br,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(t){}))}return t._s=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.fs=setTimeout((function(){return e.ds()}),t)},t.prototype.pn=function(){return this.ds()},t.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new p(f.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ds=function(){var t=this;this.cs.ws((function(){return null!==t.fs?(t.clearTimeout(),t.op().then((function(e){return t.ls.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},t}(),Br=function(){function t(){var t=this;this.Ts=Promise.resolve(),this.Es=[],this.Is=!1,this.As=[],this.Rs=null,this.gs=!1,this.Ps=[],this.ys=new mr(this,"async_queue_retry"),this.Vs=function(){var e=Pr();e&&v("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.ys.Vn()};var e=Pr();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vs)}return Object.defineProperty(t.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),t.prototype.ws=function(t){this.enqueue(t)},t.prototype.bs=function(t){this.vs(),this.Ss(t)},t.prototype.Ds=function(){if(!this.Is){this.Is=!0;var t=Pr();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs)}},t.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise((function(t){})):this.Ss(t)},t.prototype.Cs=function(t){var e=this;this.ws((function(){return e.Es.push(t),e.Ns()}))},t.prototype.Ns=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e=this;return o.__generator(this,(function(n){switch(n.label){case 0:if(0===this.Es.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Es[0]()];case 2:return n.sent(),this.Es.shift(),this.ys.reset(),[3,4];case 3:if(!Er(t=n.sent()))throw t;return v("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Es.length>0&&this.ys.gn((function(){return e.Ns()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ss=function(t){var e=this,n=this.Ts.then((function(){return e.gs=!0,t().catch((function(t){throw e.Rs=t,e.gs=!1,g("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gs=!1,t}))}));return this.Ts=n,n},t.prototype.yn=function(t,e,n){var r=this;this.vs(),this.Ps.indexOf(t)>-1&&(e=0);var i=Nr._s(this,t,e,n,(function(t){return r.Fs(t)}));return this.As.push(i),i},t.prototype.vs=function(){this.Rs&&w()},t.prototype.xs=function(){},t.prototype.$s=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.Ts];case 1:e.sent(),e.label=2;case 2:if(t!==this.Ts)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},t.prototype.Ms=function(t){var e=this;return this.$s().then((function(){e.As.sort((function(t,e){return t.us-e.us}));for(var n=0,r=e.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==t&&i.dn===t)break}return e.$s()}))},t.prototype.Os=function(t){this.Ps.push(t)},t.prototype.Fs=function(t){var e=this.As.indexOf(t);this.As.splice(e,1)},t}();function Dr(t,e){if(g("AsyncQueue",e+": "+t),Er(t))return new p(f.UNAVAILABLE,e+": "+t);throw t}var Rr=function(){this.Ls=void 0,this.listeners=[]},jr=function(){this.Bs=new ut((function(t){return Zn(t)}),Xn),this.onlineState="Unknown",this.qs=new Set};function Mr(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a,u,c;return o.__generator(this,(function(o){switch(o.label){case 0:if(n=S(t),r=e.query,i=!1,(s=n.Bs.get(r))||(i=!0,s=new Rr),!i)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),a=s,[4,n.Us(r)];case 2:return a.Ls=o.sent(),[3,4];case 3:return u=o.sent(),c=Dr(u,"Initialization of query '"+$n(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.Bs.set(r,s),s.listeners.push(e),e.Qs(n.onlineState),s.Ls&&e.Ws(s.Ls)&&Vr(n),[2]}}))}))}function Lr(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a;return o.__generator(this,(function(o){return n=S(t),r=e.query,i=!1,(s=n.Bs.get(r))&&(a=s.listeners.indexOf(e))>=0&&(s.listeners.splice(a,1),i=0===s.listeners.length),i?[2,(n.Bs.delete(r),n.js(r))]:[2]}))}))}function Fr(t,e){for(var n=S(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.Bs.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Ws(s)&&(r=!0);u.Ls=s}}r&&Vr(n)}function Ur(t,e,n){var r=S(t),i=r.Bs.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Bs.delete(e)}function Vr(t){t.qs.forEach((function(t){t.next()}))}var zr=function(){function t(t,e,n){this.query=t,this.Ks=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Ws=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new zt(t.query,t.docs,t.Qt,e,t.Wt,t.fromCache,t.jt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.Ks.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},t.prototype.onError=function(t){this.Ks.error(t)},t.prototype.Qs=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},t.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.m()&&"Offline"!==e)},t.prototype.Hs=function(t){if(t.docChanges.length>0)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Js=function(t){t=zt.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Gs=!0,this.Ks.next(t)},t}(),qr=function(){function t(t){this.uid=t}return t.prototype.Zs=function(){return null!=this.uid},t.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();qr.UNAUTHENTICATED=new qr(null),qr.ei=new qr("google-credentials-uid"),qr.ni=new qr("first-party-uid");var Wr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}return t.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},t}();function Gr(t,e){return"firestore_clients_"+t+"_"+e}function Hr(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Zs()&&(r+="_"+e.uid),r}function Yr(t,e){return"firestore_targets_"+t+"_"+e}Wr.ai=-1;var Kr=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ci=function(e,n,r){var o=JSON.parse(r),s="object"==i(o)&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==i(o.error)),a=void 0;return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(a=new p(o.error.code,o.error.message)),s?new t(e,n,o.state,a):(g("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Qr=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ci=function(e,n){var r=JSON.parse(n),o="object"==i(r)&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==i(r.error)),s=void 0;return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(s=new p(r.error.code,r.error.message)),o?new t(e,r.state,s):(g("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Jr=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ci=function(e,n){for(var r=JSON.parse(n),o="object"==i(r)&&r.activeTargetIds instanceof Array,s=Ft(),a=0;o&&a<r.activeTargetIds.length;++a)o=pt(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return o?new t(e,s):(g("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Xr=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ci=function(e){var n=JSON.parse(e);return"object"==i(n)&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(g("SharedClientState","Failed to parse online state: "+e),null)},t}(),Zr=function(){function t(){this.activeTargetIds=Ft()}return t.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),$r=function(){function t(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.mi.bind(this),this.Ti=new At(Z),this.Ei=!1,this.Ii=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=Gr(this.persistenceKey,this._i),this.Ri=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ti=this.Ti.ot(this._i,new Zr),this.gi=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Vi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wi)}return t.Ln=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,s,a,u,c,l,h,f=this;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,this.fi.pi()];case 1:for(t=o.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(Gr(this.persistenceKey,r)))&&(s=Jr.ci(r,i))&&(this.Ti=this.Ti.ot(s.clientId,s));for(this.bi(),(a=this.storage.getItem(this.Vi))&&(u=this.vi(a))&&this.Si(u),c=0,l=this.Ii;c<l.length;c++)h=l[c],this.mi(h);return this.Ii=[],this.window.addEventListener("unload",(function(){return f.Di()})),this.Ei=!0,[2]}}))}))},t.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},t.prototype.Ci=function(){return this.Ni(this.Ti)},t.prototype.Fi=function(t){var e=!1;return this.Ti.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.xi=function(t){this.$i(t,"pending")},t.prototype.ki=function(t,e,n){this.$i(t,e,n),this.Mi(t)},t.prototype.Oi=function(t){var e="not-current";if(this.Fi(t)){var n=this.storage.getItem(Yr(this.persistenceKey,t));if(n){var r=Qr.ci(t,n);r&&(e=r.state)}}return this.Li.hi(t),this.bi(),e},t.prototype.Bi=function(t){this.Li.li(t),this.bi()},t.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},t.prototype.Ui=function(t){this.removeItem(Yr(this.persistenceKey,t))},t.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},t.prototype.ji=function(t,e,n){var r=this;e.forEach((function(t){r.Mi(t)})),this.currentUser=t,n.forEach((function(t){r.xi(t)}))},t.prototype.Ki=function(t){this.Gi(t)},t.prototype.Di=function(){this.Ei&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ei=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return v("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){v("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){v("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.mi=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(v("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ai)return void g("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return o.__awaiter(e,void 0,void 0,(function(){var t,e,r,i,s,a;return o.__generator(this,(function(o){if(this.Ei){if(null!==n.key)if(this.gi.test(n.key)){if(null==n.newValue)return t=this.zi(n.key),[2,this.Hi(t,null)];if(e=this.Yi(n.key,n.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Pi.test(n.key)){if(null!==n.newValue&&(r=this.Ji(n.key,n.newValue)))return[2,this.Xi(r)]}else if(this.yi.test(n.key)){if(null!==n.newValue&&(i=this.Zi(n.key,n.newValue)))return[2,this.tr(i)]}else if(n.key===this.Vi){if(null!==n.newValue&&(s=this.vi(n.newValue)))return[2,this.Si(s)]}else n.key===this.Ri&&(a=function(t){var e=Wr.ai;if(null!=t)try{var n=JSON.parse(t);_("number"==typeof n),e=n}catch(t){g("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Wr.ai&&this.si(a)}else this.Ii.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),t.prototype.bi=function(){this.setItem(this.Ai,this.Li.ui())},t.prototype.$i=function(t,e,n){var r=new Kr(this.currentUser,t,e,n),i=Hr(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ui())},t.prototype.Mi=function(t){var e=Hr(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Gi=function(t){var e={clientId:this._i,onlineState:t};this.storage.setItem(this.Vi,JSON.stringify(e))},t.prototype.Wi=function(t,e,n){var r=Yr(this.persistenceKey,t),i=new Qr(t,e,n);this.setItem(r,i.ui())},t.prototype.zi=function(t){var e=this.gi.exec(t);return e?e[1]:null},t.prototype.Yi=function(t,e){var n=this.zi(t);return Jr.ci(n,e)},t.prototype.Ji=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Kr.ci(new qr(i),r,e)},t.prototype.Zi=function(t,e){var n=this.yi.exec(t),r=Number(n[1]);return Qr.ci(r,e)},t.prototype.vi=function(t){return Xr.ci(t)},t.prototype.Xi=function(t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fi.er(t.batchId,t.state,t.error)]:(v("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},t.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.fi.sr(s,a).then((function(){n.Ti=r}))},t.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},t.prototype.Ni=function(t){var e=Ft();return t.forEach((function(t,n){e=e.kt(n.activeTargetIds)})),e},t}(),ti=function(){function t(){this.ir=new Zr,this.rr={},this.di=null,this.si=null}return t.prototype.xi=function(t){},t.prototype.ki=function(t,e,n){},t.prototype.Oi=function(t){return this.ir.hi(t),this.rr[t]||"not-current"},t.prototype.Qi=function(t,e,n){this.rr[t]=e},t.prototype.Bi=function(t){this.ir.li(t)},t.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.Ui=function(t){delete this.rr[t]},t.prototype.Ci=function(){return this.ir.activeTargetIds},t.prototype.Fi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.start=function(){return this.ir=new Zr,Promise.resolve()},t.prototype.ji=function(t,e,n){},t.prototype.Ki=function(t){},t.prototype.Di=function(){},t.prototype.oi=function(t){},t}(),ei=function(){function t(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}return t.prototype.cr=function(t,e,n){for(var r=n.ur,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=bn(o,e,r[i]))}return e},t.prototype.hr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=mn(i,e,e,this.ar))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=mn(u,e,o,this.ar))}return e},t.prototype.lr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.hr(r.key,t.get(r.key));i&&(n=n.ot(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Mt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&$(this.mutations,t.mutations,(function(t,e){return _n(t,e)}))&&$(this.baseMutations,t.baseMutations,(function(t,e){return _n(t,e)}))},t}(),ni=function(){function t(t,e,n,r){this.batch=t,this._r=e,this.ur=n,this.dr=r}return t.from=function(e,n,r){_(e.mutations.length===r.length);for(var i=Rt,o=e.mutations,s=0;s<o.length;s++)i=i.ot(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ri=function(){function t(){this.wr=new ut((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.mr=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),t.prototype.Er=function(t,e){this.Ir(),this.readTime=e,this.wr.set(t.key,t)},t.prototype.Ar=function(t,e){this.Ir(),e&&(this.readTime=e),this.wr.set(t,null)},t.prototype.Rr=function(t,e){this.Ir();var n=this.wr.get(e);return void 0!==n?wr.resolve(n):this.gr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Ir(),this.mr=!0,this.yr(t)},t.prototype.Ir=function(){},t}(),ii="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",oi=function(){function t(){this.Vr=[]}return t.prototype.pr=function(t){this.Vr.push(t)},t.prototype.br=function(){this.Vr.forEach((function(t){return t()}))},t}(),si=function(){function t(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}return t.prototype.Cr=function(t,e){var n=this;return this.Sr.Nr(t,e).next((function(r){return n.Fr(t,e,r)}))},t.prototype.Fr=function(t,e,n){return this.vr.Rr(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].hr(e,t);return t}))},t.prototype.$r=function(t,e,n){var r=Nt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].hr(t,e);r=r.ot(t,e)})),r},t.prototype.kr=function(t,e){var n=this;return this.vr.getEntries(t,e).next((function(e){return n.Mr(t,e)}))},t.prototype.Mr=function(t,e){var n=this;return this.Sr.Or(t,e).next((function(r){var i=n.$r(t,e,r),o=Pt();return i.forEach((function(t,e){e||(e=new jn(t,lt.min())),o=o.ot(t,e)})),o}))},t.prototype.Lr=function(t,e,n){return function(t){return k.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Br(t,e.path):Gn(e)?this.qr(t,e,n):this.Ur(t,e,n)},t.prototype.Br=function(t,e){return this.Cr(t,new k(e)).next((function(t){var e=Dt();return t instanceof Rn&&(e=e.ot(t.key,t)),e}))},t.prototype.qr=function(t,e,n){var r=this,i=e.collectionGroup,o=Dt();return this.Dr.Qr(t,i).next((function(s){return wr.forEach(s,(function(s){var a=function(t,e){return new Ln(e,null,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(e,s.child(i));return r.Ur(t,a,n).next((function(t){t.forEach((function(t,e){o=o.ot(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Ur=function(t,e,n){var r,i,o=this;return this.vr.Lr(t,e,n).next((function(n){return r=n,o.Sr.Wr(t,e)})).next((function(e){return i=e,o.jr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c),h=mn(u,l,l,o.ar);r=h instanceof Rn?r.ot(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){tr(e,n)||(r=r.remove(t))})),r}))},t.prototype.jr=function(t,e,n){for(var r=Mt(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof En&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.vr.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Rn&&(c=c.ot(t,e))})),c}))},t}(),ai=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kr=n,this.Gr=r}return t.zr=function(e,n){for(var r=Mt(),i=Mt(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function ui(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Z(n,i);return 0===s?Z(r,o):s}var ci=function(){function t(t){this.Hr=t,this.buffer=new Tt(ui),this.Yr=0}return t.prototype.Jr=function(){return++this.Yr},t.prototype.Xr=function(t){var e=[t,this.Jr()];if(this.buffer.size<this.Hr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ui(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),li={Zr:!1,eo:0,no:0,so:0},hi=function(){function t(t,e,n){this.io=t,this.ro=e,this.oo=n}return t.ao=function(e){return new t(e,t.co,t.uo)},t}();hi.ho=-1,hi.lo=1048576,hi._o=41943040,hi.co=10,hi.uo=1e3,hi.fo=new hi(hi._o,hi.co,hi.uo),hi.do=new hi(hi.ho,0,0);var fi=function(){function t(t,e){this.wo=t,this.cs=e,this.mo=!1,this.To=null}return t.prototype.start=function(t){this.wo.params.io!==hi.ho&&this.Eo(t)},t.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(t.prototype,"Ei",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),t.prototype.Eo=function(t){var e=this,n=this.mo?3e5:6e4;v("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.To=this.cs.yn("lru_garbage_collection",n,(function(){return o.__awaiter(e,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.To=null,this.mo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Io(this.wo)];case 2:return n.sent(),[3,7];case 3:return Er(e=n.sent())?(v("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,No(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Eo(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),pi=function(){function t(t,e){this.Ao=t,this.params=e}return t.prototype.Ro=function(t,e){return this.Ao.Po(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.yo=function(t,e){var n=this;if(0===e)return wr.resolve(Wr.ai);var r=new ci(e);return this.Ao.Ce(t,(function(t){return r.Xr(t.sequenceNumber)})).next((function(){return n.Ao.Vo(t,(function(t){return r.Xr(t)}))})).next((function(){return r.maxValue}))},t.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},t.prototype.bo=function(t,e){return this.Ao.bo(t,e)},t.prototype.vo=function(t,e){var n=this;return this.params.io===hi.ho?(v("LruGarbageCollector","Garbage collection skipped; disabled"),wr.resolve(li)):this.So(t).next((function(r){return r<n.params.io?(v("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.io),li):n.Do(t,e)}))},t.prototype.So=function(t){return this.Ao.So(t)},t.prototype.Do=function(t,e){var n,r,i,o,s,u,c,l=this,h=Date.now();return this.Ro(t,this.params.ro).next((function(e){return e>l.params.oo?(v("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.oo+" from "+e),r=l.params.oo):r=e,o=Date.now(),l.yo(t,r)})).next((function(r){return n=r,s=Date.now(),l.po(t,n,e)})).next((function(e){return i=e,u=Date.now(),l.bo(t,n)})).next((function(t){return c=Date.now(),y()<=a.LogLevel.DEBUG&&v("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms"),wr.resolve({Zr:!0,eo:r,no:i,so:t})}))},t}();function di(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=vi(e)),e=yi(t.get(n),e);return vi(e)}function yi(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function vi(t){return t+""}function gi(t){var e=t.length;if(_(e>=2),2===e)return _(""===t.charAt(0)&&""===t.charAt(1)),I.P();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&w(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:w()}o=s+2}return new I(r)}var bi=function(t){this.Co=t};function mi(t,e){if(e.document)return function(t,e,n){var r=Pe(t,e.name),i=Ie(e.updateTime),o=new Pn({mapValue:{fields:e.fields}});return new Rn(r,i,o,{hasCommittedMutations:!!n})}(t.Co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=k.$(e.noDocument.path),r=Ei(e.noDocument.readTime);return new jn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=k.$(e.unknownDocument.path),o=Ei(e.unknownDocument.version);return new Mn(i,o)}return w()}function wi(t,e,n){var r=_i(n),i=e.key.path.h().A();if(e instanceof Rn){var o=function(t,e){return{name:ke(t,e.key),fields:e.rn().mapValue.fields,updateTime:Ee(t,e.version.Z())}}(t.Co,e),s=e.hasCommittedMutations;return new Ji(null,null,o,s,r,i)}if(e instanceof jn){var a=e.key.path.A(),u=Oi(e.version),c=e.hasCommittedMutations;return new Ji(null,new Ki(a,u),null,c,r,i)}if(e instanceof Mn){var l=e.key.path.A(),h=Oi(e.version);return new Ji(new Qi(l,h),null,null,!0,r,i)}return w()}function _i(t){var e=t.Z();return[e.seconds,e.nanoseconds]}function Si(t){var e=new ct(t[0],t[1]);return lt.J(e)}function Oi(t){var e=t.Z();return new qi(e.seconds,e.nanoseconds)}function Ei(t){var e=new ct(t.seconds,t.nanoseconds);return lt.J(e)}function Ai(t,e){var n=(e.baseMutations||[]).map((function(e){return Le(t.Co,e)})),r=e.mutations.map((function(e){return Le(t.Co,e)})),i=ct.fromMillis(e.localWriteTimeMs);return new ei(e.batchId,i,n,r)}function Ci(t){var e,n,r=Ei(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ei(t.lastLimboFreeSnapshotVersion):lt.min();return void 0!==t.query.documents?(_(1===(n=t.query).documents.length),e=Yn(Un(Be(n.documents[0])))):e=Ve(t.query),new _t(e,t.targetId,0,t.lastListenSequenceNumber,r,i,et.fromBase64String(t.resumeToken))}function Ii(t,e){var n,r=Oi(e.nt),i=Oi(e.lastLimboFreeSnapshotVersion);n=bt(e.target)?Fe(t.Co,e.target):Ue(t.Co,e.target);var o=e.resumeToken.toBase64();return new Zi(e.targetId,vt(e.target),r,o,e.sequenceNumber,i,n)}var Ti=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.Fo={}}return t.xo=function(e,n,r,i){return _(""!==e.uid),new t(e.Zs()?e.uid:"",n,r,i)},t.prototype.$o=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pi(t).rs({index:Hi.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.ko=function(t,e,n,r){var i=this,o=Ni(t),s=Pi(t);return s.add({}).next((function(a){_("number"==typeof a);for(var u=new ei(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Me(t.Co,e)})),i=n.mutations.map((function(e){return Me(t.Co,e)}));return new Hi(e,n.batchId,n.ar.toMillis(),r,i)}(i.serializer,i.userId,u),l=[],h=new Tt((function(t,e){return Z(t.R(),e.R())})),f=0,p=r;f<p.length;f++){var d=p[f],y=Yi.key(i.userId,d.key.path,a);h=h.add(d.key.path.h()),l.push(s.put(c)),l.push(o.put(y,Yi.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Dr.Mo(t,e))})),t.pr((function(){i.Fo[a]=u.keys()})),wr.$n(l).next((function(){return u}))}))},t.prototype.Oo=function(t,e){var n=this;return Pi(t).get(e).next((function(t){return t?(_(t.userId===n.userId),Ai(n.serializer,t)):null}))},t.prototype.Lo=function(t,e){var n=this;return this.Fo[e]?wr.resolve(this.Fo[e]):this.Oo(t,e).next((function(t){if(t){var r=t.keys();return n.Fo[e]=r,r}return null}))},t.prototype.Bo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Pi(t).rs({index:Hi.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(_(e.batchId>=r),o=Ai(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Pi(t).rs({index:Hi.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pi(t).ts(Hi.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ai(e.serializer,t)}))}))},t.prototype.Nr=function(t,e){var n=this,r=Yi.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ni(t).rs({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=gi(u);if(a===n.userId&&e.path.isEqual(l))return Pi(t).get(c).next((function(t){if(!t)throw w();_(t.userId===n.userId),o.push(Ai(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.Or=function(t,e){var n=this,r=new Tt(Z),i=[];return e.forEach((function(e){var o=Yi.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Ni(t).rs({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=gi(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),wr.$n(i).next((function(){return n.Qo(t,r)}))},t.prototype.Wr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Yi.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Tt(Z);return Ni(t).rs({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=gi(u);s===n.userId&&r.T(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Qo(t,a)}))},t.prototype.Qo=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Pi(t).get(e).next((function(t){if(null===t)throw w();_(t.userId===n.userId),r.push(Ai(n.serializer,t))})))})),wr.$n(i).next((function(){return r}))},t.prototype.Wo=function(t,e){var n=this;return ki(t.jo,this.userId,e).next((function(r){return t.pr((function(){n.Ko(e.batchId)})),wr.forEach(r,(function(e){return n.No.Go(t,e)}))}))},t.prototype.Ko=function(t){delete this.Fo[t]},t.prototype.zo=function(t){var e=this;return this.$o(t).next((function(n){if(!n)return wr.resolve();var r=IDBKeyRange.lowerBound(Yi.prefixForUser(e.userId)),i=[];return Ni(t).rs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=gi(t[1]);i.push(o)}else r.done()})).next((function(){_(0===i.length)}))}))},t.prototype.Ho=function(t,e){return xi(t,this.userId,e)},t.prototype.Yo=function(t){var e=this;return Bi(t).get(this.userId).next((function(t){return t||new Gi(e.userId,-1,"")}))},t}();function xi(t,e,n){var r=Yi.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ni(t).rs({range:o,ss:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function ki(t,e,n){var r=t.store(Hi.store),i=t.store(Yi.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.rs({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){_(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=Yi.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return wr.$n(o).next((function(){return c}))}function Pi(t){return yo.Qn(t,Hi.store)}function Ni(t){return yo.Qn(t,Yi.store)}function Bi(t){return yo.Qn(t,Gi.store)}var Di=function(){function t(t,e){this.serializer=t,this.Dr=e}return t.prototype.Er=function(t,e,n){return Mi(t).put(Li(e),n)},t.prototype.Ar=function(t,e){var n=Mi(t),r=Li(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Jo(t,r)}))},t.prototype.Rr=function(t,e){var n=this;return Mi(t).get(Li(e)).next((function(t){return n.Xo(t)}))},t.prototype.Zo=function(t,e){var n=this;return Mi(t).get(Li(e)).next((function(t){var e=n.Xo(t);return e?{ta:e,size:Fi(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Nt();return this.ea(t,e,(function(t,e){var i=n.Xo(e);r=r.ot(t,i)})).next((function(){return r}))},t.prototype.na=function(t,e){var n=this,r=Nt(),i=new At(k.i);return this.ea(t,e,(function(t,e){var o=n.Xo(e);o?(r=r.ot(t,o),i=i.ot(t,Fi(e))):(r=r.ot(t,null),i=i.ot(t,0))})).next((function(){return{sa:r,ia:i}}))},t.prototype.ea=function(t,e,n){if(e.m())return wr.resolve();var r=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),i=e._t(),o=i.It();return Mi(t).rs({range:r},(function(t,e,r){for(var s=k.$(t);o&&k.i(o,s)<0;)n(o,null),o=i.It();o&&o.isEqual(s)&&(n(o,e),o=i.At()?i.It():null),o?r.Xn(o.path.A()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},t.prototype.Lr=function(t,e,n){var r=this,i=Dt(),o=e.path.length+1,s={};if(n.isEqual(lt.min())){var a=e.path.A();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.A(),c=_i(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ji.collectionReadTimeIndex}return Mi(t).rs(s,(function(t,n,s){if(t.length===o){var a=mi(r.serializer,n);e.path.T(a.key.path)?a instanceof Rn&&tr(e,a)&&(i=i.ot(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.ra=function(t){return new Ri(this,!!t&&t.oa)},t.prototype.aa=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ji(t).get(Xi.key).next((function(t){return _(!!t),t}))},t.prototype.Jo=function(t,e){return ji(t).put(Xi.key,e)},t.prototype.Xo=function(t){if(t){var e=mi(this.serializer,t);return e instanceof jn&&e.version.isEqual(lt.min())?null:e}return null},t}(),Ri=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ca=e,r.oa=n,r.ua=new ut((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return o.__extends(e,t),e.prototype.yr=function(t){var e=this,n=[],r=0,i=new Tt((function(t,e){return Z(t.R(),e.R())}));return this.wr.forEach((function(o,s){var a=e.ua.get(o);if(s){var u=wi(e.ca.serializer,s,e.readTime);i=i.add(o.path.h());var c=Fi(u);r+=c-a,n.push(e.ca.Er(t,o,u))}else if(r-=a,e.oa){var l=wi(e.ca.serializer,new jn(o,lt.min()),e.readTime);n.push(e.ca.Er(t,o,l))}else n.push(e.ca.Ar(t,o))})),i.forEach((function(r){n.push(e.ca.Dr.Mo(t,r))})),n.push(this.ca.updateMetadata(t,r)),wr.$n(n)},e.prototype.gr=function(t,e){var n=this;return this.ca.Zo(t,e).next((function(t){return null===t?(n.ua.set(e,0),null):(n.ua.set(e,t.size),t.ta)}))},e.prototype.Pr=function(t,e){var n=this;return this.ca.na(t,e).next((function(t){var e=t.sa;return t.ia.forEach((function(t,e){n.ua.set(t,e)})),e}))},e}(ri);function ji(t){return yo.Qn(t,Xi.store)}function Mi(t){return yo.Qn(t,Ji.store)}function Li(t){return t.path.A()}function Fi(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw w();e=t.noDocument}return JSON.stringify(e).length}var Ui=function(){function t(){this.ha=new Vi}return t.prototype.Mo=function(t,e){return this.ha.add(e),wr.resolve()},t.prototype.Qr=function(t,e){return wr.resolve(this.ha.getEntries(e))},t}(),Vi=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new Tt(I.i),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Tt(I.i)).A()},t}(),zi=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;_(n<r&&n>=0&&r<=10);var o=new Ar("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Wi.store)}(t),function(t){t.createObjectStore(Gi.store,{keyPath:Gi.keyPath}),t.createObjectStore(Hi.store,{keyPath:Hi.keyPath,autoIncrement:!0}).createIndex(Hi.userMutationsIndex,Hi.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Yi.store)}(t),no(t),function(t){t.createObjectStore(Ji.store)}(t));var s=wr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore($i.store),t.deleteObjectStore(Zi.store),t.deleteObjectStore(to.store)}(t),no(t)),s=s.next((function(){return t=o.store(to.store),e=new to(0,0,lt.min().Z(),0),t.put(to.key,e);var t,e}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Hi.store).ts().next((function(n){t.deleteObjectStore(Hi.store),t.createObjectStore(Hi.store,{keyPath:Hi.keyPath,autoIncrement:!0}).createIndex(Hi.userMutationsIndex,Hi.userMutationsKeyPath,{unique:!0});var r=e.store(Hi.store),i=n.map((function(t){return r.put(t)}));return wr.$n(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(ro.store,{keyPath:ro.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Xi.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ji.store);e.createIndex(Ji.readTimeIndex,Ji.readTimeIndexPath,{unique:!1}),e.createIndex(Ji.collectionReadTimeIndex,Ji.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ji.store).rs((function(t,n){e+=Fi(n)})).next((function(){var n=new Xi(e);return t.store(Xi.store).put(Xi.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Gi.store),r=t.store(Hi.store);return n.ts().next((function(n){return wr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(Hi.userMutationsIndex,i).next((function(r){return wr.forEach(r,(function(r){_(r.userId===n.userId);var i=Ai(e.serializer,r);return ki(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store($i.store),n=t.store(Ji.store);return t.store(to.store).get(to.key).next((function(t){var r=[];return n.rs((function(n,i){var o=new I(n),s=[0,di(o)];r.push(e.get(s).next((function(n){return n?wr.resolve():function(n){return e.put(new $i(0,di(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return wr.$n(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(eo.store,{keyPath:eo.keyPath});var n=e.store(eo.store),r=new Vi,i=function(t){if(r.add(t)){var e=t._(),i=t.h();return n.put({collectionId:e,parent:di(i)})}};return e.store(Ji.store).rs({ss:!0},(function(t,e){var n=new I(t);return i(n.h())})).next((function(){return e.store(Yi.store).rs({ss:!0},(function(t,e){t[0];var n=t[1],r=(t[2],gi(n));return i(r.h())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Zi.store);return n.rs((function(t,r){var i=Ci(r),o=Ii(e.serializer,i);return n.put(o)}))},t}(),qi=function(t,e){this.seconds=t,this.nanoseconds=e},Wi=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Wi.store="owner",Wi.key="owner";var Gi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Gi.store="mutationQueues",Gi.keyPath="userId";var Hi=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Hi.store="mutations",Hi.keyPath="batchId",Hi.userMutationsIndex="userMutationsIndex",Hi.userMutationsKeyPath=["userId","batchId"];var Yi=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,di(e)]},t.key=function(t,e,n){return[t,di(e),n]},t}();Yi.store="documentMutations",Yi.PLACEHOLDER=new Yi;var Ki=function(t,e){this.path=t,this.readTime=e},Qi=function(t,e){this.path=t,this.version=e},Ji=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ji.store="remoteDocuments",Ji.readTimeIndex="readTimeIndex",Ji.readTimeIndexPath="readTime",Ji.collectionReadTimeIndex="collectionReadTimeIndex",Ji.collectionReadTimeIndexPath=["parentPath","readTime"];var Xi=function(t){this.byteSize=t};Xi.store="remoteDocumentGlobal",Xi.key="remoteDocumentGlobalKey";var Zi=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Zi.store="targets",Zi.keyPath="targetId",Zi.queryTargetsIndexName="queryTargetsIndex",Zi.queryTargetsKeyPath=["canonicalId","targetId"];var $i=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};$i.store="targetDocuments",$i.keyPath=["targetId","path"],$i.documentTargetsIndex="documentTargetsIndex",$i.documentTargetsKeyPath=["path","targetId"];var to=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};to.key="targetGlobalKey",to.store="targetGlobal";var eo=function(t,e){this.collectionId=t,this.parent=e};function no(t){t.createObjectStore($i.store,{keyPath:$i.keyPath}).createIndex($i.documentTargetsIndex,$i.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Zi.store,{keyPath:Zi.keyPath}).createIndex(Zi.queryTargetsIndexName,Zi.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(to.store)}eo.store="collectionParents",eo.keyPath=["collectionId","parent"];var ro=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ro.store="clientMetadata",ro.keyPath="clientId";var io=o.__spreadArrays(o.__spreadArrays(o.__spreadArrays([Gi.store,Hi.store,Yi.store,Ji.store,Zi.store,Wi.store,to.store,$i.store],[ro.store]),[Xi.store]),[eo.store]),oo=function(){function t(){this.la=new Vi}return t.prototype.Mo=function(t,e){var n=this;if(!this.la.has(e)){var r=e._(),i=e.h();t.pr((function(){n.la.add(e)}));var o={collectionId:r,parent:di(i)};return so(t).put(o)}return wr.resolve()},t.prototype.Qr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[tt(e),""],!1,!0);return so(t).ts(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(gi(o.parent))}return n}))},t}();function so(t){return yo.Qn(t,eo.store)}var ao=function(){function t(t){this._a=t}return t.prototype.next=function(){return this._a+=2,this._a},t.fa=function(){return new t(0)},t.da=function(){return new t(-1)},t}(),uo=function(){function t(t,e){this.No=t,this.serializer=e}return t.prototype.wa=function(t){var e=this;return this.ma(t).next((function(n){var r=new ao(n.highestTargetId);return n.highestTargetId=r.next(),e.Ta(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ea=function(t){return this.ma(t).next((function(t){return lt.J(new ct(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ia=function(t){return this.ma(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Aa=function(t,e,n){var r=this;return this.ma(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.Z()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ta(t,i)}))},t.prototype.Ra=function(t,e){var n=this;return this.ga(t,e).next((function(){return n.ma(t).next((function(r){return r.targetCount+=1,n.Pa(e,r),n.Ta(t,r)}))}))},t.prototype.ya=function(t,e){return this.ga(t,e)},t.prototype.Va=function(t,e){var n=this;return this.pa(t,e.targetId).next((function(){return co(t).delete(e.targetId)})).next((function(){return n.ma(t)})).next((function(e){return _(e.targetCount>0),e.targetCount-=1,n.Ta(t,e)}))},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return co(t).rs((function(s,a){var u=Ci(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Va(t,u)))})).next((function(){return wr.$n(o)})).next((function(){return i}))},t.prototype.Ce=function(t,e){return co(t).rs((function(t,n){var r=Ci(n);e(r)}))},t.prototype.ma=function(t){return lo(t).get(to.key).next((function(t){return _(null!==t),t}))},t.prototype.Ta=function(t,e){return lo(t).put(to.key,e)},t.prototype.ga=function(t,e){return co(t).put(Ii(this.serializer,e))},t.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.ba=function(t){return this.ma(t).next((function(t){return t.targetCount}))},t.prototype.va=function(t,e){var n=vt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return co(t).rs({range:r,index:Zi.queryTargetsIndexName},(function(t,n,r){var o=Ci(n);gt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Sa=function(t,e,n){var r=this,i=[],o=ho(t);return e.forEach((function(e){var s=di(e.path);i.push(o.put(new $i(n,s))),i.push(r.No.Da(t,n,e))})),wr.$n(i)},t.prototype.Ca=function(t,e,n){var r=this,i=ho(t);return wr.forEach(e,(function(e){var o=di(e.path);return wr.$n([i.delete([n,o]),r.No.Na(t,n,e)])}))},t.prototype.pa=function(t,e){var n=ho(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Fa=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ho(t),i=Mt();return r.rs({range:n,ss:!0},(function(t,e,n){var r=gi(t[1]),o=new k(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Ho=function(t,e){var n=di(e.path),r=IDBKeyRange.bound([n],[tt(n)],!1,!0),i=0;return ho(t).rs({index:$i.documentTargetsIndex,ss:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ue=function(t,e){return co(t).get(e).next((function(t){return t?Ci(t):null}))},t}();function co(t){return yo.Qn(t,Zi.store)}function lo(t){return yo.Qn(t,to.store)}function ho(t){return yo.Qn(t,$i.store)}var fo="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",po=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jo=e,r.xa=n,r}return o.__extends(e,t),e}(oi),yo=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.fn=o,this.window=s,this.document=a,this.$a=c,this.ka=l,this.Ma=null,this.Oa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Qa=function(t){return Promise.resolve()},!t.Ln())throw new p(f.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new bo(this,i),this.Wa=n+"main",this.serializer=new bi(u),this.ja=new _r(this.Wa,10,new zi(this.serializer)),this.Ka=new uo(this.No,this.serializer),this.Dr=new oo,this.vr=function(t,e){return new Di(t,e)}(this.serializer,this.Dr),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===l&&g("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Qn=function(t,e){if(t instanceof po)return _r.Qn(t.jo,e);throw w()},t.prototype.start=function(){var t=this;return this.za().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new p(f.FAILED_PRECONDITION,fo);return t.Ha(),t.Ya(),t.Ja(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ka.Ia(e)}))})).then((function(e){t.Ma=new Wr(e,t.$a)})).then((function(){t.Oa=!0})).catch((function(e){return t.ja&&t.ja.close(),Promise.reject(e)}))},t.prototype.Xa=function(t){var e=this;return this.Qa=function(n){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(e){return this.Ei?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Za=function(t){var e=this;this.ja.Kn((function(n){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.tc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws((function(){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.Ei?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.za=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return go(e).put(new ro(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.ec(e).next((function(e){e||(t.isPrimary=!1,t.fn.Cs((function(){return t.Qa(!1)})))}))})).next((function(){return t.nc(e)})).next((function(n){return t.isPrimary&&!n?t.sc(e).next((function(){return!1})):!!n&&t.ic(e).next((function(){return!0}))}))})).catch((function(e){if(Er(e))return v("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return v("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.fn.Cs((function(){return t.Qa(e)})),t.isPrimary=e}))},t.prototype.ec=function(t){var e=this;return vo(t).get(Wi.key).next((function(t){return wr.resolve(e.rc(t))}))},t.prototype.oc=function(t){return go(t).delete(this.clientId)},t.prototype.ac=function(){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,s=this;return o.__generator(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.cc(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Qn(e,ro.store);return n.ts().next((function(t){var e=s.uc(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return wr.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=o.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.hc(i.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ja=function(){var t=this;this.qa=this.fn.yn("client_metadata_refresh",4e3,(function(){return t.za().then((function(){return t.ac()})).then((function(){return t.Ja()}))}))},t.prototype.rc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.nc=function(t){var e=this;return this.ka?wr.resolve(!0):vo(t).get(Wi.key).next((function(n){if(null!==n&&e.cc(n.leaseTimestampMs,5e3)&&!e.lc(n.ownerId)){if(e.rc(n)&&e.networkEnabled)return!0;if(!e.rc(n)){if(!n.allowTabSynchronization)throw new p(f.FAILED_PRECONDITION,fo);return!1}}return!(!e.networkEnabled||!e.inForeground)||go(t).ts().next((function(t){return void 0===e.uc(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&v("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Di=function(){return o.__awaiter(this,void 0,void 0,(function(){var t=this;return o.__generator(this,(function(e){switch(e.label){case 0:return this.Oa=!1,this._c(),this.qa&&(this.qa.cancel(),this.qa=null),this.fc(),this.dc(),[4,this.ja.runTransaction("shutdown","readwrite",[Wi.store,ro.store],(function(e){var n=new po(e,Wr.ai);return t.sc(n).next((function(){return t.oc(n)}))}))];case 1:return e.sent(),this.ja.close(),this.wc(),[2]}}))}))},t.prototype.uc=function(t,e){var n=this;return t.filter((function(t){return n.cc(t.updateTimeMs,e)&&!n.lc(t.clientId)}))},t.prototype.pi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return go(e).ts().next((function(e){return t.uc(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return Ti.xo(t,this.serializer,this.Dr,this.No)},t.prototype.Tc=function(){return this.Ka},t.prototype.Ec=function(){return this.vr},t.prototype.Ic=function(){return this.Dr},t.prototype.runTransaction=function(t,e,n){var r=this;v("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.ja.runTransaction(t,o,io,(function(o){return i=new po(o,r.Ma?r.Ma.next():Wr.ai),"readwrite-primary"===e?r.ec(i).next((function(t){return!!t||r.nc(i)})).next((function(e){if(!e)throw g("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.fn.Cs((function(){return r.Qa(!1)})),new p(f.FAILED_PRECONDITION,ii);return n(i)})).next((function(t){return r.ic(i).next((function(){return t}))})):r.Ac(i).next((function(){return n(i)}))})).then((function(t){return i.br(),t}))},t.prototype.Ac=function(t){var e=this;return vo(t).get(Wi.key).next((function(t){if(null!==t&&e.cc(t.leaseTimestampMs,5e3)&&!e.lc(t.ownerId)&&!e.rc(t)&&!(e.ka||e.allowTabSynchronization&&t.allowTabSynchronization))throw new p(f.FAILED_PRECONDITION,fo)}))},t.prototype.ic=function(t){var e=new Wi(this.clientId,this.allowTabSynchronization,Date.now());return vo(t).put(Wi.key,e)},t.Ln=function(){return _r.Ln()},t.prototype.sc=function(t){var e=this,n=vo(t);return n.get(Wi.key).next((function(t){return e.rc(t)?(v("IndexedDbPersistence","Releasing primary lease."),n.delete(Wi.key)):wr.resolve()}))},t.prototype.cc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(g("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.za()}))},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},t.prototype.fc=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},t.prototype.Ya=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e._c(),e.fn.ws((function(){return e.Di()}))},this.window.addEventListener("unload",this.La))},t.prototype.dc=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},t.prototype.lc=function(t){var e;try{var n=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.hc(t)));return v("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return g("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype._c=function(){if(this.Ga)try{this.Ga.setItem(this.hc(this.clientId),String(Date.now()))}catch(t){g("Failed to set zombie client id.",t)}},t.prototype.wc=function(){if(this.Ga)try{this.Ga.removeItem(this.hc(this.clientId))}catch(t){}},t.prototype.hc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function vo(t){return yo.Qn(t,Wi.store)}function go(t){return yo.Qn(t,ro.store)}var bo=function(){function t(t,e){this.db=t,this.wo=new pi(this,e)}return t.prototype.Po=function(t){var e=this.Rc(t);return this.db.Tc().ba(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Rc=function(t){var e=0;return this.Vo(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ce=function(t,e){return this.db.Tc().Ce(t,e)},t.prototype.Vo=function(t,e){return this.gc(t,(function(t,n){return e(n)}))},t.prototype.Da=function(t,e,n){return mo(t,n)},t.prototype.Na=function(t,e,n){return mo(t,n)},t.prototype.po=function(t,e,n){return this.db.Tc().po(t,e,n)},t.prototype.Go=function(t,e){return mo(t,e)},t.prototype.Pc=function(t,e){return function(t,e){var n=!1;return Bi(t).os((function(r){return xi(t,r,e).next((function(t){return t&&(n=!0),wr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.bo=function(t,e){var n=this,r=this.db.Ec().ra(),i=[],o=0;return this.gc(t,(function(s,a){if(a<=e){var u=n.Pc(t,s).next((function(e){if(!e)return o++,r.Rr(t,s).next((function(){return r.Ar(s),ho(t).delete([0,di(s.path)])}))}));i.push(u)}})).next((function(){return wr.$n(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.st(t.xa);return this.db.Tc().ya(t,n)},t.prototype.yc=function(t,e){return mo(t,e)},t.prototype.gc=function(t,e){var n,r=ho(t),i=Wr.ai;return r.rs({index:$i.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==Wr.ai&&e(new k(gi(n)),i),i=a,n=s):i=Wr.ai})).next((function(){i!==Wr.ai&&e(new k(gi(n)),i)}))},t.prototype.So=function(t){return this.db.Ec().aa(t)},t}();function mo(t,e){return ho(t).put(function(t,e){return new $i(0,di(t.path),e)}(e,t.xa))}function wo(t,e){var n=t.projectId;return t.j||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var _o=function(){function t(t,e,n){this.persistence=t,this.Vc=e,this.bc=new At(Z),this.vc=new ut((function(t){return vt(t)}),gt),this.Sc=lt.min(),this.Sr=t.mc(n),this.Dc=t.Ec(),this.Ka=t.Tc(),this.Cc=new si(this.Dc,this.Sr,this.persistence.Ic()),this.Vc.Nc(this.Cc)}return t.prototype.Io=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.vo(n,e.bc)}))},t}();function So(t,e){var n=S(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Dc.ra({oa:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=wr.resolve();return o.forEach((function(t){s=s.next((function(){return r.Rr(e,t)})).next((function(e){var o=e,s=n.dr.get(t);_(null!==s),(!o||o.version.L(s)<0)&&(o=i.cr(t,o,n))&&r.Er(o,n._r)}))})),s.next((function(){return t.Sr.Wo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Cc.kr(t,r)}))}))}function Oo(t){var e=S(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ka.Ea(t)}))}function Eo(t,e){var n=S(t),r=e.nt,i=n.bc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Dc.ra({oa:!0});i=n.bc;var s=[];e.zt.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.Ka.Ca(t,e.se,o).next((function(){return n.Ka.Sa(t,e.ee,o)})));var u=e.resumeToken;if(u.O()>0){var c=a.it(u,r).st(t.xa);i=i.ot(o,c),function(t,e,n){return _(e.resumeToken.O()>0),0===t.resumeToken.O()||e.nt.X()-t.nt.X()>=3e8||n.ee.size+n.ne.size+n.se.size>0}(a,c,e)&&s.push(n.Ka.ya(t,c))}}}));var a=Pt(),u=Mt();if(e.Yt.forEach((function(t,e){u=u.add(t)})),s.push(o.getEntries(t,u).next((function(i){e.Yt.forEach((function(u,c){var l=i.get(u);c instanceof jn&&c.version.isEqual(lt.min())?(o.Ar(u,r),a=a.ot(u,c)):null==l||c.version.L(l.version)>0||0===c.version.L(l.version)&&l.hasPendingWrites?(o.Er(c,r),a=a.ot(u,c)):v("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.Jt.has(u)&&s.push(n.persistence.No.yc(t,u))}))}))),!r.isEqual(lt.min())){var c=n.Ka.Ea(t).next((function(e){return n.Ka.Aa(t,t.xa,r)}));s.push(c)}return wr.$n(s).next((function(){return o.apply(t)})).next((function(){return n.Cc.Mr(t,a)}))})).then((function(t){return n.bc=i,t}))}function Ao(t,e){var n=S(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Sr.Bo(t,e)}))}function Co(t,e){var n=S(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Ka.va(t,e).next((function(i){return i?(r=i,wr.resolve(r)):n.Ka.wa(t).next((function(i){return r=new _t(e,i,0,t.xa),n.Ka.Ra(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.bc.get(t.targetId);return(null===r||t.nt.L(r.nt)>0)&&(n.bc=n.bc.ot(t.targetId,t),n.vc.set(e,t.targetId)),t}))}function Io(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a;return o.__generator(this,(function(o){switch(o.label){case 0:r=S(t),i=r.bc.get(e),s=n?"readwrite":"readwrite-primary",o.label=1;case 1:return o.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.No.removeTarget(t,i)}))];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:if(!Er(a=o.sent()))throw a;return v("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.bc=r.bc.remove(e),r.vc.delete(i.target),[2]}}))}))}function To(t,e,n){var r=S(t),i=lt.min(),o=Mt();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=S(t),i=r.vc.get(n);return void 0!==i?wr.resolve(r.bc.get(i)):r.Ka.va(e,n)}(r,t,Yn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ka.Fa(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Vc.Lr(t,e,n?i:lt.min(),n?o:Mt())})).next((function(t){return{documents:t,Fc:o}}))}))}function xo(t,e){var n=S(t),r=S(n.Ka),i=n.bc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ue(t,e).next((function(t){return t?t.target:null}))}))}function ko(t){var e=S(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=S(t),i=Pt(),o=_i(n),s=Mi(e),a=IDBKeyRange.lowerBound(o,!0);return s.rs({index:Ji.readTimeIndex,range:a},(function(t,e){var n=mi(r.serializer,e);i=i.ot(n.key,n),o=e.readTime})).next((function(){return{xc:i,readTime:Si(o)}}))}(e.Dc,t,e.Sc)})).then((function(t){var n=t.xc,r=t.readTime;return e.Sc=r,n}))}function Po(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){return[2,(e=S(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Mi(t),n=lt.min();return e.rs({index:Ji.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Si(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Sc=t}))]}))}))}function No(t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){if(t.code!==f.FAILED_PRECONDITION||t.message!==ii)throw t;return v("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Bo=function(){function t(){this.$c=new Tt(Do.kc),this.Mc=new Tt(Do.Oc)}return t.prototype.m=function(){return this.$c.m()},t.prototype.Da=function(t,e){var n=new Do(t,e);this.$c=this.$c.add(n),this.Mc=this.Mc.add(n)},t.prototype.Lc=function(t,e){var n=this;t.forEach((function(t){return n.Da(t,e)}))},t.prototype.Na=function(t,e){this.Bc(new Do(t,e))},t.prototype.qc=function(t,e){var n=this;t.forEach((function(t){return n.Na(t,e)}))},t.prototype.Uc=function(t){var e=this,n=new k(new I([])),r=new Do(n,t),i=new Do(n,t+1),o=[];return this.Mc.Ft([r,i],(function(t){e.Bc(t),o.push(t.key)})),o},t.prototype.Qc=function(){var t=this;this.$c.forEach((function(e){return t.Bc(e)}))},t.prototype.Bc=function(t){this.$c=this.$c.delete(t),this.Mc=this.Mc.delete(t)},t.prototype.Wc=function(t){var e=new k(new I([])),n=new Do(e,t),r=new Do(e,t+1),i=Mt();return this.Mc.Ft([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Ho=function(t){var e=new Do(t,0),n=this.$c.$t(e);return null!==n&&t.isEqual(n.key)},t}(),Do=function(){function t(t,e){this.key=t,this.jc=e}return t.kc=function(t,e){return k.i(t.key,e.key)||Z(t.jc,e.jc)},t.Oc=function(t,e){return Z(t.jc,e.jc)||k.i(t.key,e.key)},t}(),Ro=function(t,e){this.user=e,this.type="OAuth",this.Kc={},this.Kc.Authorization="Bearer "+t},jo=function(){function t(){this.Gc=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.zc=function(){},t.prototype.Hc=function(t){this.Gc=t,t(qr.UNAUTHENTICATED)},t.prototype.Yc=function(){this.Gc=null},t}(),Mo=function(){function t(t){var e=this;this.Jc=null,this.currentUser=qr.UNAUTHENTICATED,this.Xc=!1,this.Zc=0,this.Gc=null,this.forceRefresh=!1,this.Jc=function(){e.Zc++,e.currentUser=e.tu(),e.Xc=!0,e.Gc&&e.Gc(e.currentUser)},this.Zc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Jc):(this.Jc(null),t.get().then((function(t){e.auth=t,e.Jc&&e.auth.addAuthTokenListener(e.Jc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.Zc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.Zc!==e?(v("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(_("string"==typeof n.accessToken),new Ro(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.zc=function(){this.forceRefresh=!0},t.prototype.Hc=function(t){this.Gc=t,this.Xc&&t(this.currentUser)},t.prototype.Yc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Jc),this.Jc=null,this.Gc=null},t.prototype.tu=function(){var t=this.auth&&this.auth.getUid();return _(null===t||"string"==typeof t),new qr(t)},t}(),Lo=function(){function t(t,e){this.eu=t,this.nu=e,this.type="FirstParty",this.user=qr.ni}return Object.defineProperty(t.prototype,"Kc",{get:function(){var t={"X-Goog-AuthUser":this.nu},e=this.eu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Fo=function(){function t(t,e){this.eu=t,this.nu=e}return t.prototype.getToken=function(){return Promise.resolve(new Lo(this.eu,this.nu))},t.prototype.Hc=function(t){t(qr.ni)},t.prototype.Yc=function(){},t.prototype.zc=function(){},t}(),Uo=function(){function t(t,e,n,r,i,o){this.fn=t,this.su=n,this.iu=r,this.ru=i,this.listener=o,this.state=0,this.ou=0,this.au=null,this.stream=null,this.ys=new mr(t,e)}return t.prototype.cu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.uu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.hu()},t.prototype.stop=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.cu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.lu=function(){this.state=0,this.ys.reset()},t.prototype._u=function(){var t=this;this.uu()&&null===this.au&&(this.au=this.fn.yn(this.su,6e4,(function(){return t.fu()})))},t.prototype.du=function(t){this.wu(),this.stream.send(t)},t.prototype.fu=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this.uu()?[2,this.close(0)]:[2]}))}))},t.prototype.wu=function(){this.au&&(this.au.cancel(),this.au=null)},t.prototype.close=function(t,e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(n){switch(n.label){case 0:return this.wu(),this.ys.cancel(),this.ou++,3!==t?this.ys.reset():e&&e.code===f.RESOURCE_EXHAUSTED?(g(e.toString()),g("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):e&&e.code===f.UNAUTHENTICATED&&this.ru.zc(),null!==this.stream&&(this.mu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.mu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Eu(this.ou),n=this.ou;this.ru.getToken().then((function(e){t.ou===n&&t.Iu(e)}),(function(n){e((function(){var e=new p(f.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Au(e)}))}))},t.prototype.Iu=function(t){var e=this,n=this.Eu(this.ou);this.stream=this.Ru(t),this.stream.gu((function(){n((function(){return e.state=2,e.listener.gu()}))})),this.stream.Tu((function(t){n((function(){return e.Au(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.hu=function(){var t=this;this.state=4,this.ys.gn((function(){return o.__awaiter(t,void 0,void 0,(function(){return o.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Au=function(t){return v("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Eu=function(t){var e=this;return function(n){e.fn.ws((function(){return e.ou===t?n():(v("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Vo=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return o.__extends(e,t),e.prototype.Ru=function(t){return this.iu.Pu("Listen",t)},e.prototype.onMessage=function(t){this.ys.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:w()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Qe?(_(void 0===e||"string"==typeof e),et.fromBase64String(e||"")):(_(void 0===e||e instanceof Uint8Array),et.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(t){var e=void 0===t.code?f.UNKNOWN:Et(t.code);return new p(e,t.message||"")}(s);n=new Yt(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var c=Pe(t,u.document.name),l=Ie(u.document.updateTime),h=new Pn({mapValue:{fields:u.document.fields}}),d=new Rn(c,l,h,{}),y=u.targetIds||[],v=u.removedTargetIds||[];n=new Gt(y,v,d.key,d)}else if("documentDelete"in e){e.documentDelete;var g=e.documentDelete;g.document;var b=Pe(t,g.document),m=g.readTime?Ie(g.readTime):lt.min(),S=new jn(b,m),O=g.removedTargetIds||[];n=new Gt([],O,S.key,S)}else if("documentRemove"in e){e.documentRemove;var E=e.documentRemove;E.document;var A=Pe(t,E.document),C=E.removedTargetIds||[];n=new Gt([],C,A,null)}else{if(!("filter"in e))return w();e.filter;var I=e.filter;I.targetId;var T=I.count||0,x=new St(T),k=I.targetId;n=new Ht(k,x)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return lt.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?lt.min():e.readTime?Ie(e.readTime):lt.min()}(t);return this.listener.yu(e,n)},e.prototype.Vu=function(t){var e={};e.database=De(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=bt(r)?{documents:Fe(t,r)}:{query:Ue(t,r)}).targetId=e.targetId,e.resumeToken.O()>0&&(n.resumeToken=Ae(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return w()}}(0,e.et);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.du(e)},e.prototype.pu=function(t){var e={};e.database=De(this.serializer),e.removeTarget=t,this.du(e)},e}(Uo),zo=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.bu=!1,s}return o.__extends(e,t),Object.defineProperty(e.prototype,"vu",{get:function(){return this.bu},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.bu=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.mu=function(){this.bu&&this.Su([])},e.prototype.Ru=function(t){return this.iu.Pu("Write",t)},e.prototype.onMessage=function(t){if(_(!!t.streamToken),this.lastStreamToken=t.streamToken,this.bu){this.ys.reset();var e=function(t,e){return t&&t.length>0?(_(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Ie(t.updateTime):Ie(e);n.isEqual(lt.min())&&(n=Ie(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new dn(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Ie(t.commitTime);return this.listener.Du(n,e)}return _(!t.writeResults||0===t.writeResults.length),this.bu=!0,this.listener.Cu()},e.prototype.Nu=function(){var t={};t.database=De(this.serializer),this.du(t)},e.prototype.Su=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Me(e.serializer,t)}))};this.du(n)},e}(Uo),qo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.iu=n,i.serializer=r,i.Fu=!1,i}return o.__extends(e,t),e.prototype.xu=function(){if(this.Fu)throw new p(f.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.$u=function(t,e,n){var r=this;return this.xu(),this.credentials.getToken().then((function(i){return r.iu.$u(t,e,n,i)})).catch((function(t){throw t.code===f.UNAUTHENTICATED&&r.credentials.zc(),t}))},e.prototype.ku=function(t,e,n){var r=this;return this.xu(),this.credentials.getToken().then((function(i){return r.iu.ku(t,e,n,i)})).catch((function(t){throw t.code===f.UNAUTHENTICATED&&r.credentials.zc(),t}))},e.prototype.terminate=function(){this.Fu=!1},e}((function(){})),Wo=function(){function t(t,e){this.cs=t,this.di=e,this.state="Unknown",this.Mu=0,this.Ou=null,this.Lu=!0}return t.prototype.Bu=function(){var t=this;0===this.Mu&&(this.qu("Unknown"),this.Ou=this.cs.yn("online_state_timeout",1e4,(function(){return t.Ou=null,t.Uu("Backend didn't respond within 10 seconds."),t.qu("Offline"),Promise.resolve()})))},t.prototype.Qu=function(t){"Online"===this.state?this.qu("Unknown"):(this.Mu++,this.Mu>=1&&(this.Wu(),this.Uu("Connection failed 1 times. Most recent error: "+t.toString()),this.qu("Offline")))},t.prototype.set=function(t){this.Wu(),this.Mu=0,"Online"===t&&(this.Lu=!1),this.qu(t)},t.prototype.qu=function(t){t!==this.state&&(this.state=t,this.di(t))},t.prototype.Uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Lu?(g(e),this.Lu=!1):v("OnlineStateTracker",e)},t.prototype.Wu=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t}(),Go=function(t,e,n,r,i){var s=this;this.ju=t,this.Ku=e,this.cs=n,this.Gu={},this.zu=[],this.Hu=new Map,this.Yu=new Set,this.Ju=[],this.Xu=i,this.Xu.Zu((function(t){n.ws((function(){return o.__awaiter(s,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return es(this)?(v("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return(e=S(t)).Yu.add(4),[4,Yo(e)];case 1:return n.sent(),e.th.set("Unknown"),e.Yu.delete(4),[4,Ho(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.th=new Wo(n,r)};function Ho(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!es(t))return[3,4];e=0,n=t.Ju,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Yo(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:e=0,n=t.Ju,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ko(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return e=S(t),v("RemoteStore","RemoteStore shutting down."),e.Yu.add(5),[4,Yo(e)];case 1:return n.sent(),e.Xu.Di(),e.th.set("Unknown"),[2]}}))}))}function Qo(t,e){var n=S(t);n.Hu.has(e.targetId)||(n.Hu.set(e.targetId,e),ts(n)?$o(n):vs(n).uu()&&Xo(n,e))}function Jo(t,e){var n=S(t),r=vs(n);n.Hu.delete(e),r.uu()&&Zo(n,e),0===n.Hu.size&&(r.uu()?r._u():es(n)&&n.th.set("Unknown"))}function Xo(t,e){t.eh.Ie(e.targetId),vs(t).Vu(e)}function Zo(t,e){t.eh.Ie(e),vs(t).pu(e)}function $o(t){t.eh=new Qt({qe:function(e){return t.Gu.qe(e)},Ue:function(e){return t.Hu.get(e)||null}}),vs(t).start(),t.th.Bu()}function ts(t){return es(t)&&!vs(t).cu()&&t.Hu.size>0}function es(t){return 0===S(t).Yu.size}function ns(t){t.eh=void 0}function rs(t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return t.Hu.forEach((function(e,n){Xo(t,e)})),[2]}))}))}function is(t,e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(n){return ns(t),ts(t)?(t.th.Qu(e),$o(t)):t.th.set("Unknown"),[2]}))}))}function os(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s;return o.__generator(this,(function(a){switch(a.label){case 0:if(t.th.set("Online"),!(e instanceof Yt&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:n=e.cause,r=0,i=e.targetIds,o.label=1;case 1:return r<i.length?(s=i[r],t.Hu.has(s)?[4,t.Gu.nh(s,n)]:[3,3]):[3,5];case 2:o.sent(),t.Hu.delete(s),t.eh.removeTarget(s),o.label=3;case 3:o.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),v("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,ss(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Gt?t.eh.be(e):e instanceof Ht?t.eh.$e(e):t.eh.De(e),n.isEqual(lt.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Oo(t.ju)];case 8:return i=a.sent(),n.L(i)>=0?[4,function(t,e){var n=t.eh.Oe(e);return n.zt.forEach((function(n,r){if(n.resumeToken.O()>0){var i=t.Hu.get(r);i&&t.Hu.set(r,i.it(n.resumeToken,e))}})),n.Ht.forEach((function(e){var n=t.Hu.get(e);if(n){t.Hu.set(e,n.it(et.B,n.nt)),Zo(t,e);var r=new _t(n.target,e,1,n.sequenceNumber);Xo(t,r)}})),t.Gu.sh(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return v("RemoteStore","Failed to raise snapshot:",s=a.sent()),[4,ss(t,s)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function ss(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r=this;return o.__generator(this,(function(i){switch(i.label){case 0:if(!Er(e))throw e;return t.Yu.add(1),[4,Yo(t)];case 1:return i.sent(),t.th.set("Offline"),n||(n=function(){return Oo(t.ju)}),t.cs.Cs((function(){return o.__awaiter(r,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return v("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Yu.delete(1),[4,Ho(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function as(t,e){return e().catch((function(n){return ss(t,n,e)}))}function us(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:e=S(t),n=gs(e),r=e.zu.length>0?e.zu[e.zu.length-1].batchId:-1,o.label=1;case 1:if(!function(t){return es(t)&&t.zu.length<10}(e))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,Ao(e.ju,r)];case 3:return null===(i=o.sent())?(0===e.zu.length&&n._u(),[3,7]):(r=i.batchId,function(t,e){t.zu.push(e);var n=gs(t);n.uu()&&n.vu&&n.Su(e.mutations)}(e,i),[3,6]);case 4:return s=o.sent(),[4,ss(e,s)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return cs(e)&&ls(e),[2]}}))}))}function cs(t){return es(t)&&!gs(t).cu()&&t.zu.length>0}function ls(t){gs(t).start()}function hs(t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return gs(t).Nu(),[2]}))}))}function fs(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){for(e=gs(t),n=0,r=t.zu;n<r.length;n++)i=r[n],e.Su(i.mutations);return[2]}))}))}function ps(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return r=t.zu.shift(),i=ni.from(r,e,n),[4,as(t,(function(){return t.Gu.ih(i)}))];case 1:return o.sent(),[4,us(t)];case 2:return o.sent(),[2]}}))}))}function ds(t,e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(n){switch(n.label){case 0:return e&&gs(t).vu?[4,function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r;return o.__generator(this,(function(i){switch(i.label){case 0:return Ot(r=e.code)&&r!==f.ABORTED?(n=t.zu.shift(),gs(t).lu(),[4,as(t,(function(){return t.Gu.rh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,us(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return cs(t)&&ls(t),[2]}}))}))}function ys(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return n=S(t),e?(n.Yu.delete(2),[4,Ho(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Yu.add(2),[4,Yo(n)]);case 3:r.sent(),n.th.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function vs(t){var e=this;return t.oh||(t.oh=function(t,e,n){var r=S(t);return r.xu(),new Vo(e,r.iu,r.credentials,r.serializer,n)}(t.Ku,t.cs,{gu:rs.bind(null,t),Tu:is.bind(null,t),yu:os.bind(null,t)}),t.Ju.push((function(n){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return n?(t.oh.lu(),ts(t)?$o(t):t.th.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.oh.stop()];case 2:e.sent(),ns(t),e.label=3;case 3:return[2]}}))}))}))),t.oh}function gs(t){var e=this;return t.ah||(t.ah=function(t,e,n){var r=S(t);return r.xu(),new zo(e,r.iu,r.credentials,r.serializer,n)}(t.Ku,t.cs,{gu:hs.bind(null,t),Tu:ds.bind(null,t),Cu:fs.bind(null,t),Du:ps.bind(null,t)}),t.Ju.push((function(n){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return n?(t.ah.lu(),[4,us(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.ah.stop()];case 3:e.sent(),t.zu.length>0&&(v("RemoteStore","Stopping write stream with "+t.zu.length+" pending writes"),t.zu=[]),e.label=4;case 4:return[2]}}))}))}))),t.ah}var bs=function(t){this.key=t},ms=function(t){this.key=t},ws=function(){function t(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=Mt(),this.Wt=Mt(),this._h=er(t),this.fh=new Ut(this._h)}return Object.defineProperty(t.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),t.prototype.wh=function(t,e){var n=this,r=e?e.mh:new Vt,i=e?e.fh:this.fh,o=e?e.Wt:this.Wt,s=i,a=!1,u=Vn(this.query)&&i.size===this.query.limit?i.last():null,c=zn(this.query)&&i.size===this.query.limit?i.first():null;if(t.ht((function(t,e){var l=i.get(t),h=e instanceof Rn?e:null;h&&(h=tr(n.query,h)?h:null);var f=!!l&&n.Wt.has(l.key),p=!!h&&(h.Je||n.Wt.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data().isEqual(h.data())?f!==p&&(r.track({type:3,doc:h}),d=!0):n.Th(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n._h(h,u)>0||c&&n._h(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(a=!0)),d&&(h?(s=s.add(h),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Vn(this.query)||zn(this.query))for(;s.size>this.query.limit;){var l=Vn(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fh:s,mh:r,Eh:a,Wt:o}},t.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},t.prototype.yr=function(t,e,n){var r=this,i=this.fh;this.fh=t.fh,this.Wt=t.Wt;var o=t.mh.Ut();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return w()}};return n(t)-n(e)}(t.type,e.type)||r._h(t.doc,e.doc)})),this.Ih(n);var s=e?this.Ah():[],a=0===this.lh.size&&this.te?1:0,u=a!==this.hh;return this.hh=a,0!==o.length||u?{snapshot:new zt(this.query,t.fh,i,o,t.Wt,0===a,u,!1),Rh:s}:{Rh:s}},t.prototype.Qs=function(t){return this.te&&"Offline"===t?(this.te=!1,this.yr({fh:this.fh,mh:new Vt,Wt:this.Wt,Eh:!1},!1)):{Rh:[]}},t.prototype.gh=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},t.prototype.Ih=function(t){var e=this;t&&(t.ee.forEach((function(t){return e.uh=e.uh.add(t)})),t.ne.forEach((function(t){})),t.se.forEach((function(t){return e.uh=e.uh.delete(t)})),this.te=t.te)},t.prototype.Ah=function(){var t=this;if(!this.te)return[];var e=this.lh;this.lh=Mt(),this.fh.forEach((function(e){t.gh(e.key)&&(t.lh=t.lh.add(e.key))}));var n=[];return e.forEach((function(e){t.lh.has(e)||n.push(new ms(e))})),this.lh.forEach((function(t){e.has(t)||n.push(new bs(t))})),n},t.prototype.Ph=function(t){this.uh=t.Fc,this.lh=Mt();var e=this.wh(t.documents);return this.yr(e,!0)},t.prototype.yh=function(){return zt.Gt(this.query,this.fh,this.Wt,0===this.hh)},t}(),_s=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ss=function(t){this.key=t,this.Vh=!1},Os=function(){function t(t,e,n,r,i,o){this.ju=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new ut((function(t){return Zn(t)}),Xn),this.Fh=new Map,this.xh=[],this.$h=new At(k.i),this.kh=new Map,this.Mh=new Bo,this.Oh={},this.Lh=new Map,this.Bh=ao.da(),this.onlineState="Unknown",this.qh=void 0}return Object.defineProperty(t.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),t}();function Es(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a,u;return o.__generator(this,(function(o){switch(o.label){case 0:return n=Js(t),(s=n.Nh.get(e))?(r=s.targetId,n.Sh.Oi(r),i=s.view.yh(),[3,4]):[3,1];case 1:return[4,Co(n.ju,Yn(e))];case 2:return a=o.sent(),u=n.Sh.Oi(a.targetId),r=a.targetId,[4,As(n,e,r,"current"===u)];case 3:i=o.sent(),n.Uh&&Qo(n.ph,a),o.label=4;case 4:return[2,i]}}))}))}function As(t,e,n,r){return o.__awaiter(this,void 0,void 0,(function(){var i,s,a,u,c,l;return o.__generator(this,(function(h){switch(h.label){case 0:return t.Qh=function(e,n,r){return function(t,e,n,r){return o.__awaiter(this,void 0,void 0,(function(){var i,s,a;return o.__generator(this,(function(o){switch(o.label){case 0:return(i=e.view.wh(n)).Eh?[4,To(t.ju,e.query,!1).then((function(t){var n=t.documents;return e.view.wh(n,i)}))]:[3,2];case 1:i=o.sent(),o.label=2;case 2:return s=r&&r.zt.get(e.targetId),a=e.view.yr(i,t.Uh,s),[2,(js(t,e.targetId,a.Rh),a.snapshot)]}}))}))}(t,e,n,r)},[4,To(t.ju,e,!0)];case 1:return i=h.sent(),s=new ws(e,i.Fc),a=s.wh(i.documents),u=Wt.Zt(n,r&&"Offline"!==t.onlineState),c=s.yr(a,t.Uh,u),js(t,n,c.Rh),l=new _s(e,n,s),[2,(t.Nh.set(e,l),t.Fh.has(n)?t.Fh.get(n).push(e):t.Fh.set(n,[e]),c.snapshot)]}}))}))}function Cs(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return n=S(t),r=n.Nh.get(e),(i=n.Fh.get(r.targetId)).length>1?[2,(n.Fh.set(r.targetId,i.filter((function(t){return!Xn(t,e)}))),void n.Nh.delete(e))]:n.Uh?(n.Sh.Bi(r.targetId),n.Sh.Fi(r.targetId)?[3,2]:[4,Io(n.ju,r.targetId,!1).then((function(){n.Sh.Ui(r.targetId),Jo(n.ph,r.targetId),Ds(n,r.targetId)})).catch(No)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Ds(n,r.targetId),[4,Io(n.ju,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Is(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r;return o.__generator(this,(function(i){switch(i.label){case 0:n=S(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Eo(n.ju,e)];case 2:return r=i.sent(),e.zt.forEach((function(t,e){var r=n.kh.get(e);r&&(_(t.ee.size+t.ne.size+t.se.size<=1),t.ee.size>0?r.Vh=!0:t.ne.size>0?_(r.Vh):t.se.size>0&&(_(r.Vh),r.Vh=!1))})),[4,Fs(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,No(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Ts(t,e,n){var r=S(t);if(r.Uh&&0===n||!r.Uh&&1===n){var i=[];r.Nh.forEach((function(t,n){var r=n.view.Qs(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=S(t);n.onlineState=e;var r=!1;n.Bs.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Qs(e)&&(r=!0)})),r&&Vr(n)}(r.bh,e),i.length&&r.Ch.yu(i),r.onlineState=e,r.Uh&&r.Sh.Ki(e)}}function xs(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a,u,c;return o.__generator(this,(function(o){switch(o.label){case 0:return(r=S(t)).Sh.Qi(e,"rejected",n),i=r.kh.get(e),(s=i&&i.key)?(a=(a=new At(k.i)).ot(s,new jn(s,lt.min())),u=Mt().add(s),c=new qt(lt.min(),new Map,new Tt(Z),a,u),[4,Is(r,c)]):[3,2];case 1:return o.sent(),r.$h=r.$h.remove(s),r.kh.delete(e),Ls(r),[3,4];case 2:return[4,Io(r.ju,e,!1).then((function(){return Ds(r,e,n)})).catch(No)];case 3:o.sent(),o.label=4;case 4:return[2]}}))}))}function ks(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:n=S(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,So(n.ju,e)];case 2:return i=o.sent(),Bs(n,r,null),Ns(n,r),n.Sh.ki(r,"acknowledged"),[4,Fs(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,No(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ps(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i;return o.__generator(this,(function(o){switch(o.label){case 0:r=S(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=S(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Sr.Oo(t,e).next((function(e){return _(null!==e),r=e.keys(),n.Sr.Wo(t,e)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Cc.kr(t,r)}))}))}(r.ju,e)];case 2:return i=o.sent(),Bs(r,e,n),Ns(r,e),r.Sh.ki(e,"rejected",n),[4,Fs(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,No(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ns(t,e){(t.Lh.get(e)||[]).forEach((function(t){t.resolve()})),t.Lh.delete(e)}function Bs(t,e,n){var r=S(t),i=r.Oh[r.currentUser.ti()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Oh[r.currentUser.ti()]=i}}function Ds(t,e,n){void 0===n&&(n=null),t.Sh.Bi(e);for(var r=0,i=t.Fh.get(e);r<i.length;r++){var o=i[r];t.Nh.delete(o),n&&t.Ch.Wh(o,n)}t.Fh.delete(e),t.Uh&&t.Mh.Uc(e).forEach((function(e){t.Mh.Ho(e)||Rs(t,e)}))}function Rs(t,e){var n=t.$h.get(e);null!==n&&(Jo(t.ph,n),t.$h=t.$h.remove(e),t.kh.delete(n),Ls(t))}function js(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof bs?(t.Mh.Da(o.key,e),Ms(t,o)):o instanceof ms?(v("SyncEngine","Document no longer in limbo: "+o.key),t.Mh.Na(o.key,e),t.Mh.Ho(o.key)||Rs(t,o.key)):w()}}function Ms(t,e){var n=e.key;t.$h.get(n)||(v("SyncEngine","New document in limbo: "+n),t.xh.push(n),Ls(t))}function Ls(t){for(;t.xh.length>0&&t.$h.size<t.Dh;){var e=t.xh.shift(),n=t.Bh.next();t.kh.set(n,new Ss(e)),t.$h=t.$h.ot(e,n),Qo(t.ph,new _t(Yn(Un(e.path)),n,2,Wr.ai))}}function Fs(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a;return o.__generator(this,(function(u){switch(u.label){case 0:return r=S(t),i=[],s=[],a=[],r.Nh.m()?[3,3]:(r.Nh.forEach((function(t,o){a.push(r.Qh(o,e,n).then((function(t){if(t){r.Uh&&r.Sh.Qi(o.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=ai.zr(o.targetId,t);s.push(e)}})))})),[4,Promise.all(a)]);case 1:return u.sent(),r.Ch.yu(i),[4,function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l,h;return o.__generator(this,(function(o){switch(o.label){case 0:n=S(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return wr.forEach(e,(function(e){return wr.forEach(e.Kr,(function(r){return n.persistence.No.Da(t,e.targetId,r)})).next((function(){return wr.forEach(e.Gr,(function(r){return n.persistence.No.Na(t,e.targetId,r)}))}))}))}))];case 2:return o.sent(),[3,4];case 3:if(!Er(r=o.sent()))throw r;return v("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,s=e;i<s.length;i++)a=s[i],u=a.targetId,a.fromCache||(c=n.bc.get(u),l=c.nt,h=c.rt(l),n.bc=n.bc.ot(u,h));return[2]}}))}))}(r.ju,s)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Us(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r;return o.__generator(this,(function(i){switch(i.label){case 0:return(n=S(t)).currentUser.isEqual(e)?[3,3]:(v("SyncEngine","User change. New user:",e.ti()),[4,function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return n=S(t),r=n.Sr,i=n.Cc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Sr.Uo(t).next((function(s){return o=s,r=n.persistence.mc(e),i=new si(n.Dc,r,n.persistence.Ic()),r.Uo(t)})).next((function(e){for(var n=[],r=[],s=Mt(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var b=g[v];s=s.add(b.key)}}return i.kr(t,s).next((function(t){return{jh:t,Kh:n,Gh:r}}))}))}))];case 1:return s=o.sent(),[2,(n.Sr=r,n.Cc=i,n.Vc.Nc(n.Cc),s)]}}))}))}(n.ju,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Lh.forEach((function(t){t.forEach((function(t){t.reject(new p(f.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Lh.clear()}(n),n.Sh.ji(e,r.Kh,r.Gh),[4,Fs(n,r.jh)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Vs(t,e){var n=S(t),r=n.kh.get(e);if(r&&r.Vh)return Mt().add(r.key);var i=Mt(),o=n.Fh.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Nh.get(u);i=i.kt(c.view.dh)}return i}function zs(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,To((n=S(t)).ju,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ph(r),[2,(n.Uh&&js(n,e.targetId,i.Rh),i)]}}))}))}function qs(t,e,n,r){return o.__awaiter(this,void 0,void 0,(function(){var i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,function(t,e){var n=S(t),r=S(n.Sr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Lo(t,e).next((function(e){return e?n.Cc.kr(t,e):wr.resolve(null)}))}))}((i=S(t)).ju,e)];case 1:return null===(s=o.sent())?[3,6]:"pending"!==n?[3,3]:[4,us(i.ph)];case 2:return o.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Bs(i,e,r||null),Ns(i,e),function(t,e){S(S(t).Sr).Ko(e)}(i.ju,e)):w(),o.label=4;case 4:return[4,Fs(i,s)];case 5:return o.sent(),[3,7];case 6:v("SyncEngine","Cannot apply mutation batch with id: "+e),o.label=7;case 7:return[2]}}))}))}function Ws(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l;return o.__generator(this,(function(o){switch(o.label){case 0:return Js(n=S(t)),Xs(n),!0!==e||!0===n.qh?[3,3]:(r=n.Sh.Ci(),[4,Gs(n,r.A())]);case 1:return i=o.sent(),n.qh=!0,[4,ys(n.ph,!0)];case 2:for(o.sent(),s=0,a=i;s<a.length;s++)u=a[s],Qo(n.ph,u);return[3,7];case 3:return!1!==e||!1===n.qh?[3,7]:(c=[],l=Promise.resolve(),n.Fh.forEach((function(t,e){n.Sh.qi(e)?c.push(e):l=l.then((function(){return Ds(n,e),Io(n.ju,e,!0)})),Jo(n.ph,e)})),[4,l]);case 4:return o.sent(),[4,Gs(n,c)];case 5:return o.sent(),function(t){var e=S(n);e.kh.forEach((function(t,n){Jo(e.ph,n)})),e.Mh.Qc(),e.kh=new Map,e.$h=new At(k.i)}(),n.qh=!1,[4,ys(n.ph,!1)];case 6:o.sent(),o.label=7;case 7:return[2]}}))}))}function Gs(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l,h,f,p,d,y,v;return o.__generator(this,(function(o){switch(o.label){case 0:n=S(t),r=[],i=[],s=0,a=e,o.label=1;case 1:return s<a.length?(u=a[s],c=void 0,(l=n.Fh.get(u))&&0!==l.length?[4,Co(n.ju,Yn(l[0]))]:[3,7]):[3,13];case 2:c=o.sent(),h=0,f=l,o.label=3;case 3:return h<f.length?(p=f[h],d=n.Nh.get(p),[4,zs(n,d)]):[3,6];case 4:(y=o.sent()).snapshot&&i.push(y.snapshot),o.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,xo(n.ju,u)];case 8:return v=o.sent(),[4,Co(n.ju,v)];case 9:return c=o.sent(),[4,As(n,Hs(v),u,!1)];case 10:o.sent(),o.label=11;case 11:r.push(c),o.label=12;case 12:return s++,[3,1];case 13:return[2,(n.Ch.yu(i),r)]}}))}))}function Hs(t){return Fn(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ys(t){var e=S(t);return S(S(e.ju).persistence).pi()}function Ks(t,e,n,r){return o.__awaiter(this,void 0,void 0,(function(){var i,s,a;return o.__generator(this,(function(o){switch(o.label){case 0:return(i=S(t)).qh?(v("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Fh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,ko(i.ju)];case 3:return s=o.sent(),a=qt.Xt(e,"current"===n),[4,Fs(i,s,a)];case 4:return o.sent(),[3,8];case 5:return[4,Io(i.ju,e,!0)];case 6:return o.sent(),Ds(i,e,r),[3,8];case 7:w(),o.label=8;case 8:return[2]}}))}))}function Qs(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a,u,c,l,h,f,p;return o.__generator(this,(function(d){switch(d.label){case 0:if(!(r=Js(t)).qh)return[3,10];i=0,s=e,d.label=1;case 1:return i<s.length?(a=s[i],r.Fh.has(a)?(v("SyncEngine","Adding an already active target "+a),[3,5]):[4,xo(r.ju,a)]):[3,6];case 2:return u=d.sent(),[4,Co(r.ju,u)];case 3:return c=d.sent(),[4,As(r,Hs(u),c.targetId,!1)];case 4:d.sent(),Qo(r.ph,c),d.label=5;case 5:return i++,[3,1];case 6:l=function(t){return o.__generator(this,(function(e){switch(e.label){case 0:return r.Fh.has(t)?[4,Io(r.ju,t,!1).then((function(){Jo(r.ph,t),Ds(r,t)})).catch(No)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,d.label=7;case 7:return h<f.length?(p=f[h],[5,l(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Js(t){var e=S(t);return e.ph.Gu.sh=Is.bind(null,e),e.ph.Gu.qe=Vs.bind(null,e),e.ph.Gu.nh=xs.bind(null,e),e.Ch.yu=Fr.bind(null,e.bh),e.Ch.Wh=Ur.bind(null,e.bh),e}function Xs(t){var e=S(t);return e.ph.Gu.ih=ks.bind(null,e),e.ph.Gu.rh=Ps.bind(null,e),e}var Zs=function(){function t(){}return t.prototype.Nc=function(t){this.zh=t},t.prototype.Lr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.on.length||1===t.on.length&&t.on[0].field.p())}(e)||n.isEqual(lt.min())?this.Hh(t,e):this.zh.kr(t,r).next((function(o){var s=i.Yh(e,o);return(Vn(e)||zn(e))&&i.Eh(e.an,s,r,n)?i.Hh(t,e):(y()<=a.LogLevel.DEBUG&&v("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),$n(e)),i.zh.Lr(t,e,n).next((function(t){return s.forEach((function(e){t=t.ot(e.key,e)})),t})))}))},t.prototype.Yh=function(t,e){var n=new Tt(er(t));return e.forEach((function(e,r){r instanceof Rn&&tr(t,r)&&(n=n.add(r))})),n},t.prototype.Eh=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},t.prototype.Hh=function(t,e){return y()<=a.LogLevel.DEBUG&&v("IndexFreeQueryEngine","Using full collection scan to execute query:",$n(e)),this.zh.Lr(t,e,lt.min())},t}(),$s=function(){function t(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Jh=1,this.Xh=new Tt(Do.kc)}return t.prototype.$o=function(t){return wr.resolve(0===this.Sr.length)},t.prototype.ko=function(t,e,n,r){var i=this.Jh;this.Jh++,this.Sr.length>0&&this.Sr[this.Sr.length-1];var o=new ei(i,e,n,r);this.Sr.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Xh=this.Xh.add(new Do(u.key,i)),this.Dr.Mo(t,u.key.path.h())}return wr.resolve(o)},t.prototype.Oo=function(t,e){return wr.resolve(this.Zh(e))},t.prototype.Bo=function(t,e){var n=e+1,r=this.tl(n),i=r<0?0:r;return wr.resolve(this.Sr.length>i?this.Sr[i]:null)},t.prototype.qo=function(){return wr.resolve(0===this.Sr.length?-1:this.Jh-1)},t.prototype.Uo=function(t){return wr.resolve(this.Sr.slice())},t.prototype.Nr=function(t,e){var n=this,r=new Do(e,0),i=new Do(e,Number.POSITIVE_INFINITY),o=[];return this.Xh.Ft([r,i],(function(t){var e=n.Zh(t.jc);o.push(e)})),wr.resolve(o)},t.prototype.Or=function(t,e){var n=this,r=new Tt(Z);return e.forEach((function(t){var e=new Do(t,0),i=new Do(t,Number.POSITIVE_INFINITY);n.Xh.Ft([e,i],(function(t){r=r.add(t.jc)}))})),wr.resolve(this.el(r))},t.prototype.Wr=function(t,e){var n=e.path,r=n.length+1,i=n;k.F(i)||(i=i.child(""));var o=new Do(new k(i),0),s=new Tt(Z);return this.Xh.xt((function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.jc)),!0)}),o),wr.resolve(this.el(s))},t.prototype.el=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Zh(t);null!==r&&n.push(r)})),n},t.prototype.Wo=function(t,e){var n=this;_(0===this.nl(e.batchId,"removed")),this.Sr.shift();var r=this.Xh;return wr.forEach(e.mutations,(function(i){var o=new Do(i.key,e.batchId);return r=r.delete(o),n.No.Go(t,i.key)})).next((function(){n.Xh=r}))},t.prototype.Ko=function(t){},t.prototype.Ho=function(t,e){var n=new Do(e,0),r=this.Xh.$t(n);return wr.resolve(e.isEqual(r&&r.key))},t.prototype.zo=function(t){return this.Sr.length,wr.resolve()},t.prototype.nl=function(t,e){return this.tl(t)},t.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},t.prototype.Zh=function(t){var e=this.tl(t);return e<0||e>=this.Sr.length?null:this.Sr[e]},t}(),ta=function(){function t(t,e){this.Dr=t,this.sl=e,this.docs=new At(k.i),this.size=0}return t.prototype.Er=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:s,readTime:n}),this.size+=s-o,this.Dr.Mo(t,r.path.h())},t.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Rr=function(t,e){var n=this.docs.get(e);return wr.resolve(n?n.ta:null)},t.prototype.getEntries=function(t,e){var n=this,r=Nt();return e.forEach((function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)})),wr.resolve(r)},t.prototype.Lr=function(t,e,n){for(var r=Dt(),i=new k(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),a=s.key,u=s.value,c=u.ta,l=u.readTime;if(!e.path.T(a.path))break;l.L(n)<=0||c instanceof Rn&&tr(e,c)&&(r=r.ot(c.key,c))}return wr.resolve(r)},t.prototype.il=function(t,e){return wr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.ra=function(t){return new ea(this)},t.prototype.aa=function(t){return wr.resolve(this.size)},t}(),ea=function(t){function e(e){var n=this;return(n=t.call(this)||this).ca=e,n}return o.__extends(e,t),e.prototype.yr=function(t){var e=this,n=[];return this.wr.forEach((function(r,i){i?n.push(e.ca.Er(t,i,e.readTime)):e.ca.Ar(r)})),wr.$n(n)},e.prototype.gr=function(t,e){return this.ca.Rr(t,e)},e.prototype.Pr=function(t,e){return this.ca.getEntries(t,e)},e}(ri),na=function(){function t(t){this.persistence=t,this.rl=new ut((function(t){return vt(t)}),gt),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.ol=0,this.al=new Bo,this.targetCount=0,this.cl=ao.fa()}return t.prototype.Ce=function(t,e){return this.rl.forEach((function(t,n){return e(n)})),wr.resolve()},t.prototype.Ea=function(t){return wr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ia=function(t){return wr.resolve(this.ol)},t.prototype.wa=function(t){return this.highestTargetId=this.cl.next(),wr.resolve(this.highestTargetId)},t.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),wr.resolve()},t.prototype.ga=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cl=new ao(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},t.prototype.Ra=function(t,e){return this.ga(e),this.targetCount+=1,wr.resolve()},t.prototype.ya=function(t,e){return this.ga(e),wr.resolve()},t.prototype.Va=function(t,e){return this.rl.delete(e.target),this.al.Uc(e.targetId),this.targetCount-=1,wr.resolve()},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return this.rl.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.rl.delete(s),o.push(r.pa(t,a.targetId)),i++)})),wr.$n(o).next((function(){return i}))},t.prototype.ba=function(t){return wr.resolve(this.targetCount)},t.prototype.va=function(t,e){var n=this.rl.get(e)||null;return wr.resolve(n)},t.prototype.Sa=function(t,e,n){return this.al.Lc(e,n),wr.resolve()},t.prototype.Ca=function(t,e,n){this.al.qc(e,n);var r=this.persistence.No,i=[];return r&&e.forEach((function(e){i.push(r.Go(t,e))})),wr.$n(i)},t.prototype.pa=function(t,e){return this.al.Uc(e),wr.resolve()},t.prototype.Fa=function(t,e){var n=this.al.Wc(e);return wr.resolve(n)},t.prototype.Ho=function(t,e){return wr.resolve(this.al.Ho(e))},t}(),ra=function(){function t(t){var e=this;this.ul={},this.Ma=new Wr(0),this.Oa=!1,this.Oa=!0,this.No=t(this),this.Ka=new na(this),this.Dr=new Ui,this.vr=function(t,n){return new ta(t,(function(t){return e.No.hl(t)}))}(this.Dr)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Di=function(){return this.Oa=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),t.prototype.Za=function(){},t.prototype.tc=function(){},t.prototype.Ic=function(){return this.Dr},t.prototype.mc=function(t){var e=this.ul[t.ti()];return e||(e=new $s(this.Dr,this.No),this.ul[t.ti()]=e),e},t.prototype.Tc=function(){return this.Ka},t.prototype.Ec=function(){return this.vr},t.prototype.runTransaction=function(t,e,n){var r=this;v("MemoryPersistence","Starting transaction:",t);var i=new ia(this.Ma.next());return this.No.ll(),n(i).next((function(t){return r.No._l(i).next((function(){return t}))})).Fn().then((function(t){return i.br(),t}))},t.prototype.fl=function(t,e){return wr.kn(Object.values(this.ul).map((function(n){return function(){return n.Ho(t,e)}})))},t}(),ia=function(t){function e(e){var n=this;return(n=t.call(this)||this).xa=e,n}return o.__extends(e,t),e}(oi),oa=function(){function t(t){this.persistence=t,this.dl=new Bo,this.wl=null}return t.ml=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw w()},enumerable:!1,configurable:!0}),t.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),wr.resolve()},t.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),wr.resolve()},t.prototype.Go=function(t,e){return this.Tl.add(e.toString()),wr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.dl.Uc(e.targetId).forEach((function(t){return n.Tl.add(t.toString())}));var r=this.persistence.Tc();return r.Fa(t,e.targetId).next((function(t){t.forEach((function(t){return n.Tl.add(t.toString())}))})).next((function(){return r.Va(t,e)}))},t.prototype.ll=function(){this.wl=new Set},t.prototype._l=function(t){var e=this,n=this.persistence.Ec().ra();return wr.forEach(this.Tl,(function(r){var i=k.D(r);return e.El(t,i).next((function(t){t||n.Ar(i)}))})).next((function(){return e.wl=null,n.apply(t)}))},t.prototype.yc=function(t,e){var n=this;return this.El(t,e).next((function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())}))},t.prototype.hl=function(t){return 0},t.prototype.El=function(t,e){var n=this;return wr.kn([function(){return wr.resolve(n.dl.Ho(e))},function(){return n.persistence.Tc().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},t}(),sa=function(){function t(t){this.Il=t.Il,this.Al=t.Al}return t.prototype.gu=function(t){this.Rl=t},t.prototype.Tu=function(t){this.gl=t},t.prototype.onMessage=function(t){this.Pl=t},t.prototype.close=function(){this.Al()},t.prototype.send=function(t){this.Il(t)},t.prototype.yl=function(){this.Rl()},t.prototype.Vl=function(t){this.gl(t)},t.prototype.pl=function(t){this.Pl(t)},t}(),aa={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ua=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.W=e.W,n}return o.__extends(e,t),e.prototype.Nl=function(t,e,n,r){return new Promise((function(i,o){var s=new c.XhrIo;s.listenOnce(c.EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case c.ErrorCode.NO_ERROR:var e=s.getResponseJson();v("Connection","XHR received:",JSON.stringify(e)),i(e);break;case c.ErrorCode.TIMEOUT:v("Connection",'RPC "'+t+'" timed out'),o(new p(f.DEADLINE_EXCEEDED,"Request time out"));break;case c.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(v("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=r.status.toLowerCase().replace("_","-");return Object.values(f).indexOf(e)>=0?e:f.UNKNOWN}();o(new p(a,r.message))}else o(new p(f.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new p(f.UNAVAILABLE,"Connection failed."));break;default:w()}}finally{v("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Pu=function(t,e){var n=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=c.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.W};this.Cl(i.initMessageHeaders,e),u.isMobileCordova()||u.isReactNative()||u.isElectron()||u.isIE()||u.isUWP()||u.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");v("Connection","Creating WebChannel: "+o,i);var s=r.createWebChannel(o,i),a=!1,l=!1,h=new sa({Il:function(t){l?v("Connection","Not sending because WebChannel is closed:",t):(a||(v("Connection","Opening WebChannel transport."),s.open(),a=!0),v("Connection","WebChannel sending:",t),s.send(t))},Al:function(){return s.close()}}),d=function(t,e){s.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return d(c.WebChannel.EventType.OPEN,(function(){l||v("Connection","WebChannel transport opened.")})),d(c.WebChannel.EventType.CLOSE,(function(){l||(l=!0,v("Connection","WebChannel transport closed"),h.Vl())})),d(c.WebChannel.EventType.ERROR,(function(t){l||(l=!0,b("Connection","WebChannel transport errored:",t),h.Vl(new p(f.UNAVAILABLE,"The operation could not be completed")))})),d(c.WebChannel.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];_(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){v("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=mt[o];if(void 0!==e)return Et(e)}(),u=i.message;void 0===a&&(a=f.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vl(new p(a,u)),s.close()}else v("Connection","WebChannel received:",n),h.pl(n)}})),setTimeout((function(){h.yl()}),0),h},e}(function(){function t(t){this.bl=t,this.U=t.U;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}return t.prototype.$u=function(t,e,n,r){var i=this.Dl(t,e);v("RestConnection","Sending: ",i,n);var o={};return this.Cl(o,r),this.Nl(t,i,o,n).then((function(t){return v("RestConnection","Received: ",t),t}),(function(e){throw b("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.ku=function(t,e,n,r){return this.$u(t,e,n,r)},t.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0",t["Content-Type"]="text/plain",e)for(var n in e.Kc)e.Kc.hasOwnProperty(n)&&(t[n]=e.Kc[n])},t.prototype.Dl=function(t,e){var n=aa[t];return this.vl+"/v1/"+e+":"+n},t}()),ca=function(){function t(){var t=this;this.Fl=function(){return t.xl()},this.$l=function(){return t.kl()},this.Ml=[],this.Ol()}return t.prototype.Zu=function(t){this.Ml.push(t)},t.prototype.Di=function(){window.removeEventListener("online",this.Fl),window.removeEventListener("offline",this.$l)},t.prototype.Ol=function(){window.addEventListener("online",this.Fl),window.addEventListener("offline",this.$l)},t.prototype.xl=function(){v("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},t.prototype.kl=function(){v("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},t.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),la=function(){function t(){}return t.prototype.Zu=function(t){},t.prototype.Di=function(){},t}();function ha(t){return new we(t,!0)}var fa="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",pa=function(){function t(){}return t.prototype.initialize=function(t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.Sh=this.Ll(t),this.persistence=this.Bl(t),[4,this.persistence.start()];case 1:return e.sent(),this.ql=this.Ul(t),this.ju=this.Ql(t),[2]}}))}))},t.prototype.Ul=function(t){return null},t.prototype.Ql=function(t){return e=this.persistence,n=new Zs,r=t.Wl,new _o(e,n,r);var e,n,r},t.prototype.Bl=function(t){if(t.persistenceSettings.jl)throw new p(f.FAILED_PRECONDITION,fa);return new ra(oa.ml)},t.prototype.Ll=function(t){return new ti},t.prototype.terminate=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Sh.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}}))}))},t.prototype.clearPersistence=function(t,e){throw new p(f.FAILED_PRECONDITION,fa)},t}(),da=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.initialize=function(e){return o.__awaiter(this,void 0,void 0,(function(){var n,r=this;return o.__generator(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Kl.fi,this.Sh instanceof $r?(this.Sh.fi={er:qs.bind(null,n),nr:Ks.bind(null,n),sr:Qs.bind(null,n),pi:Ys.bind(null,n)},[4,this.Sh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Xa((function(t){return o.__awaiter(r,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,Ws(this.Kl.fi,t)];case 1:return e.sent(),this.ql&&(t&&!this.ql.Ei?this.ql.start(this.ju):t||this.ql.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Ll=function(t){if(t.persistenceSettings.jl&&t.persistenceSettings.synchronizeTabs){var e=kr();if(!$r.Ln(e))throw new p(f.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=wo(t.bl.U,t.bl.persistenceKey);return new $r(e,t.cs,n,t.clientId,t.Wl)}return new ti},e}(function(t){function e(e){var n=this;return(n=t.call(this)||this).Kl=e,n}return o.__extends(e,t),e.prototype.initialize=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Po(this.ju)];case 2:return n.sent(),[4,this.Kl.initialize(this,e)];case 3:return n.sent(),[4,Xs(this.Kl.fi)];case 4:return n.sent(),[4,us(this.Kl.ph)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ul=function(t){var e=this.persistence.No.wo;return new fi(e,t.cs)},e.prototype.Bl=function(t){var e=wo(t.bl.U,t.bl.persistenceKey),n=ha(t.bl.U);return new yo(t.persistenceSettings.synchronizeTabs,e,t.clientId,hi.ao(t.persistenceSettings.cacheSizeBytes),t.cs,kr(),Pr(),n,this.Sh,t.persistenceSettings.ka)},e.prototype.Ll=function(t){return new ti},e.prototype.clearPersistence=function(t,e){return function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return _r.Ln()?(e=t+"main",[4,_r.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(wo(t,e))},e}(pa)),ya=function(){function t(){}return t.prototype.initialize=function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n=this;return o.__generator(this,(function(r){switch(r.label){case 0:return this.ju?[3,2]:(this.ju=t.ju,this.Sh=t.Sh,this.Ku=this.Gl(e),this.ph=this.zl(e),this.bh=this.Hl(e),this.fi=this.Yl(e),this.Sh.di=function(t){return Ts(n.fi,t,1)},this.ph.Gu.Jl=Us.bind(null,this.fi),[4,ys(this.ph,this.fi.Uh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.Hl=function(t){return new jr},t.prototype.Gl=function(t){var e,n=ha(t.bl.U),r=(e=t.bl,new ua(e));return function(t,e,n){return new qo(t,r,n)}(t.credentials,0,n)},t.prototype.zl=function(t){var e,n,r,i,o,s=this;return e=this.ju,n=this.Ku,r=t.cs,i=function(t){return Ts(s.fi,t,0)},o=ca.Ln()?new ca:new la,new Go(e,n,r,i,o)},t.prototype.Yl=function(t){return function(t,e,n,r,i,o,s){var a=new Os(t,e,n,r,i,o);return s&&(a.qh=!0),a}(this.ju,this.ph,this.bh,this.Sh,t.Wl,t.Dh,!t.persistenceSettings.jl||!t.persistenceSettings.synchronizeTabs)},t.prototype.terminate=function(){return Ko(this.ph)},t}(),va=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Xl(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Xl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Zl=function(){this.muted=!0},t.prototype.Xl=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),ga=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new p(f.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Q(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(R("FieldPath","string",e,t[e]),0===t[e].length)throw new p(f.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t_=new x(t)},ba=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return o.__extends(e,t),e.documentId=function(){return new e(x.v().R())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw H("isEqual","FieldPath",1,t);return this.t_.isEqual(t.t_)},e}(ga),ma=new RegExp("[~\\*/\\[\\]]"),wa=function(t){this.e_=t},_a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.n_=function(t){if(2!==t.s_)throw 1===t.s_?t.i_(this.e_+"() can only appear at the top level of your update data"):t.i_(this.e_+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(wa);function Sa(t,e,n){return new Da({s_:3,r_:e.settings.r_,methodName:t.e_,o_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var Oa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.n_=function(t){return new pn(t.path,new rn)},e.prototype.isEqual=function(t){return t instanceof e},e}(wa),Ea=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return o.__extends(e,t),e.prototype.n_=function(t){var e=Sa(this,t,!0),n=this.a_.map((function(t){return Ua(t,e)})),r=new on(n);return new pn(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(wa),Aa=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return o.__extends(e,t),e.prototype.n_=function(t){var e=Sa(this,t,!0),n=this.a_.map((function(t){return Ua(t,e)})),r=new an(n);return new pn(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(wa),Ca=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).c_=n,r}return o.__extends(e,t),e.prototype.n_=function(t){var e=new cn(t.serializer,Oe(t.serializer,this.c_));return new pn(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(wa),Ia=function(){function t(t,e){if(N("GeoPoint",arguments,2),R("GeoPoint","number",1,t),R("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new p(f.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new p(f.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.u_=t,this.h_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.u_===t.u_&&this.h_===t.h_},t.prototype.toJSON=function(){return{latitude:this.u_,longitude:this.h_}},t.prototype.Y=function(t){return Z(this.u_,t.u_)||Z(this.h_,t.h_)},t}(),Ta=function(t){this.l_=t},xa=/^__.*__$/,ka=function(t,e,n){this.__=t,this.f_=e,this.d_=n},Pa=function(){function t(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}return t.prototype.w_=function(t,e){var n=[];return null!==this.We?n.push(new En(t,this.data,this.We,e)):n.push(new On(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Cn(t,this.fieldTransforms)),n},t}(),Na=function(){function t(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}return t.prototype.w_=function(t,e){var n=[new En(t,this.data,this.We,e)];return this.fieldTransforms.length>0&&n.push(new Cn(t,this.fieldTransforms)),n},t}();function Ba(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw w()}}var Da=function(){function t(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.m_(),this.fieldTransforms=i||[],this.We=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"s_",{get:function(){return this.settings.s_},enumerable:!1,configurable:!0}),t.prototype.T_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},t.prototype.E_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.T_({path:n,o_:!1});return r.I_(t),r},t.prototype.A_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.T_({path:n,o_:!1});return r.m_(),r},t.prototype.R_=function(t){return this.T_({path:void 0,o_:!0})},t.prototype.i_=function(t){return Ha(t,this.settings.methodName,this.settings.g_||!1,this.path,this.settings.r_)},t.prototype.contains=function(t){return void 0!==this.We.find((function(e){return t.T(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.T(e.field)}))},t.prototype.m_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},t.prototype.I_=function(t){if(0===t.length)throw this.i_("Document fields must not be empty");if(Ba(this.s_)&&xa.test(t))throw this.i_('Document fields cannot begin and end with "__"')},t}(),Ra=function(){function t(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||ha(t)}return t.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Da({s_:t,methodName:e,r_:n,path:x.P(),o_:!1,g_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},t}();function ja(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);qa("Data must be an object, but it was:",s,r);var a,u,c=Va(r,s);if(o.merge)a=new fn(s.We),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,d=o.mergeFields;h<d.length;h++){var y=d[h],v=void 0;if(y instanceof ga)v=y.t_;else{if("string"!=typeof y)throw w();v=Ga(e,y,n)}if(!s.contains(v))throw new p(f.INVALID_ARGUMENT,"Field '"+v+"' is specified in your field mask but missing from your input data.");Ya(l,v)||l.push(v)}a=new fn(l),u=s.fieldTransforms.filter((function(t){return a.Ye(t.field)}))}else a=null,u=s.fieldTransforms;return new Pa(new Pn(c),a,u)}function Ma(t,e,n,r){var i=t.P_(1,e,n);qa("Data must be an object, but it was:",i,r);var o=[],s=new Nn;E(r,(function(t,r){var a=Ga(e,t,n),u=i.A_(a);if(r instanceof _a||r instanceof Ta&&r.l_ instanceof _a)o.push(a);else{var c=Ua(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new fn(o);return new Na(s.Xe(),a,i.fieldTransforms)}function La(t,e,n,r,i,o){var s=t.P_(1,e,n),a=[Wa(e,r,n)],u=[i];if(o.length%2!=0)throw new p(f.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Wa(e,o[c])),u.push(o[c+1]);for(var l=[],h=new Nn,d=a.length-1;d>=0;--d)if(!Ya(l,a[d])){var y=a[d],v=u[d],g=s.A_(y);if(v instanceof _a||v instanceof Ta&&v.l_ instanceof _a)l.push(y);else{var b=Ua(v,g);null!=b&&(l.push(y),h.set(y,b))}}var m=new fn(l);return new Na(h.Xe(),m,s.fieldTransforms)}function Fa(t,e,n,r){return void 0===r&&(r=!1),Ua(n,t.P_(r?4:3,e))}function Ua(t,e){if(t instanceof Ta&&(t=t.l_),za(t))return qa("Unsupported field value:",e,t),Va(t,e);if(t instanceof wa)return function(t,e){if(!Ba(e.s_))throw e.i_(t.e_+"() can only be used with update() and set()");if(!e.path)throw e.i_(t.e_+"() is not currently supported inside arrays");var n=t.n_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.We.push(e.path),t instanceof Array){if(e.settings.o_&&4!==e.s_)throw e.i_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Ua(o[i],e.R_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Oe(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ct.fromDate(t);return{timestampValue:Ee(e.serializer,n)}}if(t instanceof ct){var r=new ct(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ee(e.serializer,r)}}if(t instanceof Ia)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof nt)return{bytesValue:Ae(e.serializer,t.q)};if(t instanceof ka){var i=e.U,o=t.__;if(!o.isEqual(i))throw e.i_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Te(t.__||e.U,t.f_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.i_("Unsupported field value: "+q(t))}(t,e)}function Va(t,e){var n={};return A(t)?e.path&&e.path.length>0&&e.We.push(e.path):E(t,(function(t,r){var i=Ua(r,e.E_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function za(t){return!("object"!=i(t)||null===t||t instanceof Array||t instanceof Date||t instanceof ct||t instanceof Ia||t instanceof nt||t instanceof ka||t instanceof wa)}function qa(t,e,n){if(!za(n)||!z(n)){var r=q(n);throw"an object"===r?e.i_(t+" a custom object"):e.i_(t+" "+r)}}function Wa(t,e,n){if(e instanceof ga)return e.t_;if("string"==typeof e)return Ga(t,e);throw Ha("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ga(t,e,n){try{return function(t){if(t.search(ma)>=0)throw new p(f.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ba.bind.apply(ba,o.__spreadArrays([void 0],t.split("."))))}catch(e){throw new p(f.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).t_}catch(e){throw Ha((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function Ha(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new p(f.INVALID_ARGUMENT,(a+=". ")+t+u)}function Ya(t,e){return t.some((function(t){return t.isEqual(e)}))}var Ka=function(){function t(t){this.Ku=t,this.y_=new Map,this.mutations=[],this.V_=!1,this.p_=null,this.b_=new Set}return t.prototype.v_=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n=this;return o.__generator(this,(function(r){switch(r.label){case 0:if(this.S_(),this.mutations.length>0)throw new p(f.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a,u;return o.__generator(this,(function(o){switch(o.label){case 0:return n=S(t),r=De(n.serializer)+"/documents",i={documents:e.map((function(t){return ke(n.serializer,t)}))},[4,n.ku("BatchGetDocuments",r,i)];case 1:return s=o.sent(),a=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){_(!!e.found),e.found.name,e.found.updateTime;var n=Pe(t,e.found.name),r=Ie(e.found.updateTime),i=new Pn({mapValue:{fields:e.found.fields}});return new Rn(n,r,i,{})}(t,e):"missing"in e?function(t,e){_(!!e.missing),_(!!e.readTime);var n=Pe(t,e.missing),r=Ie(e.readTime);return new jn(n,r)}(t,e):w()}(n.serializer,t);a.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=a.get(t.toString());_(!!e),u.push(e)})),u)]}}))}))}(this.Ku,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof jn||t instanceof Rn?n.D_(t):w()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.w_(t,this.Ge(t))),this.b_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.w_(t,this.C_(t)))}catch(t){this.p_=t}this.b_.add(t.toString())},t.prototype.delete=function(t){this.write([new xn(t,this.Ge(t))]),this.b_.add(t.toString())},t.prototype.commit=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e=this;return o.__generator(this,(function(n){switch(n.label){case 0:if(this.S_(),this.p_)throw this.p_;return t=this.y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=k.D(n);e.mutations.push(new kn(r,e.Ge(r)))})),[4,function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return n=S(t),r=De(n.serializer)+"/documents",i={writes:e.map((function(t){return Me(n.serializer,t)}))},[4,n.$u("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Ku,this.mutations)];case 1:return n.sent(),this.V_=!0,[2]}}))}))},t.prototype.D_=function(t){var e;if(t instanceof Rn)e=t.version;else{if(!(t instanceof jn))throw w();e=lt.min()}var n=this.y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new p(f.ABORTED,"Document version changed between two reads.")}else this.y_.set(t.key.toString(),e)},t.prototype.Ge=function(t){var e=this.y_.get(t.toString());return!this.b_.has(t.toString())&&e?yn.updateTime(e):yn.ze()},t.prototype.C_=function(t){var e=this.y_.get(t.toString());if(!this.b_.has(t.toString())&&e){if(e.isEqual(lt.min()))throw new p(f.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return yn.updateTime(e)}return yn.exists(!0)},t.prototype.write=function(t){this.S_(),this.mutations=this.mutations.concat(t)},t.prototype.S_=function(){},t}(),Qa=function(){function t(t,e,n,r){this.cs=t,this.Ku=e,this.updateFunction=n,this.ls=r,this.N_=5,this.ys=new mr(this.cs,"transaction_retry")}return t.prototype.run=function(){this.F_()},t.prototype.F_=function(){var t=this;this.ys.gn((function(){return o.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return o.__generator(this,(function(r){return t=new Ka(this.Ku),(e=this.x_(t))&&e.then((function(e){n.cs.ws((function(){return t.commit().then((function(){n.ls.resolve(e)})).catch((function(t){n.k_(t)}))}))})).catch((function(t){n.k_(t)})),[2]}))}))}))},t.prototype.x_=function(t){try{var e=this.updateFunction(t);return!ht(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},t.prototype.k_=function(t){var e=this;this.N_>0&&this.M_(t)?(this.N_-=1,this.cs.ws((function(){return e.F_(),Promise.resolve()}))):this.ls.reject(t)},t.prototype.M_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ot(e)}return!1},t}(),Ja=function(){function t(t,e){this.credentials=t,this.cs=e,this.clientId=X.k(),this.O_=new br}return t.prototype.start=function(t,e,n,r){var i=this;this.L_(),this.bl=t;var s=new br,a=!1;return this.credentials.Hc((function(t){if(!a)return a=!0,v("FirestoreClient","Initializing. user=",t.uid),i.B_(e,n,r,t,s).then(i.O_.resolve,i.O_.reject);i.cs.Cs((function(){return function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r;return o.__generator(this,(function(i){switch(i.label){case 0:return(n=S(t)).cs.xs(),v("RemoteStore","RemoteStore received new credentials"),r=es(n),n.Yu.add(3),[4,Yo(n)];case 1:return i.sent(),r&&n.th.set("Unknown"),[4,n.Gu.Jl(e)];case 2:return i.sent(),n.Yu.delete(3),[4,Ho(n)];case 3:return i.sent(),[2]}}))}))}(i.ph,t)}))})),this.cs.ws((function(){return i.O_.promise})),s.promise},t.prototype.enableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue((function(){return t.persistence.tc(!0),function(t){var e=S(t);return e.Yu.delete(0),Ho(e)}(t.ph)}))},t.prototype.B_=function(t,e,n,r,i){return o.__awaiter(this,void 0,void 0,(function(){var s,a,u=this;return o.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),s={cs:this.cs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Wl:r,Dh:100,persistenceSettings:n},[4,t.initialize(s)];case 1:return c.sent(),[4,e.initialize(t,s)];case 2:return c.sent(),this.persistence=t.persistence,this.Sh=t.Sh,this.ju=t.ju,this.ql=t.ql,this.Ku=e.Ku,this.ph=e.ph,this.fi=e.fi,this.q_=e.bh,this.q_.Us=Es.bind(null,this.fi),this.q_.js=Cs.bind(null,this.fi),this.persistence.Za((function(){return o.__awaiter(u,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),i.resolve(),[3,4];case 3:if(a=c.sent(),i.reject(a),!this.U_(a))throw a;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),this.B_(new pa,new ya,{jl:!1},r,i))];case 4:return[2]}}))}))},t.prototype.U_=function(t){return"FirebaseError"===t.name?t.code===f.FAILED_PRECONDITION||t.code===f.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.L_=function(){if(this.cs.ps)throw new p(f.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue((function(){return t.persistence.tc(!1),function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return(e=S(t)).Yu.add(0),[4,Yo(e)];case 1:return n.sent(),e.th.set("Offline"),[2]}}))}))}(t.ph)}))},t.prototype.terminate=function(){var t=this;this.cs.Ds();var e=new br;return this.cs.bs((function(){return o.__awaiter(t,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Ko(this.ph)];case 1:return r.sent(),[4,this.Sh.Di()];case 2:return r.sent(),[4,this.persistence.Di()];case 3:return r.sent(),this.credentials.Yc(),e.resolve(),[3,5];case 4:return t=r.sent(),n=Dr(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.L_();var e=new br;return this.cs.ws((function(){return function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s,a;return o.__generator(this,(function(o){switch(o.label){case 0:es((n=S(t)).ph)||v("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,function(t){var e=S(n.ju);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Sr.qo(t)}))}()];case 2:return-1===(r=o.sent())?[2,void e.resolve()]:((i=n.Lh.get(r)||[]).push(e),n.Lh.set(r,i),[3,4]);case 3:return s=o.sent(),a=Dr(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}(t.fi,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.L_();var i=new va(n),o=new zr(t,i,e);return this.cs.ws((function(){return Mr(r.q_,o)})),function(){i.Zl(),r.cs.ws((function(){return Lr(r.q_,o)}))}},t.prototype.Q_=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n=this;return o.__generator(this,(function(r){switch(r.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return r.sent(),e=new br,[2,(this.cs.ws((function(){return function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=S(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Cc.Cr(t,e)}))}(t,e)];case 1:return(r=o.sent())instanceof Rn?n.resolve(r):r instanceof jn?n.resolve(null):n.reject(new p(f.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=o.sent(),s=Dr(i,"Failed to get document '"+e+" from cache"),n.reject(s),[3,3];case 3:return[2]}}))}))}(n.ju,t,e)})),e.promise)]}}))}))},t.prototype.W_=function(t,e){return void 0===e&&(e={}),o.__awaiter(this,void 0,void 0,(function(){var n,r=this;return o.__generator(this,(function(i){switch(i.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return i.sent(),n=new br,[2,(this.cs.ws((function(){return function(t,e,n,r,i){var o=new va({next:function(o){e.ws((function(){return Lr(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new p(f.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new p(f.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new zr(Un(n.path),o,{includeMetadataChanges:!0,Xs:!0});return Mr(t,s)}(r.q_,r.cs,t,e,n)})),n.promise)]}}))}))},t.prototype.j_=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n=this;return o.__generator(this,(function(r){switch(r.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return r.sent(),e=new br,[2,(this.cs.ws((function(){return function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a,u,c;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,To(t,e,!0)];case 1:return r=o.sent(),i=new ws(e,r.Fc),s=i.wh(r.documents),a=i.yr(s,!1),n.resolve(a.snapshot),[3,3];case 2:return u=o.sent(),c=Dr(u,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))}(n.ju,t,e)})),e.promise)]}}))}))},t.prototype.K_=function(t,e){return void 0===e&&(e={}),o.__awaiter(this,void 0,void 0,(function(){var n,r=this;return o.__generator(this,(function(i){switch(i.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return i.sent(),n=new br,[2,(this.cs.ws((function(){return function(t,e,n,r,i){var o=new va({next:function(n){e.ws((function(){return Lr(t,s)})),n.fromCache&&"server"===r.source?i.reject(new p(f.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new zr(n,o,{includeMetadataChanges:!0,Xs:!0});return Mr(t,s)}(r.q_,r.cs,t,e,n)})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.L_();var n=new br;return this.cs.ws((function(){return function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a;return o.__generator(this,(function(o){switch(o.label){case 0:r=Xs(t),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,function(t,e){var n,r=S(t),i=ct.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Mt());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Cc.kr(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=wn(c,n.get(c.key));null!=l&&s.push(new En(c.key,l,Bn(l.proto.mapValue),yn.exists(!0)))}return r.Sr.ko(t,i,s,e)}))})).then((function(t){var e=t.lr(n);return{batchId:t.batchId,wr:e}}))}(r.ju,e)];case 2:return i=o.sent(),r.Sh.xi(i.batchId),function(t,e,n){var r=t.Oh[t.currentUser.ti()];r||(r=new At(Z)),r=r.ot(e,n),t.Oh[t.currentUser.ti()]=r}(r,i.batchId,n),[4,Fs(r,i.wr)];case 3:return o.sent(),[4,us(r.ph)];case 4:return o.sent(),[3,6];case 5:return s=o.sent(),a=Dr(s,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}(e.fi,t,n)})),n.promise},t.prototype.U=function(){return this.bl.U},t.prototype.G_=function(t){var e=this;this.L_();var n=new va(t);return this.cs.ws((function(){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(t){return[2,function(t,e){S(t).qs.add(e),e.next()}(this.q_,n)]}))}))})),function(){n.Zl(),e.cs.ws((function(){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(t){return[2,function(t,e){S(t).qs.delete(e)}(this.q_,n)]}))}))}))}},Object.defineProperty(t.prototype,"z_",{get:function(){return this.cs.ps},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.L_();var n=new br;return this.cs.ws((function(){return new Qa(e.cs,e.Ku,t,n).run(),Promise.resolve()})),n.promise},t}();function Xa(t){return function(t,e){if("object"!=i(t)||null===t)return!1;for(var n=t,r=0,o=["next","error","complete"];r<o.length;r++){var s=o[r];if(s in n&&"function"==typeof n[s])return!0}return!1}(t)}var Za=function(){function t(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.H_=n,this.Y_=r,this.J_=i}return t.prototype.X_=function(t){switch(ne(t)){case 0:return null;case 1:return t.booleanValue;case 2:return le(t.integerValue||t.doubleValue);case 3:return this.Z_(t.timestampValue);case 4:return this.tf(t);case 5:return t.stringValue;case 6:return this.J_(he(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue);case 10:return this.if(t.mapValue);default:throw w()}},t.prototype.if=function(t){var e=this,n={};return E(t.fields||{},(function(t,r){n[t]=e.X_(r)})),n},t.prototype.nf=function(t){return new Ia(le(t.latitude),le(t.longitude))},t.prototype.sf=function(t){var e=this;return(t.values||[]).map((function(t){return e.X_(t)}))},t.prototype.tf=function(t){switch(this.H_){case"previous":var e=$t(t);return null==e?null:this.X_(e);case"estimate":return this.Z_(te(t));default:return null}},t.prototype.Z_=function(t){var e=ce(t),n=new ct(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.ef=function(t){var e=I.g(t);_(Ze(e));var n=new at(e.get(1),e.get(3)),r=new k(e.u(5));return n.isEqual(this.U)||g("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Y_(r)},t}(),$a=hi.ho,tu=function(){function t(t){var e,n,r,i,o;if(void 0===t.host){if(void 0!==t.ssl)throw new p(f.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else M("settings","non-empty string","host",t.host),this.host=t.host,L("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(G("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),L("settings","object","credentials",t.credentials),this.credentials=t.credentials,L("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),L("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?g("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&g("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,L("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=hi._o;else{if(t.cacheSizeBytes!==$a&&t.cacheSizeBytes<hi.lo)throw new p(f.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+hi.lo);this.cacheSizeBytes=t.cacheSizeBytes}L("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i,L("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(o=t.experimentalAutoDetectLongPolling)&&void 0!==o&&o,function(t,e,n,r){if(!0===e&&!0===r)throw new p(f.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),eu=function(){function t(e,n,r,s){var a=this;if(void 0===r&&(r=new pa),void 0===s&&(s=new ya),this.rf=r,this.af=s,this.cf=null,this.uf=new Br,this.INTERNAL={delete:function(){return o.__awaiter(a,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.hf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==i(e.options)){var u=e;this.cf=u,this.__=t._f(u),this.ff=u.name,this.df=new Mo(n)}else{var c=e;if(!c.projectId)throw new p(f.INVALID_ARGUMENT,"Must provide projectId");this.__=new at(c.projectId,c.database),this.ff="[DEFAULT]",this.df=new jo}this.wf=new tu({})}return Object.defineProperty(t.prototype,"mf",{get:function(){return this.Tf||(this.Tf=new Ra(this.__,this.wf.ignoreUndefinedProperties)),this.Tf},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){N("Firestore.settings",arguments,1),R("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.wf),t)).merge;var e=new tu(t);if(this.lf&&!this.wf.isEqual(e))throw new p(f.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.wf=e,void 0!==e.credentials&&(this.df=function(t){if(!t)return new jo;switch(t.type){case"gapi":var e=t.client;return _(!("object"!=i(e)||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Fo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new p(f.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.hf(),this.lf.enableNetwork()},t.prototype.disableNetwork=function(){return this.hf(),this.lf.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.lf)throw new p(f.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&g("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new p(f.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ef(this.rf,this.af,{jl:!0,cacheSizeBytes:this.wf.cacheSizeBytes,synchronizeTabs:r,ka:i})},t.prototype.clearPersistence=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e=this;return o.__generator(this,(function(n){if(void 0!==this.lf&&!this.lf.z_)throw new p(f.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new br,[2,(this.uf.bs((function(){return o.__awaiter(e,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.rf.clearPersistence(this.__,this.ff)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"If",{get:function(){return this.hf(),this.lf.z_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.hf(),this.lf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.hf(),Xa(t))return this.lf.G_(t);R("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.lf.G_(e)},t.prototype.hf=function(){return this.lf||this.Ef(new pa,new ya,{jl:!1}),this.lf},t.prototype.Af=function(){return new st(this.__,this.ff,this.wf.host,this.wf.ssl,this.wf.experimentalForceLongPolling,this.wf.experimentalAutoDetectLongPolling)},t.prototype.Ef=function(t,e,n){var r=this.Af();return this.lf=new Ja(this.df,this.uf),this.lf.start(r,t,e,n)},t._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new p(f.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new p(f.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new at(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.cf)throw new p(f.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return N("Firestore.collection",arguments,1),R("Firestore.collection","non-empty string",1,t),this.hf(),new vu(I.g(t),this,null)},t.prototype.doc=function(t){return N("Firestore.doc",arguments,1),R("Firestore.doc","non-empty string",1,t),this.hf(),iu.Rf(I.g(t),this,null)},t.prototype.collectionGroup=function(t){if(N("Firestore.collectionGroup",arguments,1),R("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new p(f.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new du(function(t){return new Ln(I.P(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return N("Firestore.runTransaction",arguments,1),R("Firestore.runTransaction","function",1,t),this.hf().transaction((function(n){return t(new nu(e,n))}))},t.prototype.batch=function(){return this.hf(),new ru(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(y()){case a.LogLevel.DEBUG:return"debug";case a.LogLevel.ERROR:return"error";case a.LogLevel.SILENT:return"silent";case a.LogLevel.WARN:return"warn";case a.LogLevel.INFO:return"info";case a.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;N("Firestore.setLogLevel",arguments,1),U("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,d.setLogLevel(e)},t.prototype.gf=function(){return this.wf.timestampsInSnapshots},t.prototype.Pf=function(){return this.wf},t}(),nu=function(){function t(t,e){this.yf=t,this.Vf=e}return t.prototype.get=function(t){var e=this;N("Transaction.get",arguments,1);var n=wu("Transaction.get",t,this.yf);return this.Vf.v_([n.f_]).then((function(t){if(!t||1!==t.length)return w();var r=t[0];if(r instanceof jn)return new su(e.yf,n.f_,null,!1,!1,n.d_);if(r instanceof Rn)return new su(e.yf,n.f_,r,!1,!1,n.d_);throw w()}))},t.prototype.set=function(t,e,n){D("Transaction.set",arguments,2,3);var r=wu("Transaction.set",t,this.yf);n=gu("Transaction.set",n);var i=Su(r.d_,e,n),o=ja(this.yf.mf,"Transaction.set",r.f_,i,null!==r.d_,n);return this.Vf.set(r.f_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof ba?(B("Transaction.update",arguments,3),r=wu("Transaction.update",t,this.yf),i=La(this.yf.mf,"Transaction.update",r.f_,e,n,o)):(N("Transaction.update",arguments,2),r=wu("Transaction.update",t,this.yf),i=Ma(this.yf.mf,"Transaction.update",r.f_,e)),this.Vf.update(r.f_,i),this},t.prototype.delete=function(t){N("Transaction.delete",arguments,1);var e=wu("Transaction.delete",t,this.yf);return this.Vf.delete(e.f_),this},t}(),ru=function(){function t(t){this.yf=t,this.pf=[],this.bf=!1}return t.prototype.set=function(t,e,n){D("WriteBatch.set",arguments,2,3),this.vf();var r=wu("WriteBatch.set",t,this.yf);n=gu("WriteBatch.set",n);var i=Su(r.d_,e,n),o=ja(this.yf.mf,"WriteBatch.set",r.f_,i,null!==r.d_,n);return this.pf=this.pf.concat(o.w_(r.f_,yn.ze())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.vf(),"string"==typeof e||e instanceof ba?(B("WriteBatch.update",arguments,3),r=wu("WriteBatch.update",t,this.yf),i=La(this.yf.mf,"WriteBatch.update",r.f_,e,n,o)):(N("WriteBatch.update",arguments,2),r=wu("WriteBatch.update",t,this.yf),i=Ma(this.yf.mf,"WriteBatch.update",r.f_,e)),this.pf=this.pf.concat(i.w_(r.f_,yn.exists(!0))),this},t.prototype.delete=function(t){N("WriteBatch.delete",arguments,1),this.vf();var e=wu("WriteBatch.delete",t,this.yf);return this.pf=this.pf.concat(new xn(e.f_,yn.ze())),this},t.prototype.commit=function(){return this.vf(),this.bf=!0,this.pf.length>0?this.yf.hf().write(this.pf):Promise.resolve()},t.prototype.vf=function(){if(this.bf)throw new p(f.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),iu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.__,e,r)||this).f_=e,i.firestore=n,i.d_=r,i.lf=i.firestore.hf(),i}return o.__extends(e,t),e.Rf=function(t,n,r){if(t.length%2!=0)throw new p(f.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new e(new k(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new vu(this.f_.path.h(),this.firestore,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.f_.path.R()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(N("DocumentReference.collection",arguments,1),R("DocumentReference.collection","non-empty string",1,t),!t)throw new p(f.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=I.g(t);return new vu(this.f_.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw H("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.f_.isEqual(t.f_)&&this.d_===t.d_},e.prototype.set=function(t,e){D("DocumentReference.set",arguments,1,2),e=gu("DocumentReference.set",e);var n=Su(this.d_,t,e),r=ja(this.firestore.mf,"DocumentReference.set",this.f_,n,null!==this.d_,e);return this.lf.write(r.w_(this.f_,yn.ze()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof ba?(B("DocumentReference.update",arguments,2),n=La(this.firestore.mf,"DocumentReference.update",this.f_,t,e,r)):(N("DocumentReference.update",arguments,1),n=Ma(this.firestore.mf,"DocumentReference.update",this.f_,t)),this.lf.write(n.w_(this.f_,yn.exists(!0)))},e.prototype.delete=function(){return N("DocumentReference.delete",arguments,0),this.lf.write([new xn(this.f_,yn.ze())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];D("DocumentReference.onSnapshot",arguments,1,4);var a={includeMetadataChanges:!1},u=0;"object"!=i(o[u])||Xa(o[u])||(G("DocumentReference.onSnapshot",a=o[u],["includeMetadataChanges"]),L("DocumentReference.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++);var c={includeMetadataChanges:a.includeMetadataChanges};if(Xa(o[u])){var l=o[u];o[u]=null===(t=l.next)||void 0===t?void 0:t.bind(l),o[u+1]=null===(e=l.error)||void 0===e?void 0:e.bind(l),o[u+2]=null===(n=l.complete)||void 0===n?void 0:n.bind(l)}else R("DocumentReference.onSnapshot","function",u,o[u]),j("DocumentReference.onSnapshot","function",u+1,o[u+1]),j("DocumentReference.onSnapshot","function",u+2,o[u+2]);var h={next:function(t){o[u]&&o[u](r.Sf(t))},error:o[u+1],complete:o[u+2]};return this.lf.listen(Un(this.f_.path),c,h)},e.prototype.get=function(t){var e=this;D("DocumentReference.get",arguments,0,1),mu("DocumentReference.get",t);var n=this.firestore.hf();return t&&"cache"===t.source?n.Q_(this.f_).then((function(t){return new su(e.firestore,e.f_,t,!0,t instanceof Rn&&t.Je,e.d_)})):n.W_(this.f_,t).then((function(t){return e.Sf(t)}))},e.prototype.withConverter=function(t){return new e(this.f_,this.firestore,t)},e.prototype.Sf=function(t){var e=t.docs.get(this.f_);return new su(this.firestore,this.f_,e,t.fromCache,t.hasPendingWrites,this.d_)},e}(ka),ou=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),su=function(){function t(t,e,n,r,i,o){this.yf=t,this.f_=e,this.Df=n,this.Cf=r,this.Nf=i,this.d_=o}return t.prototype.data=function(t){var e=this;if(D("DocumentSnapshot.data",arguments,0,1),t=bu("DocumentSnapshot.data",t),this.Df){if(this.d_){var n=new au(this.yf,this.f_,this.Df,this.Cf,this.Nf,null);return this.d_.fromFirestore(n,t)}return new Za(this.yf.__,this.yf.gf(),t.serverTimestamps||"none",(function(t){return new iu(t,e.yf,null)}),(function(t){return new ot(t)})).X_(this.Df.rn())}},t.prototype.get=function(t,e){var n=this;if(D("DocumentSnapshot.get",arguments,1,2),e=bu("DocumentSnapshot.get",e),this.Df){var r=this.Df.data().field(Wa("DocumentSnapshot.get",t,this.f_));if(null!==r)return new Za(this.yf.__,this.yf.gf(),e.serverTimestamps||"none",(function(t){return new iu(t,n.yf,n.d_)}),(function(t){return new ot(t)})).X_(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new iu(this.f_,this.yf,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new ou(this.Nf,this.Cf)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","DocumentSnapshot",1,e);return this.yf===e.yf&&this.Cf===e.Cf&&this.f_.isEqual(e.f_)&&(null===this.Df?null===e.Df:this.Df.isEqual(e.Df))&&this.d_===e.d_},t}(),au=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(su);function uu(t,e,n,r,i,o,s){var a;if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new p(f.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){hu(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(lu(r,t,h))}a={arrayValue:{values:u}}}else a=lu(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||hu(s,o),a=Fa(n,e,s,"in"===o||"not-in"===o);var d=nr.create(i,o,a);return function(t,e){if(e.hn()){var n=Wn(t);if(null!==n&&!n.isEqual(e.field))throw new p(f.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=qn(t);null!==r&&fu(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new p(f.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new p(f.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,d),d}function cu(t,e,n){if(null!==t.startAt)throw new p(f.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new p(f.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new yr(e,n);return function(t,e){if(null===qn(t)){var n=Wn(t);null!==n&&fu(0,n,e.field)}}(t,r),r}function lu(t,e,n){if("string"==typeof n){if(""===n)throw new p(f.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Gn(e)&&-1!==n.indexOf("/"))throw new p(f.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(I.g(n));if(!k.F(r))throw new p(f.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return fe(t,new k(r))}if(n instanceof ka)return fe(t,n.f_);throw new p(f.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+q(n)+".")}function hu(t,e){if(!Array.isArray(t)||0===t.length)throw new p(f.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new p(f.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new p(f.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new p(f.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function fu(t,e,n){if(!n.isEqual(e))throw new p(f.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function pu(t){if(zn(t)&&0===t.on.length)throw new p(f.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var du=function(){function t(t,e,n){this.Ff=t,this.firestore=e,this.d_=n}return t.prototype.where=function(e,n,r){N("Query.where",arguments,3),W("Query.where",3,r);var i=U("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,n),o=Wa("Query.where",e),s=uu(this.Ff,"Query.where",this.firestore.mf,this.firestore.__,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new Ln(t.path,t.collectionGroup,t.on.slice(),n,t.limit,t.an,t.startAt,t.endAt)}(this.Ff,s),this.firestore,this.d_)},t.prototype.orderBy=function(e,n){var r;if(D("Query.orderBy",arguments,1,2),j("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new p(f.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Wa("Query.orderBy",e),o=cu(this.Ff,i,r);return new t(function(t,e){var n=t.on.concat([e]);return new Ln(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(this.Ff,o),this.firestore,this.d_)},t.prototype.limit=function(e){return N("Query.limit",arguments,1),R("Query.limit","number",1,e),Y("Query.limit",1,e),new t(Kn(this.Ff,e,"F"),this.firestore,this.d_)},t.prototype.limitToLast=function(e){return N("Query.limitToLast",arguments,1),R("Query.limitToLast","number",1,e),Y("Query.limitToLast",1,e),new t(Kn(this.Ff,e,"L"),this.firestore,this.d_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];B("Query.startAt",arguments,1);var i=this.xf("Query.startAt",e,n,!0);return new t(Qn(this.Ff,i),this.firestore,this.d_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];B("Query.startAfter",arguments,1);var i=this.xf("Query.startAfter",e,n,!1);return new t(Qn(this.Ff,i),this.firestore,this.d_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];B("Query.endBefore",arguments,1);var i=this.xf("Query.endBefore",e,n,!0);return new t(Jn(this.Ff,i),this.firestore,this.d_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];B("Query.endAt",arguments,1);var i=this.xf("Query.endAt",e,n,!1);return new t(Jn(this.Ff,i),this.firestore,this.d_)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","Query",1,e);return this.firestore===e.firestore&&Xn(this.Ff,e.Ff)&&this.d_===e.d_},t.prototype.withConverter=function(e){return new t(this.Ff,this.firestore,e)},t.prototype.xf=function(t,e,n,r){if(W(t,1,e),e instanceof su)return N(t,o.__spreadArrays([e],n),1),function(t,e,n,r,i){if(!r)throw new p(f.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Hn(t);s<a.length;s++){var u=a[s];if(u.field.p())o.push(fe(e,r.key));else{var c=r.field(u.field);if(Zt(c))throw new p(f.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.R();throw new p(f.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new hr(o,i)}(this.Ff,this.firestore.__,t,e.Df,r);var s=[e].concat(n);return function(t,e,n,r,o,s){var a=t.on;if(o.length>a.length)throw new p(f.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],c=0;c<o.length;c++){var l=o[c];if(a[c].field.p()){if("string"!=typeof l)throw new p(f.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+i(l));if(!Gn(t)&&-1!==l.indexOf("/"))throw new p(f.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+l+"' contains a slash.");var h=t.path.child(I.g(l));if(!k.F(h))throw new p(f.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var d=new k(h);u.push(fe(e,d))}else{var y=Fa(n,r,l);u.push(y)}}return new hr(u,s)}(this.Ff,this.firestore.__,this.firestore.mf,t,s,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];D("Query.onSnapshot",arguments,1,4);var a={},u=0;if("object"!=i(o[u])||Xa(o[u])||(G("Query.onSnapshot",a=o[u],["includeMetadataChanges"]),L("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),Xa(o[u])){var c=o[u];o[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),o[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),o[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else R("Query.onSnapshot","function",u,o[u]),j("Query.onSnapshot","function",u+1,o[u+1]),j("Query.onSnapshot","function",u+2,o[u+2]);var l={next:function(t){o[u]&&o[u](new yu(r.firestore,r.Ff,t,r.d_))},error:o[u+1],complete:o[u+2]};return pu(this.Ff),this.firestore.hf().listen(this.Ff,a,l)},t.prototype.get=function(t){var e=this;D("Query.get",arguments,0,1),mu("Query.get",t),pu(this.Ff);var n=this.firestore.hf();return(t&&"cache"===t.source?n.j_(this.Ff):n.K_(this.Ff,t)).then((function(t){return new yu(e.firestore,e.Ff,t,e.d_)}))},t}(),yu=function(){function t(t,e,n,r){this.yf=t,this.$f=e,this.kf=n,this.d_=r,this.Mf=null,this.Of=null,this.metadata=new ou(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.kf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.kf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;D("QuerySnapshot.forEach",arguments,1,2),R("QuerySnapshot.forEach","function",1,t),this.kf.docs.forEach((function(r){t.call(e,n.Lf(r,n.metadata.fromCache,n.kf.Wt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new du(this.$f,this.yf,this.d_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(G("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),L("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.kf.Kt)throw new p(f.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mf&&this.Of===e||(this.Mf=function(t,e,n){if(t.Qt.m()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.Wt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Qt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Wt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:_u(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.kf,e,this.Lf.bind(this)),this.Of=e),this.Mf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","QuerySnapshot",1,e);return this.yf===e.yf&&Xn(this.$f,e.$f)&&this.kf.isEqual(e.kf)&&this.d_===e.d_},t.prototype.Lf=function(t,e,n){return new au(this.yf,t.key,t,e,n,this.d_)},t}(),vu=function(t){function e(e,n,r){var i=this;if((i=t.call(this,Un(e),n,r)||this).Bf=e,e.length%2!=1)throw new p(f.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.R()+" has "+e.length);return i}return o.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Ff.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Ff.path.h();return t.m()?null:new iu(new k(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Ff.path.R()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){D("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=X.k()),R("CollectionReference.doc","non-empty string",1,t);var e=I.g(t);return iu.Rf(this.Ff.path.child(e),this.firestore,this.d_)},e.prototype.add=function(t){N("CollectionReference.add",arguments,1);var e=this.d_?this.d_.toFirestore(t):t;R("CollectionReference.add","object",1,e);var n=this.doc();return new iu(n.f_,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Bf,this.firestore,t)},e}(du);function gu(t,e){if(void 0===e)return{merge:!1};if(G(t,e,["merge","mergeFields"]),L(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+q(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new p(f.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+q(r[o]))}(t,"mergeFields",0,r,(function(t){return"string"==typeof t||t instanceof ba}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new p(f.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function bu(t,e){return void 0===e?{}:(G(t,e,["serverTimestamps"]),F(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function mu(t,e){j(t,"object",1,e),e&&(G(t,e,["source"]),F(t,0,"source",e.source,["default","server","cache"]))}function wu(t,e,n){if(e instanceof ka){if(e.firestore!==n)throw new p(f.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw H(t,"DocumentReference",1,e)}function _u(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return w()}}function Su(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ou=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.serverTimestamp=function(){P("FieldValue.serverTimestamp",arguments);var t=new Oa("serverTimestamp");return t.e_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){P("FieldValue.delete",arguments);var t=new _a("deleteField");return t.e_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];B("FieldValue.arrayUnion",arguments,1);var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return B("arrayUnion()",arguments,1),new Ea("arrayUnion",t)}.apply(void 0,t);return r.e_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];B("FieldValue.arrayRemove",arguments,1);var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return B("arrayRemove()",arguments,1),new Aa("arrayRemove",t)}.apply(void 0,t);return r.e_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){R("FieldValue.increment","number",1,t),N("FieldValue.increment",arguments,1);var n=function(t){return new Ca("increment",t)}(t);return n.e_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.l_.isEqual(t.l_)},e}(Ta),Eu={Firestore:eu,GeoPoint:Ia,Timestamp:ct,Blob:ot,Transaction:nu,WriteBatch:ru,DocumentReference:iu,DocumentSnapshot:su,Query:du,QueryDocumentSnapshot:au,QuerySnapshot:yu,CollectionReference:vu,FieldPath:ba,FieldValue:Ou,setLogLevel:eu.setLogLevel,CACHE_SIZE_UNLIMITED:$a};function Au(t){!function(t,e){t.INTERNAL.registerComponent(new l.Component("firestore",(function(t){return function(t,e){var n=new ya,r=new da(n);return new eu(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Eu)))}(t),t.registerVersion("@firebase/firestore","1.18.0")}Au(h.default),n.__PRIVATE_registerFirestore=Au},{tslib:"f2sD","@firebase/app":"dP58","@firebase/logger":"TUpU","@firebase/util":"xA6u","@firebase/webchannel-wrapper":"ueHA","@firebase/component":"nzQs",process:"pBGv"}],vHL5:[function(t,e,n){"use strict";t("@firebase/firestore")},{"@firebase/firestore":"eA7g"}],TX5A:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.config={apiKey:"AIzaSyB0TkZ83Fj0CIzn8AAmE-Osc92s3ER8hy8",authDomain:"neurosity-device.firebaseapp.com",databaseURL:"https://neurosity-device.firebaseio.com",projectId:"neurosity-device",storageBucket:"neurosity-device.appspot.com",messagingSenderId:"212595049674"}},{}],OERo:[function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=o(t("firebase/app"));t("firebase/database"),t("firebase/auth"),t("firebase/functions"),t("firebase/firestore");var a=t("./config");n.SERVER_TIMESTAMP=s.default.database.ServerValue.TIMESTAMP;var u=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.app=this.getApp(e.deviceId),this.standalone=this.app.name===e.deviceId}return function(t,e,n){e&&i(t.prototype,e)}(t,[{key:"getApp",value:function(t){var e=s.default.apps,n="undefined"!=typeof window&&"firebase"in window&&"apps"in window.firebase?window.firebase.apps:[],i=[].concat(r(e),r(n)).find((function(t){return"[DEFAULT]"===t.name&&t.options.databaseURL===a.config.databaseURL}));if(i)return i;if(t){var o=t;return e.find((function(t){return t.name===o}))||s.default.initializeApp(a.config,o)}return s.default.initializeApp(a.config)}},{key:"goOnline",value:function(){this.app.database().goOnline()}},{key:"goOffline",value:function(){this.app.database().goOffline()}},{key:"disconnect",value:function(){return this.standalone?this.app.delete():Promise.resolve()}}]),t}();n.FirebaseApp=u},{"firebase/app":"ZUoI","firebase/database":"Uuoh","firebase/auth":"zKjx","firebase/functions":"a7Bh","firebase/firestore":"vHL5","./config":"TX5A"}],Cc51:[function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t,e,n){return(a=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&u(i,n.prototype),i}).apply(null,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var h=t("rxjs"),f=t("rxjs/operators"),p=l(t("firebase/app")),d=p.default.database.ServerValue.TIMESTAMP;n.credentialWithLink=p.default.auth.EmailAuthProvider.credentialWithLink,n.createUser=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a(p.default.User,e)};var y=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.app=e.app,this.app.auth().onAuthStateChanged((function(t){n.user=t}))}return function(t,e,n){e&&o(t.prototype,e)}(t,[{key:"auth",value:function(){return this.app.auth()}},{key:"onAuthStateChanged",value:function(){var t=this;return new h.Observable((function(e){t.app.auth().onAuthStateChanged((function(t){e.next(t)}))}))}},{key:"onLogin",value:function(){var t=this;return new h.Observable((function(e){var n=t.app.auth().onAuthStateChanged((function(t){t&&(e.next(t),e.complete())}));return function(){return n()}}))}},{key:"login",value:function(t){if("idToken"in t&&"providerId"in t){var e=new p.default.auth.OAuthProvider(t.providerId).credential(t.idToken);return this.app.auth().signInWithCredential(e)}if("email"in t&&"password"in t){var n=t.email,r=t.password;return this.app.auth().signInWithEmailAndPassword(n,r)}throw new Error("Either email/password or an idToken/providerId is required")}},{key:"logout",value:function(){return this.app.auth().signOut()}},{key:"getDevices",value:function(){var t;return c(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this.user)||void 0===t?void 0:t.uid){e.next=3;break}return e.abrupt("return",Promise.reject("Please login."));case 3:return e.next=5,this.app.database().ref(this.getUserDevicesPath()).once("value");case 5:return n=e.sent,r=n.val(),e.abrupt("return",this.userDevicesToDeviceInfoList(r));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"addDevice",value:function(t){var e;return c(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,s,a,u,c,l,h,f,p,y,v,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=null===(e=this.user)||void 0===e?void 0:e.uid){n.next=3;break}return n.abrupt("return",Promise.reject("Please login."));case 3:return n.next=5,this.isDeviceIdValid(t).then((function(t){return[t]})).catch((function(t){return[!1,t]}));case 5:if(a=n.sent,u=i(a,2),c=u[0],l=u[1],c){n.next=11;break}return n.abrupt("return",Promise.reject(l));case 11:return h=this.getDeviceClaimedByPath(t),f=this.getUserClaimedDevicePath(t),n.next=15,this.app.database().ref().update((o={},r(o,h,s),r(o,f,{claimedOn:d}),o)).then((function(){return[!1]})).catch((function(t){return[!0,t]}));case 15:if(p=n.sent,y=i(p,2),v=y[0],g=y[1],!v){n.next=21;break}return n.abrupt("return",Promise.reject(g));case 21:case"end":return n.stop()}}),n,this)})))}},{key:"removeDevice",value:function(t){var e;return c(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s,a,u,c,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(e=this.user)||void 0===e?void 0:e.uid){n.next=3;break}return n.abrupt("return",Promise.reject("Please login."));case 3:return r=this.getDeviceClaimedByPath(t),o=this.getUserClaimedDevicePath(t),s=this.app.database().ref(r),a=this.app.database().ref(o),n.next=9,Promise.all([s.remove(),a.remove()]).then((function(){return[!1]})).catch((function(t){return[!0,t]}));case 9:if(u=n.sent,c=i(u,2),l=c[0],h=c[1],!l){n.next=15;break}return n.abrupt("return",Promise.reject(h));case 15:case"end":return n.stop()}}),n,this)})))}},{key:"isDeviceIdValid",value:function(t){return c(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=/[0-9A-Fa-f]{32}/g,t&&32===t.length&&n.test(t)){e.next=3;break}return e.abrupt("return",Promise.reject("The device id is incorrectly formatted."));case 3:return r=this.getDeviceClaimedByPath(t),i=this.app.database().ref(r),e.next=7,i.once("value").catch((function(){return null}));case 7:if((o=e.sent)&&!o.exists()){e.next=10;break}return e.abrupt("return",Promise.reject("The device has already been claimed."));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"onUserDevicesChange",value:function(){var t=this;return this.onAuthStateChanged().pipe(f.switchMap((function(e){if(!e)return h.empty();var n=t.getUserDevicesPath(),r=t.app.database().ref(n);return h.fromEventPattern((function(t){return r.on("value",t)}),(function(t){return r.off("value",t)})).pipe(f.map((function(t){return t.val()})),f.switchMap((function(e){return h.from(t.userDevicesToDeviceInfoList(e))})))})))}},{key:"userDevicesToDeviceInfoList",value:function(t){return c(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.keys(null!=t?t:{}).map((function(t){return o.app.database().ref(o.getDeviceInfoPath(t)).once("value")})),e.next=3,Promise.all(n).then((function(t){return t.map((function(t){return t.val()}))}));case 3:return r=e.sent,(i=r.filter((function(t){return!!t}))).sort((function(e,n){return t[e.deviceId].claimedOn-t[n.deviceId].claimedOn})),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))}},{key:"hasDevicePermission",value:function(t){return c(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getDeviceInfoPath(t),e.next=3,this.app.database().ref(n).once("value").then((function(){return!0})).catch((function(){return!1}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getDeviceClaimedByPath",value:function(t){return"devices/".concat(t,"/status/claimedBy")}},{key:"getUserClaimedDevicePath",value:function(t){var e=this.user.uid;return"users/".concat(e,"/devices/").concat(t)}},{key:"getUserDevicesPath",value:function(){var t=this.user.uid;return"users/".concat(t,"/devices")}},{key:"getDeviceInfoPath",value:function(t){return"devices/".concat(t,"/info")}}]),t}();n.FirebaseUser=y},{rxjs:"iRqj","rxjs/operators":"cVrl","firebase/app":"ZUoI"}],mSvX:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=o(t("firebase/app")).default.database.ServerValue.TIMESTAMP;n.createDeviceStore=function(t,e,n){var o=t.database().ref("devices/".concat(e)),a=o.child("subscriptions").push().key,u=o.child("clients/".concat(a)),c=[],l=function(t,e){return o.child(t).set(e)},h=function(t,e){return o.child(t).update(e)},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"value",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=o.child(e).on(t,(function(t){n(t.val(),t)}));return c.push((function(){o.child(e).off(t,r)})),r},p=function(t,e,n){n?o.child(t).off(e,n):o.child(t).off(e)},d=t.database().ref(".info/connected").on("value",(function(t){t.val()&&u.onDisconnect().remove().then((function(){u.set(s),h("subscriptions",n.get()).then((function(){n.toList().forEach((function(t){var e="subscriptions/".concat(t.id);o.child(e).onDisconnect().remove()}))}))}))}));return c.push((function(){t.database().ref(".info/connected").off("value",d)})),{set:l,once:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";return i(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.child(t).once(e);case 2:return r=n.sent,n.abrupt("return",r.val());case 4:case"end":return n.stop()}}),n)})))},update:h,lastOfChildValue:function(t,e,n){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function i(){var s,a,u,c,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.child(t).orderByChild(e).equalTo(n).limitToLast(1).once("value");case 2:return s=i.sent,a=s.val(),u=Object.values(a||{}),c=r(u,1),l=c[0],i.abrupt("return",l||null);case 6:case"end":return i.stop()}}),i)})))},onNamespace:function(t,e){return f("value",t,(function(t){e(t)}))},offNamespace:function(t,e){p(t,"value",e)},dispatchAction:function(t){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,s,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c=t,o.child("actions").push(c);case 2:if(n=e.sent,r=n.key,i="actions/".concat(r),n.onDisconnect().remove(),!t.responseRequired){e.next=11;break}return s=t.responseTimeout||6e5,a=new Promise((function(t,e){var r=setTimeout((function(){clearTimeout(r),n.remove(),e("Action response timed out in ".concat(s,"ms."))}),s)})),u=new Promise((function(t){var e,n,r;e="value",n="".concat(i,"/response"),r=t,f(e,n,(function(t){null!==t&&(p(n,e),r(t))}))})),e.abrupt("return",Promise.race([u,a]));case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}var c}),e)})))},nextMetric:function(t,e){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l("metrics/".concat(t),e);case 1:case"end":return n.stop()}}),n)})))},onMetric:function(t,e){var n=t.atomic,r=t.metric,i=t.labels,o=n?"metrics/".concat(r):"metrics/".concat(r,"/").concat(i[0]);return f("value",o,(function(t){null!==t&&e(t)}))},subscribeToMetric:function(t){var e=o.child("subscriptions").push().key,n="subscriptions/".concat(e),r=Object.assign({id:e,clientId:a},t);return l(n,r),o.child(n).onDisconnect().remove(),r},unsubscribeFromMetric:function(t){var e;e="subscriptions/".concat(t.id),o.child(e).remove()},removeMetricListener:function(t,e){var n=t.atomic,r=t.metric,i=t.labels,o=n?"metrics/".concat(r):"metrics/".concat(r,"/").concat(i[0]);p(o,"value",e)},disconnect:function(){u.remove(),c.forEach((function(t){t()})),n.toList().filter((function(t){return t.clientId===a})).forEach((function(t){var e="subscriptions/".concat(t.id);o.child(e).remove()}))}}}},{"firebase/app":"ZUoI"}],KzOJ:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=s(t("firebase/app")),u=t("./deviceStore"),c=a.default.database.ServerValue.TIMESTAMP,l=function(){function t(e){var n=e.deviceId,r=e.firebaseApp,i=e.dependencies;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.app=r.app,this.deviceStore=u.createDeviceStore(this.app,n,i.subscriptionManager)}return i(t,[{key:"dispatchAction",value:function(t){return this.deviceStore.dispatchAction(t)}},{key:"getInfo",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deviceStore.once("info");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"onNamespace",value:function(t,e){return this.deviceStore.onNamespace(t,e)}},{key:"onceNamespace",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deviceStore.once(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"offNamespace",value:function(t,e){this.deviceStore.offNamespace(t,e)}},{key:"getTimesync",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dispatchAction({command:"timesync",action:"get",responseRequired:!0,responseTimeout:250});case 2:return e=t.sent,t.abrupt("return",e.timestamp);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"nextMetric",value:function(t,e){this.deviceStore.nextMetric(t,e)}},{key:"onMetric",value:function(t,e){return this.deviceStore.onMetric(t,e)}},{key:"subscribeToMetric",value:function(t){return this.deviceStore.subscribeToMetric(t)}},{key:"unsubscribeFromMetric",value:function(t){this.deviceStore.unsubscribeFromMetric(t)}},{key:"removeMetricListener",value:function(t,e){this.deviceStore.removeMetricListener(t,e)}},{key:"changeSettings",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deviceStore.update("settings",t));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getSkill",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deviceStore.lastOfChildValue("skills","bundleId",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"disconnect",value:function(){this.deviceStore.disconnect()}},{key:"timestamp",get:function(){return c}}]),t}();n.FirebaseDevice=l,l.serverType="firebase"},{"firebase/app":"ZUoI","./deviceStore":"mSvX"}],kM30:[function(t,e,n){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),r(t("./FirebaseApp")),r(t("./FirebaseUser")),r(t("./FirebaseDevice"))},{"./FirebaseApp":"OERo","./FirebaseUser":"Cc51","./FirebaseDevice":"KzOJ"}],imeZ:[function(t,e,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){var e=t,n=t.indexOf("["),o=t.indexOf("]");-1!=n&&-1!=o&&(t=t.substring(0,n)+t.substring(n,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=r.exec(t||""),a={},u=14;u--;)a[i[u]]=s[u]||"";return-1!=n&&-1!=o&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],IAgR:[function(t,e,n){var r=1e3,i=60*r,o=60*i,s=24*o;function a(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function u(t){return t>=s?Math.round(t/s)+"d":t>=o?Math.round(t/o)+"h":t>=i?Math.round(t/i)+"m":t>=r?Math.round(t/r)+"s":t+"ms"}function c(t){return l(t,s,"day")||l(t,o,"hour")||l(t,i,"minute")||l(t,r,"second")||t+" ms"}function l(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}e.exports=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return a(t);if("number"===n&&!1===isNaN(t))return e.long?c(t):u(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],y5CM:[function(t,e,n){function r(t){var e;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(e||i);t.diff=o,t.prev=e,t.curr=i,e=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return e;u++;var i=n.formatters[r];if("function"==typeof i){var o=s[u];e=i.call(t,o),s.splice(u,1),u--}return e})),n.formatArgs.call(t,s),(r.log||n.log||console.log.bind(console)).apply(t,s)}}return r.namespace=t,r.enabled=n.enabled(t),r.useColors=n.useColors(),r.color=function(t){var e,r=0;for(e in t)r=(r<<5)-r+t.charCodeAt(e),r|=0;return n.colors[Math.abs(r)%n.colors.length]}(t),r.destroy=i,"function"==typeof n.init&&n.init(r),n.instances.push(r),r}function i(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}(n=e.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){n.enable("")},n.enable=function(t){var e;n.save(t),n.names=[],n.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(e=0;e<i;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(e=0;e<n.instances.length;e++){var o=n.instances[e];o.enabled=n.enabled(o.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=t("ms"),n.instances=[],n.names=[],n.skips=[],n.formatters={}},{ms:"IAgR"}],jcLW:[function(t,e,n){t("process");var r=t("process");function i(){var t;try{t=n.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=void 0),t}(n=e.exports=t("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+n.humanize(this.diff),e){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))})),t.splice(o,0,r)}},n.save=function(t){try{null==t?n.storage.removeItem("debug"):n.storage.debug=t}catch(t){}},n.load=i,n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},n.enable(i())},{"./debug":"y5CM",process:"pBGv"}],ECAZ:[function(t,e,n){var r=t("parseuri"),i=t("debug")("socket.io-client:url");e.exports=function(t,e){var n=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),i("parse %s",t),n=r(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(e&&e.port===n.port?"":":"+n.port),n}},{parseuri:"imeZ",debug:"jcLW"}],Wr69:[function(t,e,n){function r(t){if(t)return i(t)}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}void 0!==e&&(e.exports=r),r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],REa7:[function(t,e,n){var r={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},{}],yh9p:[function(t,e,n){"use strict";n.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},n.toByteArray=function(t){var e,n,r=c(t),s=r[0],a=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e),1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u},n.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(h(t,s,s+16383>a?a:s+16383));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function h(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(l(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],JgNJ:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*y}},{}],dskh:[function(t,e,n){var r=arguments[3],i=t("base64-js"),o=t("ieee754"),s=t("isarray");function a(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function u(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(u()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return h(this,t,e,n)}function h(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?g(t,e,n,r):"string"==typeof e?y(t,e,n):b(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function p(t,e,n,r){return f(e),e<=0?c(t,e):void 0!==n?"string"==typeof r?c(t,e).fill(n,r):c(t,e).fill(n):c(t,e)}function d(t,e){if(f(e),t=c(t,e<0?0:0|m(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function y(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|_(e,n),i=(t=c(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}function v(t,e){var n=e.length<0?0:0|m(e.length);t=c(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function g(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=v(t,e),t}function b(t,e){if(l.isBuffer(e)){var n=0|m(e.length);return 0===(t=c(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||nt(e.length)?c(t,0):v(t,e);if("Buffer"===e.type&&s(e.data))return v(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(t){if(t>=u())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u().toString(16)+" bytes");return 0|t}function w(t){return+t!=t&&(t=0),l.alloc(+t)}function _(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return tt(t).length;default:if(r)return X(t).length;e=(""+e).toLowerCase(),r=!0}}function S(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return B(this,e,n);case"ascii":return j(this,e,n);case"latin1":case"binary":return M(this,e,n);case"base64":return N(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function O(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function E(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:A(t,e,n,r,i);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):A(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function A(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function C(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function I(t,e,n,r){return et(X(e,t.length-n),t,n,r)}function T(t,e,n,r){return et(Z(e),t,n,r)}function x(t,e,n,r){return T(t,e,n,r)}function k(t,e,n,r){return et(tt(e),t,n,r)}function P(t,e,n,r){return et($(e,t.length-n),t,n,r)}function N(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function B(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return R(r)}n.Buffer=l,n.SlowBuffer=w,n.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:a(),n.kMaxLength=u(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return h(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return p(null,t,e,n)},l.allocUnsafe=function(t){return d(null,t)},l.allocUnsafeSlow=function(t){return d(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},l.byteLength=_,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)O(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)O(this,e,e+3),O(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)O(this,e,e+7),O(this,e+1,e+6),O(this,e+2,e+5),O(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?B(this,0,t):S.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,i){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),u=this.slice(r,i),c=t.slice(e,n),h=0;h<a;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return E(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return E(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return C(this,t,e,n);case"utf8":case"utf-8":return I(this,t,e,n);case"ascii":return T(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function R(t){var e=t.length;if(e<=D)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=D));return n}function j(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function M(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function L(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=J(t[o]);return i}function F(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function U(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function V(t,e,n,r,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function z(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function q(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function W(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function G(t,e,n,r,i){return i||W(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function H(t,e,n,r,i){return i||W(t,0,n,8),o.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var i=e-t;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUInt8=function(t,e){return e||U(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||U(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||U(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||U(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||U(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||U(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||U(t,4,this.length),o.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||U(t,4,this.length),o.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||U(t,8,this.length),o.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||U(t,8,this.length),o.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||V(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||V(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):z(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):z(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):q(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):q(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);V(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);V(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):z(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):z(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):q(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||V(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):q(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return G(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return G(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return H(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return H(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=l.isBuffer(t)?t:X(new l(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function K(t){if((t=Q(t).replace(Y,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function Q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function J(t){return t<16?"0"+t.toString(16):t.toString(16)}function X(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Z(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function $(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}function tt(t){return i.toByteArray(K(t))}function et(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function nt(t){return t!=t}},{"base64-js":"yh9p",ieee754:"JgNJ",isarray:"REa7",buffer:"dskh"}],VOQX:[function(t,e,n){t("buffer").Buffer;var r=t("buffer").Buffer;e.exports=function(t){return i&&r.isBuffer(t)||o&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}(t))};var i="function"==typeof r&&"function"==typeof r.isBuffer,o="function"==typeof ArrayBuffer},{buffer:"dskh"}],DJEA:[function(t,e,n){var r=t("isarray"),i=t("./is-buffer"),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);function u(t,e){if(!t)return t;if(i(t)){var n={_placeholder:!0,num:e.length};return e.push(t),n}if(r(t)){for(var o=new Array(t.length),s=0;s<t.length;s++)o[s]=u(t[s],e);return o}if("object"==typeof t&&!(t instanceof Date)){for(var a in o={},t)o[a]=u(t[a],e);return o}return t}function c(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(r(t))for(var n=0;n<t.length;n++)t[n]=c(t[n],e);else if("object"==typeof t)for(var i in t)t[i]=c(t[i],e);return t}n.deconstructPacket=function(t){var e=[],n=t.data,r=t;return r.data=u(n,e),r.attachments=e.length,{packet:r,buffers:e}},n.reconstructPacket=function(t,e){return t.data=c(t.data,e),t.attachments=void 0,t},n.removeBlobs=function(t,e){var n=0,o=t;!function t(u,c,l){if(!u)return u;if(s&&u instanceof Blob||a&&u instanceof File){n++;var h=new FileReader;h.onload=function(){l?l[c]=this.result:o=this.result,--n||e(o)},h.readAsArrayBuffer(u)}else if(r(u))for(var f=0;f<u.length;f++)t(u[f],f,u);else if("object"==typeof u&&!i(u))for(var p in u)t(u[p],p,u)}(o),n||e(o)}},{isarray:"REa7","./is-buffer":"VOQX"}],EDhw:[function(t,e,n){var r=t("debug")("socket.io-parser"),i=t("component-emitter"),o=t("./binary"),s=t("isarray"),a=t("./is-buffer");function u(){}n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=u,n.Decoder=f;var c=n.ERROR+'"encode error"';function l(t){var e=""+t.type;if(n.BINARY_EVENT!==t.type&&n.BINARY_ACK!==t.type||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data){var i=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===i)return c;e+=i}return r("encoded %j as %s",t,e),e}function h(t,e){o.removeBlobs(t,(function(t){var n=o.deconstructPacket(t),r=l(n.packet),i=n.buffers;i.unshift(r),e(i)}))}function f(){this.reconstructor=null}function p(t){var e=0,i={type:Number(t.charAt(0))};if(null==n.types[i.type])return y("unknown packet type "+i.type);if(n.BINARY_EVENT===i.type||n.BINARY_ACK===i.type){for(var o="";"-"!==t.charAt(++e)&&(o+=t.charAt(e),e!=t.length););if(o!=Number(o)||"-"!==t.charAt(e))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===t.charAt(e+1))for(i.nsp="";++e&&","!==(u=t.charAt(e))&&(i.nsp+=u,e!==t.length););else i.nsp="/";var a=t.charAt(e+1);if(""!==a&&Number(a)==a){for(i.id="";++e;){var u;if(null==(u=t.charAt(e))||Number(u)!=u){--e;break}if(i.id+=t.charAt(e),e===t.length)break}i.id=Number(i.id)}if(t.charAt(++e)){var c=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!1===c||i.type!==n.ERROR&&!s(c))return y("invalid payload");i.data=c}return r("decoded %s as %j",t,i),i}function d(t){this.reconPack=t,this.buffers=[]}function y(t){return{type:n.ERROR,data:"parser error: "+t}}u.prototype.encode=function(t,e){r("encoding packet %j",t),n.BINARY_EVENT===t.type||n.BINARY_ACK===t.type?h(t,e):e([l(t)])},i(f.prototype),f.prototype.add=function(t){var e;if("string"==typeof t)e=p(t),n.BINARY_EVENT===e.type||n.BINARY_ACK===e.type?(this.reconstructor=new d(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",e))}},f.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{debug:"jcLW","component-emitter":"Wr69","./binary":"DJEA",isarray:"REa7","./is-buffer":"VOQX"}],mYnU:[function(t,e,n){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},{}],cVUh:[function(t,e,n){var r=t("has-cors");e.exports=function(t){var e=t.xdomain,n=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(t){}if(!e)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},{"has-cors":"mYnU"}],Tn4q:[function(t,e,n){e.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},{}],E6Ed:[function(t,e,n){t("buffer").Buffer;var r=t("buffer").Buffer,i=t("isarray"),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function t(e){if(!e||"object"!=typeof e)return!1;if(i(e)){for(var n=0,o=e.length;n<o;n++)if(t(e[n]))return!0;return!1}if("function"==typeof r&&r.isBuffer&&r.isBuffer(e)||"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||s&&e instanceof Blob||a&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)&&t(e[u]))return!0;return!1}},{isarray:"REa7",buffer:"dskh"}],iRcD:[function(t,e,n){e.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(t),o=new Uint8Array(n-e),s=e,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}},{}],ibc9:[function(t,e,n){function r(){}e.exports=function(t,e,n){var i=!1;return n=n||r,o.count=t,0===t?e():o;function o(t,r){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(i=!0,e(t),e=n):0!==o.count||i||e(null,r)}}},{}],s6hm:[function(t,e,n){var r,i,o,s=String.fromCharCode;function a(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function u(t){for(var e,n=t.length,r=-1,i="";++r<n;)(e=t[r])>65535&&(i+=s((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=s(e);return i}function c(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function l(t,e){return s(t>>e&63|128)}function h(t,e){if(0==(4294967168&t))return s(t);var n="";return 0==(4294965248&t)?n=s(t>>6&31|192):0==(4294901760&t)?(c(t,e)||(t=65533),n=s(t>>12&15|224),n+=l(t,6)):0==(4292870144&t)&&(n=s(t>>18&7|240),n+=l(t,12),n+=l(t,6)),n+s(63&t|128)}function f(){if(o>=i)throw Error("Invalid byte index");var t=255&r[o];if(o++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function p(t){var e,n;if(o>i)throw Error("Invalid byte index");if(o==i)return!1;if(e=255&r[o],o++,0==(128&e))return e;if(192==(224&e)){if((n=(31&e)<<6|f())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&e)){if((n=(15&e)<<12|f()<<6|f())>=2048)return c(n,t)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(n=(7&e)<<18|f()<<12|f()<<6|f())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(t,e){for(var n=!1!==(e=e||{}).strict,r=a(t),i=r.length,o=-1,s="";++o<i;)s+=h(r[o],n);return s},decode:function(t,e){var n=!1!==(e=e||{}).strict;r=a(t),i=r.length,o=0;for(var s,c=[];!1!==(s=p(n));)c.push(s);return u(c)}}},{}],vLJO:[function(t,e,n){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),r=0;r<t.length;r++)e[t.charCodeAt(r)]=r;n.encode=function(e){var n,r=new Uint8Array(e),i=r.length,o="";for(n=0;n<i;n+=3)o+=t[r[n]>>2],o+=t[(3&r[n])<<4|r[n+1]>>4],o+=t[(15&r[n+1])<<2|r[n+2]>>6],o+=t[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(t){var n,r,i,o,s,a=.75*t.length,u=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var l=new ArrayBuffer(a),h=new Uint8Array(l);for(n=0;n<u;n+=4)r=e[t.charCodeAt(n)],i=e[t.charCodeAt(n+1)],o=e[t.charCodeAt(n+2)],s=e[t.charCodeAt(n+3)],h[c++]=r<<2|i>>4,h[c++]=(15&i)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return l}}()},{}],LDmX:[function(t,e,n){var r=void 0!==r?r:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,i=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),o=i&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),s=r&&r.prototype.append&&r.prototype.getBlob;function a(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=n.buffer}return e}return t}))}function u(t,e){e=e||{};var n=new r;return a(t).forEach((function(t){n.append(t)})),e.type?n.getBlob(e.type):n.getBlob()}function c(t,e){return new Blob(a(t),e||{})}"undefined"!=typeof Blob&&(u.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=i?o?Blob:c:s?u:void 0},{}],HSgu:[function(t,e,n){var r,i=t("./keys"),o=t("has-binary2"),s=t("arraybuffer.slice"),a=t("after"),u=t("./utf8");"undefined"!=typeof ArrayBuffer&&(r=t("base64-arraybuffer"));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=c||l;n.protocol=3;var f=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=i(f),d={type:"error",data:"parser error"},y=t("blob");function v(t){try{t=u.decode(t,{strict:!1})}catch(t){return!1}return t}function g(t,e,n){for(var r=new Array(t.length),i=a(t.length,n),o=function(t,n,i){e(n,(function(e,n){r[t]=n,i(e,r)}))},s=0;s<t.length;s++)o(s,t[s],i)}n.encodePacket=function(t,e,r,i){"function"==typeof e&&(i=e,e=!1),"function"==typeof r&&(i=r,r=null);var o=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,e,r){if(!e)return n.encodeBase64Packet(t,r);var i=t.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=f[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}(t,e,i);if(void 0!==y&&o instanceof y)return function(t,e,r){if(!e)return n.encodeBase64Packet(t,r);if(h)return function(t,e,r){if(!e)return n.encodeBase64Packet(t,r);var i=new FileReader;return i.onload=function(){n.encodePacket({type:t.type,data:i.result},e,!0,r)},i.readAsArrayBuffer(t.data)}(t,e,r);var i=new Uint8Array(1);return i[0]=f[t.type],r(new y([i.buffer,t.data]))}(t,e,i);if(o&&o.base64)return function(t,e){return e("b"+n.packets[t.type]+t.data.data)}(t,i);var s=f[t.type];return void 0!==t.data&&(s+=r?u.encode(String(t.data),{strict:!1}):String(t.data)),i(""+s)},n.encodeBase64Packet=function(t,e){var r,i="b"+n.packets[t.type];if(void 0!==y&&t.data instanceof y){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];e(i+t)},o.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),u=0;u<s.length;u++)a[u]=s[u];r=String.fromCharCode.apply(null,a)}return i+=btoa(r),e(i)},n.decodePacket=function(t,e,r){if(void 0===t)return d;if("string"==typeof t){if("b"===t.charAt(0))return n.decodeBase64Packet(t.substr(1),e);if(r&&!1===(t=v(t)))return d;var i=t.charAt(0);return Number(i)==i&&p[i]?t.length>1?{type:p[i],data:t.substring(1)}:{type:p[i]}:d}i=new Uint8Array(t)[0];var o=s(t,1);return y&&"blob"===e&&(o=new y([o])),{type:p[i],data:o}},n.decodeBase64Packet=function(t,e){var n=p[t.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:t.substr(1)}};var i=r.decode(t.substr(1));return"blob"===e&&y&&(i=new y([i])),{type:n,data:i}},n.encodePayload=function(t,e,r){"function"==typeof e&&(r=e,e=null);var i=o(t);return e&&i?y&&!h?n.encodePayloadAsBlob(t,r):n.encodePayloadAsArrayBuffer(t,r):t.length?void g(t,(function(t,r){n.encodePacket(t,!!i&&e,!1,(function(t){r(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return r(e.join(""))})):r("0:")},n.decodePayload=function(t,e,r){if("string"!=typeof t)return n.decodePayloadAsBinary(t,e,r);var i;if("function"==typeof e&&(r=e,e=null),""===t)return r(d,0,1);for(var o,s,a="",u=0,c=t.length;u<c;u++){var l=t.charAt(u);if(":"===l){if(""===a||a!=(o=Number(a)))return r(d,0,1);if(a!=(s=t.substr(u+1,o)).length)return r(d,0,1);if(s.length){if(i=n.decodePacket(s,e,!1),d.type===i.type&&d.data===i.data)return r(d,0,1);if(!1===r(i,u+o,c))return}u+=o,a=""}else a+=l}return""!==a?r(d,0,1):void 0},n.encodePayloadAsArrayBuffer=function(t,e){if(!t.length)return e(new ArrayBuffer(0));g(t,(function(t,e){n.encodePacket(t,!0,!0,(function(t){return e(null,t)}))}),(function(t,n){var r=n.reduce((function(t,e){var n;return t+(n="string"==typeof e?e.length:e.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),o=0;return n.forEach((function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);n=r.buffer}i[o++]=e?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);for(i[o++]=255,r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]})),e(i.buffer)}))},n.encodePayloadAsBlob=function(t,e){g(t,(function(t,e){n.encodePacket(t,!0,!0,(function(t){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);t=r.buffer,n[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,y){var a=new y([n.buffer,s.buffer,t]);e(null,a)}}))}),(function(t,n){return e(new y(n))}))},n.decodePayloadAsBinary=function(t,e,r){"function"==typeof e&&(r=e,e=null);for(var i=t,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),u=0===a[0],c="",l=1;255!==a[l];l++){if(c.length>310)return r(d,0,1);c+=a[l]}i=s(i,2+c.length),c=parseInt(c);var h=s(i,0,c);if(u)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(t){var f=new Uint8Array(h);for(h="",l=0;l<f.length;l++)h+=String.fromCharCode(f[l])}o.push(h),i=s(i,c)}var p=o.length;o.forEach((function(t,i){r(n.decodePacket(t,e,!0),i,p)}))}},{"./keys":"Tn4q","has-binary2":"E6Ed","arraybuffer.slice":"iRcD",after:"ibc9","./utf8":"s6hm","base64-arraybuffer":"vLJO",blob:"LDmX"}],HBl9:[function(t,e,n){var r=t("engine.io-parser"),i=t("component-emitter");function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"engine.io-parser":"HSgu","component-emitter":"Wr69"}],vs2a:[function(t,e,n){n.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},n.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},{}],X1xq:[function(t,e,n){e.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],t9Jt:[function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},s=0,a=0;function u(t){var e="";do{e=i[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function c(){var t=u(+new Date);return t!==r?(s=0,r=t):t+"."+u(s++)}for(;a<64;a++)o[i[a]]=a;c.encode=u,c.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=64*e+o[t.charAt(a)];return e},e.exports=c},{}],hsm0:[function(t,e,n){var r=t("../transport"),i=t("parseqs"),o=t("engine.io-parser"),s=t("component-inherit"),a=t("yeast"),u=t("debug")("engine.io-client:polling");e.exports=l;var c=null!=new(t("xmlhttprequest-ssl"))({xdomain:!1}).responseType;function l(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),r.call(this,t)}s(l,r),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(t){var e=this;function n(){u("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--r||n()}))),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){u("pre-pause writing complete"),--r||n()})))}else n()},l.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(t){var e=this;u("polling got data %s",t),o.decodePayload(t,this.socket.binaryType,(function(t,n,r){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var t=this;function e(){u("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},l.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};o.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,n)}))},l.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t}},{"../transport":"HBl9",parseqs:"vs2a","engine.io-parser":"HSgu","component-inherit":"X1xq",yeast:"t9Jt",debug:"jcLW","xmlhttprequest-ssl":"cVUh"}],tzUF:[function(t,e,n){var r=t("xmlhttprequest-ssl"),i=t("./polling"),o=t("component-emitter"),s=t("component-inherit"),a=t("debug")("engine.io-client:polling-xhr");function u(){}function c(t){if(i.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}}function l(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(e.exports=c,e.exports.Request=l,s(c,i),c.prototype.supportsBinary=!0,c.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new l(t)},c.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),i=this;r.on("success",e),r.on("error",(function(t){i.onError("xhr post error",t)})),this.sendXhr=r},c.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},o(l.prototype),l.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new r(t),n=this;try{a("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=!0),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===t&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?n.onLoad():setTimeout((function(){n.onError(e.status)}),0))},a("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){n.onError(t)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},l.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},l.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var h="onpagehide"in self?"pagehide":"unload";addEventListener(h,f,!1)}function f(){for(var t in l.requests)l.requests.hasOwnProperty(t)&&l.requests[t].abort()}},{"xmlhttprequest-ssl":"cVUh","./polling":"hsm0","component-emitter":"Wr69","component-inherit":"X1xq",debug:"jcLW"}],ruO5:[function(t,e,n){var r=arguments[3],i=t("./polling"),o=t("component-inherit");e.exports=h;var s,a=/\n/g,u=/\\n/g;function c(){}function l(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:{}}function h(t){if(i.call(this,t),this.query=this.query||{},!s){var e=l();s=e.___eio=e.___eio||[]}this.index=s.length;var n=this;s.push((function(t){n.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=c)}),!1)}o(h,i),h.prototype.supportsBinary=!1,h.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},h.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},h.prototype.doWrite=function(t,e){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=s,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function c(){l(),e()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(t)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),l(),t=t.replace(u,"\\\n"),this.area.value=t.replace(a,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},{"./polling":"hsm0","component-inherit":"X1xq"}],rDCW:[function(t,e,n){},{}],ExHC:[function(t,e,n){t("buffer").Buffer;var r,i,o=t("buffer").Buffer,s=t("../transport"),a=t("engine.io-parser"),u=t("parseqs"),c=t("component-inherit"),l=t("yeast"),h=t("debug")("engine.io-client:websocket");if("undefined"!=typeof WebSocket)r=WebSocket;else if("undefined"!=typeof self)r=self.WebSocket||self.MozWebSocket;else try{i=t("ws")}catch(t){}var f=r||i;function p(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=r&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(f=i),s.call(this,t)}e.exports=p,c(p,s),p.prototype.name="websocket",p.prototype.supportsBinary=!0,p.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new f(t,e):new f(t):new f(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},p.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},p.prototype.write=function(t){var e=this;this.writable=!1;for(var n=t.length,r=0,i=n;r<i;r++)!function(t){a.encodePacket(t,e.supportsBinary,(function(r){if(!e.usingBrowserWebSocket){var i={};t.options&&(i.compress=t.options.compress),e.perMessageDeflate&&("string"==typeof r?o.byteLength(r):r.length)<e.perMessageDeflate.threshold&&(i.compress=!1)}try{e.usingBrowserWebSocket?e.ws.send(r):e.ws.send(r,i)}catch(t){h("websocket closed before onclose event")}--n||(e.emit("flush"),setTimeout((function(){e.writable=!0,e.emit("drain")}),0))}))}(t[r])},p.prototype.onClose=function(){s.prototype.onClose.call(this)},p.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},p.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=l()),this.supportsBinary||(t.b64=1),(t=u.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},p.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===p.prototype.name)}},{"../transport":"HBl9","engine.io-parser":"HSgu",parseqs:"vs2a","component-inherit":"X1xq",yeast:"t9Jt",debug:"jcLW",ws:"rDCW",buffer:"dskh"}],xQDS:[function(t,e,n){var r=t("xmlhttprequest-ssl"),i=t("./polling-xhr"),o=t("./polling-jsonp"),s=t("./websocket");n.polling=function(t){var e=!1,n=!1,s=!1!==t.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),e=t.hostname!==location.hostname||u!==t.port,n=t.secure!==a}if(t.xdomain=e,t.xscheme=n,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!s)throw new Error("JSONP disabled");return new o(t)},n.websocket=s},{"xmlhttprequest-ssl":"cVUh","./polling-xhr":"tzUF","./polling-jsonp":"ruO5","./websocket":"ExHC"}],rcym:[function(t,e,n){var r=[].indexOf;e.exports=function(t,e){if(r)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},{}],APvO:[function(t,e,n){var r=t("./transports/index"),i=t("component-emitter"),o=t("debug")("engine.io-client:socket"),s=t("indexof"),a=t("engine.io-parser"),u=t("parseuri"),c=t("parseqs");function l(t,e){if(!(this instanceof l))return new l(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=u(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=u(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=l,l.priorWebsocketSuccess=!1,i(l.prototype),l.protocol=a.protocol,l.Socket=l,l.Transport=t("./transport"),l.transports=t("./transports/index"),l.parser=t("engine.io-parser"),l.prototype.createTransport=function(t){o('creating transport "%s"',t);var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.query);e.EIO=a.protocol,e.transport=t;var n=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},l.prototype.open=function(){var t;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},l.prototype.setTransport=function(t){o("setting transport %s",t.name);var e=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},l.prototype.probe=function(t){o('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(o('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;l.priorWebsocketSuccess="websocket"===e.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),f(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())}))}else{o('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=e.name,r.emit("upgradeError",s)}})))}function s(){n||(n=!0,f(),e.close(),e=null)}function a(n){var i=new Error("probe error: "+n);i.transport=e.name,s(),o('probe transport "%s" failed because of error: %s',t,n),r.emit("upgradeError",i)}function u(){a("transport closed")}function c(){a("socket closed")}function h(t){e&&t.name!==e.name&&(o('"%s" works - aborting "%s"',t.name,e.name),s())}function f(){e.removeListener("open",i),e.removeListener("error",a),e.removeListener("close",u),r.removeListener("close",c),r.removeListener("upgrading",h)}l.priorWebsocketSuccess=!1,e.once("open",i),e.once("error",a),e.once("close",u),this.once("close",c),this.once("upgrading",h),e.open()},l.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},l.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},l.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},l.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},l.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}function e(){t.onClose("forced close"),o("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function r(){t.once("upgrade",n),t.once("upgradeError",n)}return this},l.prototype.onError=function(t){o("socket error %j",t),l.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},l.prototype.onClose=function(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(o('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)},l.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;n<r;n++)~s(this.transports,t[n])&&e.push(t[n]);return e}},{"./transports/index":"xQDS","component-emitter":"Wr69",debug:"jcLW",indexof:"rcym","engine.io-parser":"HSgu",parseuri:"imeZ",parseqs:"vs2a","./transport":"HBl9"}],h0uD:[function(t,e,n){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")},{"./socket":"APvO","engine.io-parser":"HSgu"}],PFWQ:[function(t,e,n){e.exports=function(t,e){for(var n=[],r=(e=e||0)||0;r<t.length;r++)n[r-e]=t[r];return n}},{}],BM2E:[function(t,e,n){e.exports=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}},{}],NpfF:[function(t,e,n){var r=[].slice;e.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return e.apply(t,n.concat(r.call(arguments)))}}},{}],wT76:[function(t,e,n){var r=t("socket.io-parser"),i=t("component-emitter"),o=t("to-array"),s=t("./on"),a=t("component-bind"),u=t("debug")("socket.io-client:socket"),c=t("parseqs"),l=t("has-binary2");e.exports=p;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;function p(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(p.prototype),p.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",a(this,"onopen")),s(t,"packet",a(this,"onpacket")),s(t,"close",a(this,"onclose"))]}},p.prototype.open=p.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},p.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},p.prototype.emit=function(t){if(h.hasOwnProperty(t))return f.apply(this,arguments),this;var e=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:l(e))?r.BINARY_EVENT:r.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},p.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},p.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},p.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},p.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===r.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},p.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},p.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var i=o(arguments);u("sending ack %j",i),e.packet({type:l(i)?r.BINARY_ACK:r.ACK,id:t,data:i})}}},p.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},p.prototype.compress=function(t){return this.flags.compress=t,this},p.prototype.binary=function(t){return this.flags.binary=t,this}},{"socket.io-parser":"EDhw","component-emitter":"Wr69","to-array":"PFWQ","./on":"BM2E","component-bind":"NpfF",debug:"jcLW",parseqs:"vs2a","has-binary2":"E6Ed"}],pAuI:[function(t,e,n){function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(t){this.ms=t},r.prototype.setMax=function(t){this.max=t},r.prototype.setJitter=function(t){this.jitter=t}},{}],Di21:[function(t,e,n){var r=t("engine.io-client"),i=t("./socket"),o=t("component-emitter"),s=t("socket.io-parser"),a=t("./on"),u=t("component-bind"),c=t("debug")("socket.io-client:manager"),l=t("indexof"),h=t("backo2"),f=Object.prototype.hasOwnProperty;function p(t,e){if(!(this instanceof p))return new p(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}e.exports=p,p.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},p.prototype.updateSocketIds=function(){for(var t in this.nsps)f.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},p.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},o(p.prototype),p.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},p.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},p.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},p.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},p.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},p.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},p.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},p.prototype.open=p.prototype.connect=function(t,e){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=a(n,"open",(function(){i.onopen(),t&&t()})),s=a(n,"error",(function(e){if(c("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u);var l=setTimeout((function(){c("connect attempt timed out after %d",u),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",u)}),u);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(o),this.subs.push(s),this},p.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",u(this,"ondata"))),this.subs.push(a(t,"ping",u(this,"onping"))),this.subs.push(a(t,"pong",u(this,"onpong"))),this.subs.push(a(t,"error",u(this,"onerror"))),this.subs.push(a(t,"close",u(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",u(this,"ondecoded")))},p.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},p.prototype.ondata=function(t){this.decoder.add(t)},p.prototype.ondecoded=function(t){this.emit("packet",t)},p.prototype.onerror=function(t){c("error",t),this.emitAll("error",t)},p.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new i(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",o),n.on("connect",(function(){n.id=r.generateId(t)})),this.autoConnect&&o()}function o(){~l(r.connecting,n)||r.connecting.push(n)}return n},p.prototype.destroy=function(t){var e=l(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},p.prototype.packet=function(t){c("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()})))},p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},p.prototype.cleanup=function(){c("cleanup");for(var t=this.subs.length,e=0;e<t;e++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},p.prototype.close=p.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},p.prototype.onclose=function(t){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout((function(){t.skipReconnect||(c("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(c("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(c("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(n)}})}},p.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},{"engine.io-client":"h0uD","./socket":"wT76","component-emitter":"Wr69","socket.io-parser":"EDhw","./on":"BM2E","component-bind":"NpfF",debug:"jcLW",indexof:"rcym",backo2:"pAuI"}],gT2G:[function(t,e,n){var r=t("./url"),i=t("socket.io-parser"),o=t("./manager"),s=t("debug")("socket.io-client");e.exports=n=u;var a=n.managers={};function u(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i=r(t),u=i.source,c=i.id,l=i.path,h=a[c]&&l in a[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||h?(s("ignoring socket cache for %s",u),n=o(u,e)):(a[c]||(s("new io instance for %s",u),a[c]=o(u,e)),n=a[c]),i.query&&!e.query&&(e.query=i.query),n.socket(i.path,e)}n.protocol=i.protocol,n.connect=u,n.Manager=t("./manager"),n.Socket=t("./socket")},{"./url":"ECAZ","socket.io-parser":"EDhw","./manager":"Di21",debug:"jcLW","./socket":"wT76"}],nVpT:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=o(t("socket.io-client")),a={secure:!0},u=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.options=Object.freeze(Object.assign(Object.assign({},a),e)),this.socket=s.default(this.options.socketUrl,{path:"/".concat(this.options.deviceId)})}return i(t,[{key:"onMetric",value:function(t,e){return this.socket.on("metrics/".concat(t.id),e)}},{key:"removeMetricListener",value:function(t,e){this.socket.off("metrics/".concat(t.id),e)}},{key:"disconnect",value:function(){this.socket.removeAllListeners(),this.socket.connected&&this.socket.disconnect()}}]),t}();n.WebsocketClient=u,u.serverType="websocket"},{"socket.io-client":"gT2G"}],c6Wx:[function(t,e,n){var r=Array.isArray;function i(t,e){t=t.slice(0),e&&(t=t.map((function(t){return t[e]})));for(var n=(t=t.sort((function(t,e){return t-e}))).length,r=o(t),i=function(t){var e=t.length,n=o(t.slice(0,~~(e/2)));return 1.5*(o(t.slice(Math.ceil(e/2)))-n)}(t),s=[],a=0;a<n;a++)Math.abs(t[a]-r)>i&&s.push(t[a]);return s}function o(t){var e=t.length,n=~~(e/2);return e%2?t[n]:(t[n-1]+t[n])/2}e.exports=function(t){if(r(t))return i(t);var e=null,n="string"==typeof t&&t;return function(t,r,o){return e||(e=i(o,n)),t=n?t[n]:t,!~e.indexOf(t)}}},{}],s7Vt:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("rxjs"),i=t("rxjs/operators");n.whileOnline=function(t){var e=t.status$,n=t.allowWhileOnSleepMode;return r.pipe(i.withLatestFrom(e),i.flatMap((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),i=e[0];return function(t,e){return!("online"!==t.state||!e&&t.sleepMode)}(e[1],n)?r.of(i):r.empty()})))}},{rxjs:"iRqj","rxjs/operators":"cVrl"}],iVIU:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("rxjs"),u=t("rxjs/operators"),c=t("rxjs/operators"),l=s(t("outliers")),h=t("../utils/whileOnline"),f={bufferSize:100,updateInterval:6e4},p=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._offset=0,this.options=Object.assign(Object.assign({},f),e),this.start()}return function(t,e,n){e&&i(t.prototype,e)}(t,[{key:"start",value:function(){var t=this,e=this.options,n=e.bufferSize,r=e.updateInterval,i=e.status$,o=a.range(0,n),s=a.timer(r,r).pipe(u.map((function(t){return n+t})),h.whileOnline({status$:i,allowWhileOnSleepMode:!0}));i.pipe(u.filter((function(t){return"online"===t.state})),u.take(1)).pipe(c.switchMap((function(){return o.pipe(u.concat(s),t.toOffset(),c.bufferCount(n,1),t.filterOutliers(),u.map((function(e){return t.average(e)})))}))).subscribe((function(e){t._offset=e}))}},{key:"filterOutliers",value:function(){return a.pipe(u.map((function(t){return t.filter(l.default())})))}},{key:"toOffset",value:function(){var t=this,e=this.options.getTimesync;return a.pipe(c.concatMap((function(){return o(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,s,a,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Date.now(),t.next=3,e().then((function(t){return[null,t]})).catch((function(t){return[t]}));case 3:if(i=t.sent,o=r(i,2),s=o[0],a=o[1],!s){t.next=9;break}return t.abrupt("return",0);case 9:return u=Date.now(),c=u-(u-n)/2-a,t.abrupt("return",c);case 13:case"end":return t.stop()}}),t)})))})))}},{key:"average",value:function(t){return Math.round(t.reduce((function(t,e){return t+e}))/t.length)}},{key:"offset",get:function(){return this._offset}},{key:"timestamp",get:function(){return Date.now()+this._offset}}]),t}();n.Timesync=p},{rxjs:"iRqj","rxjs/operators":"cVrl",outliers:"c6Wx","../utils/whileOnline":"s7Vt"}],CXqr:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(t("./Timesync"))},{"./Timesync":"iVIU"}],BX8M:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._subscriptions={}}return i(t,[{key:"get",value:function(){return this._subscriptions}},{key:"toList",value:function(){return Object.values(this._subscriptions)}},{key:"add",value:function(t){this._subscriptions[t.id]=t}},{key:"remove",value:function(t){t.id in this._subscriptions&&Reflect.deleteProperty(this._subscriptions,t.id)}}]),t}();n.SubscriptionManager=o},{}],LXvB:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});var s=t("rxjs"),a=t("./firebase"),u=t("./websocket"),c=t("../timesync"),l=t("../subscriptions/SubscriptionManager"),h=t("rxjs/operators"),f=t("./firebase");n.credentialWithLink=f.credentialWithLink,n.createUser=f.createUser,n.SERVER_TIMESTAMP=f.SERVER_TIMESTAMP;var p=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.defaultServerType=a.FirebaseDevice.serverType,this.localServerType=u.WebsocketClient.serverType,this._selectedDevice=new s.BehaviorSubject(void 0),this.options=e,this.subscriptionManager=new l.SubscriptionManager,this.firebaseApp=new a.FirebaseApp(e),this.firebaseUser=new a.FirebaseUser(this.firebaseApp),this.firebaseUser.onAuthStateChanged().subscribe((function(t){n.user=t})),this.onDeviceChange().subscribe((function(t){n.firebaseDevice&&n.firebaseDevice.disconnect(),t&&(n.firebaseDevice=new a.FirebaseDevice({deviceId:t.deviceId,firebaseApp:n.firebaseApp,dependencies:{subscriptionManager:n.subscriptionManager}}),n.options.timesync&&(n.timesync=new c.Timesync({status$:n.status(),getTimesync:n.firebaseDevice.getTimesync.bind(n.firebaseDevice)})))}))}return function(t,e,n){e&&i(t.prototype,e)}(t,[{key:"onDeviceChange",value:function(){return this._selectedDevice.asObservable().pipe(h.shareReplay(1),h.filter((function(t){return void 0!==t})))}},{key:"setAutoSelectedDevice",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.options.deviceId){t.next=4;break}return t.next=3,this.selectDevice((function(t){return t.find((function(t){return t.deviceId===e.options.deviceId}))}));case 3:return t.abrupt("return",t.sent);case 4:if(this.options.deviceId||!this.options.autoSelectDevice){t.next=8;break}return t.next=7,this.selectDevice((function(t){return t[0]}));case 7:return t.abrupt("return",t.sent);case 8:return t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"setWebsocket",value:function(t,e){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.websocket=new u.WebsocketClient({socketUrl:t,deviceId:e});case 1:case"end":return n.stop()}}),n,this)})))}},{key:"unsetWebsocket",value:function(){this.websocket&&(this.websocket.disconnect(),this.websocket=null)}},{key:"disconnect",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.websocket&&this.websocket.disconnect(),t.abrupt("return",this.firebaseApp.disconnect());case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getInfo",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.firebaseDevice.getInfo();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"login",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.user){e.next=2;break}return e.abrupt("return",Promise.reject("Already logged in."));case 2:return e.next=4,this.firebaseUser.login(t);case 4:return n=e.sent,e.next=7,this.setAutoSelectedDevice();case 7:return r=e.sent,e.abrupt("return",Object.assign(Object.assign({},n),{selectedDevice:r}));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"logout",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.firebaseDevice&&this.firebaseDevice.disconnect(),t.next=3,this.firebaseUser.logout();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onAuthStateChanged",value:function(){var t=this;return this.firebaseUser.onAuthStateChanged().pipe(h.switchMap((function(e){return o(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:if(!this.didSelectDevice()){t.next=8;break}return t.next=5,this.getSelectedDevice();case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,this.setAutoSelectedDevice();case 10:t.t0=t.sent;case 11:return n=t.t0,t.abrupt("return",Object.assign(Object.assign({},e),{selectedDevice:n}));case 13:case"end":return t.stop()}}),t,this)})))})))}},{key:"getDevices",value:function(){return this.firebaseUser.getDevices()}},{key:"addDevice",value:function(t){return this.firebaseUser.addDevice(t)}},{key:"removeDevice",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.firebaseUser.removeDevice(t).then((function(){return[!1]})).catch((function(t){return[!0,t]}));case 2:if(n=e.sent,i=r(n,2),o=i[0],s=i[1],!o){e.next=8;break}return e.abrupt("return",Promise.reject(s));case 8:(null==(a=this._selectedDevice.getValue())?void 0:a.deviceId)===t&&this._selectedDevice.next(null);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"onUserDevicesChange",value:function(){return this.firebaseUser.onUserDevicesChange()}},{key:"didSelectDevice",value:function(){return!!this._selectedDevice.getValue()}},{key:"selectDevice",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDevices();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",Promise.reject("Did not find any devices for this user. Make sure your device is claimed by your Neurosity account."));case 5:if(i=function(e){return e.find((function(e){if(!Array.isArray(t))return!1;var n=r(t,2),i=n[0],o=n[1];return JSON.stringify(null==e?void 0:e[i])===JSON.stringify(o)}))},o="function"==typeof t?t(n):i(n)){e.next=9;break}return e.abrupt("return",Promise.reject("A device was not provided. Try returning a device from the devicesList provided in the callback."));case 9:return e.next=11,this.firebaseUser.hasDevicePermission(o.deviceId);case 11:if(e.sent){e.next=14;break}return e.abrupt("return",Promise.reject("Rejected device access due to permissions."));case 14:return this._selectedDevice.next(o),e.abrupt("return",o);case 16:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedDevice",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this._selectedDevice.getValue()){t.next=3;break}return t.abrupt("return",Promise.reject("There is no device currently selected."));case 3:return t.next=5,this.getDevices();case 5:if(n=t.sent){t.next=8;break}return t.abrupt("return",Promise.reject("Did not find any devices for this user. Make sure your device is claimed by your Neurosity account."));case 8:return t.abrupt("return",n.find((function(t){return t.deviceId===e.deviceId})));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"status",value:function(){return this.observeNamespace("status").pipe(h.map((function(t){return t?Object.entries(t).reduce((function(t,e){var n=r(e,2),i=n[0],o=n[1];return i.startsWith("__")||(t[i]=o),t}),{}):t})))}},{key:"observeNamespace",value:function(t){var e=this,n=s.fromEventPattern((function(n){return e.firebaseDevice.onNamespace(t,n)}),(function(n){return e.firebaseDevice.offNamespace(t,n)}));return this.onDeviceChange().pipe(h.switchMap((function(t){return t?n:s.empty()})))}},{key:"onceNamespace",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.firebaseDevice.onceNamespace(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"changeSettings",value:function(t){return this.firebaseDevice.changeSettings(t)}},{key:"goOffline",value:function(){this.firebaseApp.goOffline()}},{key:"goOnline",value:function(){this.firebaseApp.goOnline()}},{key:"__getApp",value:function(){return this.firebaseApp.app}},{key:"actions",get:function(){var t=this;return{dispatch:function(e){return t.firebaseDevice.dispatchAction(e)}}}},{key:"metrics",get:function(){var t=this,e=function(t){return t.serverType===u.WebsocketClient.serverType};return{next:function(e,n){t.firebaseDevice.nextMetric(e,n)},on:function(n,r){return e(n)?t.websocket.onMetric(n,r):t.firebaseDevice.onMetric(n,r)},subscribe:function(e){var n=t.firebaseDevice.subscribeToMetric(e);return t.subscriptionManager.add(n),n},unsubscribe:function(n,r){t.subscriptionManager.remove(n),t.firebaseDevice.unsubscribeFromMetric(n),e(n)?t.websocket&&t.websocket.removeMetricListener(n,r):t.firebaseDevice.removeMetricListener(n,r)}}}},{key:"skills",get:function(){var t=this;return{get:function(e){return o(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.firebaseDevice.getSkill(e));case 1:case"end":return t.stop()}}),t,this)})))}}}},{key:"timestamp",get:function(){return this.options.timesync?this.timesync.timestamp:Date.now()}}]),t}();n.ApiClient=p},{rxjs:"iRqj","./firebase":"kM30","./websocket":"nVpT","../timesync":"CXqr","../subscriptions/SubscriptionManager":"BX8M","rxjs/operators":"cVrl"}],ZOGh:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.metrics=void 0;const r={rest:{},artifactDetector:{},leftArm:{},rightArm:{},leftHandPinch:{},rightHandPinch:{},tongue:{},jumpingJacks:{},leftFoot:{},rightFoot:{},leftThumbFinger:{},leftIndexFinger:{},leftMiddleFinger:{},leftRingFinger:{},leftPinkyFinger:{},rightThumbFinger:{},rightIndexFinger:{},rightMiddleFinger:{},rightRingFinger:{},rightPinkyFinger:{},mentalMath:{},bitingALemon:{},push:{},pull:{},lift:{},drop:{},moveLeft:{},moveRight:{},moveForward:{},moveBackward:{},rotateLeft:{},rotateRight:{},rotateClockwise:{},rotateCounterClockwise:{},disappear:{}},i={CP6:{},F6:{},C4:{},CP4:{},CP3:{},F5:{},C3:{},CP5:{}},o={kinesis:r,predictions:r,channelAnalysis:i,signalQuality:i,status:{state:{},battery:{},charging:{},connected:{},connectedSince:{},connectedLast:{},updatingProgress:{},simulate:{},ssid:{}},accelerometer:{acceleration:{},inclination:{},orientation:{},pitch:{},roll:{},x:{},y:{},z:{}},awareness:{creativity:{},comprehension:{},focus:{},meditation:{},calm:{}},brainwaves:{raw:{},frequency:{},powerByBand:{},psd:{}},emotion:{joy:{},sadness:{},anger:{},surprise:{},excitement:{},disappointment:{},fear:{},love:{},stress:{},interest:{}},facialExpression:{smile:{},laugh:{},frown:{},blink:{},winkLeft:{},winkRight:{}}};n.metrics=o;var s={metrics:o};n.default=s},{}],yLLB:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@neurosity/ipk");n.isNotionMetric=function(t){return Object.keys(r.metrics).includes(t)},n.getLabels=function(t){return Object.keys(r.metrics[t])},n.hasInvalidLabels=function(t,e){var r=n.getLabels(t);return!e.every((function(t){return r.includes(t)}))},n.isMetricDisallowed=function(t,e){return"skill"in e&&"metrics"in e.skill&&!e.skill.metrics.includes(t)},n.validate=function(t,e,r){var i=n.getLabels(t).join(", ");return e.length?n.isMetricDisallowed(t,r)?new Error("No permission to access the ".concat(t," metric. To access this metric, edit the skill's permissions")):!!n.hasInvalidLabels(t,e)&&new Error("One ore more labels provided to ".concat(t," are invalid. The valid labels for ").concat(t," are ").concat(i)):new Error("At least one label is required for ".concat(t," metric. Please add one of the following labels: ").concat(i))}},{"@neurosity/ipk":"ZOGh"}],WDyG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mustSelectDevice=new Error('A device must be selected. Make sure to call "notion.selectDevice()"')},{}],KQ4u:[function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(n,"__esModule",{value:!0});var c=t("rxjs"),l=t("rxjs/operators"),h=t("./api/index"),f=t("./utils/whileOnline"),p=t("./utils/subscription"),d=u(t("./utils/errors")),y={timesync:!1,autoSelectDevice:!0},v=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t),this._localModeSubject=new c.BehaviorSubject(!1),this.getMetric=function(t){var n=t.metric,r=t.labels,i=t.atomic,o=p.validate(n,r,e.options);if(o)return c.throwError(o);var s=function(t){return new c.Observable((function(o){var s=(i?[e.api.metrics.subscribe({metric:n,labels:r,atomic:i,serverType:t})]:r.map((function(r){return e.api.metrics.subscribe({metric:n,labels:[r],atomic:i,serverType:t})}))).map((function(t){return{subscription:t,listener:e.api.metrics.on(t,(function(){o.next.apply(o,arguments)}))}}));return function(){s.forEach((function(t){var n=t.subscription,r=t.listener;e.api.metrics.unsubscribe(n,r)}))}}))};return e.onDeviceChange().pipe(l.switchMap((function(t){if(!t)return c.empty();var r=t.deviceId;return e.isLocalMode().pipe(l.switchMap((function(t){return t&&p.isNotionMetric(n)?e.socketUrl().pipe(l.switchMap((function(t){return e.api.setWebsocket(t,r)})),l.switchMap((function(){return s(e.api.localServerType)}))):(e.api.unsetWebsocket(),s(e.api.defaultServerType))})))})),f.whileOnline({status$:e.status(),allowWhileOnSleepMode:!1}))},this.options=Object.freeze(Object.assign(Object.assign({},y),n)),this.api=new h.ApiClient(this.options)}return function(t,e,n){e&&s(t.prototype,e)}(t,[{key:"login",value:function(t){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.login(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"logout",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.logout();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"__getApp",value:function(){return this.api.__getApp()}},{key:"onAuthStateChanged",value:function(){return this.api.onAuthStateChanged()}},{key:"addDevice",value:function(t){return this.api.addDevice(t)}},{key:"removeDevice",value:function(t){return this.api.removeDevice(t)}},{key:"onUserDevicesChange",value:function(){return this.api.onUserDevicesChange()}},{key:"getDevices",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.getDevices();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"selectDevice",value:function(t){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.selectDevice(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedDevice",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.getSelectedDevice();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getInfo",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.api.didSelectDevice()){t.next=2;break}return t.abrupt("return",Promise.reject(d.mustSelectDevice));case 2:return t.next=4,this.api.getInfo();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"isLocalMode",value:function(){return this._localModeSubject.asObservable().pipe(l.share())}},{key:"onDeviceChange",value:function(){return this.api.onDeviceChange()}},{key:"enableLocalMode",value:function(t){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("boolean"==typeof t){e.next=2;break}return e.abrupt("return",Promise.reject(new TypeError("enableLocalMode can only accept a boolean")));case 2:if(t){e.next=5;break}return this._localModeSubject.next(t),e.abrupt("return",t);case 5:return e.next=7,this.api.onceNamespace("context/socketUrl").then((function(t){return t?[!0,null]:[!1,new Error("Your device's OS does not support localMode. Try updating to the latest OS.")]})).catch((function(t){return[!1,t]}));case 7:if(n=e.sent,r=i(n,2),o=r[0],s=r[1],o){e.next=13;break}return e.abrupt("return",Promise.reject(s));case 13:return this._localModeSubject.next(t),e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"disconnect",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.disconnect();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"socketUrl",value:function(){var t=this.options.onDeviceSocketUrl;return t?c.of(t):this.api.observeNamespace("context/socketUrl")}},{key:"dispatchAction",value:function(t){return this.api.didSelectDevice()?this.api.actions.dispatch(t):Promise.reject(d.mustSelectDevice)}},{key:"addMarker",value:function(t){if(!this.api.didSelectDevice())throw d.mustSelectDevice;if(!t)throw new Error("Notion: a label is required for addMarker");this.dispatchAction({command:"marker",action:"add",message:{label:t,timestamp:this.api.timestamp}})}},{key:"accelerometer",value:function(){var t=this,e="accelerometer";return c.from(this.getSelectedDevice()).pipe(l.switchMap((function(n){return Number(null==n?void 0:n.modelVersion)>=2?t.getMetric({metric:e,labels:p.getLabels(e),atomic:!0}):c.throwError(new Error("The ".concat(e," metric is not supported by this device. Model version ").concat(2," or greater required.")))})))}},{key:"awareness",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.getMetric({metric:"awareness",labels:t?[t].concat(n):[],atomic:!1})}},{key:"brainwaves",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.getMetric({metric:"brainwaves",labels:t?[t].concat(n):[],atomic:!1})}},{key:"calm",value:function(){return this.awareness("calm")}},{key:"signalQuality",value:function(){return this.getMetric({metric:"signalQuality",labels:p.getLabels("signalQuality"),atomic:!0})}},{key:"emotion",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.getMetric({metric:"emotion",labels:t?[t].concat(n):[],atomic:!1})}},{key:"settings",value:function(){return this.api.observeNamespace("settings")}},{key:"focus",value:function(){return this.awareness("focus")}},{key:"kinesis",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.getMetric({metric:"kinesis",labels:t?[t].concat(n):[],atomic:!1})}},{key:"predictions",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.getMetric({metric:"predictions",labels:t?[t].concat(n):[],atomic:!1})}},{key:"status",value:function(){return this.api.status()}},{key:"changeSettings",value:function(t){return this.api.didSelectDevice()?this.api.changeSettings(t):Promise.reject(d.mustSelectDevice)}},{key:"goOffline",value:function(){this.api.goOffline()}},{key:"goOnline",value:function(){this.api.goOnline()}},{key:"skill",value:function(t){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.api.didSelectDevice()){e.next=2;break}return e.abrupt("return",Promise.reject(d.mustSelectDevice));case 2:return e.next=4,this.api.skills.get(t);case 4:if(null!==(n=e.sent)){e.next=7;break}return e.abrupt("return",Promise.reject(new Error("Access denied for: ".concat(t,". Make sure the skill is installed."))));case 7:return e.abrupt("return",{metric:function(t){var e="skill~".concat(n.id,"~").concat(t),o=new c.Observable((function(n){var r=i.api.metrics.subscribe({metric:e,labels:[t],atomic:!0}),o=i.api.metrics.on(r,(function(){n.next.apply(n,arguments)}));return function(){i.api.metrics.unsubscribe(r,o)}})).pipe(l.map((function(e){return e[t]})));return Object.defineProperty(o,"next",{value:function(n){i.api.metrics.next(e,r({},t,n))}}),o}});case 8:case"end":return e.stop()}}),e,this)})))}},{key:"training",get:function(){var t=this;return{record:function(e){if(!t.api.didSelectDevice())throw d.mustSelectDevice;var n=t.api.user&&"uid"in t.api.user?t.api.user.uid:null,r=Object.assign(Object.assign({fit:!1,baseline:!1,timestamp:t.api.timestamp},e),{userId:n});t.api.actions.dispatch({command:"training",action:"record",message:r})},stop:function(e){if(!t.api.didSelectDevice())throw d.mustSelectDevice;t.api.actions.dispatch({command:"training",action:"stop",message:Object.assign({},e)})},stopAll:function(){if(!t.api.didSelectDevice())throw d.mustSelectDevice;t.api.actions.dispatch({command:"training",action:"stopAll",message:{}})}}}}]),t}();n.Notion=v,v.credentialWithLink=h.credentialWithLink,v.createUser=h.createUser,v.SERVER_TIMESTAMP=h.SERVER_TIMESTAMP},{rxjs:"iRqj","rxjs/operators":"cVrl","./api/index":"LXvB","./utils/whileOnline":"s7Vt","./utils/subscription":"yLLB","./utils/errors":"WDyG"}],DCNc:[function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Notion");n.createNotionOnDevice=function(t){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.Notion(t),e.t0=Object,e.t1=Object,e.t2={},e.next=6,n.skill(t.skill.bundleId);case 6:return e.t3=e.sent,e.t4=e.t1.assign.call(e.t1,e.t2,e.t3),e.t5={props:"props"in t.skill?t.skill.props:{}},r=e.t0.assign.call(e.t0,e.t4,e.t5),delete n.skill,e.abrupt("return",[n,r]);case 12:case"end":return e.stop()}}),e)})))}},{"../Notion":"KQ4u"}],T9Vd:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});var o=t("./NotionOnDevice");n.createSkill=function(t){var e=this;return{subscribe:function(n){return i(e,void 0,void 0,regeneratorRuntime.mark((function e(){var s,a,u,c,l,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.createNotionOnDevice(Object.assign({},n));case 2:return s=e.sent,a=r(s,2),u=a[0],c=a[1],e.next=8,u.enableLocalMode(!0).catch((function(t){return console.error(t.message)}));case 8:return l=t(u,c),e.abrupt("return",{unsubscribe:function(){return i(h,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.disconnect();case 2:if(!l||!("then"in l)){t.next=7;break}return t.next=5,l;case 5:"function"==typeof(e=t.sent)&&e();case 7:if("function"!=typeof l||!("then"in l())){t.next=11;break}return t.next=10,l();case 10:return t.abrupt("return",t.sent);case 11:if("function"!=typeof l){t.next=13;break}return t.abrupt("return",l());case 13:return t.abrupt("return",l);case 14:case"end":return t.stop()}}),t)})))}});case 10:case"end":return e.stop()}}),e)})))}}}},{"./NotionOnDevice":"DCNc"}],d8ek:[function(t,e,n){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),r(t("./createSkill")),r(t("./NotionOnDevice"))},{"./createSkill":"T9Vd","./NotionOnDevice":"DCNc"}],QCba:[function(t,e,n){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),r(t("./Notion")),r(t("./skills"))},{"./Notion":"KQ4u","./skills":"d8ek"}]},{},["QCba"])},1308:t=>{function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=1308,t.exports=e},9742:(t,e)=>{"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,o=u(t),s=o[0],a=o[1],c=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;return 2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,c[l++]=255&e),1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e),c},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=16383,a=0,u=r-i;a<u;a+=s)o.push(c(t,a,a+s>u?u:a+s));return 1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},942:function(t,e,n){var r,i,o;t.exports=(r=n(5840),i={463:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))};const i=n(913).w3cwebsocket;class o{constructor(t){this._socket=null,this.onconnect=()=>{},this.onGenericSignal=t=>{},this.onStateVector=t=>{},this.onSignalProperties=t=>{},this.onStateFormat=t=>{},this.ondisconnect=()=>{},this.onReceiveBlock=()=>{},this.callingFrom="",this.states={},this.signal=null,this.signalProperties=null,this.stateFormat=null,this.stateVecOrder=null,this.SignalType={INT16:0,FLOAT24:1,FLOAT32:2,INT32:3},this.address=t}getNullTermString(t){var e="";let n=0;for(;n<t.byteLength;){var r=t.getUint8(n);if(n++,0==r)break;e+=String.fromCharCode(r)}return e}connect(t,e){let n=this;return void 0===n.address&&(n.address=t),this.callingFrom=e,new Promise(((t,e)=>{n._socket=new i(n.address),n._socket.binaryType="arraybuffer",n._socket.onerror=()=>{e("Error connecting to data source at "+n.address)},n._socket.onopen=()=>{n.onconnect(),t()},n._socket.onclose=t=>{n.ondisconnect(),setTimeout((()=>{console.log("Disconnected"),this.connect("")}),1e3)},n._socket.onmessage=t=>{n._decodeMessage(t.data)}}))}connected(){return null!=this._socket&&this._socket.readyState===i.OPEN}_decodeMessage(t){let e=new DataView(t,0,1).getUint8(0);switch(e){case 3:let n=new DataView(t,1,t.byteLength-1);this._decodeStateFormat(n);break;case 4:let r=new DataView(t,1,2).getUint8(0);switch(r){case 1:let e=new DataView(t,2,t.byteLength-2);this._decodeGenericSignal(e);break;case 3:let n=new DataView(t,2,t.byteLength-2);this._decodeSignalProperties(n);break;default:console.error("Unsupported Supplement: "+r.toString())}this.onReceiveBlock();break;case 5:let i=new DataView(t,1,t.byteLength-1);this._decodeStateVector(i);break;default:console.error("Unsupported Descriptor: "+e.toString())}}_decodePhysicalUnits(t){let e;e={};let n=t.split(" "),r=0;return e.offset=Number(n[r++]),e.gain=Number(n[r++]),e.symbol=n[r++],e.vmin=Number(n[r++]),e.vmax=Number(n[r++]),e}_decodeSignalProperties(t){let e=this.getNullTermString(t);e=e.replace(/{/g," { "),e=e.replace(/}/g," } "),this.signalProperties={};let n=e.split(" "),r=[];for(let t=0;t<n.length;t++)""!==n[t].trim()&&r.push(n[t]);let i=0;if(this.signalProperties.name=r[i++],this.signalProperties.channels=[],"{"===r[i]){for(;"}"!==r[++i];)this.signalProperties.channels.push(r[i]);i++}else{let t=parseInt(r[i++]);for(let e=0;e<t;e++)this.signalProperties.channels.push((e+1).toString())}if(this.signalProperties.elements=[],"{"===r[i]){for(;"}"!==r[++i];)this.signalProperties.elements.push(r[i]);i++}else{let t=parseInt(r[i++]);for(let e=0;e<t;e++)this.signalProperties.elements.push((e+1).toString())}this.signalProperties.numelements=this.signalProperties.elements.length,this.signalProperties.signaltype=r[i++],this.signalProperties.channelunit=this._decodePhysicalUnits(r.slice(i,i+=5).join(" ")),this.signalProperties.elementunit=this._decodePhysicalUnits(r.slice(i,i+=5).join(" ")),i++,this.signalProperties.valueunits=[];for(let t=0;t<this.signalProperties.channels.length;t++)this.signalProperties.valueunits.push(this._decodePhysicalUnits(r.slice(i,i+=5).join(" ")));i++,this.onSignalProperties(this.signalProperties)}_decodeStateFormat(t){this.stateFormat={};let e=this.getNullTermString(t).split("\n");for(let t=0;t<e.length;t++){if(0===e[t].trim().length)continue;let n=e[t].split(" "),r=n[0];this.stateFormat[r]={},this.stateFormat[r].bitWidth=parseInt(n[1]),this.stateFormat[r].defaultValue=parseInt(n[2]),this.stateFormat[r].byteLocation=parseInt(n[3]),this.stateFormat[r].bitLocation=parseInt(n[4])}let n=[];for(let t in this.stateFormat){let e=8*this.stateFormat[t].byteLocation;e+=this.stateFormat[t].bitLocation,n.push([t,e])}n.sort(((t,e)=>t[1]<e[1]?-1:t[1]>e[1]?1:0)),this.stateVecOrder=[];for(let t=0;t<n.length;t++){let e=n[t][0];this.stateVecOrder.push([e,this.stateFormat[e].bitWidth])}this.onStateFormat(this.stateFormat)}_decodeGenericSignal(t){let e=0,n=t.getUint8(e);e+=1;let r=t.getUint16(e,!0);e+=2;let i=t.getUint16(e,!0);e+=2,e+=t.byteOffset;let o=new DataView(t.buffer,e),s=[];for(let t=0;t<r;++t){s.push([]);for(let e=0;e<i;++e)switch(n){case this.SignalType.INT16:s[t].push(o.getInt16(2*(i*t+e),!0));break;case this.SignalType.FLOAT32:s[t].push(o.getFloat32(4*(i*t+e),!0));break;case this.SignalType.INT32:s[t].push(o.getInt32(4*(i*t+e),!0));break;case this.SignalType.FLOAT24:s[t].push(0)}}this.signal=s,this.onGenericSignal(s)}_decodeStateVector(t){if(null==this.stateVecOrder)return;let e=new Int8Array(t.buffer),n=e.indexOf(0),r=e.indexOf(0,n+1),i=new TextDecoder,o=parseInt(i.decode(e.slice(1,n))),s=parseInt(i.decode(e.slice(n+1,r))),a=r+1,u=new DataView(t.buffer,a),c={};for(let t in this.stateFormat)c[t]=Array(s).fill(this.stateFormat[t].defaultValue);for(let t=0;t<s;t++){let e=new Uint8Array(u.buffer,u.byteOffset+t*o,o),n=[];for(let t=0;t<e.length;t++)n.push(0!=(1&e[t])?1:0),n.push(0!=(2&e[t])?1:0),n.push(0!=(4&e[t])?1:0),n.push(0!=(8&e[t])?1:0),n.push(0!=(16&e[t])?1:0),n.push(0!=(32&e[t])?1:0),n.push(0!=(64&e[t])?1:0),n.push(0!=(128&e[t])?1:0);for(let e=0;e<this.stateVecOrder.length;e++){let r=this.stateFormat[this.stateVecOrder[e][0]],i=8*r.byteLocation+r.bitLocation,o=0,s=1;for(let t=0;t<r.bitWidth;t++)n[i+t]&&(o=(o|s)>>>0),s=s<<1>>>0;c[this.stateVecOrder[e][0]][t]=o}}this.onStateVector(c),this.states=c}}t.exports={bciOperator:class{constructor(t){this.ondisconnect=()=>{},this.onStateChange=t=>{},this._execid=0,this._exec={},this.state="",this.address=t}connect(t){return new Promise(((e,n)=>{void 0===this.address&&(this.address=t||"ws://127.0.0.1:80"),this.websocket=new i(this.address),this.websocket.onerror=t=>{n("Error connecting to BCI2000 at "+this.address)},this.websocket.onopen=()=>{e()},this.websocket.onclose=()=>{this.ondisconnect()},this.websocket.onmessage=t=>{let{opcode:e,id:n,contents:r}=JSON.parse(t.data);switch(e){case"O":this._exec[n](r),delete this._exec[n]}}}))}tap(t){let e=this,n="WS"+t+"Server";return this.execute("Get Parameter "+n).then((t=>{if(t.indexOf("does not exist")>=0)return Promise.reject("Location parameter does not exist");if(""===t)return Promise.reject("Location parameter not set");let n=new o;return n.connect(e.address+":"+t.split(":")[1],"").then((t=>n))}))}connected(){return null!==this.websocket&&this.websocket.readyState===i.OPEN}execute(t){let e=this;return this.connected()?new Promise(((n,r)=>{let i=(++e._execid).toString();e._exec[i]=t=>n(t),e.websocket.send(JSON.stringify({opcode:"E",id:i,contents:t}))})):Promise.reject("Cannot execute instruction: not connected to BCI2000")}getVersion(){this.execute("Version").then((t=>console.log(t.split(" ")[1])))}showWindow(){return this.execute("Show Window")}hideWindow(){return this.execute("Hide Window")}setWatch(t,e,n){return this.execute("Add watch "+t+" at "+e+":"+n)}resetSystem(){return this.execute("Reset System")}setConfig(){return this.execute("Set Config")}start(){return this.execute("Start")}stop(){return this.execute("Stop")}kill(){return this.execute("Exit")}stateListen(){setInterval((()=>{this.execute("GET SYSTEM STATE").then((t=>{t.trim()!=this.state&&(this.onStateChange(t.trim()),this.state=t.trim())}))}),500)}getSubjectName(){return r(this,void 0,void 0,(function*(){return yield this.execute("Get Parameter SubjectName")}))}getTaskName(){return r(this,void 0,void 0,(function*(){return yield this.execute("Get Parameter DataFile")}))}getParameters(){return r(this,void 0,void 0,(function*(){let t,e=(yield this.execute("List Parameters")).split("\n"),n={};return e.forEach((e=>{let r=e.split("=")[0],i=r.split(" ")[1],o=r.split(" ")[2],s=r.split(" ")[0].split(":");s.forEach(((e,r)=>{switch(r){case 0:null==n[s[0]]&&(n[s[0]]={}),t=n[s[0]];break;case 1:null==n[s[0]][s[1]]&&(n[s[0]][s[1]]={}),t=n[s[0]][s[1]];break;case 2:null==n[s[0]][s[1]][s[2]]&&(n[s[0]][s[1]][s[2]]={}),t=n[s[0]][s[1]][s[2]]}})),"matrix"!=i&&4==e.split("=")[1].split("//")[0].trim().split(" ").length?t[o]={dataType:i,value:{value:e.split("=")[1].split("//")[0].trim().split(" ")[0],defaultValue:e.split("=")[1].split("//")[0].trim().split(" ")[1],low:e.split("=")[1].split("//")[0].trim().split(" ")[2],high:e.split("=")[1].split("//")[0].trim().split(" ")[3]},comment:e.split("=")[1].split("//")[1]}:t[o]={dataType:i,value:e.split("=")[1].split("//")[0].trim(),comment:e.split("=")[1].split("//")[1]}})),n}))}},bciData:o}},913:t=>{"use strict";t.exports=r}},o={},function t(e){var n=o[e];if(void 0!==n)return n.exports;var r=o[e]={exports:{}};return i[e].call(r.exports,r,r.exports,t),r.exports}(463))},8764:(t,e,n)=>{"use strict";var r=n(9742),i=n(645),o=n(5826);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=a(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=a(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return T(this,e,n);case"latin1":case"binary":return x(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function m(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function w(t,e,n,r){return z(U(e,t.length-n),t,n,r)}function _(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return _(t,e,n,r)}function O(t,e,n,r){return z(V(e),t,n,r)}function E(t,e,n,r){return z(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==n.g.TYPED_ARRAY_SUPPORT?n.g.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):y.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return m(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return S(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function x(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function k(t,e,n){var r,i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var o="",s=e;s<n;++s)o+=(r=t[s])<16?"0"+r.toString(16):r.toString(16);return o}function P(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function N(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function R(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function j(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(t,e,n,r,o){return o||j(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||j(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||N(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||N(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||N(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||N(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||N(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||N(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||N(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return M(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return M(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:U(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}},9956:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(4015),i=n.n(r),o=n(3645),s=n.n(o)()(i());s.push([t.id,"\n* {\n    font-family: 'Montserrat', sans-serif;\n}\n\nhtml {\n    overflow: scroll;\n    overflow-x: hidden;\n    overflow-y: hidden;\n\n    }\n    ::-webkit-scrollbar {\n        width: 0px; \n        height: 0px; \n    }\n\nbody {\n    margin: 0;\n}\n\ndiv {\n    box-sizing: border-box; \n}\n\na {\n    color: rgb(155, 155, 155);\n    text-decoration: none;\n    transition: color 0.5s;\n}\n\na:hover{\n    color: rgb(200, 200, 200)\n}\n\n\n/* Intro UI */\n._2TR2g26icjUsxCB02bwweX {\n    color: white;\n}\n\n._2tSKrhqHjyUmCK44ZD6MAk {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    position: absolute;\n    top: 0;\n    left: 0;\n    box-sizing: border-box;\n    text-align: left;\n    height: 100%;\n    width: 100%;\n    padding: 5%;\n    color: white;\n    background: black;\n    z-index: 1;\n    /* line-height: 3em; */\n    transition: opacity 1.5s;\n}\n\n._2tSKrhqHjyUmCK44ZD6MAk div {\n    width: 100%;\n}\n\n._2tSKrhqHjyUmCK44ZD6MAk h1 {\n    font-size: 10vw;\n    margin: 0px;\n    text-transform: uppercase;\n    width: 100%;\n}\n\n._2tSKrhqHjyUmCK44ZD6MAk p {\n    font-size: 0.8em;\n    width: 100%;\n}\n\n.FRnRP78B4kztTN4FiSGmv {\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    background: #ffffff;\n    margin-top: 50px;\n    z-index: 2;\n    transform: scaleX(0);\n    transform-origin: top left;\n    transition: transform 1.5s;\n    will-change: transform;\n}\n\n.FRnRP78B4kztTN4FiSGmv._1xosdaSZqWQvx2_whTq56C\n{\n    transform-origin: 100% 0;\n    transition: transform 1.5s ease-in-out;\n}\n\n._31Wu406l0g2uf1kMjkhSkj {\n    box-sizing: border-box; \n    /* min-width: 50px; */\n    min-height: 50px;\n    flex-grow: 1;\n    width: 200px;\n    /* max-width: 48%; */\n    position: relative;\n    padding: 5px;\n    margin: 5px;\n    border-radius: 5px;\n    font-size: 80%;\n    background: black;\n    color: white;\n    border: 1px solid rgb(200, 200, 200);\n    text-align: left;\n    transition: 0.5s;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    pointer-events: 'auto'\n}\n\n._31Wu406l0g2uf1kMjkhSkj:hover {\n    background-color: rgb(35,35,35);\n}\n\n\n\n/* Device Selector */\n\n.MUdX-QijL5TDjcWpieiEf{\n    display: flex;\n    align-items: center;\n    /* grid-template-columns: repeat(2,1fr); */\n} \n\n.MUdX-QijL5TDjcWpieiEf ._31Wu406l0g2uf1kMjkhSkj{\n    max-width: 100px;\n    margin-left: 25px;\n    font-size: 80%;\n}\n\n._2WtdmIyJCGVeuJq-iDdNwx {\n    width: 100%;\n    display: flex;\n    flex-wrap: wrap;\n    /* border: 1px solid white; */\n} \n\n.wjlM69i4nvJitsmEtYWZ6 {\n    display: flex;\n    flex-wrap: wrap;\n    flex-grow: 1;\n    background: rgba(35,35,35,0.75);\n    padding: 25px;\n    margin: 10px;\n    border-radius: 5px;;\n    position: relative;\n}.CaYpgSuB5NPPUHl-6vOHe {\n    width: 100%;\n    display: flex;\n}h3 {\n    margin: 10px;\n}\n\n.HsvIVU2KWQOPQI9gGnRqL{\n    background:rgb(15,15,15);\n    padding: 10px;\n    margin: 10px;\n    flex-grow: 1;\n    border-radius: 5px;;\n    position: relative;\n}.I2itSkGECeeoWWX1190cj {\n    width: 100%;\n    display: flex;\n}h4 {\n    margin: 10px;\n}\n\n.IPutyR6ALzyEcOdfmjFra{\n    /* width: 50px; */\n    flex-grow: 1;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    transition: 0.5s;\n    border: 1px solid rgb(200, 200, 200);\n    border-radius: 5px;\n    font-size: 70%;\n    margin: 5px;\n    position: relative;\n}\n\n.IPutyR6ALzyEcOdfmjFra:hover {\n    background-color: rgb(35,35,35);\n}\n\n\n._1E9_VvsbtxT3MpvT8Nf923{\n    position: absolute;\n    width: 7px;\n    height: 7px;\n    background: transparent;\n    top: 10px;\n    right: 10px;\n    /* transform: translate(-50%,-50%)  */\n    border-radius: 50%;\n    border: 1px solid white;\n    /* opacity: 0.5; */\n}\n\n._1E9_VvsbtxT3MpvT8Nf923.smSL8F-lhPkPutUT7M8Ok {\n    background: lime;\n    border: none;\n}","",{version:3,sources:["webpack://./src/libraries/js/src/ui/styles/defaults.css"],names:[],mappings:";AACA;IACI,qCAAqC;AACzC;;AAEA;IACI,gBAAgB;IAChB,kBAAkB;IAClB,kBAAkB;;IAElB;IACA;QACI,UAAU;QACV,WAAW;IACf;;AAEJ;IACI,SAAS;AACb;;AAEA;IACI,sBAAsB;AAC1B;;AAEA;IACI,yBAAyB;IACzB,qBAAqB;IACrB,sBAAsB;AAC1B;;AAEA;IACI;AACJ;;;AAGA,aAAa;AACb;IACI,YAAY;AAChB;;AAEA;IACI,aAAa;IACb,eAAe;IACf,mBAAmB;IACnB,kBAAkB;IAClB,MAAM;IACN,OAAO;IACP,sBAAsB;IACtB,gBAAgB;IAChB,YAAY;IACZ,WAAW;IACX,WAAW;IACX,YAAY;IACZ,iBAAiB;IACjB,UAAU;IACV,sBAAsB;IACtB,wBAAwB;AAC5B;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,eAAe;IACf,WAAW;IACX,yBAAyB;IACzB,WAAW;AACf;;AAEA;IACI,gBAAgB;IAChB,WAAW;AACf;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,WAAW;IACX,WAAW;IACX,mBAAmB;IACnB,gBAAgB;IAChB,UAAU;IACV,oBAAoB;IACpB,0BAA0B;IAC1B,0BAA0B;IAC1B,sBAAsB;AAC1B;;AAEA;;IAEI,wBAAwB;IACxB,sCAAsC;AAC1C;;AAEA;IACI,sBAAsB;IACtB,qBAAqB;IACrB,gBAAgB;IAChB,YAAY;IACZ,YAAY;IACZ,oBAAoB;IACpB,kBAAkB;IAClB,YAAY;IACZ,WAAW;IACX,kBAAkB;IAClB,cAAc;IACd,iBAAiB;IACjB,YAAY;IACZ,oCAAoC;IACpC,gBAAgB;IAChB,gBAAgB;IAChB,gBAAgB;IAChB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,eAAe;IACf;AACJ;;AAEA;IACI,+BAA+B;AACnC;;;;AAIA,oBAAoB;;AAEpB;IACI,aAAa;IACb,mBAAmB;IACnB,0CAA0C;AAC9C;;AAEA;IACI,gBAAgB;IAChB,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI,WAAW;IACX,aAAa;IACb,eAAe;IACf,6BAA6B;AACjC;;AAEA;IACI,aAAa;IACb,eAAe;IACf,YAAY;IACZ,+BAA+B;IAC/B,aAAa;IACb,YAAY;IACZ,kBAAkB;IAClB,kBAAkB;AACtB,CAAC;IACG,WAAW;IACX,aAAa;AACjB,CAAC;IACG,YAAY;AAChB;;AAEA;IACI,wBAAwB;IACxB,aAAa;IACb,YAAY;IACZ,YAAY;IACZ,kBAAkB;IAClB,kBAAkB;AACtB,CAAC;IACG,WAAW;IACX,aAAa;AACjB,CAAC;IACG,YAAY;AAChB;;AAEA;IACI,iBAAiB;IACjB,YAAY;IACZ,YAAY;IACZ,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,eAAe;IACf,gBAAgB;IAChB,oCAAoC;IACpC,kBAAkB;IAClB,cAAc;IACd,WAAW;IACX,kBAAkB;AACtB;;AAEA;IACI,+BAA+B;AACnC;;;AAGA;IACI,kBAAkB;IAClB,UAAU;IACV,WAAW;IACX,uBAAuB;IACvB,SAAS;IACT,WAAW;IACX,qCAAqC;IACrC,kBAAkB;IAClB,uBAAuB;IACvB,kBAAkB;AACtB;;AAEA;IACI,gBAAgB;IAChB,YAAY;AAChB",sourcesContent:["\n* {\n    font-family: 'Montserrat', sans-serif;\n}\n\nhtml {\n    overflow: scroll;\n    overflow-x: hidden;\n    overflow-y: hidden;\n\n    }\n    ::-webkit-scrollbar {\n        width: 0px; \n        height: 0px; \n    }\n\nbody {\n    margin: 0;\n}\n\ndiv {\n    box-sizing: border-box; \n}\n\na {\n    color: rgb(155, 155, 155);\n    text-decoration: none;\n    transition: color 0.5s;\n}\n\na:hover{\n    color: rgb(200, 200, 200)\n}\n\n\n/* Intro UI */\n.brainsatplay-default-menu {\n    color: white;\n}\n\n.brainsatplay-default-container {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    position: absolute;\n    top: 0;\n    left: 0;\n    box-sizing: border-box;\n    text-align: left;\n    height: 100%;\n    width: 100%;\n    padding: 5%;\n    color: white;\n    background: black;\n    z-index: 1;\n    /* line-height: 3em; */\n    transition: opacity 1.5s;\n}\n\n.brainsatplay-default-container div {\n    width: 100%;\n}\n\n.brainsatplay-default-container h1 {\n    font-size: 10vw;\n    margin: 0px;\n    text-transform: uppercase;\n    width: 100%;\n}\n\n.brainsatplay-default-container p {\n    font-size: 0.8em;\n    width: 100%;\n}\n\n.brainsatplay-intro-loadingbar {\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    background: #ffffff;\n    margin-top: 50px;\n    z-index: 2;\n    transform: scaleX(0);\n    transform-origin: top left;\n    transition: transform 1.5s;\n    will-change: transform;\n}\n\n.brainsatplay-intro-loadingbar.ended\n{\n    transform-origin: 100% 0;\n    transition: transform 1.5s ease-in-out;\n}\n\n.brainsatplay-default-button {\n    box-sizing: border-box; \n    /* min-width: 50px; */\n    min-height: 50px;\n    flex-grow: 1;\n    width: 200px;\n    /* max-width: 48%; */\n    position: relative;\n    padding: 5px;\n    margin: 5px;\n    border-radius: 5px;\n    font-size: 80%;\n    background: black;\n    color: white;\n    border: 1px solid rgb(200, 200, 200);\n    text-align: left;\n    transition: 0.5s;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    pointer-events: 'auto'\n}\n\n.brainsatplay-default-button:hover {\n    background-color: rgb(35,35,35);\n}\n\n\n\n/* Device Selector */\n\n.brainsatplay-header-grid{\n    display: flex;\n    align-items: center;\n    /* grid-template-columns: repeat(2,1fr); */\n} \n\n.brainsatplay-header-grid .brainsatplay-default-button{\n    max-width: 100px;\n    margin-left: 25px;\n    font-size: 80%;\n}\n\n.brainsatplay-device-gallery {\n    width: 100%;\n    display: flex;\n    flex-wrap: wrap;\n    /* border: 1px solid white; */\n} \n\n.brainsatplay-companyCard {\n    display: flex;\n    flex-wrap: wrap;\n    flex-grow: 1;\n    background: rgba(35,35,35,0.75);\n    padding: 25px;\n    margin: 10px;\n    border-radius: 5px;;\n    position: relative;\n}.devices {\n    width: 100%;\n    display: flex;\n}h3 {\n    margin: 10px;\n}\n\n.brainsatplay-deviceCard{\n    background:rgb(15,15,15);\n    padding: 10px;\n    margin: 10px;\n    flex-grow: 1;\n    border-radius: 5px;;\n    position: relative;\n}.variants {\n    width: 100%;\n    display: flex;\n}h4 {\n    margin: 10px;\n}\n\n.brainsatplay-variantButton{\n    /* width: 50px; */\n    flex-grow: 1;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    transition: 0.5s;\n    border: 1px solid rgb(200, 200, 200);\n    border-radius: 5px;\n    font-size: 70%;\n    margin: 5px;\n    position: relative;\n}\n\n.brainsatplay-variantButton:hover {\n    background-color: rgb(35,35,35);\n}\n\n\n.indicator{\n    position: absolute;\n    width: 7px;\n    height: 7px;\n    background: transparent;\n    top: 10px;\n    right: 10px;\n    /* transform: translate(-50%,-50%)  */\n    border-radius: 50%;\n    border: 1px solid white;\n    /* opacity: 0.5; */\n}\n\n.indicator.on {\n    background: lime;\n    border: none;\n}"],sourceRoot:""}]),s.locals={"brainsatplay-default-menu":"_2TR2g26icjUsxCB02bwweX","brainsatplay-default-container":"_2tSKrhqHjyUmCK44ZD6MAk","brainsatplay-intro-loadingbar":"FRnRP78B4kztTN4FiSGmv",ended:"_1xosdaSZqWQvx2_whTq56C","brainsatplay-default-button":"_31Wu406l0g2uf1kMjkhSkj","brainsatplay-header-grid":"MUdX-QijL5TDjcWpieiEf","brainsatplay-device-gallery":"_2WtdmIyJCGVeuJq-iDdNwx","brainsatplay-companyCard":"wjlM69i4nvJitsmEtYWZ6",devices:"CaYpgSuB5NPPUHl-6vOHe","brainsatplay-deviceCard":"HsvIVU2KWQOPQI9gGnRqL",variants:"I2itSkGECeeoWWX1190cj","brainsatplay-variantButton":"IPutyR6ALzyEcOdfmjFra",indicator:"_1E9_VvsbtxT3MpvT8Nf923",on:"smSL8F-lhPkPutUT7M8Ok"};const a=s},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<t.length;a++){var u=[].concat(t[a]);r&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),e.push(u))}},e}},4015:t=>{"use strict";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}t.exports=function(t){var n,r,i=(r=4,function(t){if(Array.isArray(t))return t}(n=t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(n,r)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[1],s=i[3];if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),c="/*# ".concat(u," */"),l=s.sources.map((function(t){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(t," */")}));return[o].concat(l).concat([c]).join("\n")}return[o].join("\n")}},284:t=>{var e=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}()},7187:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,r){function i(){void 0!==o&&t.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==e&&(o=function(n){t.removeListener(e,i),r(n)},t.once("error",o)),t.once(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function c(t,e,n,r){var i,o,s,c;if(a(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=u(t))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=s.length,c=l,console&&console.warn&&console.warn(c)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function f(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):d(i,i.length)}function p(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=o[t];if(void 0===u)return!1;if("function"==typeof u)r(u,this,e);else{var c=u.length,l=d(u,c);for(n=0;n<c;++n)r(l[n],this,e)}return!0},o.prototype.addListener=function(t,e){return c(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return c(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,h(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,h(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,r,i,o,s;if(a(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},o.prototype.listeners=function(t){return f(this,t,!0)},o.prototype.rawListeners=function(t){return f(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},6123:t=>{!function(e){const n=2*Math.PI;var r;r=function(t,e){var r=Math.random(),i=Math.random(),o=Math.sqrt(-2*Math.log(r))*Math.cos(n*i);return Math.sqrt(-2*Math.log(r)),Math.sin(n*i),o*e+t},t.exports=r}()},1481:(t,e,n)=>{!function(e){const r=n(6123);var i=function(t){var e=Math.abs(t),n=1/(1+e/2),r=n*Math.exp(-e*e-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(n*(.27886807+n*(n*(1.48851587+n*(.17087277*n-.82215223))-1.13520398))-.18628806)))));return t>=0?r:2-r},o=function(t,e){if(e<=0)throw new Error("Variance must be > 0 (but was "+e+")");this.mean=t,this.variance=e,this.standardDeviation=Math.sqrt(e)};o.prototype.pdf=function(t){var e=this.standardDeviation*Math.sqrt(2*Math.PI);return Math.exp(-Math.pow(t-this.mean,2)/(2*this.variance))/e},o.prototype.cdf=function(t){return.5*i(-(t-this.mean)/(this.standardDeviation*Math.sqrt(2)))},o.prototype.ppf=function(t){return this.mean-this.standardDeviation*Math.sqrt(2)*function(t){if(t>=2)return-100;if(t<=0)return 100;for(var e=t<1?t:2-t,n=Math.sqrt(-2*Math.log(e/2)),r=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n),o=0;o<2;o++){var s=i(r)-e;r+=s/(1.1283791670955126*Math.exp(-r*r)-r*s)}return t<1?r:-r}(2*t)},o.prototype.mul=function(t){if("number"==typeof t)return this.scale(t);var e=1/this.variance,n=1/t.variance;return u(e+n,e*this.mean+n*t.mean)},o.prototype.div=function(t){if("number"==typeof t)return this.scale(1/t);var e=1/this.variance,n=1/t.variance;return u(e-n,e*this.mean-n*t.mean)},o.prototype.add=function(t){return a(this.mean+t.mean,this.variance+t.variance)},o.prototype.sub=function(t){return a(this.mean-t.mean,this.variance+t.variance)},o.prototype.scale=function(t){return a(this.mean*t,this.variance*t*t)},o.prototype.random=function(t){let e=this.mean,n=this.standardDeviation;return Array(t).fill(0).map((()=>r(e,n)))};var s,a=function(t,e){return new o(t,e)},u=function(t,e){return a(e/t,1/t)};s=a,t.exports=s}()},645:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*y}},5826:t=>{var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},4139:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);function i(t){for(var e=[],n=0;n<t.length;n++)n%3==0?e.push(t[n]<<4|t[n+1]>>4):(e.push((15&t[n])<<8|t[n+1]),n++);return e}function o(t,e){function n(n){return{x:e*t.getInt16(n),y:e*t.getInt16(n+2),z:e*t.getInt16(n+4)}}return{sequenceId:t.getUint16(0),samples:[n(2),n(8),n(14)]}}e.parseControl=function(t){return t.pipe(r.concatMap((function(t){return t.split("")})),r.scan((function(t,e){return t.indexOf("}")>=0?e:t+e}),""),r.filter((function(t){return t.indexOf("}")>=0})),r.map((function(t){return JSON.parse(t)})))},e.decodeUnsigned12BitData=i,e.decodeEEGSamples=function(t){return i(t).map((function(t){return.48828125*(t-2048)}))},e.parseTelemetry=function(t){return{sequenceId:t.getUint16(0),batteryLevel:t.getUint16(2)/512,fuelGaugeVoltage:2.2*t.getUint16(4),temperature:t.getUint16(8)}},e.parseAccelerometer=function(t){return o(t,610352e-10)},e.parseGyroscope=function(t){return o(t,.0074768)}},7338:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(4143),s=n(1717);e.decodeResponse=function(t){return(new TextDecoder).decode(t.subarray(1,1+t[0]))},e.encodeCommand=function(t){var e=(new TextEncoder).encode("X"+t+"\n");return e[0]=e.length-1,e},e.observableCharacteristic=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,t.startNotifications()];case 1:return n.sent(),e=o.fromEvent(t.service.device,"gattserverdisconnected"),[2,o.fromEvent(t,"characteristicvaluechanged").pipe(s.takeUntil(e),s.map((function(t){return t.target.value})))]}}))}))}},1335:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4143),i=n(1717),o=n(2306);e.zipSamples=function(t){var e=[],n=null;return t.pipe(i.mergeMap((function(t){if(t.timestamp!==n&&(n=t.timestamp,e.length)){var i=r.from([e.slice()]);return e.splice(0,e.length,t),i}return e.push(t),r.from([])})),i.concat(r.from([e])),i.mergeMap((function(t){var e=t[0].samples.map((function(e,n){for(var r=[NaN,NaN,NaN,NaN,NaN],i=0,s=t;i<s.length;i++){var a=s[i];r[a.electrode]=a.samples[n]}return{data:r,index:t[0].index,timestamp:t[0].timestamp+1e3*n/o.EEG_FREQUENCY}}));return r.from(e)})))}},2306:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(4143),s=n(1717),a=n(4139),u=n(7338),c=n(1335);e.zipSamples=c.zipSamples,e.MUSE_SERVICE=65165;var l=["273e0003-4c4d-454d-96be-f03bac821358","273e0004-4c4d-454d-96be-f03bac821358","273e0005-4c4d-454d-96be-f03bac821358","273e0006-4c4d-454d-96be-f03bac821358","273e0007-4c4d-454d-96be-f03bac821358"];e.EEG_FREQUENCY=256,e.channelNames=["TP9","AF7","AF8","TP10","AUX"];var h=function(){function t(){this.enableAux=!1,this.deviceName="",this.connectionStatus=new o.BehaviorSubject(!1),this.gatt=null,this.lastIndex=null,this.lastTimestamp=null}return t.prototype.connect=function(t){return r(this,void 0,void 0,(function(){var n,r,c,h,f,p,d,y,v,g,b,m,w,_,S,O,E=this;return i(this,(function(A){switch(A.label){case 0:return t?(this.gatt=t,[3,4]):[3,1];case 1:return[4,navigator.bluetooth.requestDevice({filters:[{services:[e.MUSE_SERVICE]}]})];case 2:return n=A.sent(),r=this,[4,n.gatt.connect()];case 3:r.gatt=A.sent(),A.label=4;case 4:return this.deviceName=this.gatt.device.name||null,[4,this.gatt.getPrimaryService(e.MUSE_SERVICE)];case 5:return c=A.sent(),o.fromEvent(this.gatt.device,"gattserverdisconnected").pipe(s.first()).subscribe((function(){E.gatt=null,E.connectionStatus.next(!1)})),h=this,[4,c.getCharacteristic("273e0001-4c4d-454d-96be-f03bac821358")];case 6:return h.controlChar=A.sent(),f=this,[4,u.observableCharacteristic(this.controlChar)];case 7:return f.rawControlData=A.sent().pipe(s.map((function(t){return u.decodeResponse(new Uint8Array(t.buffer))})),s.share()),this.controlResponses=a.parseControl(this.rawControlData),[4,c.getCharacteristic("273e000b-4c4d-454d-96be-f03bac821358")];case 8:return p=A.sent(),d=this,[4,u.observableCharacteristic(p)];case 9:return d.telemetryData=A.sent().pipe(s.map(a.parseTelemetry)),[4,c.getCharacteristic("273e0009-4c4d-454d-96be-f03bac821358")];case 10:return y=A.sent(),v=this,[4,u.observableCharacteristic(y)];case 11:return v.gyroscopeData=A.sent().pipe(s.map(a.parseGyroscope)),[4,c.getCharacteristic("273e000a-4c4d-454d-96be-f03bac821358")];case 12:return g=A.sent(),b=this,[4,u.observableCharacteristic(g)];case 13:b.accelerometerData=A.sent().pipe(s.map(a.parseAccelerometer)),this.eventMarkers=new o.Subject,this.eegCharacteristics=[],m=[],w=this.enableAux?l.length:4,_=function(t){var e,n,r,o;return i(this,(function(i){switch(i.label){case 0:return e=l[t],[4,c.getCharacteristic(e)];case 1:return n=i.sent(),o=(r=m).push,[4,u.observableCharacteristic(n)];case 2:return o.apply(r,[i.sent().pipe(s.map((function(e){var n=e.getUint16(0);return{electrode:t,index:n,samples:a.decodeEEGSamples(new Uint8Array(e.buffer).subarray(2)),timestamp:E.getTimestamp(n)}})))]),S.eegCharacteristics.push(n),[2]}}))},S=this,O=0,A.label=14;case 14:return O<w?[5,_(O)]:[3,17];case 15:A.sent(),A.label=16;case 16:return O++,[3,14];case 17:return this.eegReadings=o.merge.apply(void 0,m),this.connectionStatus.next(!0),[2]}}))}))},t.prototype.sendCommand=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.controlChar.writeValue(u.encodeCommand(t))];case 1:return e.sent(),[2]}}))}))},t.prototype.start=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this.pause()];case 1:return e.sent(),t=this.enableAux?"p20":"p21",[4,this.controlChar.writeValue(u.encodeCommand(t))];case 2:return e.sent(),[4,this.controlChar.writeValue(u.encodeCommand("s"))];case 3:return e.sent(),[4,this.resume()];case 4:return e.sent(),[2]}}))}))},t.prototype.pause=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.sendCommand("h")];case 1:return t.sent(),[2]}}))}))},t.prototype.resume=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.sendCommand("d")];case 1:return t.sent(),[2]}}))}))},t.prototype.deviceInfo=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=this.controlResponses.pipe(s.filter((function(t){return!!t.fw})),s.take(1)).toPromise(),[4,this.sendCommand("v1")];case 1:return e.sent(),[2,t]}}))}))},t.prototype.injectMarker=function(t,e){return void 0===e&&(e=(new Date).getTime()),r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.eventMarkers.next({value:t,timestamp:e})];case 1:return n.sent(),[2]}}))}))},t.prototype.disconnect=function(){this.gatt&&(this.lastIndex=null,this.lastTimestamp=null,this.gatt.disconnect(),this.connectionStatus.next(!1))},t.prototype.getTimestamp=function(t){var n=1/e.EEG_FREQUENCY*1e3*12;for(null!==this.lastIndex&&null!==this.lastTimestamp||(this.lastIndex=t,this.lastTimestamp=(new Date).getTime()-n);this.lastIndex-t>4096;)t+=65536;return t===this.lastIndex?this.lastTimestamp:t>this.lastIndex?(this.lastTimestamp+=n*(t-this.lastIndex),this.lastIndex=t,this.lastTimestamp):this.lastTimestamp-n*(this.lastIndex-t)},t}();e.MuseClient=h},4155:t=>{var e,n,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var a,u=[],c=!1,l=-1;function h(){c&&a&&(c=!1,a.length?u=a.concat(u):l=-1,u.length&&f())}function f(){if(!c){var t=s(h);c=!0;for(var e=u.length;e;){for(a=u,u=[];++l<e;)a&&a[l].run();l=-1,e=u.length}a=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function d(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||c||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},1407:(t,e,n)=>{"use strict";var r=n(9742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50;var s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,u.prototype),e}function u(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return c(t,e,n)}function c(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|y(t,e),r=a(n),i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(V(t,Uint8Array)){var e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(V(t,ArrayBuffer)||t&&V(t.buffer,ArrayBuffer))return p(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(V(t,SharedArrayBuffer)||t&&V(t.buffer,SharedArrayBuffer)))return p(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return u.from(r,e,n);var i=function(t){if(u.isBuffer(t)){var e=0|d(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||z(t.length)?a(0):f(t):"Buffer"===t.type&&Array.isArray(t.data)?f(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return u.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return l(t),a(t<0?0:0|d(t))}function f(t){for(var e=t.length<0?0:0|d(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function p(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,u.prototype),r}function d(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function y(t,e){if(u.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||V(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(i)return r?-1:L(t).length;e=(""+e).toLowerCase(),i=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return T(this,e,n);case"latin1":case"binary":return x(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),z(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(z(a))return s;t[n+s]=a}return s}function _(t,e,n,r){return U(L(e,t.length-n),t,n,r)}function S(t,e,n,r){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function O(t,e,n,r){return U(F(e),t,n,r)}function E(t,e,n,r){return U(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}(r)}e.kMaxLength=s,u.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(t,e,n){return function(t,e,n){return l(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},u.allocUnsafe=function(t){return h(t)},u.allocUnsafeSlow=function(t){return h(t)},u.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==u.prototype},u.compare=function(t,e){if(V(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),V(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(V(o,Uint8Array))i+o.length>r.length?u.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},u.byteLength=y,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?C(this,0,t):v.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(t,e,n,r,i){if(V(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return _(this,t,e,n);case"ascii":case"latin1":case"binary":return S(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function x(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function k(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=q[t[o]];return i}function P(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function N(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,o){return e=+e,n>>>=0,o||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function j(t,e,n,r,o){return e=+e,n>>>=0,o||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,u.prototype),r},u.prototype.readUintLE=u.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUintBE=u.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUint8=u.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||N(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUint8=u.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,1,255,0),this[e]=255&t,e+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(!u.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:u.from(t,r),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var M=/[^+/0-9A-Za-z-_]/g;function L(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(M,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function V(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function z(t){return t!=t}var q=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()},5666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof v?e:v,o=Object.create(i.prototype),s=new T(r||[]);return o._invoke=function(t,e,n){var r=h;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return k()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=A(s,n);if(a){if(a===y)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?d:f,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",y={};function v(){}function g(){}function b(){}var m={};m[o]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(x([])));_&&_!==n&&r.call(_,o)&&(m=_);var S=b.prototype=v.prototype=Object.create(m);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,o,s,a){var u=l(t[i],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(u.arg)}var i;this._invoke=function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}}function A(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function x(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:k}}function k(){return{value:e,done:!0}}return g.prototype=S.constructor=b,b.constructor=g,g.displayName=u(b,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,a,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},O(E.prototype),E.prototype[s]=function(){return this},t.AsyncIterator=E,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new E(c(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},O(S),u(S,a,"Generator"),S[o]=function(){return this},S.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=x,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},7576:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4143);e.BehaviorSubject=r.BehaviorSubject},5345:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4143);e.Subject=r.Subject},969:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4143);e.fromEvent=r.fromEvent},5624:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);e.filter=r.filter},6097:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);e.first=r.first},1709:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);e.map=r.map},3895:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);e.mergeMap=r.mergeMap},6740:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);e.takeUntil=r.takeUntil},698:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1717);e.tap=r.tap},9122:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(7576))},8314:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(5345))},4143:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ArgumentOutOfRangeError:()=>k.W,AsyncSubject:()=>l.c,BehaviorSubject:()=>u.X,ConnectableObservable:()=>i.c,EMPTY:()=>Q.E,EmptyError:()=>P.K,GroupedObservable:()=>o.T,NEVER:()=>ht,Notification:()=>A.P,NotificationKind:()=>A.W,ObjectUnsubscribedError:()=>N.N,Observable:()=>r.y,ReplaySubject:()=>c.t,Scheduler:()=>S.b,Subject:()=>a.xQ,Subscriber:()=>E.L,Subscription:()=>O.w,TimeoutError:()=>D.W,UnsubscriptionError:()=>B.B,VirtualAction:()=>_,VirtualTimeScheduler:()=>w,animationFrame:()=>m,animationFrameScheduler:()=>b,asap:()=>h.e,asapScheduler:()=>h.E,async:()=>f.P,asyncScheduler:()=>f.z,bindCallback:()=>F,bindNodeCallback:()=>z,combineLatest:()=>H.aj,concat:()=>Y.z,config:()=>xt.v,defer:()=>K.P,empty:()=>Q.c,forkJoin:()=>Z,from:()=>X.D,fromEvent:()=>et,fromEventPattern:()=>rt,generate:()=>it,identity:()=>T.y,iif:()=>st,interval:()=>ut,isObservable:()=>x,merge:()=>lt.T,never:()=>ft,noop:()=>I.Z,observable:()=>s.L,of:()=>pt.of,onErrorResumeNext:()=>dt,pairs:()=>yt,partition:()=>wt,pipe:()=>C.z,queue:()=>p.c,queueScheduler:()=>p.N,race:()=>_t.S3,range:()=>St,scheduled:()=>Tt.x,throwError:()=>Et._,timer:()=>At.H,using:()=>Ct,zip:()=>It.$R});var r=n(2772),i=n(3140),o=n(1120),s=n(5050),a=n(211),u=n(9233),c=n(2630),l=n(364),h=n(6650),f=n(964),p=n(2546),d=n(5987),y=n(6114),v=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return d.ZT(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},e}(y.o),g=n(8399),b=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d.ZT(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(g.v))(v),m=b,w=function(t){function e(e,n){void 0===e&&(e=_),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=t.call(this,e,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return d.ZT(e,t),e.prototype.flush=function(){for(var t,e,n=this.actions,r=this.maxFrames;(e=n[0])&&e.delay<=r&&(n.shift(),this.frame=e.delay,!(t=e.execute(e.state,e.delay))););if(t){for(;e=n.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(g.v),_=function(t){function e(e,n,r){void 0===r&&(r=e.index+=1);var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.index=r,i.active=!0,i.index=e.index=r,i}return d.ZT(e,t),e.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return t.prototype.schedule.call(this,n,r);this.active=!1;var i=new e(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},e.prototype.requestAsyncId=function(t,n,r){void 0===r&&(r=0),this.delay=t.frame+r;var i=t.actions;return i.push(this),i.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,e,n){void 0===n&&(n=0)},e.prototype._execute=function(e,n){if(!0===this.active)return t.prototype._execute.call(this,e,n)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(y.o),S=n(8725),O=n(8760),E=n(979),A=n(2632),C=n(2561),I=n(3306),T=n(3608);function x(t){return!!t&&(t instanceof r.y||"function"==typeof t.lift&&"function"==typeof t.subscribe)}var k=n(6565),P=n(6929),N=n(1016),B=n(8782),D=n(1462),R=n(5709),j=n(3642),M=n(9026),L=n(7507);function F(t,e,n){if(e){if(!(0,L.K)(e))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return F(t,n).apply(void 0,r).pipe((0,R.U)((function(t){return(0,M.k)(t)?e.apply(void 0,t):e(t)})))};n=e}return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o,s=this,a={context:s,subject:o,callbackFunc:t,scheduler:n};return new r.y((function(r){if(n){var i={args:e,subscriber:r,params:a};return n.schedule(U,0,i)}if(!o){o=new l.c;try{t.apply(s,e.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.next(t.length<=1?t[0]:t),o.complete()}]))}catch(t){(0,j._)(o)?o.error(t):console.warn(t)}}return o.subscribe(r)}))}}function U(t){var e=this,n=t.args,r=t.subscriber,i=t.params,o=i.callbackFunc,s=i.context,a=i.scheduler,u=i.subject;if(!u){u=i.subject=new l.c;try{o.apply(s,n.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.length<=1?t[0]:t;e.add(a.schedule(V,0,{value:r,subject:u}))}]))}catch(t){u.error(t)}}this.add(u.subscribe(r))}function V(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function z(t,e,n){if(e){if(!(0,L.K)(e))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return z(t,n).apply(void 0,r).pipe((0,R.U)((function(t){return(0,M.k)(t)?e.apply(void 0,t):e(t)})))};n=e}return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o={subject:void 0,args:e,callbackFunc:t,scheduler:n,context:this};return new r.y((function(r){var i=o.context,s=o.subject;if(n)return n.schedule(q,0,{params:o,subscriber:r,context:i});if(!s){s=o.subject=new l.c;try{t.apply(i,e.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();n?s.error(n):(s.next(t.length<=1?t[0]:t),s.complete())}]))}catch(t){(0,j._)(s)?s.error(t):console.warn(t)}}return s.subscribe(r)}))}}function q(t){var e=this,n=t.params,r=t.subscriber,i=t.context,o=n.callbackFunc,s=n.args,a=n.scheduler,u=n.subject;if(!u){u=n.subject=new l.c;try{o.apply(i,s.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.shift();if(r)e.add(a.schedule(G,0,{err:r,subject:u}));else{var i=t.length<=1?t[0]:t;e.add(a.schedule(W,0,{value:i,subject:u}))}}]))}catch(t){this.add(a.schedule(G,0,{err:t,subject:u}))}}this.add(u.subscribe(r))}function W(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function G(t){var e=t.err;t.subject.error(e)}var H=n(5142),Y=n(9795),K=n(1410),Q=n(5631),J=n(2009),X=n(5760);function Z(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var n=t[0];if((0,M.k)(n))return $(n,null);if((0,J.K)(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return $(r.map((function(t){return n[t]})),r)}}if("function"==typeof t[t.length-1]){var i=t.pop();return $(t=1===t.length&&(0,M.k)(t[0])?t[0]:t,null).pipe((0,R.U)((function(t){return i.apply(void 0,t)})))}return $(t,null)}function $(t,e){return new r.y((function(n){var r=t.length;if(0!==r)for(var i=new Array(r),o=0,s=0,a=function(a){var u=(0,X.D)(t[a]),c=!1;n.add(u.subscribe({next:function(t){c||(c=!0,s++),i[a]=t},error:function(t){return n.error(t)},complete:function(){++o!==r&&c||(s===r&&n.next(e?e.reduce((function(t,e,n){return t[e]=i[n],t}),{}):i),n.complete())}}))},u=0;u<r;u++)a(u);else n.complete()}))}var tt=n(4156);function et(t,e,n,i){return(0,tt.m)(n)&&(i=n,n=void 0),i?et(t,e,n).pipe((0,R.U)((function(t){return(0,M.k)(t)?i.apply(void 0,t):i(t)}))):new r.y((function(r){nt(t,e,(function(t){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(t)}),r,n)}))}function nt(t,e,n,r,i){var o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,n,i),o=function(){return s.removeEventListener(e,n,i)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var a=t;t.on(e,n),o=function(){return a.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var u=t;t.addListener(e,n),o=function(){return u.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var c=0,l=t.length;c<l;c++)nt(t[c],e,n,r,i)}r.add(o)}function rt(t,e,n){return n?rt(t,e).pipe((0,R.U)((function(t){return(0,M.k)(t)?n.apply(void 0,t):n(t)}))):new r.y((function(n){var r,i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.next(1===t.length?t[0]:t)};try{r=t(i)}catch(t){return void n.error(t)}if((0,tt.m)(e))return function(){return e(i,r)}}))}function it(t,e,n,i,o){var s,a;if(1==arguments.length){var u=t;a=u.initialState,e=u.condition,n=u.iterate,s=u.resultSelector||T.y,o=u.scheduler}else void 0===i||(0,L.K)(i)?(a=t,s=T.y,o=i):(a=t,s=i);return new r.y((function(t){var r=a;if(o)return o.schedule(ot,0,{subscriber:t,iterate:n,condition:e,resultSelector:s,state:r});for(;;){if(e){var i=void 0;try{i=e(r)}catch(e){return void t.error(e)}if(!i){t.complete();break}}var u=void 0;try{u=s(r)}catch(e){return void t.error(e)}if(t.next(u),t.closed)break;try{r=n(r)}catch(e){return void t.error(e)}}}))}function ot(t){var e=t.subscriber,n=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(t){return void e.error(t)}else t.needIterate=!0;if(n){var r=void 0;try{r=n(t.state)}catch(t){return void e.error(t)}if(!r)return void e.complete();if(e.closed)return}var i;try{i=t.resultSelector(t.state)}catch(t){return void e.error(t)}if(!e.closed&&(e.next(i),!e.closed))return this.schedule(t)}}function st(t,e,n){return void 0===e&&(e=Q.E),void 0===n&&(n=Q.E),(0,K.P)((function(){return t()?e:n}))}var at=n(5812);function ut(t,e){return void 0===t&&(t=0),void 0===e&&(e=f.P),(!(0,at.k)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=f.P),new r.y((function(n){return n.add(e.schedule(ct,t,{subscriber:n,counter:0,period:t})),n}))}function ct(t){var e=t.subscriber,n=t.counter,r=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}var lt=n(4370),ht=new r.y(I.Z);function ft(){return ht}var pt=n(8170);function dt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)return Q.E;var n=t[0],i=t.slice(1);return 1===t.length&&(0,M.k)(n)?dt.apply(void 0,n):new r.y((function(t){var e=function(){return t.add(dt.apply(void 0,i).subscribe(t))};return(0,X.D)(n).subscribe({next:function(e){t.next(e)},error:e,complete:e})}))}function yt(t,e){return e?new r.y((function(n){var r=Object.keys(t),i=new O.w;return i.add(e.schedule(vt,0,{keys:r,index:0,subscriber:n,subscription:i,obj:t})),i})):new r.y((function(e){for(var n=Object.keys(t),r=0;r<n.length&&!e.closed;r++){var i=n[r];t.hasOwnProperty(i)&&e.next([i,t[i]])}e.complete()}))}function vt(t){var e=t.keys,n=t.index,r=t.subscriber,i=t.subscription,o=t.obj;if(!r.closed)if(n<e.length){var s=e[n];r.next([s,o[s]]),i.add(this.schedule({keys:e,index:n+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}var gt=n(8463),bt=n(7843),mt=n(6008);function wt(t,e,n){return[(0,mt.h)(e,n)(new r.y((0,bt.s)(t))),(0,mt.h)((0,gt.f)(e,n))(new r.y((0,bt.s)(t)))]}var _t=n(8821);function St(t,e,n){return void 0===t&&(t=0),new r.y((function(r){void 0===e&&(e=t,t=0);var i=0,o=t;if(n)return n.schedule(Ot,0,{index:i,count:e,start:t,subscriber:r});for(;;){if(i++>=e){r.complete();break}if(r.next(o++),r.closed)break}}))}function Ot(t){var e=t.start,n=t.index,r=t.count,i=t.subscriber;n>=r?i.complete():(i.next(e),i.closed||(t.index=n+1,t.start=e+1,this.schedule(t)))}var Et=n(4944),At=n(9604);function Ct(t,e){return new r.y((function(n){var r,i;try{r=t()}catch(t){return void n.error(t)}try{i=e(r)}catch(t){return void n.error(t)}var o=(i?(0,X.D)(i):Q.E).subscribe(n);return function(){o.unsubscribe(),r&&r.unsubscribe()}}))}var It=n(5080),Tt=n(8107),xt=n(150)},364:(t,e,n)=>{"use strict";n.d(e,{c:()=>s});var r=n(5987),i=n(211),o=n(8760),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return r.ZT(e,t),e.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),o.w.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),o.w.EMPTY):t.prototype._subscribe.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(i.xQ)},9233:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(5987),i=n(211),o=n(1016),s=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return r.ZT(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.N;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(i.xQ)},2632:(t,e,n)=>{"use strict";n.d(e,{W:()=>r,P:()=>a});var r,i=n(5631),o=n(8170),s=n(4944);r||(r={});var a=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return(0,o.of)(this.value);case"E":return(0,s._)(this.error);case"C":return(0,i.c)()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}()},2772:(t,e,n)=>{"use strict";n.d(e,{y:()=>l});var r=n(3642),i=n(979),o=n(3142),s=n(2174),a=n(5050),u=n(2561),c=n(150),l=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,a=function(t,e,n){if(t){if(t instanceof i.L)return t;if(t[o.b])return t[o.b]()}return t||e||n?new i.L(t,e,n):new i.L(s.c)}(t,e,n);if(r?a.add(r.call(a,this.source)):a.add(this.source||c.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),c.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){c.v.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),(0,r._)(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=h(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(t){r(t),i&&i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[a.L]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:(0,u.U)(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=h(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function h(t){if(t||(t=c.v.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},2174:(t,e,n)=>{"use strict";n.d(e,{c:()=>o});var r=n(150),i=n(1644),o={closed:!0,next:function(t){},error:function(t){if(r.v.useDeprecatedSynchronousErrorHandling)throw t;(0,i.z)(t)},complete:function(){}}},2039:(t,e,n)=>{"use strict";n.d(e,{L:()=>i});var r=n(5987),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.ZT(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(n(979).L)},2630:(t,e,n)=>{"use strict";n.d(e,{t:()=>l});var r=n(5987),i=n(211),o=n(2546),s=n(8760),a=n(9276),u=n(1016),c=n(8253),l=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=e<1?1:e,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return r.ZT(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new h(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new u.N;if(this.isStopped||this.hasError?e=s.w.EMPTY:(this.observers.push(t),e=new c.W(this,t)),i&&t.add(t=new a.ht(t,i)),n)for(var l=0;l<o&&!t.closed;l++)t.next(r[l]);else for(l=0;l<o&&!t.closed;l++)t.next(r[l].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||o.c).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r},e}(i.xQ),h=function(){return function(t,e){this.time=t,this.value=e}}()},8725:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});var r=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}()},211:(t,e,n)=>{"use strict";n.d(e,{Yc:()=>l,xQ:()=>h});var r=n(5987),i=n(2772),o=n(979),s=n(8760),a=n(1016),u=n(8253),c=n(3142),l=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return r.ZT(e,t),e}(o.L),h=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.ZT(e,t),e.prototype[c.b]=function(){return new l(this)},e.prototype.lift=function(t){var e=new f(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.N;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.N;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new a.N;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new a.N;return this.hasError?(t.error(this.thrownError),s.w.EMPTY):this.isStopped?(t.complete(),s.w.EMPTY):(this.observers.push(t),new u.W(this,t))},e.prototype.asObservable=function(){var t=new i.y;return t.source=this,t},e.create=function(t,e){return new f(t,e)},e}(i.y),f=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return r.ZT(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):s.w.EMPTY},e}(h)},8253:(t,e,n)=>{"use strict";n.d(e,{W:()=>i});var r=n(5987),i=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return r.ZT(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(n(8760).w)},979:(t,e,n)=>{"use strict";n.d(e,{L:()=>l});var r=n(5987),i=n(4156),o=n(2174),s=n(8760),a=n(3142),u=n(150),c=n(1644),l=function(t){function e(n,r,i){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=o.c;break;case 1:if(!n){s.destination=o.c;break}if("object"==typeof n){n instanceof e?(s.syncErrorThrowable=n.syncErrorThrowable,s.destination=n,n.add(s)):(s.syncErrorThrowable=!0,s.destination=new h(s,n));break}default:s.syncErrorThrowable=!0,s.destination=new h(s,n,r,i)}return s}return r.ZT(e,t),e.prototype[a.b]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(s.w),h=function(t){function e(e,n,r,s){var a,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return(0,i.m)(n)?a=n:n&&(a=n.next,r=n.error,s=n.complete,n!==o.c&&(c=Object.create(n),(0,i.m)(c.unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=a,u._error=r,u._complete=s,u}return r.ZT(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=u.v.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,c.z)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,c.z)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};u.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),u.v.useDeprecatedSynchronousErrorHandling)throw t;(0,c.z)(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!u.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return u.v.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):((0,c.z)(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(l)},8760:(t,e,n)=>{"use strict";n.d(e,{w:()=>a});var r=n(9026),i=n(2009),o=n(4156),s=n(8782),a=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,a=n._parentOrParents,c=n._ctorUnsubscribe,l=n._unsubscribe,h=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,a instanceof t)a.remove(this);else if(null!==a)for(var f=0;f<a.length;++f)a[f].remove(this);if((0,o.m)(l)){c&&(this._unsubscribe=void 0);try{l.call(this)}catch(t){e=t instanceof s.B?u(t.errors):[t]}}if((0,r.k)(h)){f=-1;for(var p=h.length;++f<p;){var d=h[f];if((0,i.K)(d))try{d.unsubscribe()}catch(t){e=e||[],t instanceof s.B?e=e.concat(u(t.errors)):e.push(t)}}}if(e)throw new s.B(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function u(t){return t.reduce((function(t,e){return t.concat(e instanceof s.B?e.errors:e)}),[])}},150:(t,e,n)=>{"use strict";n.d(e,{v:()=>i});var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack,r=t},get useDeprecatedSynchronousErrorHandling(){return r}}},7604:(t,e,n)=>{"use strict";n.d(e,{IY:()=>a,Ds:()=>u,ft:()=>c});var r=n(5987),i=n(979),o=n(2772),s=n(7843),a=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return r.ZT(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(i.L),u=(i.L,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.ZT(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(i.L));function c(t,e){if(!e.closed){if(t instanceof o.y)return t.subscribe(e);var n;try{n=(0,s.s)(t)(e)}catch(t){e.error(t)}return n}}i.L},3140:(t,e,n)=>{"use strict";n.d(e,{c:()=>c,N:()=>l});var r=n(5987),i=n(211),o=n(2772),s=n(979),a=n(8760),u=n(3018),c=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return r.ZT(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new a.w).add(this.source.subscribe(new h(this.getSubject(),this))),t.closed&&(this._connection=null,t=a.w.EMPTY)),t},e.prototype.refCount=function(){return(0,u.x)()(this)},e}(o.y),l=function(){var t=c.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),h=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return r.ZT(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(i.Yc);s.L},5142:(t,e,n)=>{"use strict";n.d(e,{aj:()=>l,Ms:()=>h});var r=n(5987),i=n(7507),o=n(9026),s=n(2039),a=n(2080),u=n(3375),c={};function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=void 0,r=void 0;return(0,i.K)(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&(0,o.k)(t[0])&&(t=t[0]),(0,u.n)(t,r).lift(new h(n))}var h=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new f(t,this.resultSelector))},t}(),f=function(t){function e(e,n){var r=t.call(this,e)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.ZT(e,t),e.prototype._next=function(t){this.values.push(c),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add((0,a.D)(this,r,void 0,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n){var r=this.values,i=r[n],o=this.toRespond?i===c?--this.toRespond:this.toRespond:0;r[n]=e,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.L)},9795:(t,e,n)=>{"use strict";n.d(e,{z:()=>o});var r=n(8170),i=n(2257);function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,i.u)()(r.of.apply(void 0,t))}},1410:(t,e,n)=>{"use strict";n.d(e,{P:()=>s});var r=n(2772),i=n(5760),o=n(5631);function s(t){return new r.y((function(e){var n;try{n=t()}catch(t){return void e.error(t)}return(n?(0,i.D)(n):(0,o.c)()).subscribe(e)}))}},5631:(t,e,n)=>{"use strict";n.d(e,{E:()=>i,c:()=>o});var r=n(2772),i=new r.y((function(t){return t.complete()}));function o(t){return t?function(t){return new r.y((function(e){return t.schedule((function(){return e.complete()}))}))}(t):i}},5760:(t,e,n)=>{"use strict";n.d(e,{D:()=>s});var r=n(2772),i=n(7843),o=n(8107);function s(t,e){return e?(0,o.x)(t,e):t instanceof r.y?t:new r.y((0,i.s)(t))}},3375:(t,e,n)=>{"use strict";n.d(e,{n:()=>s});var r=n(2772),i=n(6900),o=n(3109);function s(t,e){return e?(0,o.r)(t,e):new r.y((0,i.V)(t))}},4370:(t,e,n)=>{"use strict";n.d(e,{T:()=>a});var r=n(2772),i=n(7507),o=n(2556),s=n(3375);function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,a=null,u=t[t.length-1];return(0,i.K)(u)?(a=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof u&&(n=t.pop()),null===a&&1===t.length&&t[0]instanceof r.y?t[0]:(0,o.J)(n)((0,s.n)(t,a))}},8170:(t,e,n)=>{"use strict";n.d(e,{of:()=>s});var r=n(7507),i=n(3375),o=n(3109);function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return(0,r.K)(n)?(t.pop(),(0,o.r)(t,n)):(0,i.n)(t)}},8821:(t,e,n)=>{"use strict";n.d(e,{S3:()=>u});var r=n(5987),i=n(9026),o=n(3375),s=n(2039),a=n(2080);function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){if(!(0,i.k)(t[0]))return t[0];t=t[0]}return(0,o.n)(t,void 0).lift(new c)}var c=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new l(t))},t}(),l=function(t){function e(e){var n=t.call(this,e)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return r.ZT(e,t),e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var n=0;n<e&&!this.hasFirst;n++){var r=t[n],i=(0,a.D)(this,r,void 0,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},e.prototype.notifyNext=function(t,e,n){if(!this.hasFirst){this.hasFirst=!0;for(var r=0;r<this.subscriptions.length;r++)if(r!==n){var i=this.subscriptions[r];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(e)},e}(s.L)},4944:(t,e,n)=>{"use strict";n.d(e,{_:()=>i});var r=n(2772);function i(t,e){return e?new r.y((function(n){return e.schedule(o,0,{error:t,subscriber:n})})):new r.y((function(e){return e.error(t)}))}function o(t){var e=t.error;t.subscriber.error(e)}},9604:(t,e,n)=>{"use strict";n.d(e,{H:()=>a});var r=n(2772),i=n(964),o=n(5812),s=n(7507);function a(t,e,n){void 0===t&&(t=0);var a=-1;return(0,o.k)(e)?a=Number(e)<1?1:Number(e):(0,s.K)(e)&&(n=e),(0,s.K)(n)||(n=i.P),new r.y((function(e){var r=(0,o.k)(t)?t:+t-n.now();return n.schedule(u,r,{index:0,period:a,subscriber:e})}))}function u(t){var e=t.index,n=t.period,r=t.subscriber;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}},5080:(t,e,n)=>{"use strict";n.d(e,{$R:()=>c,mx:()=>l});var r=n(5987),i=n(3375),o=n(9026),s=n(979),a=n(999),u=n(7604);function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return"function"==typeof n&&t.pop(),(0,i.n)(t,void 0).lift(new l(n))}var l=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.resultSelector))},t}(),h=function(t){function e(e,n,r){void 0===r&&(r=Object.create(null));var i=t.call(this,e)||this;return i.resultSelector=n,i.iterators=[],i.active=0,i.resultSelector="function"==typeof n?n:void 0,i}return r.ZT(e,t),e.prototype._next=function(t){var e=this.iterators;(0,o.k)(t)?e.push(new p(t)):"function"==typeof t[a.hZ]?e.push(new f(t[a.hZ]())):e.push(new d(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var n=0;n<e;n++){var r=t[n];r.stillUnsubscribed?this.destination.add(r.subscribe()):this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,n=this.destination,r=0;r<e;r++)if("function"==typeof(s=t[r]).hasValue&&!s.hasValue())return;var i=!1,o=[];for(r=0;r<e;r++){var s,a=(s=t[r]).next();if(s.hasCompleted()&&(i=!0),a.done)return void n.complete();o.push(a.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},e.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.L),f=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return Boolean(t&&t.done)},t}(),p=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[a.hZ]=function(){return this},t.prototype.next=function(t){var e=this.index++,n=this.array;return e<this.length?{value:n[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),d=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return r.ZT(e,t),e.prototype[a.hZ]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t){this.buffer.push(t),this.parent.checkIterators()},e.prototype.subscribe=function(){return(0,u.ft)(this.observable,new u.IY(this))},e}(u.Ds)},2257:(t,e,n)=>{"use strict";n.d(e,{u:()=>i});var r=n(2556);function i(){return(0,r.J)(1)}},6008:(t,e,n)=>{"use strict";n.d(e,{h:()=>o});var r=n(5987),i=n(979);function o(t,e){return function(n){return n.lift(new s(t,e))}}var s=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.thisArg))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return r.ZT(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(i.L)},1120:(t,e,n)=>{"use strict";n.d(e,{v:()=>u,T:()=>f});var r=n(5987),i=n(979),o=n(8760),s=n(2772),a=n(211);function u(t,e,n,r){return function(i){return i.lift(new c(t,e,n,r))}}var c=function(){function t(t,e,n,r){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=r}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),l=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.keySelector=n,s.elementSelector=r,s.durationSelector=i,s.subjectSelector=o,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return r.ZT(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},e.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var r,i=n.get(e);if(this.elementSelector)try{r=this.elementSelector(t)}catch(t){this.error(t)}else r=t;if(!i){i=this.subjectSelector?this.subjectSelector():new a.xQ,n.set(e,i);var o=new f(e,i,this);if(this.destination.next(o),this.durationSelector){var s=void 0;try{s=this.durationSelector(new f(e,i))}catch(t){return void this.error(t)}this.add(s.subscribe(new h(e,i,this)))}}i.closed||i.next(r)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach((function(e,n){e.error(t)})),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach((function(t,e){t.complete()})),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(i.L),h=function(t){function e(e,n,r){var i=t.call(this,n)||this;return i.key=e,i.group=n,i.parent=r,i}return r.ZT(e,t),e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},e}(i.L),f=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.groupSubject=n,i.refCountSubscription=r,i}return r.ZT(e,t),e.prototype._subscribe=function(t){var e=new o.w,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&e.add(new p(n)),e.add(r.subscribe(t)),e},e}(s.y),p=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,e.count++,n}return r.ZT(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(o.w)},5709:(t,e,n)=>{"use strict";n.d(e,{U:()=>o});var r=n(5987),i=n(979);function o(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}}var s=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.project,this.thisArg))},t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return r.ZT(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(i.L)},2556:(t,e,n)=>{"use strict";n.d(e,{J:()=>o});var r=n(7746),i=n(3608);function o(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),(0,r.zg)(i.y,t)}},7746:(t,e,n)=>{"use strict";n.d(e,{zg:()=>a,VS:()=>l});var r=n(5987),i=n(5709),o=n(5760),s=n(7604);function a(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe(a((function(n,r){return(0,o.D)(t(n,r)).pipe((0,i.U)((function(t,i){return e(n,t,r,i)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new u(t,n))})}var u=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.project,this.concurrent))},t}(),c=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return r.ZT(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new s.IY(this),n=this.destination;n.add(e);var r=(0,s.ft)(t,e);r!==e&&n.add(r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(s.Ds),l=a},9276:(t,e,n)=>{"use strict";n.d(e,{QV:()=>s,ht:()=>u});var r=n(5987),i=n(979),o=n(2632);function s(t,e){return void 0===e&&(e=0),function(n){return n.lift(new a(t,e))}}var a=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))},t}(),u=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e)||this;return i.scheduler=n,i.delay=r,i}return r.ZT(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new c(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.P.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.P.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(o.P.createComplete()),this.unsubscribe()},e}(i.L),c=function(){return function(t,e){this.notification=t,this.destination=e}}()},3018:(t,e,n)=>{"use strict";n.d(e,{x:()=>o});var r=n(5987),i=n(979);function o(){return function(t){return t.lift(new s(t))}}var s=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new a(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return r.ZT(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(i.L)},3109:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(2772),i=n(8760);function o(t,e){return new r.y((function(n){var r=new i.w,o=0;return r.add(e.schedule((function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}},8107:(t,e,n)=>{"use strict";n.d(e,{x:()=>l});var r=n(2772),i=n(8760),o=n(5050),s=n(3109),a=n(999),u=n(336),c=n(9217);function l(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[o.L]}(t))return function(t,e){return new r.y((function(n){var r=new i.w;return r.add(e.schedule((function(){var i=t[o.L]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if((0,u.t)(t))return function(t,e){return new r.y((function(n){var r=new i.w;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if((0,c.z)(t))return(0,s.r)(t,e);if(function(t){return t&&"function"==typeof t[a.hZ]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new r.y((function(n){var r,o=new i.w;return o.add((function(){r&&"function"==typeof r.return&&r.return()})),o.add(e.schedule((function(){r=t[a.hZ](),o.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}},6114:(t,e,n)=>{"use strict";n.d(e,{o:()=>i});var r=n(5987),i=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return r.ZT(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return r.ZT(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(n(8760).w))},8399:(t,e,n)=>{"use strict";n.d(e,{v:()=>o});var r=n(5987),i=n(8725),o=function(t){function e(n,r){void 0===r&&(r=i.b.now);var o=t.call(this,n,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return r.ZT(e,t),e.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,i):t.prototype.schedule.call(this,n,r,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(i.b)},6650:(t,e,n)=>{"use strict";n.d(e,{e:()=>l,E:()=>c});var r=n(5987),i=1,o=function(){return Promise.resolve()}(),s={};function a(t){return t in s&&(delete s[t],!0)}var u=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.ZT(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=(u=e.flush.bind(e,null),c=i++,s[c]=!0,o.then((function(){return a(c)&&u()})),c)));var u,c},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(a(n),e.scheduled=void 0)},e}(n(6114).o),c=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.ZT(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(n(8399).v))(u),l=c},964:(t,e,n)=>{"use strict";n.d(e,{z:()=>i,P:()=>o});var r=n(6114),i=new(n(8399).v)(r.o),o=i},2546:(t,e,n)=>{"use strict";n.d(e,{c:()=>s,N:()=>o});var r=n(5987),i=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.ZT(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(n(6114).o),o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.ZT(e,t),e}(n(8399).v))(i),s=o},999:(t,e,n)=>{"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,{hZ:()=>i});var i=r()},5050:(t,e,n)=>{"use strict";n.d(e,{L:()=>r});var r=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},3142:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});var r=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},6565:(t,e,n)=>{"use strict";n.d(e,{W:()=>r});var r=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}()},6929:(t,e,n)=>{"use strict";n.d(e,{K:()=>r});var r=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}()},1016:(t,e,n)=>{"use strict";n.d(e,{N:()=>r});var r=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}()},1462:(t,e,n)=>{"use strict";n.d(e,{W:()=>r});var r=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}()},8782:(t,e,n)=>{"use strict";n.d(e,{B:()=>r});var r=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}()},3642:(t,e,n)=>{"use strict";n.d(e,{_:()=>i});var r=n(979);function i(t){for(;t;){var e=t,n=e.closed,i=e.destination,o=e.isStopped;if(n||o)return!1;t=i&&i instanceof r.L?i:null}return!0}},1644:(t,e,n)=>{"use strict";function r(t){setTimeout((function(){throw t}),0)}n.d(e,{z:()=>r})},3608:(t,e,n)=>{"use strict";function r(t){return t}n.d(e,{y:()=>r})},9026:(t,e,n)=>{"use strict";n.d(e,{k:()=>r});var r=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}()},9217:(t,e,n)=>{"use strict";n.d(e,{z:()=>r});var r=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t}},4156:(t,e,n)=>{"use strict";function r(t){return"function"==typeof t}n.d(e,{m:()=>r})},5812:(t,e,n)=>{"use strict";n.d(e,{k:()=>i});var r=n(9026);function i(t){return!(0,r.k)(t)&&t-parseFloat(t)+1>=0}},2009:(t,e,n)=>{"use strict";function r(t){return null!==t&&"object"==typeof t}n.d(e,{K:()=>r})},336:(t,e,n)=>{"use strict";function r(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,{t:()=>r})},7507:(t,e,n)=>{"use strict";function r(t){return t&&"function"==typeof t.schedule}n.d(e,{K:()=>r})},3306:(t,e,n)=>{"use strict";function r(){}n.d(e,{Z:()=>r})},8463:(t,e,n)=>{"use strict";function r(t,e){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=t,n.thisArg=e,n}n.d(e,{f:()=>r})},2561:(t,e,n)=>{"use strict";n.d(e,{z:()=>i,U:()=>o});var r=n(3608);function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(t)}function o(t){return 0===t.length?r.y:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}},7843:(t,e,n)=>{"use strict";n.d(e,{s:()=>l});var r=n(6900),i=n(1644),o=n(999),s=n(5050),a=n(9217),u=n(336),c=n(2009),l=function(t){if(t&&"function"==typeof t[s.L])return l=t,function(t){var e=l[s.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if((0,a.z)(t))return(0,r.V)(t);if((0,u.t)(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,i.z),t};if(t&&"function"==typeof t[o.hZ])return e=t,function(t){for(var n=e[o.hZ]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,l,h=(0,c.K)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+h+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},6900:(t,e,n)=>{"use strict";n.d(e,{V:()=>r});var r=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}}},2080:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var r=n(5987),i=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return r.ZT(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(n(979).L),o=n(7843),s=n(2772);function a(t,e,n,r,a){if(void 0===a&&(a=new i(t,n,r)),!a.closed)return e instanceof s.y?e.subscribe(a):(0,o.s)(e)(a)}},1717:(t,e,n)=>{"use strict";n.r(e),n.d(e,{audit:()=>o,auditTime:()=>l,buffer:()=>h,bufferCount:()=>y,bufferTime:()=>w,bufferToggle:()=>k,bufferWhen:()=>B,catchError:()=>j,combineAll:()=>U,combineLatest:()=>q,concat:()=>G,concatAll:()=>H.u,concatMap:()=>K,concatMapTo:()=>Q,count:()=>J,debounce:()=>$,debounceTime:()=>nt,defaultIfEmpty:()=>st,delay:()=>ht,delayWhen:()=>vt,dematerialize:()=>_t,distinct:()=>Et,distinctUntilChanged:()=>It,distinctUntilKeyChanged:()=>kt,elementAt:()=>zt,endWith:()=>Wt,every:()=>Gt,exhaust:()=>Kt,exhaustMap:()=>Zt,expand:()=>ee,filter:()=>Nt.h,finalize:()=>ie,find:()=>ae,findIndex:()=>le,first:()=>fe,flatMap:()=>Y.VS,groupBy:()=>pe.v,ignoreElements:()=>de,isEmpty:()=>ge,last:()=>Oe,map:()=>Xt.U,mapTo:()=>Ee,materialize:()=>Ie,max:()=>Re,merge:()=>Me,mergeAll:()=>Le.J,mergeMap:()=>Y.zg,mergeMapTo:()=>Fe,mergeScan:()=>Ue,min:()=>qe,multicast:()=>Ge,observeOn:()=>Ye.QV,onErrorResumeNext:()=>Ke,pairwise:()=>Xe,partition:()=>en,pluck:()=>nn,publish:()=>sn,publishBehavior:()=>un,publishLast:()=>ln,publishReplay:()=>fn,race:()=>dn,reduce:()=>De,refCount:()=>In.x,repeat:()=>yn,repeatWhen:()=>bn,retry:()=>_n,retryWhen:()=>En,sample:()=>Tn,sampleTime:()=>Pn,scan:()=>ke,sequenceEqual:()=>Rn,share:()=>Un,shareReplay:()=>Vn,single:()=>zn,skip:()=>Gn,skipLast:()=>Kn,skipUntil:()=>Xn,skipWhile:()=>tr,startWith:()=>rr,subscribeOn:()=>ar,switchAll:()=>fr,switchMap:()=>cr,switchMapTo:()=>pr,take:()=>Ft,takeLast:()=>we,takeUntil:()=>dr,takeWhile:()=>gr,tap:()=>Sr,throttle:()=>Cr,throttleTime:()=>xr,throwIfEmpty:()=>Dt,timeInterval:()=>Dr,timeout:()=>Vr,timeoutWith:()=>Mr,timestamp:()=>zr,toArray:()=>Gr,window:()=>Hr,windowCount:()=>Qr,windowTime:()=>Zr,windowToggle:()=>oi,windowWhen:()=>ui,withLatestFrom:()=>hi,zip:()=>yi,zipAll:()=>vi});var r=n(5987),i=n(7604);function o(t){return function(e){return e.lift(new s(t))}}var s=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.durationSelector))},t}(),a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r}return r.ZT(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(t){return this.destination.error(t)}var n=(0,i.ft)(e,new i.IY(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},e.prototype.clearThrottle=function(){var t=this,e=t.value,n=t.hasValue,r=t.throttled;r&&(this.remove(r),this.throttled=void 0,r.unsubscribe()),n&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))},e.prototype.notifyNext=function(){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(i.Ds),u=n(964),c=n(9604);function l(t,e){return void 0===e&&(e=u.P),o((function(){return(0,c.H)(t,e)}))}function h(t){return function(e){return e.lift(new f(t))}}var f=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.closingNotifier))},t}(),p=function(t){function e(e,n){var r=t.call(this,e)||this;return r.buffer=[],r.add((0,i.ft)(n,new i.IY(r))),r}return r.ZT(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(){var t=this.buffer;this.buffer=[],this.destination.next(t)},e}(i.Ds),d=n(979);function y(t,e){return void 0===e&&(e=null),function(n){return n.lift(new v(t,e))}}var v=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?b:g}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),g=function(t){function e(e,n){var r=t.call(this,e)||this;return r.bufferSize=n,r.buffer=[],r}return r.ZT(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(d.L),b=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.bufferSize=n,i.startBufferEvery=r,i.buffers=[],i.count=0,i}return r.ZT(e,t),e.prototype._next=function(t){var e=this,n=e.bufferSize,r=e.startBufferEvery,i=e.buffers,o=e.count;this.count++,o%r==0&&i.push([]);for(var s=i.length;s--;){var a=i[s];a.push(t),a.length===n&&(i.splice(s,1),this.destination.next(a))}},e.prototype._complete=function(){for(var e=this.buffers,n=this.destination;e.length>0;){var r=e.shift();r.length>0&&n.next(r)}t.prototype._complete.call(this)},e}(d.L),m=n(7507);function w(t){var e=arguments.length,n=u.P;(0,m.K)(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],e--);var r=null;e>=2&&(r=arguments[1]);var i=Number.POSITIVE_INFINITY;return e>=3&&(i=arguments[2]),function(e){return e.lift(new _(t,r,i,n))}}var _=function(){function t(t,e,n,r){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new O(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),S=function(){return function(){this.buffer=[]}}(),O=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;s.bufferTimeSpan=n,s.bufferCreationInterval=r,s.maxBufferSize=i,s.scheduler=o,s.contexts=[];var a=s.openContext();if(s.timespanOnly=null==r||r<0,s.timespanOnly){var u={subscriber:s,context:a,bufferTimeSpan:n};s.add(a.closeAction=o.schedule(E,n,u))}else{var c={subscriber:s,context:a},l={bufferTimeSpan:n,bufferCreationInterval:r,subscriber:s,scheduler:o};s.add(a.closeAction=o.schedule(C,n,c)),s.add(o.schedule(A,r,l))}return s}return r.ZT(e,t),e.prototype._next=function(t){for(var e,n=this.contexts,r=n.length,i=0;i<r;i++){var o=n[i],s=o.buffer;s.push(t),s.length==this.maxBufferSize&&(e=o)}e&&this.onBufferFull(e)},e.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts,n=this.destination;e.length>0;){var r=e.shift();n.next(r.buffer)}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var n=this.bufferTimeSpan,r={subscriber:this,context:t,bufferTimeSpan:n};this.add(t.closeAction=this.scheduler.schedule(E,n,r))}},e.prototype.openContext=function(){var t=new S;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;(e?e.indexOf(t):-1)>=0&&e.splice(e.indexOf(t),1)},e}(d.L);function E(t){var e=t.subscriber,n=t.context;n&&e.closeContext(n),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function A(t){var e=t.bufferCreationInterval,n=t.bufferTimeSpan,r=t.subscriber,i=t.scheduler,o=r.openContext();r.closed||(r.add(o.closeAction=i.schedule(C,n,{subscriber:r,context:o})),this.schedule(t,e))}function C(t){var e=t.subscriber,n=t.context;e.closeContext(n)}var I=n(8760),T=n(2080),x=n(2039);function k(t,e){return function(n){return n.lift(new P(t,e))}}var P=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new N(t,this.openings,this.closingSelector))},t}(),N=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.closingSelector=r,i.contexts=[],i.add((0,T.D)(i,n)),i}return r.ZT(e,t),e.prototype._next=function(t){for(var e=this.contexts,n=e.length,r=0;r<n;r++)e[r].buffer.push(t)},e.prototype._error=function(e){for(var n=this.contexts;n.length>0;){var r=n.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var n=e.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e){t?this.closeBuffer(t):this.openBuffer(e)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(t){this._error(t)}},e.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var n=t.buffer,r=t.subscription;this.destination.next(n),e.splice(e.indexOf(t),1),this.remove(r),r.unsubscribe()}},e.prototype.trySubscribe=function(t){var e=this.contexts,n=new I.w,r={buffer:[],subscription:n};e.push(r);var i=(0,T.D)(this,t,r);!i||i.closed?this.closeBuffer(r):(i.context=r,this.add(i),n.add(i))},e}(x.L);function B(t){return function(e){return e.lift(new D(t))}}var D=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new R(t,this.closingSelector))},t}(),R=function(t){function e(e,n){var r=t.call(this,e)||this;return r.closingSelector=n,r.subscribing=!1,r.openBuffer(),r}return r.ZT(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},e.prototype.notifyNext=function(){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{e=(0,this.closingSelector)()}catch(t){return this.error(t)}t=new I.w,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add((0,i.ft)(e,new i.IY(this))),this.subscribing=!1},e}(i.Ds);function j(t){return function(e){var n=new M(t),r=e.lift(n);return n.caught=r}}var M=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new L(t,this.selector,this.caught))},t}(),L=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.selector=n,i.caught=r,i}return r.ZT(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var r=new i.IY(this);this.add(r);var o=(0,i.ft)(n,r);o!==r&&this.add(o)}},e}(i.Ds),F=n(5142);function U(t){return function(e){return e.lift(new F.Ms(t))}}var V=n(9026),z=n(5760);function q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&(0,V.k)(t[0])&&(t=t[0].slice()),function(e){return e.lift.call((0,z.D)([e].concat(t)),new F.Ms(n))}}var W=n(9795);function G(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(W.z.apply(void 0,[e].concat(t)))}}var H=n(2257),Y=n(7746);function K(t,e){return(0,Y.zg)(t,e,1)}function Q(t,e){return K((function(){return t}),e)}function J(t){return function(e){return e.lift(new X(t,e))}}var X=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Z(t,this.predicate,this.source))},t}(),Z=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.source=r,i.count=0,i.index=0,i}return r.ZT(e,t),e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(d.L);function $(t){return function(e){return e.lift(new tt(t))}}var tt=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new et(t,this.durationSelector))},t}(),et=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r}return r.ZT(e,t),e.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,e){var n=this.durationSubscription;this.value=t,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=(0,i.ft)(e,new i.IY(this)))&&!n.closed&&this.add(this.durationSubscription=n)},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var e=this.value,n=this.durationSubscription;n&&(this.durationSubscription=void 0,n.unsubscribe(),this.remove(n)),this.value=void 0,this.hasValue=!1,t.prototype._next.call(this,e)}},e}(i.Ds);function nt(t,e){return void 0===e&&(e=u.P),function(n){return n.lift(new rt(t,e))}}var rt=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new it(t,this.dueTime,this.scheduler))},t}(),it=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return r.ZT(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(ot,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(d.L);function ot(t){t.debouncedNext()}function st(t){return void 0===t&&(t=null),function(e){return e.lift(new at(t))}}var at=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new ut(t,this.defaultValue))},t}(),ut=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return r.ZT(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(d.L);function ct(t){return t instanceof Date&&!isNaN(+t)}var lt=n(2632);function ht(t,e){void 0===e&&(e=u.P);var n=ct(t)?+t-e.now():Math.abs(t);return function(t){return t.lift(new ft(n,e))}}var ft=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new pt(t,this.delay,this.scheduler))},t}(),pt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return r.ZT(e,t),e.dispatch=function(t){for(var e=t.source,n=e.queue,r=t.scheduler,i=t.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(t,o)}else this.unsubscribe(),e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.destination.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,n=new dt(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(lt.P.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(lt.P.createComplete()),this.unsubscribe()},e}(d.L),dt=function(){return function(t,e){this.time=t,this.notification=e}}(),yt=n(2772);function vt(t,e){return e?function(n){return new mt(n,e).lift(new gt(t))}:function(e){return e.lift(new gt(t))}}var gt=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new bt(t,this.delayDurationSelector))},t}(),bt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.delayDurationSelector=n,r.completed=!1,r.delayNotifierSubscriptions=[],r.index=0,r}return r.ZT(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(t),this.removeSubscription(i),this.tryComplete()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},e.prototype._next=function(t){var e=this.index++;try{var n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},e.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},e.prototype.tryDelay=function(t,e){var n=(0,T.D)(this,t,e);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))},e.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},e}(x.L),mt=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subscriptionDelay=n,r}return r.ZT(e,t),e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new wt(t,this.source))},e}(yt.y),wt=function(t){function e(e,n){var r=t.call(this)||this;return r.parent=e,r.source=n,r.sourceSubscribed=!1,r}return r.ZT(e,t),e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(d.L);function _t(){return function(t){return t.lift(new St)}}var St=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Ot(t))},t}(),Ot=function(t){function e(e){return t.call(this,e)||this}return r.ZT(e,t),e.prototype._next=function(t){t.observe(this.destination)},e}(d.L);function Et(t,e){return function(n){return n.lift(new At(t,e))}}var At=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new Ct(t,this.keySelector,this.flushes))},t}(),Ct=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.keySelector=n,o.values=new Set,r&&o.add((0,i.ft)(r,new i.IY(o))),o}return r.ZT(e,t),e.prototype.notifyNext=function(){this.values.clear()},e.prototype.notifyError=function(t){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(t){return void n.error(t)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},e}(i.Ds);function It(t,e){return function(n){return n.lift(new Tt(t,e))}}var Tt=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new xt(t,this.compare,this.keySelector))},t}(),xt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return r.ZT(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(t){return this.destination.error(t)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))},e}(d.L);function kt(t,e){return It((function(n,r){return e?e(n[t],r[t]):n[t]===r[t]}))}var Pt=n(6565),Nt=n(6008),Bt=n(6929);function Dt(t){return void 0===t&&(t=Mt),function(e){return e.lift(new Rt(t))}}var Rt=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new jt(t,this.errorFactory))},t}(),jt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.errorFactory=n,r.hasValue=!1,r}return r.ZT(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(d.L);function Mt(){return new Bt.K}var Lt=n(5631);function Ft(t){return function(e){return 0===t?(0,Lt.c)():e.lift(new Ut(t))}}var Ut=function(){function t(t){if(this.total=t,this.total<0)throw new Pt.W}return t.prototype.call=function(t,e){return e.subscribe(new Vt(t,this.total))},t}(),Vt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return r.ZT(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(d.L);function zt(t,e){if(t<0)throw new Pt.W;var n=arguments.length>=2;return function(r){return r.pipe((0,Nt.h)((function(e,n){return n===t})),Ft(1),n?st(e):Dt((function(){return new Pt.W})))}}var qt=n(8170);function Wt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return(0,W.z)(e,qt.of.apply(void 0,t))}}function Gt(t,e){return function(n){return n.lift(new Ht(t,e,n))}}var Ht=function(){function t(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new Yt(t,this.predicate,this.thisArg,this.source))},t}(),Yt=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||o,o}return r.ZT(e,t),e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(d.L);function Kt(){return function(t){return t.lift(new Qt)}}var Qt=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Jt(t))},t}(),Jt=function(t){function e(e){var n=t.call(this,e)||this;return n.hasCompleted=!1,n.hasSubscription=!1,n}return r.ZT(e,t),e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add((0,i.ft)(t,new i.IY(this))))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(i.Ds),Xt=n(5709);function Zt(t,e){return e?function(n){return n.pipe(Zt((function(n,r){return(0,z.D)(t(n,r)).pipe((0,Xt.U)((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new $t(t))}}var $t=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new te(t,this.project))},t}(),te=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return r.ZT(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.hasSubscription=!0,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new i.IY(this),n=this.destination;n.add(e);var r=(0,i.ft)(t,e);r!==e&&n.add(r)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(i.Ds);function ee(t,e,n){return void 0===e&&(e=Number.POSITIVE_INFINITY),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(r){return r.lift(new ne(t,e,n))}}var ne=function(){function t(t,e,n){this.project=t,this.concurrent=e,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new re(t,this.project,this.concurrent,this.scheduler))},t}(),re=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.project=n,o.concurrent=r,o.scheduler=i,o.index=0,o.active=0,o.hasCompleted=!1,r<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return r.ZT(e,t),e.dispatch=function(t){var e=t.subscriber,n=t.result,r=t.value,i=t.index;e.subscribeToProjection(n,r,i)},e.prototype._next=function(t){var n=this.destination;if(n.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){n.next(t);try{var i=(0,this.project)(t,r);if(this.scheduler){var o={subscriber:this,result:i,value:t,index:r};this.destination.add(this.scheduler.schedule(e.dispatch,0,o))}else this.subscribeToProjection(i,t,r)}catch(t){n.error(t)}}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,n){this.active++,this.destination.add((0,i.ft)(t,new i.IY(this)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this._next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(i.Ds);function ie(t){return function(e){return e.lift(new oe(t))}}var oe=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new se(t,this.callback))},t}(),se=function(t){function e(e,n){var r=t.call(this,e)||this;return r.add(new I.w(n)),r}return r.ZT(e,t),e}(d.L);function ae(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(n){return n.lift(new ue(t,n,!1,e))}}var ue=function(){function t(t,e,n,r){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=r}return t.prototype.call=function(t,e){return e.subscribe(new ce(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),ce=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.predicate=n,s.source=r,s.yieldIndex=i,s.thisArg=o,s.index=0,s}return r.ZT(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},e.prototype._next=function(t){var e=this.predicate,n=this.thisArg,r=this.index++;try{e.call(n||this,t,r,this.source)&&this.notifyComplete(this.yieldIndex?r:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(d.L);function le(t,e){return function(n){return n.lift(new ue(t,n,!0,e))}}var he=n(3608);function fe(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?(0,Nt.h)((function(e,n){return t(e,n,r)})):he.y,Ft(1),n?st(e):Dt((function(){return new Bt.K})))}}var pe=n(1120);function de(){return function(t){return t.lift(new ye)}}var ye=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ve(t))},t}(),ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.ZT(e,t),e.prototype._next=function(t){},e}(d.L);function ge(){return function(t){return t.lift(new be)}}var be=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new me(t))},t}(),me=function(t){function e(e){return t.call(this,e)||this}return r.ZT(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(d.L);function we(t){return function(e){return 0===t?(0,Lt.c)():e.lift(new _e(t))}}var _e=function(){function t(t){if(this.total=t,this.total<0)throw new Pt.W}return t.prototype.call=function(t,e){return e.subscribe(new Se(t,this.total))},t}(),Se=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.ring=new Array,r.count=0,r}return r.ZT(e,t),e.prototype._next=function(t){var e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=e++%n;t.next(r[o])}t.complete()},e}(d.L);function Oe(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?(0,Nt.h)((function(e,n){return t(e,n,r)})):he.y,we(1),n?st(e):Dt((function(){return new Bt.K})))}}function Ee(t){return function(e){return e.lift(new Ae(t))}}var Ae=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Ce(t,this.value))},t}(),Ce=function(t){function e(e,n){var r=t.call(this,e)||this;return r.value=n,r}return r.ZT(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(d.L);function Ie(){return function(t){return t.lift(new Te)}}var Te=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new xe(t))},t}(),xe=function(t){function e(e){return t.call(this,e)||this}return r.ZT(e,t),e.prototype._next=function(t){this.destination.next(lt.P.createNext(t))},e.prototype._error=function(t){var e=this.destination;e.next(lt.P.createError(t)),e.complete()},e.prototype._complete=function(){var t=this.destination;t.next(lt.P.createComplete()),t.complete()},e}(d.L);function ke(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Pe(t,e,n))}}var Pe=function(){function t(t,e,n){void 0===n&&(n=!1),this.accumulator=t,this.seed=e,this.hasSeed=n}return t.prototype.call=function(t,e){return e.subscribe(new Ne(t,this.accumulator,this.seed,this.hasSeed))},t}(),Ne=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return r.ZT(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(d.L),Be=n(2561);function De(t,e){return arguments.length>=2?function(n){return(0,Be.z)(ke(t,e),we(1),st(e))(n)}:function(e){return(0,Be.z)(ke((function(e,n,r){return t(e,n,r+1)})),we(1))(e)}}function Re(t){return De("function"==typeof t?function(e,n){return t(e,n)>0?e:n}:function(t,e){return t>e?t:e})}var je=n(4370);function Me(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(je.T.apply(void 0,[e].concat(t)))}}var Le=n(2556);function Fe(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?(0,Y.zg)((function(){return t}),e,n):("number"==typeof e&&(n=e),(0,Y.zg)((function(){return t}),n))}function Ue(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return r.lift(new Ve(t,e,n))}}var Ve=function(){function t(t,e,n){this.accumulator=t,this.seed=e,this.concurrent=n}return t.prototype.call=function(t,e){return e.subscribe(new ze(t,this.accumulator,this.seed,this.concurrent))},t}(),ze=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.accumulator=n,o.acc=r,o.concurrent=i,o.hasValue=!1,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return r.ZT(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,n=this.destination,r=void 0;try{r=(0,this.accumulator)(this.acc,t,e)}catch(t){return n.error(t)}this.active++,this._innerSub(r)}else this.buffer.push(t)},e.prototype._innerSub=function(t){var e=new i.IY(this),n=this.destination;n.add(e);var r=(0,i.ft)(t,e);r!==e&&n.add(r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},e.prototype.notifyNext=function(t){var e=this.destination;this.acc=t,this.hasValue=!0,e.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e}(i.Ds);function qe(t){return De("function"==typeof t?function(e,n){return t(e,n)<0?e:n}:function(t,e){return t<e?t:e})}var We=n(3140);function Ge(t,e){return function(n){var r;if(r="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new He(r,e));var i=Object.create(n,We.N);return i.source=n,i.subjectFactory=r,i}}var He=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i},t}(),Ye=n(9276);function Ke(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length&&(0,V.k)(t[0])&&(t=t[0]),function(e){return e.lift(new Qe(t))}}var Qe=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new Je(t,this.nextSources))},t}(),Je=function(t){function e(e,n){var r=t.call(this,e)||this;return r.destination=e,r.nextSources=n,r}return r.ZT(e,t),e.prototype.notifyError=function(){this.subscribeToNextSource()},e.prototype.notifyComplete=function(){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource(),this.unsubscribe()},e.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();if(t){var e=new i.IY(this),n=this.destination;n.add(e);var r=(0,i.ft)(t,e);r!==e&&n.add(r)}else this.destination.complete()},e}(i.Ds);function Xe(){return function(t){return t.lift(new Ze)}}var Ze=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new $e(t))},t}(),$e=function(t){function e(e){var n=t.call(this,e)||this;return n.hasPrev=!1,n}return r.ZT(e,t),e.prototype._next=function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)},e}(d.L),tn=n(8463);function en(t,e){return function(n){return[(0,Nt.h)(t,e)(n),(0,Nt.h)((0,tn.f)(t,e))(n)]}}function nn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(e){return(0,Xt.U)(rn(t,n))(e)}}function rn(t,e){return function(n){for(var r=n,i=0;i<e;i++){var o=null!=r?r[t[i]]:void 0;if(void 0===o)return;r=o}return r}}var on=n(211);function sn(t){return t?Ge((function(){return new on.xQ}),t):Ge(new on.xQ)}var an=n(9233);function un(t){return function(e){return Ge(new an.X(t))(e)}}var cn=n(364);function ln(){return function(t){return Ge(new cn.c)(t)}}var hn=n(2630);function fn(t,e,n,r){n&&"function"!=typeof n&&(r=n);var i="function"==typeof n?n:void 0,o=new hn.t(t,e,r);return function(t){return Ge((function(){return o}),i)(t)}}var pn=n(8821);function dn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return 1===t.length&&(0,V.k)(t[0])&&(t=t[0]),e.lift.call(pn.S3.apply(void 0,[e].concat(t)))}}function yn(t){return void 0===t&&(t=-1),function(e){return 0===t?(0,Lt.c)():t<0?e.lift(new vn(-1,e)):e.lift(new vn(t-1,e))}}var vn=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new gn(t,this.count,this.source))},t}(),gn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return r.ZT(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.complete.call(this);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(d.L);function bn(t){return function(e){return e.lift(new mn(t))}}var mn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new wn(t,this.notifier,e))},t}(),wn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.notifier=n,i.source=r,i.sourceIsBeingSubscribedTo=!0,i}return r.ZT(e,t),e.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return t.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},e.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,t.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},e.prototype.subscribeToRetries=function(){var e;this.notifications=new on.xQ;try{e=(0,this.notifier)(this.notifications)}catch(e){return t.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=(0,i.ft)(e,new i.IY(this))},e}(i.Ds);function _n(t){return void 0===t&&(t=-1),function(e){return e.lift(new Sn(t,e))}}var Sn=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new On(t,this.count,this.source))},t}(),On=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return r.ZT(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.source,r=this.count;if(0===r)return t.prototype.error.call(this,e);r>-1&&(this.count=r-1),n.subscribe(this._unsubscribeAndRecycle())}},e}(d.L);function En(t){return function(e){return e.lift(new An(t,e))}}var An=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Cn(t,this.notifier,this.source))},t}(),Cn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.notifier=n,i.source=r,i}return r.ZT(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.errors,r=this.retries,o=this.retriesSubscription;if(r)this.errors=void 0,this.retriesSubscription=void 0;else{n=new on.xQ;try{r=(0,this.notifier)(n)}catch(e){return t.prototype.error.call(this,e)}o=(0,i.ft)(r,new i.IY(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=o,n.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var t=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)},e}(i.Ds),In=n(3018);function Tn(t){return function(e){return e.lift(new xn(t))}}var xn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new kn(t),r=e.subscribe(n);return r.add((0,i.ft)(this.notifier,new i.IY(n))),r},t}(),kn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return r.ZT(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(i.Ds);function Pn(t,e){return void 0===e&&(e=u.P),function(n){return n.lift(new Nn(t,e))}}var Nn=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Bn(t,this.period,this.scheduler))},t}(),Bn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.period=n,i.scheduler=r,i.hasValue=!1,i.add(r.schedule(Dn,n,{subscriber:i,period:n})),i}return r.ZT(e,t),e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(d.L);function Dn(t){var e=t.subscriber,n=t.period;e.notifyNext(),this.schedule(t,n)}function Rn(t,e){return function(n){return n.lift(new jn(t,e))}}var jn=function(){function t(t,e){this.compareTo=t,this.comparator=e}return t.prototype.call=function(t,e){return e.subscribe(new Mn(t,this.compareTo,this.comparator))},t}(),Mn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.compareTo=n,i.comparator=r,i._a=[],i._b=[],i._oneComplete=!1,i.destination.add(n.subscribe(new Ln(e,i))),i}return r.ZT(e,t),e.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},e.prototype.checkValues=function(){for(var t=this,e=t._a,n=t._b,r=t.comparator;e.length>0&&n.length>0;){var i=e.shift(),o=n.shift(),s=!1;try{s=r?r(i,o):i===o}catch(t){this.destination.error(t)}s||this.emit(!1)}},e.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},e.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},e}(d.L),Ln=function(t){function e(e,n){var r=t.call(this,e)||this;return r.parent=n,r}return r.ZT(e,t),e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},e}(d.L);function Fn(){return new on.xQ}function Un(){return function(t){return(0,In.x)()(Ge(Fn)(t))}}function Vn(t,e,n){var r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(function(t){var e,n,r=t.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=t.windowTime,s=void 0===o?Number.POSITIVE_INFINITY:o,a=t.refCount,u=t.scheduler,c=0,l=!1,h=!1;return function(t){var r;c++,!e||l?(l=!1,e=new hn.t(i,s,u),r=e.subscribe(this),n=t.subscribe({next:function(t){e.next(t)},error:function(t){l=!0,e.error(t)},complete:function(){h=!0,n=void 0,e.complete()}}),h&&(n=void 0)):r=e.subscribe(this),this.add((function(){c--,r.unsubscribe(),r=void 0,n&&!h&&a&&0===c&&(n.unsubscribe(),n=void 0,e=void 0)}))}}(r))}}function zn(t){return function(e){return e.lift(new qn(t,e))}}var qn=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Wn(t,this.predicate,this.source))},t}(),Wn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.source=r,i.seenValue=!1,i.index=0,i}return r.ZT(e,t),e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},e.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new Bt.K)},e}(d.L);function Gn(t){return function(e){return e.lift(new Hn(t))}}var Hn=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Yn(t,this.total))},t}(),Yn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return r.ZT(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(d.L);function Kn(t){return function(e){return e.lift(new Qn(t))}}var Qn=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new Pt.W}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new d.L(t)):e.subscribe(new Jn(t,this._skipCount))},t}(),Jn=function(t){function e(e,n){var r=t.call(this,e)||this;return r._skipCount=n,r._count=0,r._ring=new Array(n),r}return r.ZT(e,t),e.prototype._next=function(t){var e=this._skipCount,n=this._count++;if(n<e)this._ring[n]=t;else{var r=n%e,i=this._ring,o=i[r];i[r]=t,this.destination.next(o)}},e}(d.L);function Xn(t){return function(e){return e.lift(new Zn(t))}}var Zn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new $n(t,this.notifier))},t}(),$n=function(t){function e(e,n){var r=t.call(this,e)||this;r.hasValue=!1;var o=new i.IY(r);r.add(o),r.innerSubscription=o;var s=(0,i.ft)(n,o);return s!==o&&(r.add(s),r.innerSubscription=s),r}return r.ZT(e,t),e.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},e.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},e.prototype.notifyComplete=function(){},e}(i.Ds);function tr(t){return function(e){return e.lift(new er(t))}}var er=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new nr(t,this.predicate))},t}(),nr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.predicate=n,r.skipping=!0,r.index=0,r}return r.ZT(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},e}(d.L);function rr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return(0,m.K)(n)?(t.pop(),function(e){return(0,W.z)(t,e,n)}):function(e){return(0,W.z)(t,e)}}var ir=n(6650),or=n(5812),sr=function(t){function e(e,n,r){void 0===n&&(n=0),void 0===r&&(r=ir.e);var i=t.call(this)||this;return i.source=e,i.delayTime=n,i.scheduler=r,(!(0,or.k)(n)||n<0)&&(i.delayTime=0),r&&"function"==typeof r.schedule||(i.scheduler=ir.e),i}return r.ZT(e,t),e.create=function(t,n,r){return void 0===n&&(n=0),void 0===r&&(r=ir.e),new e(t,n,r)},e.dispatch=function(t){var e=t.source,n=t.subscriber;return this.add(e.subscribe(n))},e.prototype._subscribe=function(t){var n=this.delayTime,r=this.source;return this.scheduler.schedule(e.dispatch,n,{source:r,subscriber:t})},e}(yt.y);function ar(t,e){return void 0===e&&(e=0),function(n){return n.lift(new ur(t,e))}}var ur=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new sr(e,this.delay,this.scheduler).subscribe(t)},t}();function cr(t,e){return"function"==typeof e?function(n){return n.pipe(cr((function(n,r){return(0,z.D)(t(n,r)).pipe((0,Xt.U)((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new lr(t))}}var lr=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new hr(t,this.project))},t}(),hr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.index=0,r}return r.ZT(e,t),e.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this._innerSub(e)},e.prototype._innerSub=function(t){var e=this.innerSubscription;e&&e.unsubscribe();var n=new i.IY(this),r=this.destination;r.add(n),this.innerSubscription=(0,i.ft)(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t){this.destination.next(t)},e}(i.Ds);function fr(){return cr(he.y)}function pr(t,e){return e?cr((function(){return t}),e):cr((function(){return t}))}function dr(t){return function(e){return e.lift(new yr(t))}}var yr=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new vr(t),r=(0,i.ft)(this.notifier,new i.IY(n));return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n},t}(),vr=function(t){function e(e){var n=t.call(this,e)||this;return n.seenValue=!1,n}return r.ZT(e,t),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(i.Ds);function gr(t,e){return void 0===e&&(e=!1),function(n){return n.lift(new br(t,e))}}var br=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new mr(t,this.predicate,this.inclusive))},t}(),mr=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return r.ZT(e,t),e.prototype._next=function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void n.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())},e}(d.L),wr=n(3306),_r=n(4156);function Sr(t,e,n){return function(r){return r.lift(new Or(t,e,n))}}var Or=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new Er(t,this.nextOrObserver,this.error,this.complete))},t}(),Er=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o._tapNext=wr.Z,o._tapError=wr.Z,o._tapComplete=wr.Z,o._tapError=r||wr.Z,o._tapComplete=i||wr.Z,(0,_r.m)(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||wr.Z,o._tapError=n.error||wr.Z,o._tapComplete=n.complete||wr.Z),o}return r.ZT(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(d.L),Ar={leading:!0,trailing:!1};function Cr(t,e){return void 0===e&&(e=Ar),function(n){return n.lift(new Ir(t,!!e.leading,!!e.trailing))}}var Ir=function(){function t(t,e,n){this.durationSelector=t,this.leading=e,this.trailing=n}return t.prototype.call=function(t,e){return e.subscribe(new Tr(t,this.durationSelector,this.leading,this.trailing))},t}(),Tr=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.destination=e,o.durationSelector=n,o._leading=r,o._trailing=i,o._hasValue=!1,o}return r.ZT(e,t),e.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},e.prototype.send=function(){var t=this._hasValue,e=this._sendValue;t&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(t){var e=this.tryDurationSelector(t);e&&this.add(this._throttled=(0,i.ft)(e,new i.IY(this)))},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(t){return this.destination.error(t),null}},e.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=void 0,e&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()},e}(i.Ds);function xr(t,e,n){return void 0===e&&(e=u.P),void 0===n&&(n=Ar),function(r){return r.lift(new kr(t,e,n.leading,n.trailing))}}var kr=function(){function t(t,e,n,r){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new Pr(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),Pr=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.duration=n,s.scheduler=r,s.leading=i,s.trailing=o,s._hasTrailingValue=!1,s._trailingValue=null,s}return r.ZT(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Nr,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(d.L);function Nr(t){t.subscriber.clearThrottle()}var Br=n(1410);function Dr(t){return void 0===t&&(t=u.P),function(e){return(0,Br.P)((function(){return e.pipe(ke((function(e,n){var r=e.current;return{value:n,current:t.now(),last:r}}),{current:t.now(),value:void 0,last:void 0}),(0,Xt.U)((function(t){var e=t.current,n=t.last,r=t.value;return new Rr(r,e-n)})))}))}}var Rr=function(){return function(t,e){this.value=t,this.interval=e}}(),jr=n(1462);function Mr(t,e,n){return void 0===n&&(n=u.P),function(r){var i=ct(t),o=i?+t-n.now():Math.abs(t);return r.lift(new Lr(o,i,e,n))}}var Lr=function(){function t(t,e,n,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new Fr(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),Fr=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.absoluteTimeout=n,s.waitFor=r,s.withObservable=i,s.scheduler=o,s.scheduleTimeout(),s}return r.ZT(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add((0,i.ft)(e,new i.IY(t)))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},e}(i.Ds),Ur=n(4944);function Vr(t,e){return void 0===e&&(e=u.P),Mr(t,(0,Ur._)(new jr.W),e)}function zr(t){return void 0===t&&(t=u.P),(0,Xt.U)((function(e){return new qr(e,t.now())}))}var qr=function(){return function(t,e){this.value=t,this.timestamp=e}}();function Wr(t,e,n){return 0===n?[e]:(t.push(e),t)}function Gr(){return De(Wr,[])}function Hr(t){return function(e){return e.lift(new Yr(t))}}var Yr=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var n=new Kr(t),r=e.subscribe(n);return r.closed||n.add((0,i.ft)(this.windowBoundaries,new i.IY(n))),r},t}(),Kr=function(t){function e(e){var n=t.call(this,e)||this;return n.window=new on.xQ,e.next(n.window),n}return r.ZT(e,t),e.prototype.notifyNext=function(){this.openWindow()},e.prototype.notifyError=function(t){this._error(t)},e.prototype.notifyComplete=function(){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,n=this.window=new on.xQ;e.next(n)},e}(i.Ds);function Qr(t,e){return void 0===e&&(e=0),function(n){return n.lift(new Jr(t,e))}}var Jr=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new Xr(t,this.windowSize,this.startWindowEvery))},t}(),Xr=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.destination=e,i.windowSize=n,i.startWindowEvery=r,i.windows=[new on.xQ],i.count=0,e.next(i.windows[0]),i}return r.ZT(e,t),e.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,n=this.destination,r=this.windowSize,i=this.windows,o=i.length,s=0;s<o&&!this.closed;s++)i[s].next(t);var a=this.count-r+1;if(a>=0&&a%e==0&&!this.closed&&i.shift().complete(),++this.count%e==0&&!this.closed){var u=new on.xQ;i.push(u),n.next(u)}},e.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(d.L);function Zr(t){var e=u.P,n=null,r=Number.POSITIVE_INFINITY;return(0,m.K)(arguments[3])&&(e=arguments[3]),(0,m.K)(arguments[2])?e=arguments[2]:(0,or.k)(arguments[2])&&(r=Number(arguments[2])),(0,m.K)(arguments[1])?e=arguments[1]:(0,or.k)(arguments[1])&&(n=Number(arguments[1])),function(i){return i.lift(new $r(t,n,r,e))}}var $r=function(){function t(t,e,n,r){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new ei(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),ti=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return r.ZT(e,t),e.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(on.xQ),ei=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;s.destination=e,s.windowTimeSpan=n,s.windowCreationInterval=r,s.maxWindowSize=i,s.scheduler=o,s.windows=[];var a=s.openWindow();if(null!==r&&r>=0){var u={subscriber:s,window:a,context:null},c={windowTimeSpan:n,windowCreationInterval:r,subscriber:s,scheduler:o};s.add(o.schedule(ii,n,u)),s.add(o.schedule(ri,r,c))}else{var l={subscriber:s,window:a,windowTimeSpan:n};s.add(o.schedule(ni,n,l))}return s}return r.ZT(e,t),e.prototype._next=function(t){for(var e=this.windows,n=e.length,r=0;r<n;r++){var i=e[r];i.closed||(i.next(t),i.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(i))}},e.prototype._error=function(t){for(var e=this.windows;e.length>0;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new ti;return this.windows.push(t),this.destination.next(t),t},e.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},e}(d.L);function ni(t){var e=t.subscriber,n=t.windowTimeSpan,r=t.window;r&&e.closeWindow(r),t.window=e.openWindow(),this.schedule(t,n)}function ri(t){var e=t.windowTimeSpan,n=t.subscriber,r=t.scheduler,i=t.windowCreationInterval,o=n.openWindow(),s=this,a={action:s,subscription:null},u={subscriber:n,window:o,context:a};a.subscription=r.schedule(ii,e,u),s.add(a.subscription),s.schedule(t,i)}function ii(t){var e=t.subscriber,n=t.window,r=t.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),e.closeWindow(n)}function oi(t,e){return function(n){return n.lift(new si(t,e))}}var si=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new ai(t,this.openings,this.closingSelector))},t}(),ai=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(i.openSubscription=(0,T.D)(i,n,n)),i}return r.ZT(e,t),e.prototype._next=function(t){var e=this.contexts;if(e)for(var n=e.length,r=0;r<n;r++)e[r].window.next(t)},e.prototype._error=function(e){var n=this.contexts;if(this.contexts=null,n)for(var r=n.length,i=-1;++i<r;){var o=n[i];o.window.error(e),o.subscription.unsubscribe()}t.prototype._error.call(this,e)},e.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,r=-1;++r<n;){var i=e[r];i.window.complete(),i.subscription.unsubscribe()}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,n=-1;++n<e;){var r=t[n];r.window.unsubscribe(),r.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,e,n,r,i){if(t===this.openings){var o=void 0;try{o=(0,this.closingSelector)(e)}catch(t){return this.error(t)}var s=new on.xQ,a=new I.w,u={window:s,subscription:a};this.contexts.push(u);var c=(0,T.D)(this,o,u);c.closed?this.closeWindow(this.contexts.length-1):(c.context=u,a.add(c)),this.destination.next(s)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,n=e[t],r=n.window,i=n.subscription;e.splice(t,1),r.complete(),i.unsubscribe()}},e}(x.L);function ui(t){return function(e){return e.lift(new ci(t))}}var ci=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new li(t,this.closingSelector))},t}(),li=function(t){function e(e,n){var r=t.call(this,e)||this;return r.destination=e,r.closingSelector=n,r.openWindow(),r}return r.ZT(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.openWindow(i)},e.prototype.notifyError=function(t){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var n,r=this.window=new on.xQ;this.destination.next(r);try{n=(0,this.closingSelector)()}catch(t){return this.destination.error(t),void this.window.error(t)}this.add(this.closingNotification=(0,T.D)(this,n))},e}(x.L);function hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"==typeof t[t.length-1]&&(n=t.pop());var r=t;return e.lift(new fi(r,n))}}var fi=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new pi(t,this.observables,this.project))},t}(),pi=function(t){function e(e,n,r){var i=t.call(this,e)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var s=0;s<o;s++)i.toRespond.push(s);for(s=0;s<o;s++){var a=n[s];i.add((0,T.D)(i,a,void 0,s))}return i}return r.ZT(e,t),e.prototype.notifyNext=function(t,e,n){this.values[n]=e;var r=this.toRespond;if(r.length>0){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(x.L),di=n(5080);function yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(di.$R.apply(void 0,[e].concat(t)))}}function vi(t){return function(e){return e.lift(new di.mx(t))}}},5987:(t,e,n)=>{"use strict";n.d(e,{ZT:()=>i});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}},9126:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(969))},8111:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(5624))},173:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(6097))},2068:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(1709))},904:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(3895))},8120:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(6740))},9890:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(698))},1301:(t,e,n)=>{var r=n(8764).Buffer,i=n(7187).EventEmitter;function o(t,e,n,r,i){for(var o=0;o<i;++o,++e,++r)if(t[e]!==n[r])return!1;return!0}function s(t){"string"==typeof t&&(t=new r(t));var e,n,i=t.length;for(this.maxMatches=1/0,this.matches=0,this._occ=new Array(256),this._lookbehind_size=0,this._needle=t,this._bufpos=0,this._lookbehind=new r(i),n=0;n<256;++n)this._occ[n]=i;if(i>=1)for(e=0;e<i-1;++e)this._occ[t[e]]=i-1-e}(0,n(9539).inherits)(s,i),s.prototype.reset=function(){this._lookbehind_size=0,this.matches=0,this._bufpos=0},s.prototype.push=function(t,e){var n,i;for(r.isBuffer(t)||(t=new r(t,"binary")),i=t.length,this._bufpos=e||0;n!==i&&this.matches<this.maxMatches;)n=this._sbmh_feed(t);return n},s.prototype._sbmh_feed=function(t){var e=t.length,n=this._needle,r=n.length,i=-this._lookbehind_size,s=n[r-1],a=this._occ,u=this._lookbehind;if(i<0){for(;i<0&&i<=e-r;){if((l=this._sbmh_lookup_char(t,i+r-1))===s&&this._sbmh_memcmp(t,i,r-1))return this._lookbehind_size=0,++this.matches,i>-this._lookbehind_size?this.emit("info",!0,u,0,this._lookbehind_size+i):this.emit("info",!0),this._bufpos=i+r,i+r;i+=a[l]}if(i<0)for(;i<0&&!this._sbmh_memcmp(t,i,e-i);)i++;if(!(i>=0)){var c=this._lookbehind_size+i;return c>0&&this.emit("info",!1,u,0,c),u.copy(u,0,c,this._lookbehind_size-c),this._lookbehind_size-=c,t.copy(u,this._lookbehind_size),this._lookbehind_size+=e,this._bufpos=e,e}this.emit("info",!1,u,0,this._lookbehind_size),this._lookbehind_size=0}for(i>=0&&(i+=this._bufpos);i<=e-r;){var l;if((l=t[i+r-1])===s&&t[i]===n[0]&&o(n,0,t,i,r-1))return++this.matches,i>0?this.emit("info",!0,t,this._bufpos,i):this.emit("info",!0),this._bufpos=i+r,i+r;i+=a[l]}if(i<e){for(;i<e&&(t[i]!==n[0]||!o(t,i,n,0,e-i));)++i;i<e&&(t.copy(u,0,i,i+(e-i)),this._lookbehind_size=e-i)}return i>0&&this.emit("info",!1,t,this._bufpos,i<e?i:e),this._bufpos=e,e},s.prototype._sbmh_lookup_char=function(t,e){return e<0?this._lookbehind[this._lookbehind_size+e]:t[e]},s.prototype._sbmh_memcmp=function(t,e,n){for(var r=0;r<n;){if(this._sbmh_lookup_char(t,e+r)!==this._needle[r])return!1;++r}return!0},t.exports=s},3379:(t,e,n)=>{"use strict";var r,i=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),o=[];function s(t){for(var e=-1,n=0;n<o.length;n++)if(o[n].identifier===t){e=n;break}return e}function a(t,e){for(var n={},r=[],i=0;i<t.length;i++){var a=t[i],u=e.base?a[0]+e.base:a[0],c=n[u]||0,l="".concat(u," ").concat(c);n[u]=c+1;var h=s(l),f={css:a[1],media:a[2],sourceMap:a[3]};-1!==h?(o[h].references++,o[h].updater(f)):o.push({identifier:l,updater:y(f,e),references:1}),r.push(l)}return r}function u(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var s=i(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var c,l=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function h(t,e,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=l(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function f(t,e,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var p=null,d=0;function y(t,e){var n,r,i;if(e.singleton){var o=d++;n=p||(p=u(e)),r=h.bind(null,n,o,!1),i=h.bind(null,n,o,!0)}else n=u(e),r=f.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=a(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var i=s(n[r]);o[i].references--}for(var u=a(t,e),c=0;c<n.length;c++){var l=s(n[c]);0===o[l].references&&(o[l].updater(),o.splice(l,1))}n=u}}}},1496:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},384:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},9539:(t,e,n)=>{var r=n(4155),i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},o=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),a=r[n];n<i;a=r[++n])v(a)||!_(a)?s+=" "+a:s+=" "+u(a);return s},e.deprecate=function(t,n){if(void 0!==r&&!0===r.noDeprecation)return t;if(void 0===r)return function(){return e.deprecate(t,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(n);r.traceDeprecation?console.trace(n):console.error(n),i=!0}return t.apply(this,arguments)}};var s,a={};function u(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&e._extend(r,n),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),h(r,t,r.depth)}function c(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function l(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=h(t,i,r)),i}var o=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}(t,n);if(o)return o;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),O(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(E(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(S(n))return t.stylize(Date.prototype.toString.call(n),"date");if(O(n))return f(n)}var c,l="",_=!1,A=["{","}"];return d(n)&&(_=!0,A=["[","]"]),E(n)&&(l=" [Function"+(n.name?": "+n.name:"")+"]"),w(n)&&(l=" "+RegExp.prototype.toString.call(n)),S(n)&&(l=" "+Date.prototype.toUTCString.call(n)),O(n)&&(l=" "+f(n)),0!==s.length||_&&0!=n.length?r<0?w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=_?function(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)x(e,String(s))?o.push(p(t,e,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))})),o}(t,n,r,a,s):s.map((function(e){return p(t,n,r,a,e,_)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(c,l,A)):A[0]+l+A[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),x(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=v(n)?h(t,u.value,null):h(t,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),m(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function d(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function m(t){return void 0===t}function w(t){return _(t)&&"[object RegExp]"===A(t)}function _(t){return"object"==typeof t&&null!==t}function S(t){return _(t)&&"[object Date]"===A(t)}function O(t){return _(t)&&("[object Error]"===A(t)||t instanceof Error)}function E(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function C(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(m(s)&&(s=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(s)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=y,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=m,e.isRegExp=w,e.isObject=_,e.isDate=S,e.isError=O,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(384);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var t=new Date,e=[C(t.getHours()),C(t.getMinutes()),C(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}function x(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",T(),e.format.apply(e,arguments))},e.inherits=n(1496),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var k="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(k&&t[k]){var e;if("function"!=typeof(e=t[k]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),k&&Object.defineProperty(e,k,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=k,e.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function e(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);var i=e.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};t.apply(this,e).then((function(t){r.nextTick(s,null,t)}),(function(t){r.nextTick(P,t,s)}))}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,i(t)),e}},4763:t=>{t.exports=Worker},5840:(t,e,n)=>{var r;if("object"==typeof globalThis)r=globalThis;else try{r=n(284)}catch(t){}finally{if(r||"undefined"==typeof window||(r=window),!r)throw new Error("Could not determine global this")}var i=r.WebSocket||r.MozWebSocket,o=n(9387);function s(t,e){return e?new i(t,e):new i(t)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(t){Object.defineProperty(s,t,{get:function(){return i[t]}})})),t.exports={w3cwebsocket:i?s:null,version:o}},9387:(t,e,n)=>{t.exports=n(2847).version},2847:t=>{"use strict";t.exports={version:"1.0.34"}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.u=t=>t+".brainsatplay.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/src/libraries/js/dist/",n.b=document.baseURI||self.location.href;var r={};return(()=>{"use strict";n.r(r),n.d(r,{Application:()=>ju,Session:()=>ku,plugins:()=>t});var t={};n.r(t),n.d(t,{Debug:()=>y,Keyboard:()=>p,Neurofeedback:()=>g,Signal:()=>a,Transform:()=>l});var e=n(3379),i=n.n(e),o=n(9956);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals;var a=function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};s(this,t),this.init=function(){r.params.autoconnect&&0===r.session.deviceStreams.length&&r.session.connectDevice(void 0,void 0,void 0,{device:"Synthetic",variant:"",analysis:["eegcoherence"]})},this.deinit=function(){},this.default=function(){return{value:r.session.atlas.data}},this.label=e,this.session=n,this.params=i,this.paramOptions={autoconnect:{default:!1,show:!1}}};function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}a.id=String(Math.floor(1e6*Math.random()));var l=function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,t),this.init=function(){},this.deinit=function(){},this.default=function(t){return Array.isArray(u.value)||(u.value=[u.value]),t.forEach((function(t){"Add"===r.params.operator.toLowerCase()?t.value=t.value.map((function(t){return t+r.params.value})):"Subtract"===r.params.operator.toLowerCase()?t.value=t.value.map((function(t){return t-r.params.value})):"Multiply"===r.params.operator.toLowerCase()?t.value=t.value.map((function(t){return t*r.params.value})):"Divide"===r.params.operator.toLowerCase()?t.value=t.value.map((function(t){return t/r.params.value})):"Mean"===r.params.operator.toLowerCase()?t.value=t.value.reduce((function(t,e){return t+e}))/t.value.length:"Sum"===r.params.operator.toLowerCase()&&(t.value=t.value.reduce((function(t,e){return t+e})))})),t},this.label=e,this.session=n,this.params=i,this.paramOptions={operator:{default:"",options:["Add","Subtract","Multiply","Divide","Mean","Sum"]},value:{default:0,options:null}}};function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}l.id=String(Math.floor(1e6*Math.random()));var p=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};h(this,t),this.init=function(){document.addEventListener("keydown",r.handleKeyDown),document.addEventListener("keyup",r.handleKeyUp)},this.deinit=function(){document.removeEventListener("keydown",r.handleKeyDown),document.removeEventListener("keyup",r.handleKeyDown)},this.handleKeyDown=function(t){r.matchKey(t.code)&&1!=r.state.value&&(r.state.value=!0)},this.handleKeyUp=function(t){r.matchKey(t.code)&&(r.state.value=!1)},this.label=e,this.session=n,this.params=i,this.paramOptions={key:{default:"Space",options:null}}}var e,n;return e=t,(n=[{key:"matchKey",value:function(t){var e=new RegExp("(?:^|W)".concat(this.params.key,"(?:$|W)"),"i");return t.match(e)||t.replace("Key","").match(e)||t.replace("Digit","").match(e)}}])&&f(e.prototype,n),t}();function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}p.id=String(Math.floor(1e6*Math.random()));var y=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};d(this,t),this.init=function(){},this.deinit=function(){},this.default=function(t){return t.forEach((function(t){console.log(t)})),t},this.label=e,this.session=n,this.params=r};function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}y.id=String(Math.floor(1e6*Math.random()));var g=function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};v(this,t),this.init=function(){},this.deinit=function(){},this.default=function(t){return t.forEach((function(t){var e=[],n=null!=t.value?t.value:r.session.atlas.data;try{["Alpha Beta Ratio","Alpha Theta Ratio","Theta Beta Ratio","Alpha Ratio","Gamma Peak","Low Gamma Score"].includes(r.params.metric)&&n.eeg.forEach((function(t){"Alpha Beta Ratio"===r.params.metric?e.push(r.session.atlas.getAlphaBetaRatio(t)):"Alpha Theta Ratio"===r.params.metric?e.push(r.session.atlas.getAlphaThetaRatio(t)):"Theta Beta Ratio"===r.params.metric?e.push(r.session.atlas.getThetaBetaRatio(t)):"Alpha Ratio"===r.params.metric?e.push(r.session.atlas.getAlphaRatio(t)):"Gamma Peak"===r.params.metric?e.push(r.session.atlas.get40HzGamma(t)):"Low Gamma Score"===r.params.metric?e.push(r.session.atlas.getLowGammaScore(t)):e.push(0)})),["Alpha Coherence"].includes(r.params.metric)&&n.coherence.forEach((function(t){if("Alpha Coherence"===r.params.metric){var n=r.session.atlas.getCoherenceScore(t,"alpha1");e.push(n)}})),["HEG Score"].includes(r.params.metric)&&n.heg.forEach((function(t){"HEG Score"===r.params.metric?e.push(r.session.atlas.getHEGRatioScore(t)):e.push(0)})),"Focus"===r.params.metric&&r.session.atlas.getFrontalData().forEach((function(t){e.push(Math.min(1/r.session.atlas.getThetaBetaRatio(t),1))}))}catch(t){console.error("input not compatible"),e.push(0)}"Mean"===r.params.output?t.value=r.session.atlas.mean(e):t.value=e,t.label=r.params.metric})),t},this.label=e,this.session=n,this.params=i,this.paramOptions={metric:{default:"Alpha Coherence",options:["Alpha Coherence","Focus","Alpha Beta Ratio","Alpha Theta Ratio","Theta Beta Ratio","Alpha Ratio","Gamma Peak","Low Gamma Score","HEG Score"]},output:{default:"Mean",options:["Mean"]}}};function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),t}g.id=String(Math.floor(1e6*Math.random())),n(5666);var O=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];w(this,t),this.addFunc=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=null;return null!==n&&(null===t?e.listeners.forEach((function(t,e){r=t.listener.addFunc(n)})):e.listeners.find((function(e,i){e.key===t&&(r=e.listener.addFunc(n))}))),r},this.removeFuncs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t?e.listeners.forEach((function(t,e){t.listener.removeFuncs(n)})):e.listeners.find((function(e,r){e.key===t&&e.listener.removeFuncs(n)}))},this.debug=n,this.listeners=[]}return S(t,[{key:"addListener",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.debug;if(void 0!==e){var s=t;null===s&&(s=Math.floor(1e5*Math.random()));var a={key:s,listener:new E(e,n,r,i,o)};this.listeners.push(a)}else console.error("You must assign an object")}},{key:"hasKey",value:function(t){var e=!1;return this.listeners.forEach((function(n,r){if(n.key===t)return e=!0,!0})),e}},{key:"getKeyIndices",value:function(t){var e=[];return this.listeners.find((function(n,r){n.key===t&&e.push(r)})),e}},{key:"onchange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t?this.listeners.forEach((function(t,n){t.listener.onchange=e})):this.listeners.find((function(n,r){n.name===t&&(n.listener.onchange=e)}))}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t?this.listeners.forEach((function(t,e){t.listener.stop()})):this.listeners.find((function(e,n){e.name===t&&e.listener.stop()}))}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t?this.listeners.forEach((function(t,e){t.listener.start()})):this.listeners.find((function(e,n){e.name===t&&e.listener.start()}))}},{key:"remove",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e)this.listeners.splice(0,this.listeners.length);else{var n=[];this.listeners.forEach((function(t,r){t.key===e&&n.push(r)})),n.reverse().forEach((function(e){t.listeners[e].listener.stop(),t.listeners.splice(e,1)}))}}}]),t}(),E=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"__ANY__",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onchange,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"FRAMERATE",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];w(this,t),A.call(this),this.debug=s,this.onchange=i,this.onchangeFuncs=[],this.object=e,this.propName=r,this.propOld=void 0,this.setListenerRef(r),this.running=!0,this.interval,o<10?(this.interval=10,console.log("Min recommended interval set: 10ms")):this.interval=o,"undefined"==typeof window?setTimeout((function(){n.check()}),60):this.checker=requestAnimationFrame(this.check)}return S(t,[{key:"removeFuncs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t?this.onchangeFuncs=[]:void 0!==this.onchangeFuncs[t]&&this.onchangeFuncs.splice(t,1)}},{key:"start",value:function(){var t=this;this.running=!0,"undefined"==typeof window?setTimeout((function(){t.check()}),16):this.checker=requestAnimationFrame(this.check)}},{key:"stop",value:function(){this.running=!1,cancelAnimationFrame(this.checker)}}]),t}(),A=function(){var t=this;this.onchange=function(e){console.log(t.propName," changed from: ",t.propOld," to: ",t.object[t.propName])},this.addFunc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==e&&t.onchangeFuncs.push(e),t.onchangeFuncs.length-1},this.onchangeMulti=function(e){var n;(n=t.onchangeFuncs,function(t){if(Array.isArray(t))return b(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach((function(n,r){!0===t.debug&&console.log(n),n(e)}))},this.setListenerRef=function(e){"__ANY__"===e||null==e?t.propOld=JSON.stringifyFast(t.object):Array.isArray(t.object[e])?t.propOld=JSON.stringifyFast(t.object[e].slice(t.object[e].length-20)):"object"===m(t.object[e])?t.propOld=JSON.stringifyFast(t.object[e]):"function"==typeof t.object[e]?t.propOld=t.object[e].toString():t.propOld=t.object[e],!0===t.debug&&console.log("propname",e,", new assignment: ",t.propOld)},this.check=function(){if("__ANY__"===t.propName||null===t.propName||void 0===t.propName)t.propOld!==JSON.stringifyFast(t.object)&&(!0===t.debug&&console.log("onchange: ",t.onchange),t.onchange(t.object),t.onchangeFuncs.length>0&&t.onchangeMulti(t.object),t.setListenerRef(t.propName));else if(Array.isArray(t.object[t.propName]))t.propOld!==JSON.stringifyFast(t.object[t.propName].slice(t.object[t.propName].length-20))&&(!0===t.debug&&console.log("onchange: ",t.onchange),t.onchange(t.object[t.propName]),t.onchangeFuncs.length>0&&t.onchangeMulti(t.object[t.propName]),t.setListenerRef(t.propName));else if("object"===m(t.object[t.propName])){var e=JSON.stringifyFast(t.object[t.propName]);t.propOld!==e&&(!0===t.debug&&console.log("onchange: ",t.onchange),t.onchange(t.object[t.propName]),t.onchangeFuncs.length>0&&t.onchangeMulti(t.object[t.propName]),t.setListenerRef(t.propName))}else"function"==typeof t.object[t.propName]?t.propOld!==t.object[t.propName].toString()&&(!0===t.debug&&console.log("onchange: ",t.onchange),t.onchange(t.object[t.propName].toString()),t.onchangeFuncs.length>0&&t.onchangeMulti(t.object[t.propName].toString()),t.setListenerRef(t.propName)):t.object[t.propName]!==t.propOld&&(!0===t.debug&&console.log("onchange: ",t.onchange),t.onchange(t.object[t.propName]),t.onchangeFuncs.length>0&&t.onchangeMulti(t.object[t.propName]),t.setListenerRef(t.propName));!0===t.running&&(!0===t.debug&&console.log("checking",t.object,t.propName),"FRAMERATE"===t.interval?"undefined"==typeof window?setTimeout((function(){t.check()}),16):t.checker=requestAnimationFrame(t.check):setTimeout((function(){t.check()}),t.interval))}};function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}void 0===JSON.stringifyFast&&(JSON.stringifyFast=function(){var t=new Map,e=[],n=["this"];function r(e,r){var i=r;if(null!==i&&"object"===m(r)){var o=t.get(i),s=r.constructor.name;if(o)return"[Circular Reference]"+o;if("Array"===s&&r.length>20)i=r.slice(r.length-20),t.set(i,n.join("."));else if("Object"!==s&&"Number"!==s&&"String"!==s&&"Boolean"!==s)i="instanceof_"+s,t.set(i,n.join("."));else if("object"===m(i)){var a={};for(var u in i)Array.isArray(i[u])?a[u]=i[u].slice(i[u].length-20):a[u]=i[u]}else t.set(i,n.join("."))}return i}return function(i,o){try{return e.push(i),JSON.stringify(i,r,o)}finally{t.clear(),e.length=0,n.length=1}}}());var x=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.templateStringGen,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(t){},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NEVER";I(this,t),this.onchange=function(){arguments.length>0&&void 0!==arguments[0]||e.renderSettings.props},this.onRender=function(){arguments.length>0&&void 0!==arguments[0]||e.renderSettings.props},this.onRender=o,this.onchange=s,this.parentNode=r,"string"==typeof r&&(this.parentNode=document.getElementById(r)),this.renderSettings={templateStringGen:n,props:i},this.templateString="",this.templateString="function"==typeof n?n(i):n;var u=a;if(this.renderSettings.props==={}&&(u="NEVER"),this.node=null,this.listener=void 0,Object.keys(this.renderSettings.props).length>0&&null!=u&&"NEVER"!==u){console.log("making listeners for ",n),this.listener=new O;var c=function(){e.updateNode()};this.listener.addListener("templateChange",this.renderSettings,"templateStringGen",c,u);var l=function(){e.updateNode(),e.onchange()};this.listener.addListener("props",this.renderSettings,"props",l,u)}this.renderNode()}var e,n;return e=t,(n=[{key:"appendFragment",value:function(t,e){var n=document.createElement("template");n.innerHTML=t;var r=n.content;return e.appendChild(r),e.children[e.children.length-1]}},{key:"deleteFragment",value:function(t,e){var n=document.getElementById(e);t.removeChild(n)}},{key:"removeParent",value:function(t){var e=document.getElementById(t);e.parentNode.parentNode.removeChild(e.parentNode)}},{key:"renderNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parentNode;this.node=this.appendFragment(this.templateString,t),this.onRender()}},{key:"updateNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parentNode,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.node,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props;t.removeChild(e),"function"==typeof this.renderSettings.templateStringGen?this.templateString=this.renderSettings.templateStringGen(this.props):this.templateString=this.renderSettings.templateStringGen,this.renderNode(t,n)}},{key:"deleteNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.node;"string"==typeof t?(thisNode=document.getElementById(t),thisNode.parentNode.removeChild(thisNode),this.node=null):"object"===C(t)&&(t.parentNode.removeChild(t),this.node=null)}},{key:"appendStylesheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.node;if("string"==typeof t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=t,e.insertAdjacentElement("afterbegin",n)}else if(Array.isArray(t))t.forEach((function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=t,e.insertAdjacentElement("afterbegin",n)}));else if("function"==typeof t){var r=t();e.insertAdjacentHTML("afterbegin",r)}}}])&&T(e.prototype,n),t}();function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var R=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FRAMERATE";B(this,t),this.data=e,this.interval=n,this.pushToState={},this.prev=Object.assign({},this.data),this.update={added:"",removed:"",buffer:new Set},this.listener=new O}var e,n;return e=t,(n=[{key:"setInterval",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FRAMERATE";this.interval=e,this.listener.listeners.forEach((function(e,n){e.interval=t.interval}))}},{key:"updateState",value:function(t,e){null==this.data[t]?this.addToState(t,e):this.data[t]=e}},{key:"removeState",value:function(t){this.unsubscribeAll(t),delete this.data[t],this.update.removed=t,this.update.buffer.add(t)}},{key:"addToState",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.listener.hasKey("push")){var o=function(){if(Object.keys(n.pushToState).length>0){Object.assign(n.prev,n.data),Object.assign(n.data,n.pushToState);var t,e=P(Object.getOwnPropertyNames(n.pushToState));try{for(e.s();!(t=e.n()).done;){var r=t.value;delete n.pushToState[r]}}catch(t){e.e(t)}finally{e.f()}}};this.listener.addListener("push",this.pushToState,"__ANY__",o,this.interval)}if(this.data[t]=e,this.update.added=t,this.update.buffer.add(t),null!==r)return this.addSecondaryKeyResponse(t,r,i)}},{key:"getState",value:function(){return JSON.parse(JSON.stringifyFast(this.data))}},{key:"setState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.pushToState,t),this.pushToState}},{key:"setPrimaryKeyResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null!==e&&(this.listener.hasKey(t)?this.listener.onchange(t,e):null!==t&&this.listener.addListener(t,this.data,t,e,this.data.stateUpdateInterval,n))}},{key:"addSecondaryKeyResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==e)return this.listener.hasKey(t)?this.listener.addFunc(t,e):null!==t?(this.listener.addListener(t,this.data,t,(function(){}),this.data.stateUpdateInterval,n),this.listener.addFunc(t,e)):this.listener.addFunc("state",e)}},{key:"removeSecondaryKeyResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==t?this.listener.hasKey(t)&&this.listener.removeFuncs(t,e):console.error("provide key")}},{key:"clearAllKeyResponses",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.listener.hasKey(t)&&this.listener.remove(t)}},{key:"subscribe",value:function(t,e){if(void 0!==this.data[t])return this.addSecondaryKeyResponse(t,e);this.addToState(t,null,e)}},{key:"unsubscribe",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==e?this.removeSecondaryKeyResponse(t,e):console.error("Specify a subcription function index")}},{key:"unsubscribeAll",value:function(t){this.clearAllKeyResponses(t)}}])&&D(e.prototype,n),t}();void 0===JSON.stringifyFast&&(JSON.stringifyFast=function(){var t=new Map,e=[],n=["this"];function r(e,r){var i=r;if(null!==i&&"object"===k(r)){var o=t.get(i),s=r.constructor.name;if(o)return"[Circular Reference]"+o;if("Array"===s&&r.length>20)i=r.slice(r.length-20),t.set(i,n.join("."));else if("Object"!==s&&"Number"!==s&&"String"!==s&&"Boolean"!==s)i="instanceof_"+s,t.set(i,n.join("."));else if("object"===k(i)){var a={};for(var u in i)Array.isArray(i[u])?a[u]=i[u].slice(i[u].length-20):a[u]=i[u]}else t.set(i,n.join("."))}return i}return function(i,o){try{return e.push(i),JSON.stringify(i,r,o)}finally{t.clear(),e.length=0,n.length=1}}}());for(var j=n(4763),M=n.n(j),L=[],F=0;F<2;F++)L.push(new(M())(new URL(n.p+n.u(842),n.b),{name:"eegworker_"+F,type:void 0}));var U=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),V.call(this),this.workerResponses=[],this.workers=[],this.workerThreads=2,this.workerThreadrot=0;try{for(var n=0;n<L.length;n++)L[n].onmessage=function(t){var n=t.data;e.workerResponses.forEach((function(t,e){t(n)}))},this.workers.push(L[n]);console.log("worker threads: ",this.workers.length)}catch(t){console.error(t)}},V=function(){var t=this;this.addWorker=function(e){console.log("add worker");try{return t.workers.push(new(M())(e,{name:"eegworker_"+t.workers.length,type:"module"})),t.workers[F].onmessage=function(e){var n=e.data;t.workerResponses.forEach((function(t,e){t(n)}))},console.log("worker threads: ",t.workers.length),t.workers.length-1}catch(t){console.log(t)}},this.postToWorker=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===n?(t.workers[t.workerThreadrot].postMessage(e),t.workerThreads>1&&(t.workerThreadrot++,t.workerThreadrot>=t.workerThreads&&(t.workerThreadrot=0))):t.workers[n].postMessage(e)}};function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W(t){return function(t){if(Array.isArray(t))return G(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return G(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var K=function(){function t(){var e,n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"atlas",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{eegshared:{eegChannelTags:[{ch:0,tag:"FP1",analyze:!0},{ch:1,tag:"FP2",analyze:!0}],sps:512}},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"10_20",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:["eegfft"];H(this,t),this.getDeviceDataByTag=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eeg",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FP1",r=void 0;return"number"==typeof e&&"eeg"===t&&n.data[t+"shared"][t+"ChannelTags"].find((function(t,n){if(t.ch===e&&null!==t.tag)return e=t.tag,!0})),t.indexOf("shared")<0?(n.data[t].find((function(t,n){if(t.tag===e)return r=t,!0})),r):null===e||"all"===e?n.data[t]:"string"==typeof e||"number"==typeof e?(n.data[t].find((function(t,n){if(t.tag===e)return r=t,!0})),r):r},this.getEEGDataByChannel=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=void 0;return"string"==typeof t&&(t=parseInt(t)),n.data.eegshared.eegChannelTags.find((function(r,i){if(r.ch===t&&!1!==(e=null===r.tag||"other"===r.tag?n.getEEGDataByTag(r.ch):n.getEEGDataByTag(r.tag)))return!0})),e},this.getEEGDataByTag=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FP1",e=void 0,r=new RegExp(t,"i");return n.data.eeg.find((function(n,i){if(r.test(n.tag)||n.ch===parseInt(t))return e=n,!0})),e},this.getCoherenceByTag=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FP1::FZ",e=void 0;return n.data.coherence.find((function(n,r){if(n.tag===t)return e=n,!0})),e},this.getLatestFFTData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=[];return n.data.eegshared.eegChannelTags.forEach((function(r,i){if(t){if((t===r.tag||parseInt(t)===r.ch)&&!0===r.analyze){var o=n.getEEGDataByTag(r.tag);if(0===o.fftCount)e.push({tag:o.tag,fftCount:o.fftCount});else{var s=o.fftCount-1;e.push({tag:o.tag,fftCount:o.fftCount,time:o.fftTimes[s],fft:o.ffts[s],slice:{scp:o.slices.scp[s],delta:o.slices.delta[s],theta:o.slices.theta[s],alpha1:o.slices.alpha1[s],alpha2:o.slices.alpha2[s],beta:o.slices.beta[s],lowgamma:o.slices.lowgamma[s],highgamma:o.slices.highgamma[s]},mean:{scp:o.means.scp[s],delta:o.means.delta[s],theta:o.means.theta[s],alpha1:o.means.alpha1[s],alpha2:o.means.alpha2[s],beta:o.means.beta[s],lowgamma:o.means.lowgamma[s],highgamma:o.means.highgamma[s]}})}}}else if(!0===r.analyze){var a=n.getEEGDataByTag(r.tag);if(0===a.fftCount)e.push({tag:a.tag,fftCount:a.fftCount});else{var u=a.fftCount-1;e.push({tag:a.tag,fftCount:a.fftCount,time:a.fftTimes[u],fft:a.ffts[u],slice:{scp:a.slices.scp[u],delta:a.slices.delta[u],theta:a.slices.theta[u],alpha1:a.slices.alpha1[u],alpha2:a.slices.alpha2[u],beta:a.slices.beta[u],lowgamma:a.slices.lowgamma[u],highgamma:a.slices.highgamma[u]},mean:{scp:a.means.scp[u],delta:a.means.delta[u],theta:a.means.theta[u],alpha1:a.means.alpha1[u],alpha2:a.means.alpha2[u],beta:a.means.beta[u],lowgamma:a.means.lowgamma[u],highgamma:a.means.highgamma[u]}})}}})),e},this.getLatestCoherenceData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=[];return n.data.coherence.forEach((function(n,r){if(t){if(n.tag===t){var i=n.fftCount-1;e.push({tag:n.tag,fftCount:n.fftCount,time:n.times[i],fft:n.ffts[i],slice:{scp:n.slices.scp[i],delta:n.slices.delta[i],theta:n.slices.theta[i],alpha1:n.slices.alpha1[i],alpha2:n.slices.alpha2[i],beta:n.slices.beta[i],gamma:n.slices.gamma[i]},mean:{scp:n.means.scp[i],delta:n.means.delta[i],theta:n.means.theta[i],alpha1:n.means.alpha1[i],alpha2:n.means.alpha2[i],beta:n.means.beta[i],gamma:n.means.gamma[i]}})}}else{var o=n.fftCount-1;e.push({tag:n.tag,fftCount:n.fftCount,time:n.times[o],fft:n.ffts[o],slice:{scp:n.slices.scp[o],delta:n.slices.delta[o],theta:n.slices.theta[o],alpha1:n.slices.alpha1[o],alpha2:n.slices.alpha2[o],beta:n.slices.beta[o],gamma:n.slices.gamma[o]},mean:{scp:n.means.scp[o],delta:n.means.delta[o],theta:n.means.theta[o],alpha1:n.means.alpha1[o],alpha2:n.means.alpha2[o],beta:n.means.beta[o],gamma:n.means.gamma[o]}})}})),e},this.getFrontalData=function(){var t=[];if(n.settings.eeg){var e=new RegExp("([F]|[F][A-Za-z]|[A-Za-z][F])([0-9]|[0-9][0-9])","i");n.data.eegshared.eegChannelTags.filter((function(t){return t.tag.match(e)})).forEach((function(e){t.push(n.getEEGDataByTag(e.tag))}))}return t},this.getFrontalCoherenceData=function(){var t=[];if(n.settings.coherence){var e=new RegExp("([F]|[F][A-Za-z]|[A-Za-z][F])([0-9]|[0-9][0-9])","i"),r=n.data.eegshared.eegChannelTags.filter((function(t){return t.tag.match(e)}));r.forEach((function(e,i){for(var o=i+1;o<r.length;o++)t.push(n.getCoherenceByTag("".concat(e.tag,"::").concat(r[o].tag)))}))}return t},this.getCNCoherenceData=function(){var t=void 0;return n.settings.coherence&&void 0===(t=n.getCoherenceByTag("C3_C4"))&&(t=n.getCoherenceByTag("C4_C3")),t},this.getCNData=function(){var t=void 0;if(n.settings.eeg){var e=n.getEEGDataByTag("C3"),r=n.getEEGDataByTag("C4");e&&r&&(t=[e,r])}return t},this.getCoherenceScore=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"alpha1",r=[];return Array.isArray(t)||(t=[t]),t.forEach((function(t){if(t.fftCount>0){var i=t.fftCount,o=Math.min(20,i),s=t.means[e].slice(i-o);r.push(n.mean(s))}})),n.mean(r)},this.getAlphaRatio=function(t){return t.fftCount>0?t.means.alpha2[t.fftCount-1]/t.means.alpha1[t.fftCount-1]:0},this.getThetaBetaRatio=function(t){return t.fftCount>0?t.means.theta[t.fftCount-1]/t.means.beta[t.fftCount-1]:0},this.getAlphaBetaRatio=function(t){return t.fftCount>0?.5*(t.means.alpha1[t.fftCount-1]+t.means.alpha2[t.fftCount-1])/t.means.beta[t.fftCount-1]:0},this.getAlphaThetaRatio=function(t){return t.fftCount>0?.5*(t.means.alpha1[t.fftCount-1]+t.means.alpha2[t.fftCount-1])/t.means.theta[t.fftCount-1]:0},this.get40HzGamma=function(t){if(t.fftCount>0){var e=t.slices.lowgamma[t.fftCount-1],r=[];return e.forEach((function(t,e){n.data.eegshared.bandFreqs.lowgamma[0][e]>38&&n.data.eegshared.bandFreqs.lowgamma[0][e]<42&&r.push(t)})),Math.max.apply(Math,r)}return 0},this.getLowGammaScore=function(t){if(t.fftCount>0){var e=t.fftCount,r=20;e<r&&(r=e);var i=t.means.lowgamma.slice(e-r);return t.means.lowgamma[e-1]-n.mean(i)}return 0},this.getHEGRatioScore=function(t){if(t.count>0){var e=t.count,r=40;e<r&&(r=e);var i=t.ratio.slice(e-r);return t.ratio[e-1]-n.mean(i)}return 0},this.getBlink=function(){var t=[!1,!1];return null==n.data.blink&&(n.data.blink={blinkDuration:1,blinkThreshold:220,lastBlink:Date.now()}),Date.now()-n.data.blink.lastBlink>1e3*n.data.blink.blinkDuration&&([["AF7","FP1"],["AF8","FP2"]].forEach((function(e,r){var i,o=null!==(i=n.getEEGDataByTag(e[0]))&&void 0!==i?i:n.getEEGDataByTag(e[1]),s=o.filtered.slice(o.filtered.length-n.data.blink.blinkDuration*n.data.eegshared.sps),a=Math.max.apply(Math,W(s.map((function(t){return Math.abs(t)}))));t[r]=a>n.data.blink.blinkThreshold})),n.data.blink.lastBlink=Date.now()),t},this.beatDetection=function(t,e){var r=Math.floor(e/4);r%2==0&&(r+=1);var i=Math.round(.5*r),o=Math.floor(3*e);o%2==0&&(o+=1);var s=Math.round(.5*o),a=t.beat_detect;if(a.rir.push(t.red[t.count-1]+t.ir[t.count-1]),a.rir.length>r?a.rir[a.rir.length-1]=n.mean(a.rir.slice(a.rir.length-r)):a.rir[a.rir.length-1]=n.mean(a.rir),a.rir.length>o?a.rir2.push(n.mean(a.rir.slice(a.rir.length-o))):a.rir2.push(n.mean(a.rir)),t.count>1){if(a.drir_dt.push((a.rir[t.count-1]-a.rir[t.count-2])/(t.times[t.count-1]-t.times[t.count-2])),a.drir_dt.length>r){a.drir_dt[a.drir_dt.length-1]=n.mean(a.drir_dt.slice(a.drir_dt.length-r));var u=a.localmins.length,c=a.localmaxs.length;if(n.isExtrema(a.rir.slice(a.rir.length-r),"valley")?a.localmins.push({idx:t.count-i,val:a.rir[t.count-i],t:t.times[t.count-i]}):n.isExtrema(a.rir.slice(a.rir.length-r),"peak")&&a.localmaxs.push({idx:t.count-i,val:a.rir[t.count-i],t:t.times[t.count-i]}),a.localmins.length>1&&a.localmaxs.length>1){if(a.localmins.length>a.localmaxs.length+2)for(;a.localmins.length>a.localmaxs.length+2;)a.localmins.splice(a.localmins.length-2,1);else if(a.localmaxs.length>a.localmins.length+2)for(;a.localmaxs.length>a.localmins.length+2;)a.localmaxs.splice(a.localmins.length-2,1);if(u<a.localmins.length&&a.val_dists.push({dt:a.localmins[a.localmins.length-1].t-a.localmins[a.localmins.length-2].t,t:a.localmins[a.localmins.length-1].t,y0:a.localmins[a.localmins.length-2].val,y1:a.localmins[a.localmins.length-1].val}),c<a.localmaxs.length&&a.peak_dists.push({dt:a.localmaxs[a.localmaxs.length-1].t-a.localmaxs[a.localmaxs.length-2].t,t:a.localmaxs[a.localmaxs.length-1].t,y0:a.localmaxs[a.localmaxs.length-2].val,y1:a.localmaxs[a.localmaxs.length-1].val}),a.peak_dists.length>1&&a.val_dists.length>1)if(a.val_dists[a.val_dists.length-1].t>a.peak_dists[a.peak_dists.length-1].t){if(a.beats.length<1)a.beats.push({t:a.peak_dists[a.peak_dists.length-1].t,hrv:0,bpm:60/(5e-4*(a.peak_dists[a.peak_dists.length-1].dt+a.val_dists[a.val_dists.length-1].dt)),height0:a.peak_dists[a.peak_dists.length-1].y0-a.val_dists[a.val_dists.length-1].y0,height1:a.peak_dists[a.peak_dists.length-1].y1-a.val_dists[a.val_dists.length-1].y1});else if(a.beats[a.beats.length-1].t!==a.peak_dists[a.peak_dists.length-1].t){var l=60/(5e-4*(a.peak_dists[a.peak_dists.length-1].dt+a.val_dists[a.val_dists.length-1].dt));a.beats.push({t:a.peak_dists[a.peak_dists.length-1].t,hrv:Math.abs(l-a.beats[a.beats.length-1].bpm),bpm:l,height0:a.peak_dists[a.peak_dists.length-1].y0-a.val_dists[a.val_dists.length-1].y0,height1:a.peak_dists[a.peak_dists.length-1].y1-a.val_dists[a.val_dists.length-1].y1})}}else if(a.beats.length<2)a.beats.push({t:a.peak_dists[a.peak_dists.length-2].t,hrv:0,bpm:60/(5e-4*(a.peak_dists[a.peak_dists.length-1].dt+a.val_dists[a.val_dists.length-1].dt)),height0:a.peak_dists[a.peak_dists.length-2].y0-a.val_dists[a.val_dists.length-2].y0,height1:a.peak_dists[a.peak_dists.length-2].y1-a.val_dists[a.val_dists.length-2].y1});else if(a.beats[a.beats.length-1].t!==a.peak_dists[a.peak_dists.length-2].t){var h=60/(5e-4*(a.peak_dists[a.peak_dists.length-1].dt+a.val_dists[a.val_dists.length-1].dt));a.beats.push({t:a.peak_dists[a.peak_dists.length-2].t,hrv:Math.abs(h-a.beats[a.beats.length-2].bpm),bpm:h,height0:a.peak_dists[a.peak_dists.length-2].y0-a.val_dists[a.val_dists.length-2].y0,height1:a.peak_dists[a.peak_dists.length-2].y1-a.val_dists[a.val_dists.length-2].y1})}}}if(a.rir2.length>o){var f=a.localmins2.length,p=a.localmaxs2.length;if(n.isExtrema(a.rir2.slice(a.rir2.length-o),"valley")?a.localmins2.push({idx:t.count-s,val:a.rir[t.count-s],t:t.times[t.count-s]}):n.isExtrema(a.rir2.slice(a.rir2.length-o),"peak")&&a.localmaxs2.push({idx:t.count-s,val:a.rir[t.count-s],t:t.times[t.count-s]}),a.localmins2.length>1&&a.localmaxs2.length>1){if(a.localmins2.length>a.localmaxs2.length+2)for(;a.localmins2.length>a.localmaxs2.length+2;)a.localmins2.splice(a.localmins2.length-2,1);else if(a.localmaxs2.length>a.localmins2.length+2)for(;a.localmaxs2.length>a.localmins2.length+2;)a.localmaxs2.splice(a.localmins2.length-2,1);if(f<a.localmins2.length&&a.val_dists2.push({dt:a.localmins2[a.localmins2.length-1].t-a.localmins2[a.localmins2.length-2].t,t:a.localmins2[a.localmins2.length-1].t,y0:a.localmins2[a.localmins2.length-2].val,y1:a.localmins2[a.localmins2.length-1].val}),p<a.localmaxs2.length&&a.peak_dists2.push({dt:a.localmaxs2[a.localmaxs2.length-1].t-a.localmaxs2[a.localmaxs2.length-2].t,t:a.localmaxs2[a.localmaxs2.length-1].t,y0:a.localmaxs2[a.localmaxs2.length-2].val,y1:a.localmaxs2[a.localmaxs2.length-1].val}),a.peak_dists2.length>1&&a.val_dists2.length>1)if(a.val_dists2[a.val_dists2.length-1].t>a.peak_dists2[a.peak_dists2.length-1].t){if(0===a.breaths.length)a.breaths.push(q({t:a.peak_dists2[a.peak_dists2.length-1].t,bpm:12e4/(a.peak_dists2[a.peak_dists2.length-1].dt+a.val_dists2[a.val_dists2.length-1].dt),brv:0,height0:a.peak_dists2[a.peak_dists2.length-1].y0-a.val_dists2[a.val_dists2.length-1].y0},"height0",a.peak_dists2[a.peak_dists2.length-1].y1-a.val_dists2[a.val_dists2.length-1].y1));else if(a.breaths[a.breaths.length-1].t!==a.peak_dists2[a.peak_dists2.length-1].t){var d=12e4/(a.peak_dists2[a.peak_dists2.length-1].dt+a.val_dists2[a.val_dists2.length-1].dt);a.breaths.push(q({t:a.peak_dists2[a.peak_dists2.length-1].t,bpm:d,brv:Math.abs(d-a.breaths[a.breaths.length-1].bpm),height0:a.peak_dists2[a.peak_dists2.length-1].y0-a.val_dists2[a.val_dists2.length-1].y0},"height0",a.peak_dists2[a.peak_dists2.length-1].y1-a.val_dists2[a.val_dists2.length-1].y1))}}else if(0===a.breaths.length)a.breaths.push(q({t:a.peak_dists2[a.peak_dists2.length-2].t,bpm:12e4/(a.peak_dists2[a.peak_dists2.length-2].dt+a.val_dists2[a.val_dists2.length-2].dt),brv:0,height0:a.peak_dists2[a.peak_dists2.length-2].y0-a.val_dists2[a.val_dists2.length-2].y0},"height0",a.peak_dists2[a.peak_dists2.length-2].y1-a.val_dists2[a.val_dists2.length-2].y1));else if(a.breaths[a.breaths.length-1].t!==a.peak_dists2[a.peak_dists2.length-2].t){var y=12e4/(a.peak_dists2[a.peak_dists2.length-2].dt+a.val_dists2[a.val_dists2.length-2].dt);a.breaths.push(q({t:a.peak_dists2[a.peak_dists2.length-2].t,bpm:y,brv:Math.abs(y-a.breaths[a.breaths.length-1].bpm),height0:a.peak_dists2[a.peak_dists2.length-2].y0-a.val_dists2[a.val_dists2.length-2].y0},"height0",a.peak_dists2[a.peak_dists2.length-2].y1-a.val_dists2[a.val_dists2.length-2].y1))}}}}},this.mapFFTData=function(t,e,r){n.data.eeg.find((function(i,o){if(i.tag===r){if(i.fftCount++,i.fftTimes.push(e),i.ffts.push(t),n.data.eegshared.bandFreqs.scp[1].length>0){var s=t.slice(n.data.eegshared.bandFreqs.scp[1][0],n.data.eegshared.bandFreqs.scp[1][n.data.eegshared.bandFreqs.scp[1].length-1]+1);i.slices.scp.push(s),i.means.scp.push(n.mean(s))}if(n.data.eegshared.bandFreqs.scp[1].length>0){var a=t.slice(n.data.eegshared.bandFreqs.delta[1][0],n.data.eegshared.bandFreqs.delta[1][n.data.eegshared.bandFreqs.delta[1].length-1]+1);i.slices.delta.push(a),i.means.delta.push(n.mean(a))}if(n.data.eegshared.bandFreqs.theta[1].length>0){var u=t.slice(n.data.eegshared.bandFreqs.theta[1][0],n.data.eegshared.bandFreqs.theta[1][n.data.eegshared.bandFreqs.theta[1].length-1]+1);i.slices.theta.push(u),i.means.theta.push(n.mean(u))}if(n.data.eegshared.bandFreqs.alpha1[1].length>0){var c=t.slice(n.data.eegshared.bandFreqs.alpha1[1][0],n.data.eegshared.bandFreqs.alpha1[1][n.data.eegshared.bandFreqs.alpha1[1].length-1]+1);i.slices.alpha1.push(c),i.means.alpha1.push(n.mean(c))}if(n.data.eegshared.bandFreqs.alpha2[1].length>0){var l=t.slice(n.data.eegshared.bandFreqs.alpha2[1][0],n.data.eegshared.bandFreqs.alpha2[1][n.data.eegshared.bandFreqs.alpha2[1].length-1]+1);i.slices.alpha2.push(l),i.means.alpha2.push(n.mean(l))}if(n.data.eegshared.bandFreqs.beta[1].length>0){var h=t.slice(n.data.eegshared.bandFreqs.beta[1][0],n.data.eegshared.bandFreqs.beta[1][n.data.eegshared.bandFreqs.beta[1].length-1]+1);i.slices.beta.push(h),i.means.beta.push(n.mean(h))}if(n.data.eegshared.bandFreqs.lowgamma[1].length>0){var f=t.slice(n.data.eegshared.bandFreqs.lowgamma[1][0],n.data.eegshared.bandFreqs.lowgamma[1][n.data.eegshared.bandFreqs.lowgamma[1].length-1]+1);i.slices.lowgamma.push(f),i.means.lowgamma.push(n.mean(f))}if(n.data.eegshared.bandFreqs.highgamma[1].length>0){var p=t.slice(n.data.eegshared.bandFreqs.highgamma[1][0],n.data.eegshared.bandFreqs.highgamma[1][n.data.eegshared.bandFreqs.highgamma[1].length-1]+1);i.slices.highgamma.push(p),i.means.highgamma.push(n.mean(p))}return!0}}))},this.mapCoherenceData=function(t,e){t.forEach((function(t,r){if(n.data.coherence[r].fftCount++,n.data.coherence[r].ffts.push(t),n.data.coherence[r].fftTimes.push(e),n.data.eegshared.bandFreqs.scp[1].length>0){var i=t.slice(n.data.eegshared.bandFreqs.scp[1][0],n.data.eegshared.bandFreqs.scp[1][n.data.eegshared.bandFreqs.scp[1].length-1]+1);n.data.coherence[r].slices.scp.push(i),n.data.coherence[r].means.scp.push(n.mean(i))}if(n.data.eegshared.bandFreqs.delta[1].length>0){var o=t.slice(n.data.eegshared.bandFreqs.delta[1][0],n.data.eegshared.bandFreqs.delta[1][n.data.eegshared.bandFreqs.delta[1].length-1]+1);n.data.coherence[r].slices.delta.push(o),n.data.coherence[r].means.delta.push(n.mean(o))}if(n.data.eegshared.bandFreqs.theta[1].length>0){var s=t.slice(n.data.eegshared.bandFreqs.theta[1][0],n.data.eegshared.bandFreqs.theta[1][n.data.eegshared.bandFreqs.theta[1].length-1]+1);n.data.coherence[r].slices.theta.push(s),n.data.coherence[r].means.theta.push(n.mean(s))}if(n.data.eegshared.bandFreqs.alpha1[1].length>0){var a=t.slice(n.data.eegshared.bandFreqs.alpha1[1][0],n.data.eegshared.bandFreqs.alpha1[1][n.data.eegshared.bandFreqs.alpha1[1].length-1]+1);n.data.coherence[r].slices.alpha1.push(a),n.data.coherence[r].means.alpha1.push(n.mean(a))}if(n.data.eegshared.bandFreqs.alpha2[1].length>0){var u=t.slice(n.data.eegshared.bandFreqs.alpha2[1][0],n.data.eegshared.bandFreqs.alpha2[1][n.data.eegshared.bandFreqs.alpha2[1].length-1]+1);n.data.coherence[r].slices.alpha2.push(u),n.data.coherence[r].means.alpha2.push(n.mean(u))}if(n.data.eegshared.bandFreqs.beta[1].length>0){var c=t.slice(n.data.eegshared.bandFreqs.beta[1][0],n.data.eegshared.bandFreqs.beta[1][n.data.eegshared.bandFreqs.beta[1].length-1]+1);n.data.coherence[r].slices.beta.push(c),n.data.coherence[r].means.beta.push(n.mean(c))}if(n.data.eegshared.bandFreqs.lowgamma[1].length>0){var l=t.slice(n.data.eegshared.bandFreqs.lowgamma[1][0],n.data.eegshared.bandFreqs.lowgamma[1][n.data.eegshared.bandFreqs.lowgamma[1].length-1]+1);n.data.coherence[r].slices.lowgamma.push(l),n.data.coherence[r].means.lowgamma.push(n.mean(l))}if(n.data.eegshared.bandFreqs.highgamma[1].length>0){var h=t.slice(n.data.eegshared.bandFreqs.highgamma[1][0],n.data.eegshared.bandFreqs.highgamma[1][n.data.eegshared.bandFreqs.highgamma[1].length-1]+1);n.data.coherence[r].slices.highgamma.push(h),n.data.coherence[r].means.highgamma.push(n.mean(h))}}))},this.bufferEEGSignals=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=Math.floor(n.data.eegshared.sps*t),r=[],i=null,o=0;o<n.data.eegshared.eegChannelTags.length;o++)if(!0===n.data.eegshared.eegChannelTags[o].analyze&&null!==n.data.eegshared.eegChannelTags[o].tag&&"other"!==n.data.eegshared.eegChannelTags[o].tag){var s=n.getEEGDataByTag(n.data.eegshared.eegChannelTags[o].tag);void 0!==s&&(s.filtered.length>0?r.push(s.filtered.slice(s.filtered.length-e)):s.raw.length>0&&r.push(s.raw.slice(s.raw.length-e)),null===i&&(i=s.times[s.times.length-1]))}return!0===n.settings.analyzing&&(n.workerPostTime=i),r},this.readyEEGDataForWriting=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end",r=["TimeStamps","UnixTime"],i=[],o=0,s=0,a=[],u=null;if(n.data.eegshared.eegChannelTags.forEach((function(t,e){null===u&&"other"!==t.tag&&!0===t.analyze&&(u=n.getEEGDataByChannel(t.ch)),a.push(n.getEEGDataByChannel(t.ch))})),a.length>0){if("end"===e&&(e=a[0].count),a[0].count<t&&(t=n.atlas.rolloverLimit-2e3),0!==t)for(;u.fftTimes[o]<a[0].times[t];)o++;for(var c=function(t){var e=[];if(e.push(n.toISOLocal(new Date(a[0].times[t])),a[0].times[t]),a.forEach((function(n,i){0===t&&r.push(n.tag),n.filtered.length>t?e.push(n.filtered[t].toFixed(0)):n.raw.length>t&&e.push(n.raw[t].toFixed(0))})),u.fftCount>=o&&u.fftTimes[o]===a[0].times[t]&&(a.forEach((function(i,s){if(0===o&&!n.data.eegshared.eegChannelTags.find((function(t,e){if(!(i.tag!==t.ch&&i.tag!==t.tag||!1!==t.analyze&&"other"!==t.tag))return!0}))){var u=W(n.data.eegshared.frequencies).map((function(t,e){return t.toFixed(3)}));r.push(i.tag+"; FFT Hz:",u.join(","))}a[0].times[t]===i.fftTimes[o]&&e.push([""].concat(W(W(i.ffts[o]).map((function(t,e){return t.toFixed(3)})))))})),n.settings.coherence&&n.data.coherence.forEach((function(t,i){if(0===o){var s=W(n.data.eegshared.frequencies).map((function(t,e){return t.toFixed(3)}));r.push(t.tag+"; FFT Hz:",s.join(","))}if(a[0].fftTimes[o]===t.fftTimes[o])try{e.push([""].concat(W(W(t.ffts[o]).map((function(t,e){return t.toFixed(3)})))))}catch(e){console.log(e,o,t)}})),o++),n.data.other.notes.length>0){if(0===t)r.push("Notes");else for(;n.data.other.notes[s].time<a[0].times[t];)s++;n.data.other.notes[s].time<=a[0].times[t]&&(e.length!==r.length&&(e=new Array(r.length-e.length-1).fill("")),e.push(n.data.other.notes[s].note),nodeidx++)}i.push(e.join(","))},l=t;l<e;l++)c(l);return[r.join(",")+"\n",i.join("\n")]}},this.readyHEGDataForWriting=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=["TimeStamps","UnixTime","Red","IR","Ratio","Ambient","Temp","BPM","HRV","BrPM","BRV"],o=[],s=n.data.heg[r],a=0,u=0,c=0;"end"===e&&(e=s.times.length);for(var l=t;l<e;l++){var h,f,p=s.times[l],d=s.ambient[l];d||(d=0);var y,v=[n.toISOLocal(new Date(p)),p,s.red[l],s.ir[l],s.ratio[l],d,s.temp[l]];if(p===(null===(h=s.beat_detect.beats[u])||void 0===h?void 0:h.t)?(v.push(null===(y=s.beat_detect.beats[u])||void 0===y?void 0:y.bpm,s.beat_detect.beats[u].hrv),u++):v.push("",""),p===(null===(f=s.beat_detect.breaths[c])||void 0===f?void 0:f.t)?(v.push(s.beat_detect.breaths[c].bpm,s.beat_detect.breaths[c].brv),c++):v.push("",""),n.data.other.notes.length>0){if(0===l)i.push("Notes");else for(;n.data.other.notes[a].time<p;)a++;n.data.other.notes[a].time<=p&&(v.push(n.data.other.notes[a].note),nodeidx++)}o.push(v.join(","))}return[i.join(",")+"\n",o.join("\n")]},this.workeronmessage=function(t){if(t.origin===n.name){if("multidftbandpass"===t.foo||"multidft"===t.foo){var e=W(t.output[1]),r=0;n.data.eegshared.eegChannelTags.forEach((function(t,i){null!==t.tag&&"other"!==t.tag&&!0===t.analyze&&(n.mapFFTData(e[r],n.workerPostTime,t.tag),r++)})),n.checkRollover("eeg")}else if("coherence"===t.foo){e=W(t.output[1]);var i=W(t.output[2]),o=0;n.data.eegshared.eegChannelTags.forEach((function(t,r){null!==t.tag&&"other"!==t.tag&&!0===t.analyze&&(n.mapFFTData(e[o],n.workerPostTime,t.tag),o++)})),n.mapCoherenceData(i,n.workerPostTime),n.checkRollover("eeg")}n.workerWaiting=!1}},this.analyzer=function(){!0===n.settings.analyzing&&(n.settings.analysis.forEach((function(t,e){n.analyzerOpts.forEach((function(e,r){e===t&&n.analyzerFuncs[r]()}))})),"undefined"==typeof window?setTimeout((function(){n.analyzer()}),60):setTimeout((function(){requestAnimationFrame(n.analyzer)}),50))},this.makeFeedbackOptions=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.getElementById(t.props.id).querySelector(".brainsatplay-neurofeedback-container"),i=t.props.id,o="";if(n.settings.deviceConnected){r.style.pointerEvents="auto";var s=function(){return n.getCoherenceScore(n.getFrontalCoherenceData(),"alpha1")},a=function(){var t=n.getFrontalData(),e=[];return t.forEach((function(t){e.push(n.getThetaBetaRatio(t))})),Math.min(1/(e.reduce((function(t,e){return t+e}))/e.length),1)},u=function(){var t=n.data.heg[0].count;return t>1?n.data.heg[0].ratio[t-1]:0},c=function(){var t=n.data.heg[0].count;if(t>1){var e=40;t<e&&(e=t);var r=n.data.heg[0].ratio.slice(t-e);return n.data.heg[0].ratio[t-1]-n.mean(r)}return 0},l=function(t){var e=n.data.heg[0].beat_detect[t],r=n.data.heg[0].beat_detect.prevBeatLength;if(n.data.heg[0].beat_detect.prevBeatLength=e.length,r<e.length&&(console.log("beat"),e[e.length-1].tRead=Date.now()),0<e.length){var i=(Date.now()-e[e.length-1].tRead)/1e3*e[e.length-1].bpm/30;return i<1?1-(.5+.5*Math.cos(2*Math.PI*i)):0}return 0},h=function(){return l("beats")},f=function(){return l("breaths")};e=[{label:"Select your neurofeedback",function:t.defaultNeurofeedback}],n.settings.heg&&e.push({label:"HEG Ratio",function:u},{label:"HEG Score",function:c},{label:"Heartbeat",function:h},{label:"Breath",function:f}),n.settings.eeg&&e.push({label:"Frontal Alpha Coherence",function:s},{label:"Focus (Theta/Beta Ratio)",function:a});var p=document.getElementById("".concat(i,"-neurofeedbackselector"));null==p&&(o='<div><select id="'.concat(i,'-neurofeedbackselector">'),e.forEach((function(t,n){o+=0===n?"<option value=".concat(t.function.name," disabled>").concat(t.label,"</option>"):1===n?"<option value=".concat(t.function.name," selected>").concat(t.label,"</option>"):"<option value=".concat(t.function.name,">").concat(t.label,"</option>"),n===e.length-1&&(o+="</select></div>")})),r.innerHTML+=o,p=document.getElementById("".concat(i,"-neurofeedbackselector"))),t.getNeurofeedback=e.find((function(t){return t.function.name==p.value})).function,p.onchange=function(n){t.getNeurofeedback=e.find((function(t){return t.function.name==n.target.value})).function}}},this.name=r,this.config=o,null==window.workers?window.workers=new U:console.log("Workers already created."),this.state=new R({deviceConnected:!1,analyzing:!1,analysis:u,heg:!1,eeg:!1,coherence:!1,eyetracker:!1,accelerometer:!1,hrv:!1,fnirs:!1,ecg:!1,spo2:!1,emg:!1}),this.settings=this.state.data,this.data={eegshared:{eegChannelTags:[],sps:1,startTime:0,frequencies:[],bandFreqs:{scp:[[],[]],delta:[[],[]],theta:[[],[]],alpha1:[[],[]],alpha2:[[],[]],beta:[[],[]],lowgamma:[[],[]],highgamma:[[],[]]}},eeg:[],coherence:[],heg:[],fnirs:[],accelerometer:[],hrv:[],spo2:[],emg:[],ecg:[],eyetracker:[],other:{notes:[],games:{}}},Object.assign(this.data,i),this.rolloverLimit=60030,Array.isArray(this.data.eegshared.eegChannelTags)||(e="string"==typeof this.data.eegshared.eegChannelTags?parseInt(this.data.eegshared.eegChannelTags):this.data.eegshared.eegChannelTags,this.data.eegshared.eegChannelTags=["FP1","FP2","FZ","F3","F4","F7","F8","CZ","C3","C4","T3","T4","T5","T6","PZ","P3","P4","O1","O2"].slice(0,e),this.data.eegshared.eegChannelTags=this.data.eegshared.eegChannelTags.map((function(t,e){return{ch:e,tag:t,analyze:!0}}))),"10_20"===o?(this.settings.eeg=!0,this.data.eeg=this.gen10_20Atlas(this.data.eegshared.eegChannelTags)):"muse"===o?(this.settings.eeg=!0,this.data.eeg=this.genMuseAtlas()):"big"===o?(this.settings.eeg=!0,this.data.eeg=this.gen10_20Atlas()):"hegduino"===o?(this.addHEGCoord(this.data.heg.length,0,60,60),this.settings.heg=!0):"eyetracker"===o&&(this.settings.eyetracker=!0,this.addEyeTracker(this.data.eyetracker.length)),!0===s&&(this.settings.coherence=!0,this.data.coherence=this.genCoherenceMap(this.data.eegshared.eegChannelTags)),this.data.eegshared.eegChannelTags&&this.data.eegshared.eegChannelTags.forEach((function(t,e){void 0===n.getEEGDataByTag(t.tag)&&n.addEEGCoord(t.ch)})),this.data.eegshared.sps&&(this.data.eegshared.frequencies=this.bandpassWindow(0,128,.5*this.data.eegshared.sps),this.data.eegshared.bandFreqs=this.getBandFreqs(this.data.eegshared.frequencies)),this.analyzerOpts=[],this.analyzerFuncs=[],this.workerPostTime=0,this.workerWaiting=!1,this.workerIdx=0,!0===a&&(this.addDefaultAnalyzerFuncs(),window.workers.workerResponses||(window.workers.workerResponses=[]),window.workers.workerResponses.push(this.workeronmessage))}var e,n;return e=t,(n=[{key:"genEEGCoordinateStruct",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={scp:[],delta:[],theta:[],alpha1:[],alpha2:[],beta:[],lowgamma:[],highgamma:[]},o={tag:t,position:{x:e,y:n,z:r},count:0,times:[],raw:[],filtered:[],fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(i)),means:JSON.parse(JSON.stringify(i)),lastReadFFT:0,lastRead:0};return o}},{key:"addEEGCoord",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:999,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:999;this.data.eeg.push(this.genEEGCoordinateStruct(t,e,n,r))}},{key:"genMuseAtlas",value:function(){var t=this,e=[],n=[[-21.5,70.2,-.1],[28.4,69.1,-.4],[-54.8,33.9,-3.5],[56.6,30.8,-4.1]];function r(t,e){var n=[];return t.forEach((function(t,r){n.push(.5*(t+e[r]))})),n}var i=[r(n[0],n[2]),r(n[1],n[3]),[-80.2,-31.3,-10.7],[81.9,-34.2,-8.2],[NaN,NaN,NaN]];return["AF7","AF8","TP9","TP10","AUX"].forEach((function(n,r){e.push(t.genEEGCoordinateStruct(n,i[r][0],i[r][1],i[r][2]))})),e}},{key:"gen10_20Atlas",value:function(t){var e=this,n={FP1:[-21.2,66.9,12.1],FPZ:[1.4,65.1,11.3],FP2:[24.3,66.3,12.5],AF7:[-41.7,52.8,11.3],AF3:[-32.7,48.4,32.8],AFZ:[1.8,54.8,37.9],AF4:[35.1,50.1,31.1],AF8:[43.9,52.7,9.3],F5:[-51.4,26.7,24.7],F3:[-39.7,25.3,44.7],F1:[-22.1,26.8,54.9],FZ:[0,26.8,60.6],F2:[23.6,28.2,55.6],F4:[41.9,27.5,43.9],F6:[52.9,28.7,25.2],F7:[-52.1,28.6,3.8],F8:[53.2,28.4,3.1],FC5:[-59.1,3,26.1],FC3:[-45.5,2.4,51.3],FC1:[-24.7,.3,66.4],FCZ:[1,1,72.8],FC2:[26.1,3.2,66],FC4:[47.5,4.6,49.7],FC6:[60.5,4.9,25.5],FT9:[-53.8,-2.1,-29.1],FT7:[-59.2,3.4,-2.1],FT8:[60.2,4.7,-2.8],FT10:[55,-3.6,-31],T7:[-65.8,-17.8,-2.9],T5:[-61.5,-65.3,1.1],T3:[-70.2,-21.3,-10.7],T4:[71.9,-25.2,-8.2],T6:[59.3,-67.6,3.8],T8:[67.4,-18.5,-3.4],C5:[-63.6,-18.9,25.8],C3:[-49.1,-20.7,53.2],C1:[-25.1,-22.5,70.1],CZ:[.8,-21.9,77.4],C2:[26.7,-20.9,69.5],C4:[50.3,-18.8,53],C6:[65.2,-18,26.4],CP5:[-61.8,-46.2,22.5],CP3:[-46.9,-47.7,49.7],CP1:[-24,-49.1,66.1],CPZ:[.7,-47.9,72.6],CP2:[25.8,-47.1,66],CP4:[49.5,-45.5,50.7],CP6:[62.9,-44.6,24.4],TP9:[-73.6,-46.7,-4],TP7:[-63.6,-44.7,-4],TP8:[64.6,-45.4,-3.7],TP10:[74.6,-47.4,-3.7],P9:[-50.8,-51.3,-37.7],P7:[-55.9,-64.8,0],P5:[-52.7,-67.1,19.9],P3:[-41.4,-67.8,42.4],P1:[-21.6,-71.3,52.6],PZ:[.7,-69.3,56.9],P2:[24.4,-69.9,53.5],P4:[44.2,-65.8,42.7],P6:[54.4,-65.3,20.2],P8:[56.4,-64.4,.1],P10:[51,-53.9,-36.5],PO7:[-44,-81.7,1.6],PO3:[-33.3,-84.3,26.5],POZ:[0,-87.9,33.5],PO4:[35.2,-82.6,26.1],PO8:[43.3,-82,.7],O1:[-25.8,-93.3,7.7],OZ:[.3,-97.1,8.7],O2:[25,-95.2,6.2]},r=[];if(null==t)for(var i in n)r.push(this.genEEGCoordinateStruct(i,n[i][0],n[i][1],n[i][2]));else Array.isArray(t)&&t.forEach((function(t){var i=t.tag;n[i]?r.push(e.genEEGCoordinateStruct(i,n[i][0],n[i][1],n[i][2])):r.push(e.genEEGCoordinateStruct(i,NaN,NaN,NaN))}));return r}},{key:"genCoherenceStruct",value:function(t,e,n,r){var i={scp:[],delta:[],theta:[],alpha1:[],alpha2:[],beta:[],lowgamma:[],highgamma:[]};return{tag:t+"::"+e,x0:null==n?void 0:n.x,y0:null==n?void 0:n.y,z0:null==n?void 0:n.z,x1:null==r?void 0:r.x,y1:null==r?void 0:r.y,z1:null==r?void 0:r.z,fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(i)),means:JSON.parse(JSON.stringify(i)),lastRead:0}}},{key:"genCoherenceMap",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data.eegshared.eegChannelTags,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],r=1,i=0,o=0;o<t.length*(t.length+1)/2-t.length;o++){if(!1===e||!0===e&&null!==t[i].tag&&null!==t[i+r].tag&&"other"!==t[i].tag&&"other"!==t[i+r].tag&&!0===t[i].analyze&&!0===t[i+r].analyze){var s=this.getEEGDataByTag(t[i].tag),a=this.getEEGDataByTag(t[i+r].tag);n.push(this.genCoherenceStruct(t[i].tag,t[i+r].tag,s.position,a.position))}++r+i===t.length&&(i++,r=1)}return n}},{key:"genHEGStruct",value:function(t,e,n,r){return{tag:t,position:{x:e,y:n,z:r},count:0,times:[],red:[],ir:[],ambient:[],ratio:[],temp:[],beat_detect:{beats:[],breaths:[],rir:[],rir2:[],drir_dt:[],localmins:[],localmaxs:[],val_dists:[],peak_dists:[],localmins2:[],localmaxs2:[],val_dists2:[],peak_dists2:[]},lastRead:0,startTime:0}}},{key:"addHEGCoord",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"heg1",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.data.heg.push(this.genHEGStruct(t,e,n,r))}},{key:"genFNIRSStruct",value:function(t,e,n,r){return{tag:t,position:{x:e,y:n,z:r},count:0,times:[],red:[],ir:[],ir2:[],ambient:[],lastRead:0}}},{key:"addFNIRSCoord",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"banana1",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.data.fnirs.push(this.genHEGStruct(t,e,n,r))}},{key:"genAccelerometerStruct",value:function(t,e,n,r){return{tag:t,position:{x:e,y:n,z:r},count:0,times:[],Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[],lastRead:0,startTime:0}}},{key:"addAccelerometerCoord",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"accel1",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.data.accelerometer.push(this.genAccelerometerStruct(t,e,n,r))}},{key:"genHRVStruct",value:function(t){return{tag:t,count:0,times:[],raw:[],filtered:[],bpm:[],hrv:[],lastRead:0,startTime:0}}},{key:"addHRV",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hrv1";this.data.hrv.push(genHRVStruct(t))}},{key:"genEyeTrackerStruct",value:function(t){return{tag:t,count:0,times:[],x:[],y:[],smax:[],smay:[],lastRead:0,startTime:0}}},{key:"addEyeTracker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eyes";this.data.eyetracker.push(this.genEyeTrackerStruct(t))}},{key:"makeNote",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"event",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(void 0===e){if(this.settings.eeg){var n=this.getEEGDataByChannel(this.data.eegshared.eegChannelTags[0].ch);e=n.times[n.times.length-1],this.data.other.notes.push({time:e,note:t})}this.settings.heg?(e=this.data.heg[0].times[this.data.heg[0].times.length-1],this.data.other.notes.push({time:e,note:t})):this.data.other.notes.push({time:Date.now(),note:t})}else this.data.other.notes.push({time:e,note:t})}},{key:"getCoordPositions",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eeg",e=[],n=0;n<this.data[t].length;n++)e.push([this.data[t][n].position.x,this.data[t][n].position.y,this.data[t][n].position.z]);return e}},{key:"mean",value:function(t){return t.length>0?t.reduce((function(t,e){return e+t}))/t.length:0}},{key:"isExtrema",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"peak",n=W(t);if(n.length%2==0&&n.pop(),t.length>1){var r=!0;return n.forEach((function(t,i){"peak"===e?(i<Math.floor(.5*n.length)&&t>=n[Math.floor(.5*n.length)]||i>Math.floor(.5*n.length)&&t>=n[Math.floor(.5*n.length)])&&(r=!1):(i<Math.floor(.5*n.length)&&t<=n[Math.floor(.5*n.length)]||i>Math.floor(.5*n.length)&&t<=n[Math.floor(.5*n.length)])&&(r=!1)})),"peak"!==e&&"valley"!==e&&!1===r&&(r=!0,n.forEach((function(t,e){(e<Math.floor(.5*n.length)&&t>=n[Math.floor(.5*n.length)]||e>Math.floor(.5*n.length)&&t>=n[Math.floor(.5*n.length)])&&(r=!1)}))),r}}},{key:"isCriticalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"peak",n=W(t);if(n.length%2==0&&n.pop(),t.length>1){var r=!0;return n.forEach((function(t,i){"peak"===e?(i<.5*n.length&&t<=0||i>.5*n.length&&t>0)&&(r=!1):(i<.5*n.length&&t>=0||i>.5*n.length&&t<0)&&(r=!1)})),"peak"!==e&&"valley"!==e&&!1===r&&(r=!0,n.forEach((function(t,e){(e<.5*n.length&&t<=0||e>.5*n.length&&t>0)&&(r=!1)}))),r}}},{key:"setDefaultTags",value:function(){return[{ch:0,tag:null},{ch:1,tag:null},{ch:2,tag:null},{ch:3,tag:null},{ch:4,tag:null},{ch:5,tag:null},{ch:6,tag:null},{ch:7,tag:null},{ch:8,tag:null},{ch:9,tag:null},{ch:10,tag:null},{ch:11,tag:null},{ch:12,tag:null},{ch:13,tag:null},{ch:14,tag:null},{ch:15,tag:null},{ch:16,tag:null},{ch:17,tag:null},{ch:18,tag:null},{ch:19,tag:null},{ch:20,tag:null},{ch:21,tag:null},{ch:22,tag:null},{ch:23,tag:null},{ch:24,tag:null},{ch:25,tag:null},{ch:26,tag:null},{ch:27,tag:null},{ch:28,tag:null},{ch:29,tag:null},{ch:30,tag:null},{ch:31,tag:null}]}},{key:"getBandFreqs",value:function(t){var e=[[],[]],n=[[],[]],r=[[],[]],i=[[],[]],o=[[],[]],s=[[],[]],a=[[],[]],u=[[],[]];return t.forEach((function(t,c){t>=.1&&t<=1?(e[0].push(t),e[1].push(c)):t>=1&&t<=4?(n[0].push(t),n[1].push(c)):t>4&&t<=8?(r[0].push(t),r[1].push(c)):t>8&&t<=10?(i[0].push(t),i[1].push(c)):t>10&&t<=12?(o[0].push(t),o[1].push(c)):t>12&&t<=30?(s[0].push(t),s[1].push(c)):t>30&&t<=45?(a[0].push(t),a[1].push(c)):t>45&&(u[0].push(t),u[1].push(c))})),{scp:e,delta:n,theta:r,alpha1:i,alpha2:o,beta:s,lowgamma:a,highgamma:u}}},{key:"bandpassWindow",value:function(t,e,n){for(var r=(e-t)/n,i=[],o=0;o<e;)i.push(o),o+=r;return i}},{key:"toISOLocal",value:function(t){var e=function(t){return("0"+t).slice(-2)},n=t.getTimezoneOffset(),r=n<0?"+":"-";return n=Math.abs(n),t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+"T"+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+("00"+t.getMilliseconds()).slice(-3)+"(UTC"+r+e(n/60|0)+":00)"}},{key:"regenAtlasses",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512;this.data.eeg=this.makeAtlas10_20();var r=this.bandPassWindow(t,e,n);this.data.eegshared.frequencies=r,this.data.eegshared.bandFreqs=this.getBandFreqs(r),this.coherenceMap=this.genCoherenceMap()}},{key:"addDefaultAnalyzerFuncs",value:function(){var t=this;this.analyzerOpts.push("eegfft","eegcoherence"),this.analyzerFuncs.push((function(){if(!1===t.workerWaiting){var e=t.bufferEEGSignals(1);e.length>0&&e[0].length>=t.data.eegshared.sps&&(window.workers.postToWorker({foo:"multidftbandpass",input:[e,1,0,128,1],origin:t.name},t.workerIdx),t.workerWaiting=!0)}}),(function(){if(!1===t.workerWaiting){var e=t.bufferEEGSignals(1);e.length>0&&e[0].length>=t.data.eegshared.sps&&(window.workers.postToWorker({foo:"coherence",input:[e,1,0,128,1],origin:t.name},t.workerIdx),t.workerWaiting=!0)}}))}},{key:"addAnalyzerFunc",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.analyzerOpts.find((function(e,r){if(e==e)return t.analyzerFuncs[r]=n,!0}));void 0===r&&(this.analyzerOpts.push(e),this.analyzerFuncs.push(n))}},{key:"checkRollover",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e)for(var n in this.data)Array.isArray(this.data[n])&&this.data[n].forEach((function(e,n){for(var r in e)if(Array.isArray(e[r])||"object"!==z(e[r]))Array.isArray(e[r])&&e[r].length>t.rolloverLimit&&(e[r].splice(0,e[r].length-t.rolloverLimit-2e3),"ffts"===r?(e.fftCount=e[r].length,e.lastReadFFT>e[r].length&&(e.lastReadFFT=e[r].length)):"times"===r&&(e.count=e[r].length,e.lastRead>e[r].length&&(e.lastRead=e[r].length)));else for(var i in e[r])Array.isArray(e[r][i])&&e[r][i].length>t.rolloverLimit&&e[r][i].splice(0,e[r][i].length-t.rolloverLimit-2e3)}));else Array.isArray(this.data[e])&&this.data[e].forEach((function(e,n){for(var r in e)if(Array.isArray(e[r])||"object"!==z(e[r]))Array.isArray(e[r])&&e[r].length>t.rolloverLimit&&(e[r].splice(0,e[r].length-t.rolloverLimit-2e3),"ffts"===r?(e.fftCount=e[r].length,e.lastReadFFT=e[r].length):"times"===r&&(e.count=e[r].length,e.lastRead=e[r].length));else for(var i in e[r])Array.isArray(e[r][i])&&e[r][i].length>t.rolloverLimit&&e[r][i].splice(0,e[r][i].length-t.rolloverLimit-2e3)}))}}])&&Y(e.prototype,n),t}();function Q(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function J(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Q(o,r,i,s,a,"next",t)}function a(t){Q(o,r,i,s,a,"throw",t)}s(void 0)}))}}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var et=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.onDecodedCallback,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onConnectedCallback,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onDisconnectedCallback,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.decode,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:115200;$(this,t),this.onDecodedCallback=e,this.onConnectedCallback=n,this.onDisconnectedCallback=r,this.decode=i,this.connected=!1,this.subscribed=!1,this.buffer=[],this.startByte=160,this.stopByte=192,this.searchString=new Uint8Array([this.stopByte,this.startByte]),this.readRate=16.666667,this.readBufferSize=2e3,this.sps=512,this.nChannels=32,this.nPeripheralChannels=6,this.updateMs=1e3/this.sps,this.stepSize=1/Math.pow(2,24),this.vref=2.5,this.gain=8,this.vscale=this.vref/this.gain*this.stepSize,this.uVperStep=this.vref/this.gain*this.stepSize*1e6,this.scalar=1/(1e6/(this.vref/this.gain*this.stepSize)),this.maxBufferedSamples=60*this.sps*2,this.data={count:0,startms:0,ms:[],A0:[],A1:[],A2:[],A3:[],A4:[],A5:[],A6:[],A7:[],A8:[],A9:[],A10:[],A11:[],A12:[],A13:[],A14:[],A15:[],A16:[],A17:[],A18:[],A19:[],A20:[],A21:[],A22:[],A23:[],A24:[],A25:[],A26:[],A27:[],A28:[],A29:[],A30:[],A31:[],Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[]},this.resetDataBuffers(),navigator.serial||console.error("`navigator.serial not found! Enable #enable-experimental-web-platform-features in chrome://flags (search 'experimental')"),this.port=null,this.reader=null,this.baudrate=o}var e,n,r,i,o,s,a;return e=t,(n=[{key:"resetDataBuffers",value:function(){for(var t in this.data.count=0,this.data.startms=0,this.data)"object"===Z(this.data[t])&&(this.data[t]=new Array(this.maxBufferedSamples).fill(0))}},{key:"setScalar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/(Math.pow(2,23)-1),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4.5;this.stepSize=e,this.vref=n,this.gain=t,this.vscale=this.vref/this.gain*this.stepSize,this.uVperStep=this.vref/this.gain*this.stepSize*1e6,this.scalar=1/(1e6/(this.vref/this.gain*this.stepSize))}},{key:"getLatestData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A0",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e;return n<=1?[this.data[t][this.data.count-1]]:(n>this.data.count&&(n=this.data.count),this.data[t].slice(this.data.count-n,this.data.count))}},{key:"bytesToInt16",value:function(t,e){return 256*t+e}},{key:"int16ToBytes",value:function(t){return[255&t,t>>8&255]}},{key:"bytesToInt24",value:function(t,e,n){return 65536*t+256*e+n}},{key:"int24ToBytes",value:function(t){return[255&t,t>>8&255,t>>16&255]}},{key:"decode",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.buffer,e=this.searchString,n=t,r=this.boyerMoore(e),i=r.byteLength,o=[],s=0,a=r(n);-1!==a;a=r(n,a+i))o.push(a);if(o.length>=2){for(var u=1;u<o.length;u++)if(o[u]-o[u-1]!=105);else{var c=t.slice(o[u-1],o[u]+1);for(this.data.count<this.maxBufferedSamples&&this.data.count++,this.data.count-1==0?(this.data.ms[this.data.count-1]=Date.now(),this.data.startms=this.data.ms[0]):(this.data.ms[this.data.count-1]=this.data.ms[this.data.count-2]+this.updateMs,this.data.count>=this.maxBufferedSamples&&(this.data.ms.splice(0,5120),this.data.ms.push(new Array(5120).fill(0)))),a=3;a<99;a+=3){var l="A"+(a-3)/3;this.data[l][this.data.count-1]=this.bytesToInt24(c[a],c[a+1],c[a+2]),this.data.count>=this.maxBufferedSamples&&(this.data[l].splice(0,5120),this.data[l].push(new Array(5120).fill(0)))}this.data.Ax[this.data.count-1]=this.bytesToInt16(c[99],c[100]),this.data.Ay[this.data.count-1]=this.bytesToInt16(c[101],c[102]),this.data.Az[this.data.count-1]=this.bytesToInt16(c[103],c[104]),this.data.count>=this.maxBufferedSamples&&(this.data.Ax.splice(0,5120),this.data.Ay.splice(0,5120),this.data.Az.splice(0,5120),this.data.Ax.push(new Array(5120).fill(0)),this.data.Ay.push(new Array(5120).fill(0)),this.data.Az.push(new Array(5120).fill(0)),this.data.count-=5120),s++}return s>0&&t.splice(0,o[o.length-1]),s}}},{key:"onDecodedCallback",value:function(t){}},{key:"onConnectedCallback",value:function(){console.log("port connected!")}},{key:"onDisconnectedCallback",value:function(){console.log("port disconnected!")}},{key:"onReceive",value:function(t){var e,n;(e=this.buffer).push.apply(e,function(t){if(Array.isArray(t))return X(t)}(n=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return X(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var r=this.decode(this.buffer);!1===r||0===r||isNaN(r)||this.onDecodedCallback(r)}},{key:"onPortSelected",value:(a=J(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.baudrate,t.prev=1,t.prev=2,t.next=5,e.open({baudRate:n,bufferSize:this.readBufferSize});case 5:this.onConnectedCallback(),this.connected=!0,this.subscribed=!0,this.subscribe(e),t.next=19;break;case 11:return t.prev=11,t.t0=t.catch(2),t.next=15,e.open({baudrate:n,buffersize:this.readBufferSize});case 15:this.onConnectedCallback(),this.connected=!0,this.subscribed=!0,this.subscribe(e);case 19:t.next=25;break;case 21:t.prev=21,t.t1=t.catch(1),console.log(t.t1),this.connected=!1;case 25:case"end":return t.stop()}}),t,this,[[1,21],[2,11]])}))),function(t){return a.apply(this,arguments)})},{key:"subscribe",value:(s=J(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.port.readable&&!0===this.subscribed&&(this.reader=e.readable.getReader(),(n=function(){var t=J(regeneratorRuntime.mark((function t(){var i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.reader.read();case 3:if(i=t.sent,o=i.value,!i.done&&!1!==r.subscribed){t.next=9;break}return t.next=9,r.reader.releaseLock();case 9:if(o)try{r.onReceive(o)}catch(t){console.log(t)}!0===r.subscribed&&setTimeout((function(){n()}),r.readRate),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0),t.t0.message.includes("framing")||t.t0.message.includes("overflow")||t.t0.message.includes("overrun")||t.t0.message.includes("Overflow")||t.t0.message.includes("break")?(r.subscribed=!1,setTimeout(J(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.reader){t.next=4;break}return t.next=3,r.reader.releaseLock();case 3:r.reader=null;case 4:r.subscribed=!0,r.subscribe(e);case 6:case"end":return t.stop()}}),t)}))),30)):t.t0.message.includes("parity")||t.t0.message.includes("Parity")?r.port&&(r.subscribed=!1,setTimeout(J(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.reader){t.next=4;break}return t.next=3,r.reader.releaseLock();case 3:r.reader=null;case 4:return t.next=6,e.close();case 6:r.connected=!1,setTimeout((function(){r.onPortSelected(r.port)}),100);case 8:case"end":return t.stop()}}),t)}))),50)):r.closePort();case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}())());case 1:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"subscribeSafe",value:(o=J(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:new Promise((function(t,r){for(;n.port.readable&&!0===n.subscribed;){n.reader=e.readable.getReader();for(var i=!0,o=new Promise((function(t,e){return n.reader.read()})),s=new Promise((function(t,e){setTimeout(t,100,"readfail")}));!0===i;)Promise.race([o,s]).then((function(t){if(console.log("newpromise"),"readfail"===t)console.log(t);else{var e=t.value;!0===t.done||!0===n.subscribed?new Promise((function(t,e){t(n.reader.releaseLock())})).then((function(){i=!1})):n.onReceive(e)}}))}t("not readable")}));case 1:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"closePort",value:(i=J(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=r.length>0&&void 0!==r[0]?r[0]:this.port,this.port&&(this.subscribed=!1,setTimeout(J(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.reader){t.next=4;break}return t.next=3,n.reader.releaseLock();case 3:n.reader=null;case 4:return t.next=6,e.close();case 6:n.port=null,n.connected=!1,n.onDisconnectedCallback();case 9:case"end":return t.stop()}}),t)}))),100));case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"setupSerialAsync",value:(r=J(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:this.baudrate,t.next=4,navigator.serial.requestPort();case 4:this.port=t.sent,navigator.serial.addEventListener("disconnect",(function(t){n.closePort(n.port)})),this.onPortSelected(this.port,e);case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"asUint8Array",value:function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r>127)throw new TypeError("Only ASCII patterns are supported");e[n]=r}return e}return new Uint8Array(t)}},{key:"boyerMoore",value:function(t){var e=this,n=this.asUint8Array(t),r=n.length;if(0===r)throw new TypeError("patternBuffer must be at least 1 byte long");for(var i=new Int32Array(256),o=0;o<256;o++)i[o]=-1;for(var s=0;s<r;s++)i[n[s]]=s;var a=function(t,r,o){var s=e.asUint8Array(t);void 0===r&&(r=0),void 0===o&&(o=s.length);for(var a,u=n,c=i,l=o-u.length,h=u.length-1,f=r;f<=l;f+=a){a=0;for(var p=h;p>=0;p--){var d=s[f+p];if(u[p]!==d){a=Math.max(1,p-c[d]);break}}if(0===a)return f}return-1};return a.byteLength=n.byteLength,a}}])&&tt(e.prototype,n),t}();function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function it(t,e,n){return e&&rt(t.prototype,e),n&&rt(t,n),t}var ot=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/Math.sqrt(2),o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;nt(this,t);var s=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(s.indexOf(e)<0)return console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'"),!1;this.type=e,this.freq=n,this.sps=r,this.Q=i,this.dbGain=o,this.a0=0,this.a1=0,this.a2=0,this.b0=0,this.b1=0,this.b2=0,this.x1=0,this.x2=0,this.y1=0,this.y2=0;var a=Math.pow(10,o/40),u=2*Math.PI*n/r,c=Math.sin(u),l=Math.cos(u),h=c/(2*i),f=Math.sqrt(a+a);this[e](a,c,l,h,f),this.b0/=this.a0,this.b1/=this.a0,this.b2/=this.a0,this.a1/=this.a0,this.a2/=this.a0}return it(t,[{key:"lowpass",value:function(t,e,n,r,i){this.b0=.5*(1-n),this.b1=1-n,this.b2=.5*(1-n),this.a0=1+r,this.a1=-2*n,this.a2=1-r}},{key:"highpass",value:function(t,e,n,r,i){this.b0=.5*(1+n),this.b1=-(1+n),this.b2=.5*(1+n),this.a0=1+r,this.a1=-2*n,this.a2=1-r}},{key:"bandpass",value:function(t,e,n,r,i){this.b0=r,this.b1=0,this.b2=-r,this.a0=1+r,this.a1=-2*n,this.a2=1-r}},{key:"notch",value:function(t,e,n,r,i){this.b0=1,this.b1=-2*n,this.b2=1,this.a0=1+r,this.a1=-2*n,this.a2=1-r}},{key:"peak",value:function(t,e,n,r,i){this.b0=1+r*t,this.b1=-2*n,this.b2=1-r*t,this.a0=1+r/t,this.a1=-2*n,this.a2=1-r/t}},{key:"lowshelf",value:function(t,e,n,r,i){this.b0=t*(t+1-(t-1)*n+i*e),this.b1=2*t*(t-1-(t+1)*n),this.b2=t*(t+1-(t-1)*n-i*e),this.a0=t+1+(t+1)*n+i*e,this.a1=2*(t-1+(t+1)*n),this.a2=t+1+(t-1)*n-i*e}},{key:"highshelf",value:function(t,e,n,r,i){this.b0=t*(t+1+(t-1)*n+i*e),this.b1=2*t*(t-1+(t+1)*n),this.b2=t*(t+1-(t-1)*n-i*e),this.a0=t+1-(t+1)*n-i*e,this.a1=2*(t-1-(t+1)*n),this.a2=t+1-(t-1)*n-i*e}},{key:"applyFilter",value:function(t){var e=this.b0*t+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;return this.x2=this.x1,this.x1=t,this.y2=this.y1,this.y1=e,e}},{key:"zResult",value:function(t){try{var e=Math.pow(Math.sin(Math.PI*t*2/(2*this.sps)),2);return(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*e+16*this.b0*this.b2*e*e)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*e+16*this.a2*e*e)}catch(t){return-200}}}],[{key:"calcCenterFrequency",value:function(t,e){return(t+e)/2}},{key:"calcBandwidth",value:function(t,e){return e-this.calcCenterFrequency(t,e)}},{key:"calcBandpassQ",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.pow(10,Math.floor(Math.log10(t))),r=n*Math.sqrt((t-e)*(t+e))/(2*e);return r}},{key:"calcNotchQ",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.pow(10,Math.floor(Math.log10(t))),r=n*t*e/Math.sqrt((t-e)*(t+e));return r}}]),t}(),st=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.995;nt(this,t),this.r=e,this.y1=this.y2=this.x1=this.x2=0}return it(t,[{key:"applyFilter",value:function(t){this.x2=this.x1,this.x1=t;var e=this.x1-this.x2+this.r*this.y1;return this.y2=this.y1,this.y1=e,e}}]),t}(),at=function(t,e,n){return new ot("notch",t,e,ot.calcNotchQ(t,n),0)},ut=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.pow(10,Math.floor(Math.log10(ot.calcCenterFrequency(t,e))));return new ot("bandpass",ot.calcCenterFrequency(t,e),n,ot.calcBandpassQ(ot.calcCenterFrequency(t,e),ot.calcBandwidth(t,e),r),0)},ct=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A0",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;nt(this,t),this.channel=e,this.idx=0,this.sps=n,this.filtering=r,this.bplower=3,this.bpupper=45,this.scalingFactor=i,this.useSMA4=!1,this.last4=[],this.useNotch50=!0,this.useNotch60=!0,this.useLp1=!1,this.useBp1=!1,this.useDCB=!0,this.useScaling=!1,this.notch50=[at(50,n,1),at(100,n,1)],this.notch60=[at(60,n,1),at(120,n,1)],this.lp1=[new ot("lowpass",50,n),new ot("lowpass",50,n),new ot("lowpass",50,n),new ot("lowpass",50,n)],this.bp1=[ut(this.bplower,this.bpupper,n,9.75),ut(this.bplower,this.bpupper,n,9.75),ut(this.bplower,this.bpupper,n,9.75),ut(this.bplower,this.bpupper,n,9.75)],this.dcb=new st(.995)}return it(t,[{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sps;this.notch50=at(50,t,1),this.notch60=at(60,t,1),this.lp1=[new ot("lowpass",50,t),new ot("lowpass",50,t),new ot("lowpass",50,t),new ot("lowpass",50,t)],this.bp1=[ut(this.bplower,this.bpupper,t,9.75),ut(this.bplower,this.bpupper,t,9.75),ut(this.bplower,this.bpupper,t,9.75),ut(this.bplower,this.bpupper,t,9.75)],this.dcb=new st(.995)}},{key:"setBandpass",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.bplower,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bpupper,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sps;this.bplower=t,this.bpupper=e,this.bp1=[ut(t,e,n),ut(t,e,n),ut(t,e,n),ut(t,e,n)]}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastidx+1,n=t;return!0===this.filtering&&(!0===this.useDCB&&(n=this.dcb.applyFilter(n)),!0===this.useSMA4&&(e<4||(n=this.last4.reduce((function(t,e){return t+e}))/this.last4.length,this.last4.shift()),this.last4.push(n)),!0===this.useNotch50&&this.notch50.forEach((function(t,e){n=t.applyFilter(n)})),!0===this.useNotch60&&this.notch60.forEach((function(t,e){n=t.applyFilter(n)})),!0===this.useLp1&&this.lp1.forEach((function(t,e){n=t.applyFilter(n)})),!0===this.useBp1&&(this.bp1.forEach((function(t,e){n=t.applyFilter(n)})),n*=this.bp1.length),!0===this.useScaling&&(n*=this.scalingFactor)),this.lastidx=e,n}}]),t}();function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t){return function(t){if(Array.isArray(t))return ft(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ft(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ft(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pt(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function dt(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){pt(o,r,i,s,a,"next",t)}function a(t){pt(o,r,i,s,a,"throw",t)}s(void 0)}))}}function yt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var vt=n(2306);function gt(t){return function(t){if(Array.isArray(t))return bt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return bt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wt(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function _t(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){wt(o,r,i,s,a,"next",t)}function a(t){wt(o,r,i,s,a,"throw",t)}s(void 0)}))}}function St(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ot=function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;St(this,t),this.init=function(){var t=_t(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.sps=256,e.deviceType="eeg",e.eegChannelTags=[{ch:0,tag:"TP9",analyze:!0},{ch:1,tag:"AF7",analyze:!0},{ch:2,tag:"AF8",analyze:!0},{ch:3,tag:"TP10",analyze:!0}],n.device=new vt.MuseClient,"muse_Aux"==n.mode&&(n.device.enableAux=!0,e.eegChannelTags.push({ch:4,tag:"AUX",analyze:!0})),n.info=e,n._onConnected=function(){n.setupAtlas(e,r)};case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(t,e){if(!0===t.useFilters&&t.eegChannelTags.forEach((function(e,r){"other"!==e.tag?n.filters.push(new ct(e.ch,t.sps,!0,1)):n.filters.push(new ct(e.ch,t.sps,!1,1))})),!0===e)n.atlas=new K(location+":"+n.mode,{eegshared:{eegChannelTags:t.eegChannelTags,sps:t.sps}},"muse",!0,!0,t.analysis),t.useAtlas=!0;else if("object"===mt(e)){var r;n.atlas=e,n.atlas.data.eegshared.eegChannelTags=t.eegChannelTags,n.atlas.data.eegshared.sps=t.sps,n.atlas.data.eegshared.frequencies=n.atlas.bandpassWindow(0,128,.5*t.sps),n.atlas.data.eegshared.bandFreqs=n.atlas.getBandFreqs(n.atlas.data.eegshared.frequencies),n.atlas.data.eeg=n.atlas.genMuseAtlas(),n.atlas.data.coherence=n.atlas.genCoherenceMap(t.eegChannelTags),n.atlas.settings.coherence=!0,n.atlas.settings.eeg=!0,t.useAtlas=!0,t.analysis.length>0&&((r=n.atlas.settings.analysis).push.apply(r,gt(t.analysis)),n.atlas.settings.analyzing||(n.atlas.settings.analyzing=!0,n.atlas.analyzer()))}},this._onConnected=function(){},this.timeCorrection=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"back",o=t.times[t.times.length-1];null==o&&(o=r-e.length/n.info.sps);var s=(r-o)/e.length;n.info.sps=1e3/s;var a=Array(e.length).fill(r);return a="back"===i?a.map((function(t,e){return t-s*(a.length-e)})):a.map((function(t,e){return t+s*e}))},this.connect=_t(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.device.connect();case 2:return t.next=4,n.device.start();case 4:n._onConnected(),n.device.eegReadings.subscribe((function(t){if(n.info.useAtlas){var e,r,i=n.atlas.getEEGDataByChannel(t.electrode),o=n.timeCorrection(i,t.samples,t.timestamp);if((e=i.times).push.apply(e,gt(o)),(r=i.raw).push.apply(r,gt(t.samples)),i.count+=t.samples.length,!0===n.info.useFilters){var s,a=new Array(t.samples.length).fill(0);void 0!==n.filters[t.electrode]&&t.samples.forEach((function(e,r){a[r]=n.filters[t.electrode].apply(e)})),(s=i.filtered).push.apply(s,gt(a))}}})),n.atlas.data.eegshared.startTime=Date.now(),n.atlas.settings.deviceConnected=!0,!0!==n.atlas.settings.analyzing&&n.info.analysis.length>0&&(n.atlas.settings.analyzing=!0,setTimeout((function(){n.atlas.analyzer()}),1200)),n.device.gatt.device.addEventListener("gattserverdisconnected",(function(){n.atlas.settings.deviceConnected&&(n.atlas.analyzing=!1,n.atlas.settings.deviceConnected=!1,n.ondisconnect())})),n.onconnect();case 11:case"end":return t.stop()}}),t)}))),this.disconnect=function(){n.ui&&n.ui.deleteNode(),n.device.disconnect()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=(Math.floor(1e4*Math.random()),function(){return"\n            "}),r=function(){};n.ui=new x(e,t,void 0,r)},this.atlas=null,this.mode=e,this.device=null,this.filters=[],this.info,this.onconnect=r,this.ondisconnect=i};function Et(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function At(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Et(o,r,i,s,a,"next",t)}function a(t){Et(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tt(t,e,n){return e&&It(t.prototype,e),n&&It(t,n),t}var xt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"usb",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"http://192.168.4.1/";Ct(this,t),this.interface=null,this.mode=e,"usb"===e||"serial"===e?this.setupSerialDevice(n,r,i):"ble"===e||"bt"===e?this.setupBLEDevice(n,r,i):"wifi"!==e&&"events"!==e&&"sse"!==e||this.setupSSEDevice(o,n,r,i)}return Tt(t,[{key:"setupSerialDevice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.interface=new Bt,this.interface.onConnectedCallback=e,this.interface.onReadLine=t,this.interface.onDisconnectedCallback=n}},{key:"setupBLEDevice",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.interface=new kt,this.interface.onConnectedCallback=n,this.interface.onDisconnectedCallback=r,this.interface.onNotificationCallback=function(n){var r=t.interface.decoder.decode(n.target.value);e(r)}}},{key:"setupSSEDevice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http://192.168.4.1/",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=function(t){e(t.data)};this.interface=new Nt(t+"events",n,r,void 0,[{tag:"heg",callback:i}]),this.interface.newPostFunction("sendCommand",t+"command")}},{key:"sendCommand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"usb"===this.mode||"serial"===this.mode||"ble"===this.mode||"bt"===this.mode?this.interface.sendMessage(t):"wifi"!==this.mode&&"events"!==this.mode&&"sse"!==this.mode||this.interface.sendCommand(t)}},{key:"connect",value:function(t){"usb"===this.mode||"serial"===this.mode?navigator.serial?this.interface.setupSerialAsync():chrome.serial?this.interface.connectSelected(!0,t):(console.error("ERROR: Cannot locate navigator.serial. Enable #experimental-web-platform-features in chrome://flags"),alert("Serial support not found. Enable #experimental-web-platform-features in chrome://flags or use a chrome extension")):"ble"===this.mode||"bt"===this.mode?this.interface.connect():"wifi"!==this.mode&&"events"!==this.mode&&"sse"!==this.mode||this.interface.open()}},{key:"disconnect",value:function(){"usb"===this.mode||"serial"===this.mode?navigator.serial?this.interface.closePort():this.interface.connectSelected(!1):"ble"===this.mode||"bt"===this.mode?this.interface.disconnect():"wifi"!==this.mode&&"events"!==this.mode&&"sse"!==this.mode||this.interface.close()}}]),t}(),kt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"6e400001-b5a3-f393-e0a9-e50e24dcca9e",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"6e400003-b5a3-f393-e0a9-e50e24dcca9e",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"main_body",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"blebutton",a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];Ct(this,t),Pt.call(this),this.serviceUUID=e,this.rxUUID=n,this.txUUID=r,this.encoder=new TextEncoder("utf-8"),this.decoder=new TextDecoder("utf-8"),this.device=null,this.server=null,this.service=null,this.parentId=o,this.buttonId=s,this.async=a,this.android=navigator.userAgent.toLowerCase().indexOf("android")>-1,this.n,this.otaServiceUuid=e.toLowerCase(),this.versionCharacteristicUuid="6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase(),this.fileCharacteristicUuid="6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase(),this.esp32Device=null,this.esp32otaService=null,this.readyFlagCharacteristic=null,this.dataToSend=null,this.updateData=null,this.totalSize,this.remaining,this.amountToWrite,this.currentPosition,this.currentHardwareVersion="N/A",this.softwareVersion="N/A",this.latestCompatibleSoftware="N/A",this.characteristicSize=512,!0===i&&this.initUI(o,s)}var e,n,r;return Tt(t,[{key:"initUI",value:function(t,e){var n=this;null!==this.device&&this.device.gatt.connected&&(this.device.gatt.disconnect(),console.log("device disconnected"));var r='<button id="'+e+'">BLE Connect</button>';HEGwebAPI.appendFragment(r,t),document.getElementById(e).onclick=function(){!1===n.async?n.connect():n.initBLEasync()}}},{key:"getFile",value:function(){var t=this,e=document.createElement("input");e.accept=".bin",e.type="file",e.onchange=function(n){var r=n.target.files[0],i=new FileReader;i.onload=function(n){t.updateData=n.target.result,t.SendFileOverBluetooth(),e.value=""},i.readAsArrayBuffer(r)},e.click()}},{key:"SendFileOverBluetooth",value:function(){var t=this;this.esp32otaService?(this.totalSize=this.updateData.byteLength,this.remaining=this.totalSize,this.amountToWrite=0,this.currentPosition=0,this.esp32otaService.getCharacteristic(this.fileCharacteristicUuid).then((function(e){return t.readyFlagCharacteristic=e,e.startNotifications().then((function(e){t.readyFlagCharacteristic.addEventListener("characteristicvaluechanged",t.SendBufferedData)}))})).catch((function(t){console.log(t)})),this.SendBufferedData()):console.log("No ota Service")}},{key:"SendBufferedData",value:function(){var t=this;this.remaining>0&&(this.remaining>=this.characteristicSize?this.amountToWrite=this.characteristicSize:this.amountToWrite=this.remaining,this.dataToSend=this.updateData.slice(this.currentPosition,this.currentPosition+this.amountToWrite),this.currentPosition+=this.amountToWrite,this.remaining-=this.amountToWrite,console.log("remaining: "+this.remaining),this.esp32otaService.getCharacteristic(this.fileCharacteristicUuid).then((function(e){return t.RecursiveSend(e,t.dataToSend)})).then((function(e){var n=(t.currentPosition/t.totalSize*100).toPrecision(3)+"%";t.onProgress(n)})).catch((function(t){console.log(t)})))}},{key:"onProgress",value:function(t){console.log("ESP32 Update Progress: ",t)}},{key:"RecursiveSend",value:function(t,e){var n=this;return t.writeValue(e).catch((function(r){return n.RecursiveSend(t,e)}))}},{key:"connectAsync",value:(r=At(regeneratorRuntime.mark((function t(){var e,n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.bluetooth.requestDevice({filters:[{namePrefix:"HEG"}],optionalServices:[this.serviceUUID]});case 2:return this.device=t.sent,console.log("BLE Device: ",this.device),t.next=6,null===(e=this.device.gatt)||void 0===e?void 0:e.connect();case 6:if(n=t.sent){t.next=9;break}throw"no connection";case 9:return this.device.addEventListener("gattserverdisconnected",onDisconnected),this.server=n,t.next=13,this.server.getPrimaryService(this.serviceUUID);case 13:return r=t.sent,t.next=16,r.getCharacteristic(this.rxUUID);case 16:return i=t.sent,t.next=19,i.writeValue(this.encoder.encode("t"));case 19:if(1!=this.android){t.next=22;break}return t.next=22,i.writeValue(this.encoder.encode("o"));case 22:return t.next=24,r.getCharacteristic(this.txUUID);case 24:return this.characteristic=t.sent,this.onConnectedCallback(),t.abrupt("return",!0);case 27:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"readDeviceAsync",value:(n=At(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.characteristic){t.next=3;break}throw console.log("HEG not connected"),"error";case 3:this.doReadHeg=!0,e="";case 5:if(!this.doReadHeg){t.next=14;break}return t.t0=this.decoder,t.next=9,this.characteristic.readValue();case 9:t.t1=t.sent,(n=t.t0.decode.call(t.t0,t.t1))!==this.data&&(e=n,console.log(e),this.n+=1,this.onReadAsyncCallback(e)),t.next=5;break;case 14:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"initBLEasync",value:(e=At(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.connectAsync();case 2:this.readDeviceasync(),this.spsinterval();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),Pt=function(){var t=this;this.connect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.serviceUUID,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.rxUUID,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.txUUID;function i(t){return function(e){return new Promise((function(n){return setTimeout((function(){return n(e)}),t)}))}}navigator.bluetooth.requestDevice({filters:[{services:[e]},{namePrefix:"HEG"}],optionalServices:[e]}).then((function(e){return t.device=e,e.gatt.connect()})).then(i(100)).then((function(t){return t.getPrimaryService(e)})).then(i(100)).then((function(e){return t.service=e,t.esp32otaService=e,e.getCharacteristic(n).then(i(100)).then((function(e){return t.rxchar=e,e.writeValue(t.encoder.encode("t"))})),1==t.android&&e.getCharacteristic(n).then(i(1e3)).then((function(e){return e.writeValue(t.encoder.encode("o"))})),e.getCharacteristic(r)})).then(i(1100)).then((function(e){return t.txchar=e,e.startNotifications()})).then(i(100)).then((function(e){e.addEventListener("characteristicvaluechanged",t.onNotificationCallback)})).then(i(100)).then(t.onConnectedCallback()).catch((function(e){console.error(e),t.onErrorCallback(e)}))},this.onNotificationCallback=function(e){var n=t.decoder.decode(e.target.value);console.log("BLE MSG: ",n)},this.onConnectedCallback=function(){},this.onErrorCallback=function(){},this.sendMessage=function(e){t.service&&t.service.getCharacteristic(t.rxUUID).then((function(n){return n.writeValue(t.encoder.encode(e))}))},this.disconnect=function(){var e;null===(e=t.server)||void 0===e||e.disconnect(),t.onDisconnectedCallback()},this.onDisconnectedCallback=function(){console.log("BLE device disconnected!")},this.onReadAsyncCallback=function(t){console.log("BLE Data: ",t)},this.stopReadAsync=function(){t.doReadHeg=!1,tx.writeValue(t.encoder.encode("f"))},this.spsinterval=function(){setTimeout((function(){console.log("SPS",t.n+""),t.n=0,t.spsinterval()}),1e3)}},Nt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http://192.168.4.1/events",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onOpen,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onError,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.onMsg,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];Ct(this,t),this.onOpen=function(t){console.log("Events Connected!",t.data)},this.onError=function(t){console.log("event source error:",t.data),t.target.readyState!==EventSource.OPEN&&console.log("Events Disconnected")},this.onMsg=function(t){console.log("event source:",t.data)},this.open=function(){e.createEventListeners()},this.close=function(){e.removeEventListeners()},this.hostUrl=n,this.onOpen=r,this.onError=i,this.onMsg=o,this.source=null,this.customCallbacks=s,this.createEventListeners(n,custom)}return Tt(t,[{key:"createEventListeners",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hostUrl,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.customCallbacks,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.source;null!==n&&this.removeEventListeners(e,n),window.EventSource&&((n=new EventSource(t)).addEventListener("open",this.onOpen,!1),n.addEventListener("error",this.onError,!1),n.addEventListener("message",this.onMsg,!1),e.length>0&&e.forEach((function(t,e){n.addEventListener(t.tag,t.callback,!1)})))}},{key:"removeEventListeners",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.custom,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.source;window.EventSource&&(e.close(),e.removeEventListener("open",this.openEvent,!1),e.removeEventListener("error",this.errorEvent,!1),e.removeEventListener("message",this.messageEvent,!1),t.length>0&&t.forEach((function(t,n){e.removeEventListener(t.tag,t.callback,!1)})),e=null)}},{key:"newPostFunction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"post",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hostUrl,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=function(){var t=new XMLHttpRequest;t.open("POST",e,!0,r,i),t.send(n),t.onerror=function(){t.abort()}};return this[t]=o,o}}]),t}(),Bt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"serialmenu";Ct(this,t),this.onGetDevices=function(t){document.getElementById("serialports").innerHTML="";for(var n=[],r=0;r<t.length;r++)console.log(t[r].path);t.forEach((function(t){var r=t.displayName+"("+t.path+")";if(console.log("displayName "+r),r||(r=t.path),n.push({option:r,value:t.path}),console.log(e.defaultUI),1==e.defaultUI){var i=document.createElement("option");i.text=r,i.value=t.path,console.log("option",i),document.getElementById("serialports").appendChild(i)}})),e.displayPorts=n},this.onReceive=function(t){if(t.connectionId===e.connectionId){var n,r=new Uint8Array(t.data),i=String.fromCharCode.apply(null,r);for(e.encodedBuffer+=decodeURIComponent(escape(i)),console.log(e.encodedBuffer.length);(n=e.encodedBuffer.indexOf("\n"))>=0;){var o=e.encodedBuffer.substr(0,n+1);1==e.recordData&&e.recorded.push(o),(e.monitoring=!0)&&(e.newSamples++,e.monitorData.push(o)),e.onReadLine(o),e.encodedBuffer=e.encodedBuffer.substr(n+1)}}else console.log("ERR: Receive ID:",t.connectionId)},this.onConnectComplete=function(t){e.connectionId=t.connectionId,console.log("Connected! ID:",e.connectionId),chrome.serial.onReceive.addListener(e.onReceive),chrome.serial.onReceiveError.addListener(e.onReceiveError),e.onConnectedCallback()},this.displayPorts=[],this.defaultUI=n,this.encodedBuffer="",this.connectionId=-1,this.recordData=!1,this.recorded=[],this.port=null,this.decoder=null,this.subscribed=!1,this.reader=null,this.writer=null,this.monitoring=!1,this.newSamples=0,this.monitorSamples=1e4,this.monitorData=[],this.monitorIdx=0,chrome.serial?(!0===n&&this.setupSelect(r,!1),this.setupSerial()):navigator.serial?(this.decoder=new TextDecoder,!0===n&&this.setupSelect(r,!0)):(console.log("ERROR: Cannot locate navigator.serial. Enable #experimental-web-platform-features in chrome://flags"),alert("Serial support not found. Enable #experimental-web-platform-features in chrome://flags or use a chrome extension"))}var e,n,r,i,o;return Tt(t,[{key:"setupSelect",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(chrome.serial){var r=document.createElement("select");r.setAttribute("id","serialports"),(i=document.createDocumentFragment()).appendChild(r),document.getElementById(t).innerHTML='<button id="refreshSerial">Get</button><button id="connectSerial">Set</button>',document.getElementById(t).appendChild(i),document.getElementById("connectSerial").onclick=function(){n?e.setupSerialAsync():(-1!==e.connectionId&&e.connectSelected(!1),e.connectSelected(!0,document.getElementById("serialports").value))}}else if(navigator.serial){var i=document.createDocumentFragment();document.getElementById(t).innerHTML='<button id="refreshSerial">Set USB Device</button>',document.getElementById(t).appendChild(i)}document.getElementById("refreshSerial").onclick=function(){n?e.setupSerialAsync():e.setupSerial()}}},{key:"onReceiveError",value:function(t){console.log("onReceiveError"),t.connectionId===this.connectionId&&(console.log("Error from ID:",t.connectionId),this.onError.dispatch(t.error),console.log("Error: "+t.error))}},{key:"onConnectedCallback",value:function(){console.log("USB device Ready!")}},{key:"onDisconnectedCallback",value:function(){console.log("USB device disconnected!")}},{key:"sendMessage",value:function(t){t+="\n";for(var e=unescape(encodeURIComponent(t)),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);chrome.serial?this.connectionId>-1?(chrome.serial.send(this.connectionId,n.buffer,this.onSendCallback),console.log("Send message:",t)):console.log("Device is disconnected!"):navigator.serial&&this.port.writable&&this.sendMessageAsync(n.buffer)}},{key:"onSendCallback",value:function(t){console.log("sendInfo",t)}},{key:"onReadLine",value:function(t){console.log(t)}},{key:"connectSelected",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(1==t&&""!==e)console.log("Connecting",e),chrome.serial.connect(e,{bitrate:115200},this.onConnectComplete);else{if(console.log("Disconnect"+e),this.connectionId<0)return void console.log("connectionId",this.connectionId);this.encodedBuffer="",chrome.serial.onReceive.removeListener(this.onReceive),chrome.serial.onReceiveError.removeListener(this.onReceiveError),chrome.serial.flush(this.connectionId,(function(){console.log("chrome.serial.flush",this.connectionId)})),chrome.serial.disconnect(this.connectionId,(function(){console.log("chrome.serial.disconnect",this.connectionId)}))}}},{key:"setupSerial",value:function(){chrome.serial.getDevices(this.onGetDevices)}},{key:"sendMessageAsync",value:(o=At(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.port.writable.getWriter(),t.next=3,n.write(e);case 3:n.releaseLock();case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"onPortSelected",value:(i=At(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.open({baudRate:115200,bufferSize:1e3});case 3:t.next=9;break;case 5:return t.prev=5,t.t0=t.catch(0),t.next=9,e.open({baudrate:115200,buffersize:1e3});case 9:this.onConnectedCallback(),this.connected=!0,this.subscribed=!0,this.subscribe(e);case 13:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(t){return i.apply(this,arguments)})},{key:"onReceiveAsync",value:function(t){var e;for(this.encodedBuffer+=this.decoder.decode(t);(e=this.encodedBuffer.indexOf("\n"))>=0;){var n=this.encodedBuffer.substr(0,e+1);1==this.recordData&&this.recorded.push(n),(this.monitoring=!0)&&(this.newSamples++,this.monitorData.push(n)),this.onReadLine(n),this.encodedBuffer=this.encodedBuffer.substr(e+1)}}},{key:"subscribe",value:(r=At(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.port.readable&&!0===this.subscribed&&(this.reader=e.readable.getReader(),(n=function(){var t=At(regeneratorRuntime.mark((function t(){var i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.reader.read();case 3:if(i=t.sent,o=i.value,!i.done&&!1!==r.subscribed){t.next=9;break}return t.next=9,r.reader.releaseLock();case 9:if(o)try{r.onReceiveAsync(o),!0===r.subscribed&&setTimeout((function(){n()}),30)}catch(t){console.log(t)}t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),t.t0.message.includes("framing")||t.t0.message.includes("overflow")||t.t0.message.includes("overrun")||t.t0.message.includes("Overflow")||t.t0.message.includes("break")?(r.subscribed=!1,setTimeout(At(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.reader){t.next=4;break}return t.next=3,r.reader.releaseLock();case 3:r.reader=null;case 4:r.subscribed=!0,r.subscribe(e);case 6:case"end":return t.stop()}}),t)}))),30)):t.t0.message.includes("parity")||t.t0.message.includes("Parity")?r.port&&(r.subscribed=!1,setTimeout(At(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.reader){t.next=4;break}return t.next=3,r.reader.releaseLock();case 3:r.reader=null;case 4:return t.next=6,e.close();case 6:r.connected=!1,setTimeout((function(){r.onPortSelected(r.port)}),100);case 8:case"end":return t.stop()}}),t)}))),50)):r.closePort();case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(){return t.apply(this,arguments)}}())());case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"closePort",value:(n=At(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=r.length>0&&void 0!==r[0]?r[0]:this.port,this.port&&(this.subscribed=!1,setTimeout(At(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.reader){t.next=4;break}return t.next=3,n.reader.releaseLock();case 3:n.reader=null;case 4:return t.next=6,e.close();case 6:n.connected=!1,n.onDisconnectedCallback();case 8:case"end":return t.stop()}}),t)}))),50));case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setupSerialAsync",value:(e=At(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,navigator.serial.requestPort();case 3:this.port=t.sent,navigator.serial.addEventListener("disconnect",(function(t){e.closePort()})),this.onPortSelected(this.port);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"saveCsv",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.recorded,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).toISOString(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"|",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Header\n",i=r;t.forEach((function(t){i+=t.split(n).join(",")+"\n"}));var o=document.createElement("a");o.href="data:text/csv;charset=utf-8,"+encodeURI(i),o.target="_blank",o.download=""!==e?e+".csv":(new Date).toISOString()+".csv",o.click()}},{key:"openFile",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:",",n=document.createElement("input");n.type="file",n.onchange=function(r){t.csvDat=[];var i=r.target.files[0],o=new FileReader;o.readAsText(i),o.onload=function(n){var r=n.target.result.split("\n");r.pop(),r.forEach((function(n,r){if(0==r)var i=n.split(e);else i=n.split(e),t.csvDat.push(i)})),t.onOpen()},n.value=""},n.click()}},{key:"onOpen",value:function(){alert("CSV Opened!")}}]),t}();function Dt(t){return function(t){if(Array.isArray(t))return Rt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Rt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Lt(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Mt(o,r,i,s,a,"next",t)}function a(t){Mt(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hegduino_usb",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;Ft(this,t),this.init=function(){var t=Lt(regeneratorRuntime.mark((function t(n,r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.sps=32,n.deviceType="heg",i=function(t){if(t.indexOf("|")>-1){var r=t.split("|");if(r.length>3){var i=e.atlas.data.heg[n.deviceNum];if(i.count++,1===i.count&&(i.startTime=Date.now()),"ble"===e.device.mode&&!0===e.device.interface.android)i.times.push(Date.now()),e.filtering?(i.red.push(e.filters[0].applyFilter(parseFloat(r[0]))),i.ir.push(e.filters[1].applyFilter(parseFloat(r[1]))),i.ratio.push(e.filters[2].applyFilter(parseFloat(r[2])))):(i.red.push(parseFloat(r[0])),i.ir.push(parseFloat(r[1])),i.ratio.push(parseFloat(r[2])));else{if(0===i.times.length)i.times.push(Date.now()),e.refuS=parseFloat(r[0]);else{var o=parseFloat(r[0]);i.times.push(Math.floor(i.times[i.times.length-1]+.001*(o-e.refuS))),e.refuS=o}e.filtering?(i.red.push(e.filters[0].applyFilter(parseFloat(r[1]))),i.ir.push(e.filters[1].applyFilter(parseFloat(r[2]))),i.ratio.push(e.filters[2].applyFilter(parseFloat(r[3]))),i.ambient.push(e.filters[3].applyFilter(parseFloat(r[4]))),i.temp.push(parseFloat(r[5]))):(i.red.push(parseFloat(r[1])),i.ir.push(parseFloat(r[2])),i.ratio.push(parseFloat(r[3])),i.ambient.push(parseFloat(r[4])),i.temp.push(parseFloat(r[5])))}e.atlas.beatDetection(i,n.sps)}}else console.log("HEGDUINO: ",t)},"hegduino_wifi"===e.mode||"hegduino_sse"===e.mode?(n.sps=20,e.device=new xt("wifi",i,(function(){e.setupAtlas(r,n),!0!==e.atlas.settings.analyzing&&n.analysis.length>0&&(e.atlas.settings.analyzing=!0,setTimeout((function(){e.atlas.analyzer()}),1200)),e.atlas.settings.deviceConnected=!0,e.device.sendCommand("t"),e.onconnect()}),(function(){e.atlas.settings.analyzing=!1,e.atlas.settings.deviceConnected=!1,e.ondisconnect()}))):"hegduino_Bluetooth"===e.mode?e.device=new xt("ble",i,(function(){e.setupAtlas(r,n),!0!==e.atlas.settings.analyzing&&n.analysis.length>0&&(e.atlas.settings.analyzing=!0,setTimeout((function(){e.atlas.analyzer()}),1200)),e.atlas.settings.deviceConnected=!0,e.device.sendCommand("t"),e.onconnect()}),(function(){e.atlas.settings.analyzing=!1,e.atlas.settings.deviceConnected=!1,e.ondisconnect()})):"hegduino_USB"===e.mode&&(e.device=new xt("usb",i,(function(){e.setupAtlas(r,n),!0!==e.atlas.settings.analyzing&&n.analysis.length>0&&(e.atlas.settings.analyzing=!0,setTimeout((function(){e.atlas.analyzer()}),1200)),e.atlas.settings.deviceConnected=!0,e.device.sendCommand("t"),e.onconnect()}),(function(){e.atlas.settings.analyzing=!1,e.atlas.settings.deviceConnected=!1,e.ondisconnect()})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(t,n){if(e.filters.push(new ct("red",100,!1,1),new ct("ir",100,!1,1),new ct("ratio",100,!1,1),new ct("ambient",100,!1,1)),e.filters.forEach((function(t){t.useSMA4=!0,t.useDCB=!1})),!0===t)e.atlas=new K(location+":"+e.mode,{hegshared:{sps:n.sps}},"hegduino",!1,!0,n.analysis),n.deviceNum=e.atlas.data.heg.length-1,n.useAtlas=!0;else if("object"===jt(t)){var r;e.atlas=t,n.deviceNum=e.atlas.data.heg.length,e.atlas.data.hegshared={sps:n.sps},e.atlas.addHEGCoord(e.atlas.data.heg.length),e.atlas.settings.heg=!0,n.useAtlas=!0,n.analysis.length>0&&((r=e.atlas.settings.analysis).push.apply(r,Dt(n.analysis)),e.atlas.settings.analyzing||(e.atlas.settings.analyzing=!0,e.atlas.analyzer()))}},this.connect=function(){e.device.connect()},this.disconnect=function(){e.device.disconnect(),e.ui&&e.ui.deleteNode()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=Math.floor(1e4*Math.random()),r=function(){var t="\n            <br>\n            <div id='"+n+"hegduinoControls'>\n                <h3>Control Panel</h3>\n                <hr>\n                <button id='"+n+"hegon'>On</button>\n                <button id='"+n+"hegoff'>Off</button>\n                <input id='"+n+"hegcmd' type='text' placeholder='R'></input><button id='"+n+"sendcmd'>Send</button>\n                Add Digital Filters:<input id='"+n+"filter' type='checkbox'></input>\n            ";return"hegduino_ble"===e.mode?t+="\n                <button id='"+n+"hegupdate'>Update Firmware (.bin)</button>\n                </div>\n                ":t+="</div>",t},i=function(){document.getElementById(n+"hegon").onclick=function(){e.device.sendCommand("t")},document.getElementById(n+"hegoff").onclick=function(){e.device.sendCommand("f")},document.getElementById(n+"sendcmd").onclick=function(){e.device.sendCommand(document.getElementById(n+"hegcmd").value)},"hegduino_ble"===e.mode&&(document.getElementById(n+"hegupdate").onclick=function(){e.device.getFile()}),document.getElementById(n+"filter").onchange=function(){e.filters.forEach((function(t){t.filtering?t.filtering=!1:t.filtering=!0}))}};e.ui=new x(r,t,void 0,i)},this.atlas=null,this.mode=n,this.device=null,this.filters=[],this.filtering=!1,this.ui=null,this.refuS=0,this.onconnect=r,this.ondisconnect=i}var e,n;return e=t,(n=[{key:"mean",value:function(t){return t.reduce((function(t,e){return e+t}))/t.length}}])&&Ut(e.prototype,n),t}();function zt(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function qt(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){zt(o,r,i,s,a,"next",t)}function a(t){zt(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.onDecodedCallback,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onConnectedCallback,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onDisconnectedCallback,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"daisy",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.decode,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:115200;Ht(this,t),this.onDecodedCallback=e,this.onConnectedCallback=n,this.onDisconnectedCallback=r,this.decode=o,this.connected=!1,this.subscribed=!1,this.buffer=[],this.startByte=160,this.stopByte=192,this.searchString=new Uint8Array([this.stopByte,this.startByte]),this.readRate=16.666667,this.readBufferSize=2e3,this.sps=250,this.nChannels=16,this.nPeripheralChannels=6,this.updateMs=1e3/this.sps,this.stepSize=1/(Math.pow(2,23)-1),this.vref=4.5,this.gain=24,this.vscale=this.vref/this.gain*this.stepSize,this.uVperStep=this.vref/this.gain*this.stepSize*1e6,this.scalar=1/(1e6/(this.vref/this.gain*this.stepSize)),this.maxBufferedSamples=60*this.sps*1,this.mode=i,this.data={count:0,startms:0,ms:[],A0:[],A1:[],A2:[],A3:[],A4:[],A5:[],A6:[],A7:[],A8:[],A9:[],A10:[],A11:[],A12:[],A13:[],A14:[],A15:[],Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[]},this.resetDataBuffers(),navigator.serial||console.error("`navigator.serial not found! Enable #enable-experimental-web-platform-features in chrome://flags (search 'experimental')"),this.port=null,this.reader=null,this.baudrate=s}var e,n,r,i,o,s,a,u;return e=t,(n=[{key:"resetDataBuffers",value:function(){for(var t in this.data.count=0,this.data.startms=0,this.data)"object"===Gt(this.data[t])&&(this.data[t]=new Array(this.maxBufferedSamples).fill(0))}},{key:"setScalar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/(Math.pow(2,23)-1),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4.5;this.stepSize=e,this.vref=n,this.gain=t,this.vscale=this.vref/this.gain*this.stepSize,this.uVperStep=this.vref/this.gain*this.stepSize*1e6,this.scalar=1/(1e6/(this.vref/this.gain*this.stepSize))}},{key:"getLatestData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A0",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e;return n<=1?[this.data[t][this.data.count-1]]:(n>this.data.count&&(n=this.data.count),this.data[t].slice(this.data.count-n,this.data.count))}},{key:"bytesToInt16",value:function(t,e){var n=(255&t)<<8|255&e;return(8388608&n)>0?n|=4294901760:n&=65535,n}},{key:"int16ToBytes",value:function(t){return[255&t,t>>8&255]}},{key:"bytesToInt24",value:function(t,e,n){var r=(255&t)<<16|(255&e)<<8|255&n;return(8388608&r)>0?r|=4278190080:r&=16777215,r}},{key:"int24ToBytes",value:function(t){return[255&t,t>>8&255,t>>16&255]}},{key:"decode",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.buffer,e=this.searchString,n=t,r=this.boyerMoore(e),i=r.byteLength,o=[],s=0,a=r(n);-1!==a;a=r(n,a+i))o.push(a);if(o.length>=2){for(var u=1;u<o.length;u++)if(o[u]-o[u-1]==33){var c=t.slice(o[u-1],o[u]+1);for(this.data.count<this.maxBufferedSamples&&this.data.count++,this.data.count-1==0?(this.data.ms[this.data.count-1]=Date.now(),this.data.startms=this.data.ms[0]):(this.data.ms[this.data.count-1]=this.data.ms[this.data.count-2]+this.updateMs,this.data.count>=this.maxBufferedSamples&&(this.data.ms.splice(0,5120),this.data.ms.push(new Array(5120).fill(0)))),a=3;a<27;a+=3){var l=void 0;l="daisy"===this.mode?c[2]%2!=0?"A"+(a-3)/3:"A"+(8+(a-3)/3):"A"+(a-3)/3,this.data[l][this.data.count-1]=this.bytesToInt24(c[a],c[a+1],c[a+2]),this.data.count>=this.maxBufferedSamples&&(this.data[l].splice(0,5120),this.data[l].push(new Array(5120).fill(0)))}this.data.Ax[this.data.count-1]=this.bytesToInt16(c[27],c[28]),this.data.Ay[this.data.count-1]=this.bytesToInt16(c[29],c[30]),this.data.Az[this.data.count-1]=this.bytesToInt16(c[31],c[32]),this.data.count>=this.maxBufferedSamples&&(this.data.Ax.splice(0,5120),this.data.Ay.splice(0,5120),this.data.Az.splice(0,5120),this.data.Ax.push(new Array(5120).fill(0)),this.data.Ay.push(new Array(5120).fill(0)),this.data.Az.push(new Array(5120).fill(0)),this.data.count-=5120),s++}return s>0&&t.splice(0,o[o.length-1]),s}}},{key:"onDecodedCallback",value:function(t){}},{key:"onConnectedCallback",value:function(){console.log("port connected!")}},{key:"onDisconnectedCallback",value:function(){console.log("port disconnected!")}},{key:"onReceive",value:function(t){var e,n;(e=this.buffer).push.apply(e,function(t){if(Array.isArray(t))return Wt(t)}(n=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var r=this.decode(this.buffer);!1===r||0===r||isNaN(r)||this.onDecodedCallback(r)}},{key:"sendMsg",value:(u=qt(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=unescape(encodeURIComponent(e+="\n")),r=new Uint8Array(n.length),i=this.port.writable.getWriter(),t.next=6,i.write(r.buffer);case 6:return i.releaseLock(),t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"onPortSelected",value:(a=qt(regeneratorRuntime.mark((function t(e){var n,r=this,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:this.baudrate,t.prev=1,t.prev=2,t.next=5,e.open({baudRate:n,bufferSize:this.readBufferSize});case 5:setTimeout((function(){r.onConnectedCallback(),r.connected=!0,r.subscribed=!0,r.sendMsg("b"),r.subscribe(e)}),500),t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(2),t.next=12,e.open({baudrate:n,buffersize:this.readBufferSize});case 12:setTimeout((function(){r.onConnectedCallback(),r.connected=!0,r.subscribed=!0,r.sendMsg("b"),r.subscribe(e)}),500);case 13:t.next=19;break;case 15:t.prev=15,t.t1=t.catch(1),console.log(t.t1),this.connected=!1;case 19:case"end":return t.stop()}}),t,this,[[1,15],[2,8]])}))),function(t){return a.apply(this,arguments)})},{key:"subscribe",value:(s=qt(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.port.readable&&!0===this.subscribed&&(this.reader=e.readable.getReader(),(n=function(){var t=qt(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.reader.read();case 3:if(e=t.sent,i=e.value,!e.done&&!1!==r.subscribed){t.next=9;break}return t.next=9,r.reader.releaseLock();case 9:if(i)try{r.onReceive(i)}catch(t){console.log(t)}!0===r.subscribed&&setTimeout((function(){n()}),r.readRate),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0),r.closePort();case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}())());case 1:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"subscribeSafe",value:(o=qt(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:new Promise((function(t,r){for(;n.port.readable&&!0===n.subscribed;){n.reader=e.readable.getReader();for(var i=!0,o=new Promise((function(t,e){return n.reader.read()})),s=new Promise((function(t,e){setTimeout(t,100,"readfail")}));!0===i;)Promise.race([o,s]).then((function(t){if(console.log("newpromise"),"readfail"===t)console.log(t);else{var e=t.value;!0===t.done||!0===n.subscribed?new Promise((function(t,e){t(n.reader.releaseLock())})).then((function(){i=!1})):n.onReceive(e)}}))}t("not readable")}));case 1:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"closePort",value:(i=qt(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=r.length>0&&void 0!==r[0]?r[0]:this.port,this.port&&(this.subscribed=!1,this.sendMsg("s"),setTimeout(qt(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.reader&&(n.reader=null),t.next=3,e.close();case 3:n.port=null,n.connected=!1,n.onDisconnectedCallback();case 6:case"end":return t.stop()}}),t)}))),100));case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"setupSerialAsync",value:(r=qt(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:this.baudrate,t.next=4,navigator.serial.requestPort();case 4:this.port=t.sent,navigator.serial.addEventListener("disconnect",(function(t){n.closePort(n.port)})),this.onPortSelected(this.port,e);case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"asUint8Array",value:function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r>127)throw new TypeError("Only ASCII patterns are supported");e[n]=r}return e}return new Uint8Array(t)}},{key:"boyerMoore",value:function(t){var e=this,n=this.asUint8Array(t),r=n.length;if(0===r)throw new TypeError("patternBuffer must be at least 1 byte long");for(var i=new Int32Array(256),o=0;o<256;o++)i[o]=-1;for(var s=0;s<r;s++)i[n[s]]=s;var a=function(t,r,o){var s=e.asUint8Array(t);void 0===r&&(r=0),void 0===o&&(o=s.length);for(var a,u=n,c=i,l=o-u.length,h=u.length-1,f=r;f<=l;f+=a){a=0;for(var p=h;p>=0;p--){var d=s[f+p];if(u[p]!==d){a=Math.max(1,p-c[d]);break}}if(0===a)return f}return-1};return a.byteLength=n.byteLength,a}}])&&Yt(e.prototype,n),t}();function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t){return function(t){if(Array.isArray(t))return Xt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Zt(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function $t(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Zt(o,r,i,s,a,"next",t)}function a(t){Zt(o,r,i,s,a,"throw",t)}s(void 0)}))}}function te(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ee=n(8314),ne=n(9122),re=n(9890),ie=n(2068),oe=n(173),se=n(8111),ae=n(8120),ue=n(904),ce=n(9126),le=n(8764).Buffer;function he(t){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var fe="normal",pe="shorted",de="biasMethod",ye="mvdd",ve="temp",ge="testSig",be="biasDrp",me="biasDrn",we="1hour",_e="2hour",Se="4hour",Oe="12hour",Ee="24hour",Ae="5min",Ce="15min",Ie="30min",Te="14sec",xe="CH1SET",ke="CH2SET",Pe="CH3SET",Ne="CH4SET",Be="CH5SET",De="CH6SET",Re="CH7SET",je="CH8SET",Me="analog",Le="default",Fe="debug",Ue="digital",Ve="cyton",ze="cytonBLE",qe="daisy",We="ganglion",Ge="none",He="none",Ye="good",Ke=1e6,Qe="Ganglion",Je="\nLIS3DH Registers\n0x07.0\n0x08.0\n0x09.0\n0x0A.0\n0x0B.0\n0x0C.0\n0x0D.0\n0x0E.0\n0x0F.33\n\n0x1F.0\n0x20.8\n0x21.0\n0x22.0\n0x23.18\n0x24.0\n0x25.0\n0x26.0\n0x27.0\n0x28.0\n0x29.0\n0x2A.0\n0x2B.0\n0x2C.0\n0x2D.0\n0x2E.0\n0x2F.20\n0x30.0\n0x31.0\n0x32.0\n0x33.0\n\n0x38.0\n0x39.0\n0x3A.0\n0x3B.0\n0x3C.0\n0x3D.0\n",Xe="\nLIS3DH Registers\n0x07 00\n0x08 00\n0x09 00\n0x0A 00\n0x0B 00\n0x0C 00\n0x0D 00\n0x0E 00\n0x0F 33\n\n0x1F 00\n0x20 08\n0x21 00\n0x22 00\n0x23 18\n0x24 00\n0x25 00\n0x26 00\n0x27 00\n0x28 00\n0x29 00\n0x2A 00\n0x2B 00\n0x2C 00\n0x2D 00\n0x2E 00\n0x2F 20\n0x30 00\n0x31 00\n0x32 00\n0x33 00\n\n0x38 00\n0x39 00\n0x3A 00\n0x3B 00\n0x3C 00\n0x3D 00\n",Ze="\nBoard ADS Registers\nADS_ID, 00, 3E, 0, 0, 1, 1, 1, 1, 1, 0\nCONFIG1, 01, 96, 1, 0, 0, 1, 0, 1, 1, 0\nCONFIG2, 02, C0, 1, 1, 0, 0, 0, 0, 0, 0\nCONFIG3, 03, EC, 1, 1, 1, 0, 1, 1, 0, 0\nLOFF, 04, 02, 0, 0, 0, 0, 0, 0, 1, 0\nCH1SET, 05, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH2SET, 06, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH3SET, 07, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH4SET, 08, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH5SET, 09, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH6SET, 0A, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH7SET, 0B, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH8SET, 0C, 68, 0, 1, 1, 0, 1, 0, 0, 0\nBIAS_SENSP, 0D, FF, 1, 1, 1, 1, 1, 1, 1, 1\nBIAS_SENSN, 0E, FF, 1, 1, 1, 1, 1, 1, 1, 1\nLOFF_SENSP, 0F, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_SENSN, 10, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_FLIP, 11, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_STATP, 12, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_STATN, 13, 00, 0, 0, 0, 0, 0, 0, 0, 0\nGPIO, 14, 0F, 0, 0, 0, 0, 1, 1, 1, 1\nMISC1, 15, 00, 0, 0, 0, 0, 0, 0, 0, 0\nMISC2, 16, 00, 0, 0, 0, 0, 0, 0, 0, 0\nCONFIG4, 17, 00, 0, 0, 0, 0, 0, 0, 0, 0\n",$e="\nDaisy ADS Registers\nADS_ID, 00, 3E, 0, 0, 1, 1, 1, 1, 1, 0\nCONFIG1, 01, 96, 1, 0, 0, 1, 0, 1, 1, 0\nCONFIG2, 02, C0, 1, 1, 0, 0, 0, 0, 0, 0\nCONFIG3, 03, EC, 1, 1, 1, 0, 1, 1, 0, 0\nLOFF, 04, 02, 0, 0, 0, 0, 0, 0, 1, 0\nCH1SET, 05, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH2SET, 06, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH3SET, 07, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH4SET, 08, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH5SET, 09, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH6SET, 0A, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH7SET, 0B, 68, 0, 1, 1, 0, 1, 0, 0, 0\nCH8SET, 0C, 68, 0, 1, 1, 0, 1, 0, 0, 0\nBIAS_SENSP, 0D, FF, 1, 1, 1, 1, 1, 1, 1, 1\nBIAS_SENSN, 0E, FF, 1, 1, 1, 1, 1, 1, 1, 1\nLOFF_SENSP, 0F, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_SENSN, 10, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_FLIP, 11, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_STATP, 12, 00, 0, 0, 0, 0, 0, 0, 0, 0\nLOFF_STATN, 13, 00, 0, 0, 0, 0, 0, 0, 0, 0\nGPIO, 14, 0F, 0, 0, 0, 0, 1, 1, 1, 1\nMISC1, 15, 00, 0, 0, 0, 0, 0, 0, 0, 0\nMISC2, 16, 00, 0, 0, 0, 0, 0, 0, 0, 0\nCONFIG4, 17, 00, 0, 0, 0, 0, 0, 0, 0, 0\n",tn={OBCIChannelOff1:"1",OBCIChannelOff2:"2",OBCIChannelOff3:"3",OBCIChannelOff4:"4",OBCIChannelOff5:"5",OBCIChannelOff6:"6",OBCIChannelOff7:"7",OBCIChannelOff8:"8",OBCIChannelOff9:"q",OBCIChannelOff10:"w",OBCIChannelOff11:"e",OBCIChannelOff12:"r",OBCIChannelOff13:"t",OBCIChannelOff14:"y",OBCIChannelOff15:"u",OBCIChannelOff16:"i",commandChannelOff:function(t){return new Promise((function(e,n){switch(t){case 1:e("1");break;case 2:e("2");break;case 3:e("3");break;case 4:e("4");break;case 5:e("5");break;case 6:e("6");break;case 7:e("7");break;case 8:e("8");break;case 9:e("q");break;case 10:e("w");break;case 11:e("e");break;case 12:e("r");break;case 13:e("t");break;case 14:e("y");break;case 15:e("u");break;case 16:e("i");break;default:n(Error("Error [commandChannelOff]: Invalid Channel Number"))}}))},OBCIChannelOn1:"!",OBCIChannelOn2:"@",OBCIChannelOn3:"#",OBCIChannelOn4:"$",OBCIChannelOn5:"%",OBCIChannelOn6:"^",OBCIChannelOn7:"&",OBCIChannelOn8:"*",OBCIChannelOn9:"Q",OBCIChannelOn10:"W",OBCIChannelOn11:"E",OBCIChannelOn12:"R",OBCIChannelOn13:"T",OBCIChannelOn14:"Y",OBCIChannelOn15:"U",OBCIChannelOn16:"I",commandChannelOn:function(t){return new Promise((function(e,n){switch(t){case 1:e("!");break;case 2:e("@");break;case 3:e("#");break;case 4:e("$");break;case 5:e("%");break;case 6:e("^");break;case 7:e("&");break;case 8:e("*");break;case 9:e("Q");break;case 10:e("W");break;case 11:e("E");break;case 12:e("R");break;case 13:e("T");break;case 14:e("Y");break;case 15:e("U");break;case 16:e("I");break;default:n(Error("Error [commandChannelOn]: Invalid Channel Number"))}}))},OBCITestSignalConnectToDC:"p",OBCITestSignalConnectToGround:"0",OBCITestSignalConnectToPulse1xFast:"=",OBCITestSignalConnectToPulse1xSlow:"-",OBCITestSignalConnectToPulse2xFast:"]",OBCITestSignalConnectToPulse2xSlow:"[",getTestSignalCommand:function(t){return new Promise((function(e,n){switch(t){case"dc":e("p");break;case"ground":e("0");break;case"pulse1xFast":e("=");break;case"pulse1xSlow":e("-");break;case"pulse2xFast":e("]");break;case"pulse2xSlow":e("[");break;case"none":e("d");break;default:n(Error("Invalid selection! Check your spelling."))}}))},OBCIChannelCmdADCNormal:"0",OBCIChannelCmdADCShorted:"1",OBCIChannelCmdADCBiasDRP:"6",OBCIChannelCmdADCBiasDRN:"7",OBCIChannelCmdADCBiasMethod:"2",OBCIChannelCmdADCMVDD:"3",OBCIChannelCmdADCTemp:"4",OBCIChannelCmdADCTestSig:"5",OBCIChannelCmdBiasInclude:"1",OBCIChannelCmdBiasRemove:"0",OBCIChannelCmdChannel1:"1",OBCIChannelCmdChannel2:"2",OBCIChannelCmdChannel3:"3",OBCIChannelCmdChannel4:"4",OBCIChannelCmdChannel5:"5",OBCIChannelCmdChannel6:"6",OBCIChannelCmdChannel7:"7",OBCIChannelCmdChannel8:"8",OBCIChannelCmdChannel9:"Q",OBCIChannelCmdChannel10:"W",OBCIChannelCmdChannel11:"E",OBCIChannelCmdChannel12:"R",OBCIChannelCmdChannel13:"T",OBCIChannelCmdChannel14:"Y",OBCIChannelCmdChannel15:"U",OBCIChannelCmdChannel16:"I",commandChannelForCmd:an,OBCIChannelCmdGain1:"0",OBCIChannelCmdGain2:"1",OBCIChannelCmdGain4:"2",OBCIChannelCmdGain6:"3",OBCIChannelCmdGain8:"4",OBCIChannelCmdGain12:"5",OBCIChannelCmdGain24:"6",commandForGain:sn,gainForCommand:function(t){switch(String(t)){case"0":return 1;case"1":return 2;case"2":return 4;case"3":return 6;case"4":return 8;case"5":return 12;case"6":return 24;default:throw new Error("Invalid gain setting of ".concat(t," gain must be (0,1,2,3,4,5,6)"))}},OBCIChannelCmdLatch:"X",OBCIChannelCmdPowerOff:"1",OBCIChannelCmdPowerOn:"0",OBCIChannelCmdSet:"x",OBCIChannelCmdSRB1Connect:"1",OBCIChannelCmdSRB1Diconnect:"0",OBCIChannelCmdSRB2Connect:"1",OBCIChannelCmdSRB2Diconnect:"0",channelSettingsObjectDefault:un,channelSettingsArrayInit:function(t){for(var e=[],n=0;n<t;n++)e.push(un(n));return e},OBCIStringADCNormal:fe,OBCIStringADCShorted:pe,OBCIStringADCBiasMethod:de,OBCIStringADCMvdd:ye,OBCIStringADCTemp:ve,OBCIStringADCTestSig:ge,OBCIStringADCBiasDrp:be,OBCIStringADCBiasDrn:me,commandForADCString:on,inputTypeForCommand:function(t){switch(String(t)){case"0":return fe;case"1":return pe;case"2":return de;case"3":return ye;case"4":return ve;case"5":return ge;case"6":return be;case"7":return me;default:throw new Error("Invalid input type, must be less than 8")}},OBCIChannelDefaultAllSet:"d",OBCIChannelDefaultAllGet:"D",OBCIChannelImpedanceLatch:"Z",OBCIChannelImpedanceSet:"z",OBCIChannelImpedanceTestSignalApplied:"1",OBCIChannelImpedanceTestSignalAppliedNot:"0",OBCISDLogForHour1:"G",OBCISDLogForHour2:"H",OBCISDLogForHour4:"J",OBCISDLogForHour12:"K",OBCISDLogForHour24:"L",OBCISDLogForMin5:"A",OBCISDLogForMin15:"S",OBCISDLogForMin30:"F",OBCISDLogForSec14:"a",OBCISDLogStop:"j",OBCIStringSDHour1:we,OBCIStringSDHour2:_e,OBCIStringSDHour4:Se,OBCIStringSDHour12:Oe,OBCIStringSDHour24:Ee,OBCIStringSDMin5:Ae,OBCIStringSDMin15:Ce,OBCIStringSDMin30:Ie,OBCIStringSDSec14:Te,sdSettingForString:function(t){return new Promise((function(e,n){switch(t){case we:e("G");break;case _e:e("H");break;case Se:e("J");break;case Oe:e("K");break;case Ee:e("L");break;case Ae:e("A");break;case Ce:e("S");break;case Ie:e("F");break;case Te:e("a");break;default:n(Error(TypeError))}}))},OBCIStreamStart:"b",OBCIStreamStop:"s",OBCIAccelStart:"n",OBCIAccelStop:"N",OBCIMiscQueryRegisterSettings:"?",OBCIMiscQueryRegisterSettingsChannel1:xe,OBCIMiscQueryRegisterSettingsChannel2:ke,OBCIMiscQueryRegisterSettingsChannel3:Pe,OBCIMiscQueryRegisterSettingsChannel4:Ne,OBCIMiscQueryRegisterSettingsChannel5:Be,OBCIMiscQueryRegisterSettingsChannel6:De,OBCIMiscQueryRegisterSettingsChannel7:Re,OBCIMiscQueryRegisterSettingsChannel8:je,channelSettingsKeyForChannel:function(t){return new Promise((function(e,n){switch(t){case 1:e(new le(xe));break;case 2:e(new le(ke));break;case 3:e(new le(Pe));break;case 4:e(new le(Ne));break;case 5:e(new le(Be));break;case 6:e(new le(De));break;case 7:e(new le(Re));break;case 8:e(new le(je));break;default:n(Error("Invalid channel number"))}}))},OBCIMiscSoftReset:"v",OBCIChannelMaxNumber8:"c",OBCIChannelMaxNumber16:"C",OBCIChannelMaxNumber8NoDaisyToRemove:"",OBCIChannelMaxNumber8SuccessDaisyRemoved:"daisy removed",OBCIChannelMaxNumber16DaisyAlreadyAttached:"16",OBCIChannelMaxNumber16DaisyAttached:"daisy attached16",OBCIChannelMaxNumber16NoDaisyAttached:"no daisy to attach!8",OBCIFilterDisable:"g",OBCIFilterEnable:"f",OBCITrigger:"`",OBCINumberOfChannelsCyton:8,OBCINumberOfChannelsCytonBLE:2,OBCINumberOfChannelsDaisy:16,OBCINumberOfChannelsDefault:8,OBCINumberOfChannelsGanglion:4,OBCIBoardCyton:Ve,OBCIBoardCytonBLE:ze,OBCIBoardDaisy:qe,OBCIBoardDefault:"default",OBCIBoardGanglion:We,OBCIBoardNone:Ge,numberOfChannelsForBoardType:function(t){switch(t){case qe:return 16;case We:return 4;case Ge:return 0;case ze:return 2;case Ve:default:return 8}},boardTypeForNumberOfChannels:function(t){switch(t){case 16:return qe;case 4:return We;case 0:return Ge;case 2:return ze;case 8:default:return Ve}},OBCISampleRate1000:1e3,OBCISampleRate125:125,OBCISampleRate12800:12800,OBCISampleRate1600:1600,OBCISampleRate16000:16e3,OBCISampleRate200:200,OBCISampleRate2000:2e3,OBCISampleRate250:250,OBCISampleRate25600:25600,OBCISampleRate3200:3200,OBCISampleRate400:400,OBCISampleRate4000:4e3,OBCISampleRate500:500,OBCISampleRate6400:6400,OBCISampleRate800:800,OBCISampleRate8000:8e3,OBCISampleNumberMax:255,OBCIPacketSize:33,OBCIPacketSizeBLECyton:20,OBCIPacketSizeBLERaw:12,OBCIByteStart:160,OBCIByteStop:192,OBCIErrorInvalidByteLength:"Invalid Packet Byte Length",OBCIErrorInvalidByteStart:"Invalid Start Byte",OBCIErrorInvalidByteStop:"Invalid Stop Byte",OBCIErrorInvalidData:"Invalid data - try again",OBCIErrorInvalidType:"Invalid type - check comments for input type",OBCIErrorMissingRegisterSetting:"Missing register setting",OBCIErrorMissingRequiredProperty:"Missing property in JSON",OBCIErrorNobleAlreadyScanning:"Scan already under way",OBCIErrorNobleNotAlreadyScanning:"No scan started",OBCIErrorNobleNotInPoweredOnState:"Please turn blue tooth on.",OBCIErrorTimeSyncIsNull:"'this.sync.curSyncObj' must not be null",OBCIErrorTimeSyncNoComma:"Missed the time sync sent confirmation. Try sync again",OBCIErrorUndefinedOrNullInput:"Undefined or Null Input",OBCIMasterBufferSize:4096,OBCILeadOffDriveInAmps:6e-9,OBCILeadOffFrequencyHz:31.5,getChannelSetter:function(t,e,n,r,i,o,s){var a,u,c,l;return new Promise((function(h,f){en(t)||f(Error("channelNumber must be of type 'number' ")),nn(e)||f(Error("powerDown must be of type 'boolean' ")),en(n)||f(Error("gain must be of type 'number' ")),rn(r)||f(Error("inputType must be of type 'string' ")),nn(i)||f(Error("bias must be of type 'boolean' ")),nn(o)||f(Error("srb1 must be of type 'boolean' ")),nn(s)||f(Error("srb2 must be of type 'boolean' "));var p=an(t).catch((function(t){return f(t)}));a=e?"1":"0";var d=sn(n).catch((function(t){return f(t)})),y=on(r).catch((function(t){return f(t)}));u=i?"1":"0",c=o?"1":"0",l=s?"1":"0";var v={channelNumber:t,powerDown:e,gain:n,inputType:r,bias:i,srb2:o,srb1:s};Promise.all([p,d,y]).then((function(t){var e=["x",t[0],a,t[1],t[2],u,c,l,"X"];h({commandArray:e,newChannelSettingsObject:v})}))}))},getImpedanceSetter:function(t,e,n){var r,i;return new Promise((function(o,s){en(t)||s(Error("channelNumber must be of type 'number' ")),nn(e)||s(Error("pInputApplied must be of type 'boolean' ")),nn(n)||s(Error("nInputApplied must be of type 'boolean' ")),i=e?"1":"0",r=n?"1":"0",an(t).then((function(t){o(["z",t,i,r,"Z"])})).catch((function(t){return s(t)}))}))},getSampleRateSetter:function(t,e){return new Promise((function(n,r){if(!rn(t))return r(Error("board type must be of type 'string' "));if(!en(e))return r(Error("sampleRate must be of type 'number' "));var i;if(e=Math.floor(e),t===Ve||t===qe)i=ln;else{if(t!==We)return r(Error("boardType must be either ".concat(Ve," or ").concat(We)));i=hn}i(e).then((function(t){n(["~",t])})).catch((function(t){return r(t)}))}))},getBoardModeSetter:function(t){return new Promise((function(e,n){if(!rn(t))return n(Error("board mode must be of type 'string' "));fn(t).then((function(t){e(["/",t])})).catch((function(t){return n(t)}))}))},OBCIWriteIntervalDelayMSLong:50,OBCIWriteIntervalDelayMSNone:0,OBCIWriteIntervalDelayMSShort:10,OBCISyncTimeSent:",",OBCISyncTimeSet:"<",OBCIRadioKey:240,OBCIRadioCmdChannelGet:0,OBCIRadioCmdChannelSet:1,OBCIRadioCmdChannelSetOverride:2,OBCIRadioCmdPollTimeGet:3,OBCIRadioCmdPollTimeSet:4,OBCIRadioCmdBaudRateSetDefault:5,OBCIRadioCmdBaudRateSetFast:6,OBCIRadioCmdSystemStatus:7,OBCIImpedanceTextBad:"bad",OBCIImpedanceTextGood:Ye,OBCIImpedanceTextInit:"init",OBCIImpedanceTextOk:"ok",OBCIImpedanceTextNone:He,OBCIImpedanceThresholdBadMax:Ke,OBCIImpedanceSeriesResistor:2200,getTextForRawImpedance:function(t){return t>0&&t<5e3?Ye:t>5001&&t<1e4?"ok":t>10001&&t<Ke?"bad":He},OBCISimulatorPortName:"OpenBCISimulator",OBCIStreamPacketStandardAccel:0,OBCIStreamPacketStandardRawAux:1,OBCIStreamPacketUserDefinedType:2,OBCIStreamPacketAccelTimeSyncSet:3,OBCIStreamPacketAccelTimeSynced:4,OBCIStreamPacketRawAuxTimeSyncSet:5,OBCIStreamPacketRawAuxTimeSynced:6,OBCIStreamPacketImpedance:7,isNumber:en,isBoolean:nn,isString:rn,isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},OBCIPacketPositionStartByte:0,OBCIPacketPositionStopByte:32,OBCIPacketPositionStartAux:26,OBCIPacketPositionStopAux:31,OBCIPacketPositionChannelDataStart:2,OBCIPacketPositionChannelDataStop:25,OBCIPacketPositionSampleNumber:1,OBCIPacketPositionTimeSyncAuxStart:26,OBCIPacketPositionTimeSyncAuxStop:28,OBCIPacketPositionTimeSyncTimeStart:28,OBCIPacketPositionTimeSyncTimeStop:32,OBCISimulatorLineNoiseHz60:"60Hz",OBCISimulatorLineNoiseHz50:"50Hz",OBCISimulatorLineNoiseNone:"none",OBCISimulatorFragmentationRandom:"random",OBCISimulatorFragmentationFullBuffers:"fullBuffers",OBCISimulatorFragmentationOneByOne:"oneByOne",OBCISimulatorFragmentationNone:"none",OBCIFirmwareV1:"v1",OBCIFirmwareV2:"v2",OBCIFirmwareV3:"v3",OBCIAccelAxisX:7,OBCIAccelAxisY:8,OBCIAccelAxisZ:9,OBCIStreamPacketTimeByteSize:4,OBCIParseDaisy:"Daisy",OBCIParseFailure:"Failure",OBCIParseFirmware:"v2",OBCIParseEOT:"$$$",OBCIParseSuccess:"Success",OBCIParsingChannelSettings:2,OBCIParsingEOT:4,OBCIParsingNormal:3,OBCIParsingReset:0,OBCIParsingTimeSyncSent:1,OBCITimeoutProcessBytes:500,OBCISimulatorRawAux:"rawAux",OBCISimulatorStandard:"standard",OBCIRadioChannelMax:25,OBCIRadioChannelMin:1,OBCIRadioPollTimeMax:255,OBCIRadioPollTimeMin:0,OBCITimeSyncArraySize:10,OBCITimeSyncMultiplierWithSyncConf:.9,OBCITimeSyncMultiplierWithoutSyncConf:.75,OBCITimeSyncThresholdTransFailureMS:10,OBCIBoardModeSet:"/",OBCIBoardModeCmdDefault:"0",OBCIBoardModeCmdDebug:"1",OBCIBoardModeCmdAnalog:"2",OBCIBoardModeCmdDigital:"3",OBCIBoardModeCmdGetCur:"/",OBCIBoardModeAnalog:Me,OBCIBoardModeDefault:Le,OBCIBoardModeDebug:Fe,OBCIBoardModeDigital:Ue,OBCISampleRateSet:"~",OBCISampleRateCmdCyton16000:"0",OBCISampleRateCmdCyton8000:"1",OBCISampleRateCmdCyton4000:"2",OBCISampleRateCmdCyton2000:"3",OBCISampleRateCmdCyton1000:"4",OBCISampleRateCmdCyton500:"5",OBCISampleRateCmdCyton250:"6",OBCISampleRateCmdGang25600:"0",OBCISampleRateCmdGang12800:"1",OBCISampleRateCmdGang6400:"2",OBCISampleRateCmdGang3200:"3",OBCISampleRateCmdGang1600:"4",OBCISampleRateCmdGang800:"5",OBCISampleRateCmdGang400:"6",OBCISampleRateCmdGang200:"7",OBCISampleRateCmdGetCur:"~",OBCIWifiAttach:"{",OBCIWifiRemove:"}",OBCIWifiReset:";",OBCIWifiStatus:":",OBCIRadioBaudRateDefault:115200,OBCIRadioBaudRateDefaultStr:"default",OBCIRadioBaudRateFast:230400,OBCIRadioBaudRateFastStr:"fast",OBCIEmitterAccelerometer:"accelerometer",OBCIEmitterBlePoweredUp:"blePoweredOn",OBCIEmitterClose:"close",OBCIEmitterDroppedPacket:"droppedPacket",OBCIEmitterEot:"eot",OBCIEmitterError:"error",OBCIEmitterGanglionFound:"ganglionFound",OBCIEmitterHardSet:"hardSet",OBCIEmitterImpedance:"impedance",OBCIEmitterImpedanceArray:"impedanceArray",OBCIEmitterMessage:"message",OBCIEmitterQuery:"query",OBCIEmitterRawDataPacket:"rawDataPacket",OBCIEmitterReady:"ready",OBCIEmitterRFduino:"rfduino",OBCIEmitterSample:"sample",OBCIEmitterScanStopped:"scanStopped",OBCIEmitterSynced:"synced",OBCIEmitterWifiShield:"wifiShield",OBCIGanglionAccelAxisX:1,OBCIGanglionAccelAxisY:2,OBCIGanglionAccelAxisZ:3,OBCIGanglionBleSearchTime:2e4,OBCIGanglionByteIdUncompressed:0,OBCIGanglionByteId18Bit:{max:100,min:1},OBCIGanglionByteId19Bit:{max:200,min:101},OBCIGanglionByteIdImpedanceChannel1:201,OBCIGanglionByteIdImpedanceChannel2:202,OBCIGanglionByteIdImpedanceChannel3:203,OBCIGanglionByteIdImpedanceChannel4:204,OBCIGanglionByteIdImpedanceChannelReference:205,OBCIGanglionByteIdMultiPacket:206,OBCIGanglionByteIdMultiPacketStop:207,OBCIGanglionMCP3912Gain:51,OBCIGanglionMCP3912Vref:1.2,OBCIGanglionPacketSize:20,OBCIGanglionPacket18Bit:{auxByte:20,byteId:0,dataStart:1,dataStop:19},OBCIGanglionPacket19Bit:{byteId:0,dataStart:1,dataStop:20},OBCIGanglionPrefix:Qe,OBCIGanglionSamplesPerPacket:2,OBCIGanglionSyntheticDataEnable:"t",OBCIGanglionSyntheticDataDisable:"T",OBCIGanglionImpedanceStart:"z",OBCIGanglionImpedanceStop:"Z",OBCIGanglionScaleFactorPerCountVolts:1.8699498629276494e-9,SimbleeUuidService:"fe84",SimbleeUuidReceive:"2d30c082f39f4ce6923f3484ea480596",SimbleeUuidSend:"2d30c083f39f4ce6923f3484ea480596",SimbleeUuidDisconnect:"2d30c084f39f4ce6923f3484ea480596",RFduinoUuidService:"2220",RFduinoUuidReceive:"2221",RFduinoUuidSend:"2222",RFduinoUuidSendTwo:"2223",OBCICytonBLESamplesPerPacket:3,OBCIGanglionAccelScaleFactor:.016,OBCINobleEmitterPeripheralConnect:"connect",OBCINobleEmitterPeripheralDisconnect:"disconnect",OBCINobleEmitterPeripheralDiscover:"discover",OBCINobleEmitterPeripheralServicesDiscover:"servicesDiscover",OBCINobleEmitterServiceCharacteristicsDiscover:"characteristicsDiscover",OBCINobleEmitterServiceRead:"read",OBCINobleEmitterDiscover:"discover",OBCINobleEmitterScanStart:"scanStart",OBCINobleEmitterScanStop:"scanStop",OBCINobleEmitterStateChange:"stateChange",OBCINobleStatePoweredOn:"poweredOn",getPeripheralLocalNames:function(t){return new Promise((function(e,n){var r=[];return t.forEach((function(t){r.push(t.advertisement.localName)})),r.length>0?e(r):n(Error("No peripherals discovered with prefix equal to ".concat(Qe)))}))},getPeripheralWithLocalName:function(t,e){return new Promise((function(n,r){return"object"!==he(t)?r(Error("pArray must be of type Object")):(t.forEach((function(t){if(t.advertisement.hasOwnProperty("localName")&&t.advertisement.localName===e)return n(t)})),r(Error("No peripheral found with localName: ".concat(e))))}))},getVersionNumber:function(t){return Number(t[1])},isPeripheralGanglion:function(t){return!!(t&&t.hasOwnProperty("advertisement")&&null!==t.advertisement&&t.advertisement.hasOwnProperty("localName")&&void 0!==t.advertisement.localName&&null!==t.advertisement.localName&&t.advertisement.localName.indexOf(Qe)>-1)},commandSampleRateForCmdCyton:ln,commandSampleRateForCmdGanglion:hn,commandBoardModeForMode:fn,rawDataToSampleObjectDefault:function(t){return void 0===t&&(t=8),{accelArray:[0,0,0],channelSettings:tn.channelSettingsArrayInit(t),decompressedSamples:cn(t),lastSampleNumber:0,rawDataPacket:le.alloc(33),rawDataPackets:[],scale:!0,sendCounts:!1,timeOffset:0,verbose:!1}},OBCIProtocolBLE:"ble",OBCIProtocolSerial:"serial",OBCIProtocolWifi:"wifi",OBCIRegisterQueryAccelerometerFirmwareV1:Je,OBCIRegisterQueryAccelerometerFirmwareV3:Xe,OBCIRegisterQueryCyton:Ze,OBCIRegisterQueryCytonDaisy:$e,OBCIRegisterQueryNameMISC1:"MISC1",OBCIRegisterQueryNameBIASSENSP:"BIAS_SENSP",OBCIRegisterQueryNameCHnSET:["CH1SET","CH2SET","CH3SET","CH4SET","CH5SET","CH6SET","CH7SET","CH8SET"],OBCIRegisterQuerySizeCytonFirmwareV1:Ze.length+Je.length,OBCIRegisterQuerySizeCytonDaisyFirmwareV1:Ze.length+$e.length+Je.length,OBCIRegisterQuerySizeCytonFirmwareV3:Ze.length+Xe.length,OBCIRegisterQuerySizeCytonDaisyFirmwareV3:Ze.length+$e.length+Xe.length};function en(t){return"number"==typeof t}function nn(t){return"boolean"==typeof t}function rn(t){return"string"==typeof t}function on(t){return new Promise((function(e,n){switch(t){case fe:e("0");break;case pe:e("1");break;case de:e("2");break;case ye:e("3");break;case ve:e("4");break;case ge:e("5");break;case be:e("6");break;case me:e("7");break;default:n(Error("Invalid ADC string"))}}))}function sn(t){return new Promise((function(e,n){switch(t){case 1:e("0");break;case 2:e("1");break;case 4:e("2");break;case 6:e("3");break;case 8:e("4");break;case 12:e("5");break;case 24:e("6");break;default:n(Error("Invalid gain setting of "+t+" gain must be (1,2,4,6,8,12,24)"))}}))}function an(t){return new Promise((function(e,n){switch(t){case 1:e("1");break;case 2:e("2");break;case 3:e("3");break;case 4:e("4");break;case 5:e("5");break;case 6:e("6");break;case 7:e("7");break;case 8:e("8");break;case 9:e("Q");break;case 10:e("W");break;case 11:e("E");break;case 12:e("R");break;case 13:e("T");break;case 14:e("Y");break;case 15:e("U");break;case 16:e("I");break;default:n(Error("Invalid channel number"))}}))}function un(t){return{channelNumber:t,powerDown:!1,gain:24,inputType:fe,bias:!0,srb2:!0,srb1:!1}}function cn(t){for(var e=[],n=0;n<3;n++)e.push(new Array(t));return e}function ln(t){return new Promise((function(e,n){switch(t){case 16e3:e("0");break;case 8e3:e("1");break;case 4e3:e("2");break;case 2e3:e("3");break;case 1e3:e("4");break;case 500:e("5");break;case 250:e("6");break;default:n(Error("Invalid sample rate"))}}))}function hn(t){return new Promise((function(e,n){switch(t){case 25600:e("0");break;case 12800:e("1");break;case 6400:e("2");break;case 3200:e("3");break;case 1600:e("4");break;case 800:e("5");break;case 400:e("6");break;case 200:e("7");break;default:n(Error("Invalid sample rate"))}}))}function fn(t){return new Promise((function(e,n){switch(t){case Le:e("0");break;case Fe:e("1");break;case Me:e("2");break;case Ue:e("3");break;default:n(Error("Invalid sample rate"))}}))}const pn=tn;var dn=n(1481),yn=n.n(dn),vn=n(1301),gn=n.n(vn),bn=4.5,mn=.002/Math.pow(2,4),wn={extractRawDataPackets:function(t){if(!t)return{buffer:t,rawDataPackets:[]};var e=t.length,n=[];if(e<pn.OBCIPacketSize)return{buffer:t,rawDataPackets:n};for(var r=0;r<=e-pn.OBCIPacketSize;){if(t[r]===pn.OBCIByteStart&&tr(t[r+pn.OBCIPacketSize-1])){var i;i=Uint8Array.from(t.slice(r,r+pn.OBCIPacketSize)),n.push(i);var o;o=r>0?Uint8Array.concat([Uint8Array.from(t.slice(0,r)),Uint8Array.from(t.slice(r+pn.OBCIPacketSize))]):Uint8Array.from(t.slice(pn.OBCIPacketSize)),t=0===o.length?null:Uint8Array.from(o),r=-1,e-=pn.OBCIPacketSize}r++}return{buffer:t,rawDataPackets:n}},extractRawBLEDataPackets:function(t){var e=[];if(pn.isNull(t))return e;if(t.byteLength!==pn.OBCIPacketSizeBLECyton)return e;var n=[0,0,0];n[0]=t[1],n[1]=n[0]+1,n[1]>255&&(n[1]-=256),n[2]=n[1]+1,n[2]>255&&(n[2]-=256);for(var r=0;r<pn.OBCICytonBLESamplesPerPacket;r++){var i=wn.samplePacketZero(n[r]);i[0]=pn.OBCIByteStart,i[pn.OBCIPacketPositionStopByte]=t[0],t.copy(i,pn.OBCIPacketPositionChannelDataStart,pn.OBCIPacketPositionChannelDataStart+6*r,pn.OBCIPacketPositionChannelDataStart+6+6*r),e.push(i)}return e},transformRawDataPacketToSample:Pn,transformRawDataPacketsToSample:function(t){for(var e=[],n=0;n<t.rawDataPackets.length;n++){t.rawDataPacket=t.rawDataPackets[n];var r=Pn(t);e.push(r),r.hasOwnProperty("sampleNumber")?t.lastSampleNumber=r.sampleNumber:r.hasOwnProperty("impedanceValue")||(t.lastSampleNumber=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber])}return e},convertGanglionArrayToBuffer:function(t,e){for(var n=0;n<pn.OBCINumberOfChannelsGanglion;n++)e.writeInt16BE(t[n]>>8,3*n),e.writeInt8(255&t[n],3*n+2)},getRawPacketType:Wn,getFromTimePacketAccel:Ln,getFromTimePacketTime:Mn,getFromTimePacketRawAux:Fn,ganglionFillRawDataPacket:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.rawDataPacket)||pn.isNull(t.rawDataPacket)||pn.isUndefined(t.data)||pn.isNull(t.data))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(!t.hasOwnProperty("sampleNumber"))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);if(t.data.byteLength!==pn.OBCIPacketSizeBLERaw)throw new Error(pn.OBCIErrorInvalidByteLength);t.data.copy(t.rawDataPacket,pn.OBCIPacketPositionChannelDataStart),t.rawDataPacket[pn.OBCIPacketPositionSampleNumber]=t.sampleNumber,t.rawDataPacket[pn.OBCIPacketPositionStartByte]=pn.OBCIByteStart,t.rawDataPacket[pn.OBCIPacketPositionStopByte]=pn.OBCIStreamPacketStandardRawAux},parsePacketStandardAccel:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.rawDataPacket)||pn.isNull(t.rawDataPacket))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);if(t.rawDataPacket[0]!==pn.OBCIByteStart)throw new Error(pn.OBCIErrorInvalidByteStart);var e={};return(pn.isUndefined(t.scale)||pn.isNull(t.scale))&&(t.scale=!0),t.scale?e.accelData=Un(t.rawDataPacket.slice(pn.OBCIPacketPositionStartAux,pn.OBCIPacketPositionStopAux+1)):e.accelDataCounts=Vn(t.rawDataPacket.slice(pn.OBCIPacketPositionStartAux,pn.OBCIPacketPositionStopAux+1)),t.scale?e.channelData=zn(t):e.channelDataCounts=qn(t),e.auxData=Uint8Array.from(t.rawDataPacket.slice(pn.OBCIPacketPositionStartAux,pn.OBCIPacketPositionStopAux+1)),e.sampleNumber=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber],e.startByte=t.rawDataPacket[0],e.stopByte=t.rawDataPacket[pn.OBCIPacketPositionStopByte],e.valid=!0,e.timestamp=Date.now(),e.boardTime=0,e},parsePacketStandardRawAux:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.rawDataPacket)||pn.isNull(t.rawDataPacket))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);if(t.rawDataPacket[0]!==pn.OBCIByteStart)throw new Error(pn.OBCIErrorInvalidByteStart);var e={};return(pn.isUndefined(t.scale)||pn.isNull(t.scale))&&(t.scale=!0),t.scale?e.channelData=zn(t):e.channelDataCounts=qn(t),e.auxData=Uint8Array.from(t.rawDataPacket.slice(pn.OBCIPacketPositionStartAux,pn.OBCIPacketPositionStopAux+1)),e.sampleNumber=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber],e.startByte=t.rawDataPacket[0],e.stopByte=t.rawDataPacket[pn.OBCIPacketPositionStopByte],e.valid=!0,e.timestamp=Date.now(),e.boardTime=0,e},parsePacketTimeSyncedAccel:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.rawDataPacket)||pn.isNull(t.rawDataPacket))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);if(t.rawDataPacket[0]!==pn.OBCIByteStart)throw new Error(pn.OBCIErrorInvalidByteStart);var e={};return e.sampleNumber=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber],e.startByte=t.rawDataPacket[0],e.stopByte=t.rawDataPacket[pn.OBCIPacketPositionStopByte],e.boardTime=Mn(t.rawDataPacket),t.hasOwnProperty("timeOffset")?e.timestamp=e.boardTime+t.timeOffset:e.timestamp=Date.now(),e.auxData=Fn(t.rawDataPacket),(pn.isUndefined(t.scale)||pn.isNull(t.scale))&&(t.scale=!0),t.scale?e.channelData=zn(t):e.channelDataCounts=qn(t),Ln(t)&&(t.scale?e.accelData=t.accelArray:e.accelDataCounts=t.accelArray),e.valid=!0,e},parsePacketTimeSyncedRawAux:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.rawDataPacket)||pn.isNull(t.rawDataPacket))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);if(t.rawDataPacket[0]!==pn.OBCIByteStart)throw new Error(pn.OBCIErrorInvalidByteStart);var e={};return e.sampleNumber=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber],e.startByte=t.rawDataPacket[0],e.stopByte=t.rawDataPacket[pn.OBCIPacketPositionStopByte],e.boardTime=Mn(t.rawDataPacket),t.hasOwnProperty("timeOffset")?e.timestamp=e.boardTime+t.timeOffset:e.timestamp=Date.now(),e.auxData=Fn(t.rawDataPacket),(pn.isUndefined(t.scale)||pn.isNull(t.scale))&&(t.scale=!0),t.scale?e.channelData=zn(t):e.channelDataCounts=qn(t),e.valid=!0,e},parsePacketImpedance:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.rawDataPacket)||pn.isNull(t.rawDataPacket))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);var e={};return e.channelNumber=t.rawDataPacket[1],5===e.channelNumber&&(e.channelNumber=0),e.impedanceValue=Number(t.rawDataPacket.toString().match(/\d+/)[0]),e},convertSampleToPacketStandard:function(t){var e=new Uint8Array(pn.OBCIPacketSize);e.fill(0),e[0]=pn.OBCIByteStart,e[1]=t.sampleNumber;for(var n=0;n<pn.OBCINumberOfChannelsDefault;n++)Kn(t.channelData[n]).copy(e,2+3*n);for(var r=0;r<3;r++)Qn(t.auxData[r]).copy(e,pn.OBCIPacketSize-1-6+2*r);return e[pn.OBCIPacketSize-1]=pn.OBCIByteStop,e},convertSampleToPacketRawAux:function(t,e){var n=new Uint8Array(pn.OBCIPacketSize);n.fill(0),n[0]=pn.OBCIByteStart,n[1]=t.sampleNumber;for(var r=0;r<pn.OBCINumberOfChannelsDefault;r++)Kn(t.channelData[r]).copy(n,2+3*r);return e.copy(n,26),n[pn.OBCIPacketSize-1]=$n(pn.OBCIStreamPacketStandardRawAux),n},convertSampleToPacketAccelTimeSyncSet:function(t,e){var n=Zn(t,e);return n[pn.OBCIPacketPositionStopByte]=$n(pn.OBCIStreamPacketAccelTimeSyncSet),n},convertSampleToPacketAccelTimeSynced:Zn,convertSampleToPacketRawAuxTimeSyncSet:function(t,e,n){var r=Xn(t,e,n);return r[pn.OBCIPacketPositionStopByte]=$n(pn.OBCIStreamPacketRawAuxTimeSyncSet),r},convertSampleToPacketRawAuxTimeSynced:Xn,debugPrettyPrint:function(t){if(null==t)console.log("== Sample is undefined ==");else{console.log("-- Sample --"),console.log("---- Start Byte: "+t.startByte),console.log("---- Sample Number: "+t.sampleNumber);for(var e=0;e<8;e++)console.log("---- Channel Data "+(e+1)+": "+t.channelData[e]);if(t.accelData)for(var n=0;n<3;n++)console.log("---- Accel Data "+n+": "+t.accelData[n]);t.auxData&&console.log("---- Aux Data "+t.auxData),console.log("---- Stop Byte: "+t.stopByte)}},samplePrintHeader:function(){return"All voltages in Volts!sampleNumber, channel1, channel2, channel3, channel4, channel5, channel6, channel7, channel8, aux1, aux2, aux3\n"},samplePrintLine:function(t){return new Promise((function(e,n){null==t&&n(Error("undefined sample")),e(t.sampleNumber+","+t.channelData[0].toFixed(8)+","+t.channelData[1].toFixed(8)+","+t.channelData[2].toFixed(8)+","+t.channelData[3].toFixed(8)+","+t.channelData[4].toFixed(8)+","+t.channelData[5].toFixed(8)+","+t.channelData[6].toFixed(8)+","+t.channelData[7].toFixed(8)+","+t.auxData[0].toFixed(8)+","+t.auxData[1].toFixed(8)+","+t.auxData[2].toFixed(8)+"\n")}))},floatTo3ByteBuffer:Kn,floatTo2ByteBuffer:Qn,impedanceCalculationForChannel:function(t,e){var n=Math.sqrt(2);return new Promise((function(r,i){null==t&&i(Error("Sample Object cannot be null or undefined")),void 0!==t.channelData&&null!==t.channelData||i(Error("Channel cannot be null or undefined")),(e<1||e>pn.OBCINumberOfChannelsDefault)&&i(Error("Channel number invalid."));var o=e-1;t.channelData[o]<0&&(t.channelData[o]*=-1),r(n*t.channelData[o]/pn.OBCILeadOffDriveInAmps)}))},impedanceCalculationForAllChannels:function(t){var e=Math.sqrt(2);return new Promise((function(n,r){null==t&&r(Error("Sample Object cannot be null or undefined")),void 0!==t.channelData&&null!==t.channelData||r(Error("Channel cannot be null or undefined"));for(var i=[],o=t.channelData.length,s=0;s<o;s++){t.channelData[s]<0&&(t.channelData[s]*=-1);var a=e*t.channelData[s]/pn.OBCILeadOffDriveInAmps;i.push(a)}t.impedances=i,n(t)}))},interpret16bitAsInt32:function(t){var e=0;return t[0]>127&&(e=65535),e<<16|t[0]<<8|t[1]},interpret24bitAsInt32:function(t){var e=0;return t[0]>127&&(e=255),e<<24|t[0]<<16|t[1]<<8|t[2]},impedanceArray:function(t){for(var e=[],n=0;n<t;n++)e.push(kn(n+1));return e},impedanceObject:kn,impedanceSummarize:function(t){t.raw>pn.OBCIImpedanceThresholdBadMax?t.text=pn.OBCIImpedanceTextNone:t.text=pn.getTextForRawImpedance(t.raw)},newSample:Hn,newSampleNoScale:Yn,randomSample:function(t,e,n,r){var i=yn()(0,1),o=1e6,s=new Array(t+1);s.fill(0);var a=[0,0,0],u=0,c=Math.floor(e/25);c<1&&(c=1);var l=new Array(t).fill(0),h=new Array(t).fill(0),f=new Array(t).fill(0);return function(p){for(var d,y=Hn(),v=0;v<t;v++){switch(d=i.ppf(Math.random())*Math.sqrt(e/2)/o,v){case 0:case 1:n&&(s[v]+=2*Math.PI*10/e,s[v]>2*Math.PI&&(s[v]-=2*Math.PI),d+=5*Math.SQRT2*Math.sin(s[v])/o);break;default:r===pn.OBCISimulatorLineNoiseHz60?(s[v]+=2*Math.PI*60/e,s[v]>2*Math.PI&&(s[v]-=2*Math.PI),d+=8*Math.SQRT2*Math.sin(s[v])/o):r===pn.OBCISimulatorLineNoiseHz50&&(s[v]+=2*Math.PI*50/e,s[v]>2*Math.PI&&(s[v]-=2*Math.PI),d+=8*Math.SQRT2*Math.sin(s[v])/o)}l[v]=.99765*l[v]+.099046*d,h[v]=.963*h[v]+.2965164*d,f[v]=.57*f[v]+1.0526913*d,y.channelData[v]=l[v]+h[v]+f[v]+.1848*d}if(y.sampleNumber=255===p?0:p+1,u===c){var g=[0,0,0];g[0]=.1*Math.random()*(Math.random()>.5?-1:1),g[1]=.1*Math.random()*(Math.random()>.5?-1:1),g[2]=1-.4*Math.random()*(Math.random()>.5?-1:1),y.auxData=g,u=0}else u++,y.auxData=a;return y}},scaleFactorAux:mn,impedanceCalculateArray:function(t,e){if(e.buffer.push(t.channelData),e.count++,e.count>=e.window){for(var n=[],r=0;r<t.channelData.length;r++){for(var i=0,o=0;o<e.window;o++)e.buffer[r][o]>i&&(i=e.buffer[r][o]);for(var s=0,a=0;a<e.window;a++)e.buffer[r][a]<s&&(s=e.buffer[r][a]);var u=i-s;n.push(u/2/pn.OBCILeadOffDriveInAmps)}return e.count=0,n}return null},impedanceTestObjDefault:function(t){var e=t||{};return e.active=!1,e.buffer=[],e.count=0,e.isTestingPInput=!1,e.isTestingNInput=!1,e.onChannel=0,e.sampleNumber=0,e.continuousMode=!1,e.impedanceForChannel=0,e.window=40,e},samplePacket:function(t){return new Uint8Array([160,Gn(t),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,0,0,1,0,2,$n(pn.OBCIStreamPacketStandardAccel)])},samplePacketZero:function(t){return new Uint8Array([160,Gn(t),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,$n(pn.OBCIStreamPacketStandardAccel)])},samplePacketReal:function(t){return new Uint8Array([160,Gn(t),143,242,64,143,223,244,144,43,182,143,191,191,127,255,255,127,255,255,148,37,52,32,182,125,0,224,0,224,15,112,$n(pn.OBCIStreamPacketStandardAccel)])},samplePacketStandardRawAux:function(t){return new Uint8Array([160,Gn(t),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,2,3,4,5,$n(pn.OBCIStreamPacketStandardRawAux)])},samplePacketAccelTimeSyncSet:function(t){return new Uint8Array([160,Gn(t),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,$n(pn.OBCIStreamPacketAccelTimeSyncSet)])},samplePacketAccelTimeSynced:function(t){return new Uint8Array([160,Gn(t),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,$n(pn.OBCIStreamPacketAccelTimeSynced)])},samplePacketRawAuxTimeSyncSet:function(t){return new Uint8Array([160,Gn(t),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,$n(pn.OBCIStreamPacketRawAuxTimeSyncSet)])},samplePacketRawAuxTimeSynced:function(t){return new Uint8Array([160,Gn(t),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,$n(pn.OBCIStreamPacketRawAuxTimeSynced)])},samplePacketImpedance:function(t){return new Uint8Array([160,t,54,52,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,$n(pn.OBCIStreamPacketImpedance)])},samplePacketUserDefined:function(){return new Uint8Array([160,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,$n(pn.OBCIStreamPacketUserDefinedType)])},samplePacketCytonBLE:function(t){return new Uint8Array([192,Gn(t),0,0,1,0,0,2,0,0,10,0,0,20,0,0,100,0,0,200])},countADSPresent:function(t){var e=new(gn())(new Uint8Array("ADS1299"));return e.reset(),e.push(t),e.matches},doesBufferHaveEOT:function(t){var e=new(gn())(new Uint8Array(pn.OBCIParseEOT));return e.reset(),e.push(t),e.matches>=1},getBiasSetFromADSRegisterQuery:Dn,getBooleanFromRegisterQuery:Nn,getChannelDataArray:zn,getChannelDataArrayNoScale:qn,getDataArrayAccel:Un,getDataArrayAccelNoScale:Vn,getFirmware:function(t){var e=t.toString().match(/v\d.\d*.\d*/);if(e){var n=e[0].split(".");return{major:Number(n[0][1]),minor:Number(n[1]),patch:Number(n[2]),raw:e[0]}}return e},getSRB1FromADSRegisterQuery:Bn,getNumFromThreeCSVADSRegisterQuery:Rn,isEven:Jn,isFailureInBuffer:function(t){var e=new(gn())(new Uint8Array(pn.OBCIParseFailure));return e.reset(),e.push(t),e.matches>=1},isOdd:function(t){return t%2==1},isStopByte:tr,isSuccessInBuffer:function(t){var e=new(gn())(new Uint8Array(pn.OBCIParseSuccess));return e.reset(),e.push(t),e.matches>=1},isTimeSyncSetConfirmationInBuffer:function(t){if(t){var e=t.length;switch(e){case 0:return!1;case 1:return t[0]===pn.OBCISyncTimeSent.charCodeAt(0);case 2:return t[1]===pn.OBCIByteStart?t[0]===pn.OBCISyncTimeSent.charCodeAt(0):!!tr(t[0])&&t[1]===pn.OBCISyncTimeSent.charCodeAt(0);default:if(t[0]===pn.OBCISyncTimeSent.charCodeAt(0)&&t[1]===pn.OBCIByteStart)return!0;for(var n=1;n<e;n++)if(n===e-1){if(tr(t[n-1]))return t[n]===pn.OBCISyncTimeSent.charCodeAt(0)}else if(tr(t[n-1])&&t[n+1]===pn.OBCIByteStart)return t[n]===pn.OBCISyncTimeSent.charCodeAt(0);return!1}}},makeDaisySampleObject:function(t,e){var n={};return t.hasOwnProperty("channelData")&&(n.channelData=t.channelData.concat(e.channelData)),t.hasOwnProperty("channelDataCounts")&&(n.channelDataCounts=t.channelDataCounts.concat(e.channelDataCounts)),n.sampleNumber=Math.floor(e.sampleNumber/2),n.auxData={lower:t.auxData,upper:e.auxData},n.stopByte=t.stopByte,n.timestamp=(t.timestamp+e.timestamp)/2,n._timestamps={lower:t.timestamp,upper:e.timestamp},t.hasOwnProperty("accelData")&&(t.accelData[0]>0||t.accelData[1]>0||t.accelData[2]>0?n.accelData=t.accelData:n.accelData=e.accelData),t.hasOwnProperty("accelDataCounts")&&(t.accelDataCounts[0]>0||t.accelDataCounts[1]>0||t.accelDataCounts[2]>0?n.accelDataCounts=t.accelDataCounts:n.accelDataCounts=e.accelDataCounts),n.valid=!0,n},makeDaisySampleObjectWifi:function(t,e){var n={};return t.hasOwnProperty("channelData")&&(n.channelData=t.channelData.concat(e.channelData)),t.hasOwnProperty("channelDataCounts")&&(n.channelDataCounts=t.channelDataCounts.concat(e.channelDataCounts)),n.sampleNumber=e.sampleNumber,n.auxData={lower:t.auxData,upper:e.auxData},t.hasOwnProperty("timestamp")&&(n.timestamp=t.timestamp),n.stopByte=t.stopByte,n._timestamps={lower:t.timestamp,upper:e.timestamp},t.hasOwnProperty("accelData")&&(t.accelData[0]>0||t.accelData[1]>0||t.accelData[2]>0?n.accelData=t.accelData:n.accelData=e.accelData),t.hasOwnProperty("accelDataCounts")&&(t.accelDataCounts[0]>0||t.accelDataCounts[1]>0||t.accelDataCounts[2]>0?n.accelDataCounts=t.accelDataCounts:n.accelDataCounts=e.accelDataCounts),n.valid=!0,n},makeTailByteFromPacketType:$n,newSyncObject:function(){return{boardTime:0,correctedTransmissionTime:!1,error:null,timeSyncSent:0,timeSyncSentConfirmation:0,timeSyncSetPacket:0,timeRoundTrip:0,timeTransmission:0,timeOffset:0,timeOffsetMaster:0,valid:!1}},setChSetFromADSRegisterQuery:jn,stripToEOTBuffer:function(t){var e=t.indexOf(pn.OBCIParseEOT);return e>=0?(e+=pn.OBCIParseEOT.length)<t.byteLength?Uint8Array.from(t.slice(e)):null:t},syncChannelSettingsWithRawData:function(t){if(pn.isUndefined(t)||pn.isUndefined(t.channelSettings)||pn.isNull(t.channelSettings)||pn.isUndefined(t.data)||pn.isNull(t.data))throw new Error(pn.OBCIErrorUndefinedOrNullInput);if(!Array.isArray(t.channelSettings))throw new Error("".concat(pn.OBCIErrorInvalidType," channelSettings"));if(t.channelSettings.length===pn.OBCINumberOfChannelsCyton){if(t.data.toString().match(/Daisy ADS/))throw new Error("raw data mismatch - expected only cyton register info but also found daisy");if(null==t.data.toString().match(/Board ADS/))throw new Error(pn.OBCIErrorInvalidData)}else{if(null==t.data.toString().match(/Daisy ADS/))throw new Error("raw data mismatch - expected daisy register info but none found");if(null==t.data.toString().match(/Board ADS/))throw new Error("no Board ADS info found")}t.channelSettings.forEach((function(t){if(!(t.hasOwnProperty("channelNumber")&&t.hasOwnProperty("powerDown")&&t.hasOwnProperty("gain")&&t.hasOwnProperty("inputType")&&t.hasOwnProperty("bias")&&t.hasOwnProperty("srb2")&&t.hasOwnProperty("srb1")))throw new Error(pn.OBCIErrorMissingRequiredProperty)}));var e=null,n=!1,r=!1,i=t.data.toString().match(/Board ADS/),o=t.data.toString().slice(i.index,pn.OBCIRegisterQueryCyton.length);if(Bn(o)&&(n=!0),t.channelSettings.length>pn.OBCINumberOfChannelsCyton){var s=t.data.toString().match(/Daisy ADS/);e=t.data.toString().slice(s.index,s.index+pn.OBCIRegisterQueryCytonDaisy.length),Bn(o)&&(r=!0)}t.channelSettings.forEach((function(t){t.channelNumber<pn.OBCINumberOfChannelsCyton?(jn(o,t),t.bias=Dn(o,t.channelNumber),t.srb1=n):(jn(e,t),t.bias=Dn(e,t.channelNumber-pn.OBCINumberOfChannelsCyton),t.srb1=r)}))},droppedPacketCheck:function(t,e){if(t===pn.OBCISampleNumberMax&&0===e)return null;if(e-t==1)return null;var n=[];if(t>e){for(var r=pn.OBCISampleNumberMax-t,i=0;i<r;i++)n.push(t+i+1);t=-1}for(var o=1;o<e-t;o++)n.push(t+o);return n},convert18bitAsInt32:Cn,convert19bitAsInt32:In,decompressDeltas18Bit:Tn,decompressDeltas19Bit:xn,sampleCompressedData:function(t){return new Uint8Array([t,0,0,0,0,8,0,5,0,0,72,0,9,240,1,176,0,48,0,8])},sampleBLERaw:function(){return new Uint8Array([0,0,1,0,0,2,0,0,3,0,0,4])},sampleImpedanceChannel1:function(){return new Uint8Array([pn.OBCIGanglionByteIdImpedanceChannel1,0,0,1])},sampleImpedanceChannel2:function(){return new Uint8Array([pn.OBCIGanglionByteIdImpedanceChannel2,0,0,1])},sampleImpedanceChannel3:function(){return new Uint8Array([pn.OBCIGanglionByteIdImpedanceChannel3,0,0,1])},sampleImpedanceChannel4:function(){return new Uint8Array([pn.OBCIGanglionByteIdImpedanceChannel4,0,0,1])},sampleImpedanceChannelReference:function(){return new Uint8Array([pn.OBCIGanglionByteIdImpedanceChannelReference,0,0,1])},sampleMultiBytePacket:function(t){var e=new Uint8Array([pn.OBCIGanglionByteIdMultiPacket]);return Uint8Array.concat([e,t])},sampleMultiBytePacketStop:function(t){var e=new Uint8Array([pn.OBCIGanglionByteIdMultiPacketStop]);return Uint8Array.concat([e,t])},sampleOtherData:function(t){var e=new Uint8Array([255]);return Uint8Array.concat([e,t])},sampleUncompressedData:function(){return new Uint8Array([0,0,0,1,0,0,2,0,0,3,0,0,4,1,2,3,4,5,6,7])},parseGanglion:function(t){var e=parseInt(t.rawDataPacket[0]);if(e<=pn.OBCIGanglionByteId19Bit.max)return An(t);switch(e){case pn.OBCIGanglionByteIdMultiPacket:return _n(t);case pn.OBCIGanglionByteIdMultiPacketStop:return Sn(t);case pn.OBCIGanglionByteIdImpedanceChannel1:case pn.OBCIGanglionByteIdImpedanceChannel2:case pn.OBCIGanglionByteIdImpedanceChannel3:case pn.OBCIGanglionByteIdImpedanceChannel4:case pn.OBCIGanglionByteIdImpedanceChannelReference:return function(t){var e;switch(parseInt(t.rawDataPacket[0])){case pn.OBCIGanglionByteIdImpedanceChannel1:e=1;break;case pn.OBCIGanglionByteIdImpedanceChannel2:e=2;break;case pn.OBCIGanglionByteIdImpedanceChannel3:e=3;break;case pn.OBCIGanglionByteIdImpedanceChannel4:e=4;break;case pn.OBCIGanglionByteIdImpedanceChannelReference:e=0}for(var n={channelNumber:e,impedanceValue:0},r=t.rawDataPacket.length;Number.isNaN(Number(t.rawDataPacket.slice(1,r)))&&0!==r;)r--;return 0!==r&&(n.impedanceValue=Number(t.rawDataPacket.slice(1,r))),n}(t);default:return null}},processMultiBytePacket:_n,processMultiBytePacketStop:Sn};function _n(t){t.multiPacketBuffer?t.multiPacketBuffer=Uint8Array.concat([Uint8Array.from(t.multiPacketBuffer),Uint8Array.from(t.rawDataPacket.slice(pn.OBCIGanglionPacket19Bit.dataStart,pn.OBCIGanglionPacket19Bit.dataStop))]):t.multiPacketBuffer=t.rawDataPacket.slice(pn.OBCIGanglionPacket19Bit.dataStart,pn.OBCIGanglionPacket19Bit.dataStop)}function Sn(t){_n(t);var e=t.multiPacketBuffer.toString();return t.multiPacketBuffer=null,{message:e}}function On(t,e){for(var n=1;n<3;n++)for(var r=0;r<4;r++)t.decompressedSamples[n][r]=t.decompressedSamples[n-1][r]-e[n-1][r]}function En(t,e,n){var r;if(n)(r=Yn(t)).channelDataCounts=e;else{r=Hn(t);for(var i=0;i<pn.OBCINumberOfChannelsGanglion;i++)r.channelData.push(e[i]*pn.OBCIGanglionScaleFactorPerCountVolts)}return r.timestamp=Date.now(),r}function An(t){return parseInt(t.rawDataPacket[0])===pn.OBCIGanglionByteIdUncompressed?function(t){t.lastSampleNumber=pn.OBCIGanglionByteIdUncompressed;for(var e=0;e<4;e++)t.decompressedSamples[0][e]=wn.interpret24bitAsInt32(t.rawDataPacket.slice(1+3*e,1+3*e+3));return[En(0,t.decompressedSamples[0],t.sendCounts)]}(t):function(t){t.lastSampleNumber=parseInt(t.rawDataPacket[0]);var e=[];if(t.lastSampleNumber<=pn.OBCIGanglionByteId18Bit.max)switch(On(t,Tn(t.rawDataPacket.slice(pn.OBCIGanglionPacket18Bit.dataStart,pn.OBCIGanglionPacket18Bit.dataStop))),e.push(En(2*t.lastSampleNumber-1,t.decompressedSamples[1],t.sendCounts)),e.push(En(2*t.lastSampleNumber,t.decompressedSamples[2],t.sendCounts)),t.lastSampleNumber%10){case pn.OBCIGanglionAccelAxisX:t.accelArray[0]=t.sendCounts?t.rawDataPacket.readInt8(pn.OBCIGanglionPacket18Bit.auxByte-1):t.rawDataPacket.readInt8(pn.OBCIGanglionPacket18Bit.auxByte-1)*pn.OBCIGanglionAccelScaleFactor;break;case pn.OBCIGanglionAccelAxisY:t.accelArray[1]=t.sendCounts?t.rawDataPacket.readInt8(pn.OBCIGanglionPacket18Bit.auxByte-1):t.rawDataPacket.readInt8(pn.OBCIGanglionPacket18Bit.auxByte-1)*pn.OBCIGanglionAccelScaleFactor;break;case pn.OBCIGanglionAccelAxisZ:t.accelArray[2]=t.sendCounts?t.rawDataPacket.readInt8(pn.OBCIGanglionPacket18Bit.auxByte-1):t.rawDataPacket.readInt8(pn.OBCIGanglionPacket18Bit.auxByte-1)*pn.OBCIGanglionAccelScaleFactor,t.sendCounts?e[0].accelData=t.accelArray:e[0].accelDataCounts=t.accelArray}else On(t,xn(t.rawDataPacket.slice(pn.OBCIGanglionPacket19Bit.dataStart,pn.OBCIGanglionPacket19Bit.dataStop))),e.push(En(2*(t.lastSampleNumber-100)-1,t.decompressedSamples[1],t.sendCounts)),e.push(En(2*(t.lastSampleNumber-100),t.decompressedSamples[2],t.sendCounts));for(var n=0;n<pn.OBCINumberOfChannelsGanglion;n++)t.decompressedSamples[0][n]=t.decompressedSamples[2][n];return e}(t)}function Cn(t){var e=0;return!0&t[2]&&(e=16383),e<<18|t[0]<<16|t[1]<<8|t[2]}function In(t){var e=0;return!0&t[2]&&(e=8191),e<<19|t[0]<<16|t[1]<<8|t[2]}function Tn(t){var e=new Array(pn.OBCIGanglionSamplesPerPacket);e[0]=[0,0,0,0],e[1]=[0,0,0,0];for(var n,r=[],i=0;i<pn.OBCIGanglionSamplesPerPacket;i++)r.push([0,0,0,0]);return n=new Uint8Array([t[0]>>6,(63&t[0])<<2|t[1]>>6,(63&t[1])<<2|t[2]>>6]),r[0][0]=Cn(n),n=new Uint8Array([(63&t[2])>>4,t[2]<<4|t[3]>>4,t[3]<<4|t[4]>>4]),r[0][1]=Cn(n),n=new Uint8Array([(15&t[4])>>2,t[4]<<6|t[5]>>2,t[5]<<6|t[6]>>2]),r[0][2]=Cn(n),n=new Uint8Array([3&t[6],t[7],t[8]]),r[0][3]=Cn(n),n=new Uint8Array([t[9]>>6,(63&t[9])<<2|t[10]>>6,(63&t[10])<<2|t[11]>>6]),r[1][0]=Cn(n),n=new Uint8Array([(63&t[11])>>4,t[11]<<4|t[12]>>4,t[12]<<4|t[13]>>4]),r[1][1]=Cn(n),n=new Uint8Array([(15&t[13])>>2,t[13]<<6|t[14]>>2,t[14]<<6|t[15]>>2]),r[1][2]=Cn(n),n=new Uint8Array([3&t[15],t[16],t[17]]),r[1][3]=Cn(n),r}function xn(t){var e=new Array(pn.OBCIGanglionSamplesPerPacket);e[0]=[0,0,0,0],e[1]=[0,0,0,0];for(var n,r=[],i=0;i<pn.OBCIGanglionSamplesPerPacket;i++)r.push([0,0,0,0]);return n=new Uint8Array([t[0]>>5,(31&t[0])<<3|t[1]>>5,(31&t[1])<<3|t[2]>>5]),r[0][0]=In(n),n=new Uint8Array([(31&t[2])>>2,t[2]<<6|t[3]>>2,t[3]<<6|t[4]>>2]),r[0][1]=In(n),n=new Uint8Array([(3&t[4])<<1|t[5]>>7,(127&t[5])<<1|t[6]>>7,(127&t[6])<<1|t[7]>>7]),r[0][2]=In(n),n=new Uint8Array([(127&t[7])>>4,(15&t[7])<<4|t[8]>>4,(15&t[8])<<4|t[9]>>4]),r[0][3]=In(n),n=new Uint8Array([(15&t[9])>>1,t[9]<<7|t[10]>>1,t[10]<<7|t[11]>>1]),r[1][0]=In(n),n=new Uint8Array([(1&t[11])<<2|t[12]>>6,t[12]<<2|t[13]>>6,t[13]<<2|t[14]>>6]),r[1][1]=In(n),n=new Uint8Array([(56&t[14])>>3,(7&t[14])<<5|(248&t[15])>>3,(7&t[15])<<5|(248&t[16])>>3]),r[1][2]=In(n),n=new Uint8Array([7&t[16],t[17],t[18]]),r[1][3]=In(n),r}function kn(t){return{channel:t,P:{raw:-1,text:pn.OBCIImpedanceTextInit},N:{raw:-1,text:pn.OBCIImpedanceTextInit}}}function Pn(t){var e;try{switch(Wn(t.rawDataPacket[pn.OBCIPacketPositionStopByte])){case pn.OBCIStreamPacketStandardAccel:e=wn.parsePacketStandardAccel(t);break;case pn.OBCIStreamPacketStandardRawAux:e=wn.parsePacketStandardRawAux(t);break;case pn.OBCIStreamPacketAccelTimeSyncSet:case pn.OBCIStreamPacketAccelTimeSynced:e=wn.parsePacketTimeSyncedAccel(t);break;case pn.OBCIStreamPacketRawAuxTimeSyncSet:case pn.OBCIStreamPacketRawAuxTimeSynced:e=wn.parsePacketTimeSyncedRawAux(t);break;case pn.OBCIStreamPacketImpedance:e=wn.parsePacketImpedance(t);break;default:e={error:"bad stop byte ".concat(t.rawDataPacket.slice(32,33).toString("hex")),valid:!1,rawDataPacket:t.rawDataPacket},t.verbose&&console.log(e.error)}}catch(n){e={error:n,valid:!1,rawDataPacket:t.rawDataPacket},t.verbose&&console.log(n)}return e}function Nn(t,e,n){var r=t.match(e);if(r){var i=parseInt(t.charAt(r.index+n));if(Number.isNaN(i))throw new Error(pn.OBCIErrorInvalidData);return Boolean(i)}throw new Error(pn.OBCIErrorMissingRegisterSetting)}function Bn(t){return Nn(t,pn.OBCIRegisterQueryNameMISC1,21)}function Dn(t,e){return Nn(t,pn.OBCIRegisterQueryNameBIASSENSP,20+3*e)}function Rn(t,e,n){var r=t.match(e);if(r){var i=parseInt(t.charAt(r.index+n)),o=parseInt(t.charAt(r.index+n+3)),s=parseInt(t.charAt(r.index+n+6));if(Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(s))throw new Error(pn.OBCIErrorInvalidData);return i<<2|o<<1|s}throw new Error(pn.OBCIErrorMissingRegisterSetting)}function jn(t,e){var n=pn.OBCIRegisterQueryNameCHnSET[e.channelNumber];void 0===n&&(n=pn.OBCIRegisterQueryNameCHnSET[e.channelNumber-pn.OBCINumberOfChannelsCyton]),e.powerDown=Nn(t,n,16),e.gain=pn.gainForCommand(Rn(t,n,19)),e.inputType=pn.inputTypeForCommand(Rn(t,n,31)),e.srb2=Nn(t,n,28)}function Mn(t){var e=pn.OBCIPacketSize-1;if(t.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);return t.readUInt32BE(e-pn.OBCIStreamPacketTimeByteSize)}function Ln(t){var e=pn.OBCIPacketSize-1-pn.OBCIStreamPacketTimeByteSize-2;if(t.rawDataPacket.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);var n=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber],r=wn.interpret16bitAsInt32(t.rawDataPacket.slice(e,e+2));switch(n%10){case pn.OBCIAccelAxisX:return t.accelArray[0]=t.scale?r*mn:r,!1;case pn.OBCIAccelAxisY:return t.accelArray[1]=t.scale?r*mn:r,!1;case pn.OBCIAccelAxisZ:return t.accelArray[2]=t.scale?r*mn:r,!0;default:return!1}}function Fn(t){if(t.byteLength!==pn.OBCIPacketSize)throw new Error(pn.OBCIErrorInvalidByteLength);return Uint8Array.from(t.slice(pn.OBCIPacketPositionTimeSyncAuxStart,pn.OBCIPacketPositionTimeSyncAuxStop))}function Un(t){for(var e=[],n=0;n<3;n++){var r=2*n;e.push(wn.interpret16bitAsInt32(t.slice(r,r+2))*mn)}return e}function Vn(t){for(var e=[],n=0;n<3;n++){var r=2*n;e.push(wn.interpret16bitAsInt32(t.slice(r,r+2)))}return e}function zn(t){if(!Array.isArray(t.channelSettings))throw new Error("Error [getChannelDataArray]: Channel Settings must be an array!");t.hasOwnProperty("protocol")||(t.protocol=pn.OBCIProtocolSerial);var e=[],n=t.channelSettings.length,r=t.rawDataPacket[pn.OBCIPacketPositionSampleNumber],i=n===pn.OBCINumberOfChannelsDaisy,o=pn.OBCINumberOfChannelsCyton;i||(o=t.channelSettings.length);for(var s=0;s<o;s++){if(!t.channelSettings[s].hasOwnProperty("gain"))throw new Error("Error [getChannelDataArray]: Invalid channel settings object at index ".concat(s));if(!pn.isNumber(t.channelSettings[s].gain))throw new Error("Error [getChannelDataArray]: Property gain of channelSettingsObject not or type Number");var a=0;if(t.protocol===pn.OBCIProtocolSerial)a=Jn(r)&&i?bn/t.channelSettings[s+pn.OBCINumberOfChannelsDefault].gain/(Math.pow(2,23)-1):bn/t.channelSettings[s].gain/(Math.pow(2,23)-1);else if(t.protocol===pn.OBCIProtocolWifi)a=i?t.lastSampleNumber===r?bn/t.channelSettings[s+pn.OBCINumberOfChannelsDefault].gain/(Math.pow(2,23)-1):bn/t.channelSettings[s].gain/(Math.pow(2,23)-1):t.channelSettings.length===pn.OBCINumberOfChannelsCyton?bn/t.channelSettings[s].gain/(Math.pow(2,23)-1):pn.OBCIGanglionScaleFactorPerCountVolts;else{if(t.protocol!==pn.OBCIProtocolBLE)throw new Error("Error [getChannelDataArray]: Invalid protocol must be wifi or serial");a=bn/t.channelSettings[s].gain/(Math.pow(2,23)-1)}e.push(a*wn.interpret24bitAsInt32(t.rawDataPacket.slice(3*s+pn.OBCIPacketPositionChannelDataStart,3*s+pn.OBCIPacketPositionChannelDataStart+3)))}return e}function qn(t){if(!Array.isArray(t.channelSettings))throw new Error("Error [getChannelDataArrayNoScale]: Channel Settings must be an array!");var e=[],n=t.channelSettings.length;n>pn.OBCINumberOfChannelsDefault&&(n=pn.OBCINumberOfChannelsDefault);for(var r=0;r<n;r++)e.push(wn.interpret24bitAsInt32(t.rawDataPacket.slice(3*r+pn.OBCIPacketPositionChannelDataStart,3*r+pn.OBCIPacketPositionChannelDataStart+3)));return e}function Wn(t){return 15&t}function Gn(t){return t||0===t?t>255&&(t=255):t=69,t}function Hn(t){return t||0===t?t>255&&(t=255):t=0,{startByte:pn.OBCIByteStart,sampleNumber:t,channelData:[],accelData:[],auxData:null,stopByte:pn.OBCIByteStop,boardTime:0,timestamp:0,valid:!0}}function Yn(t){return t||0===t?t>255&&(t=255):t=0,{startByte:pn.OBCIByteStart,sampleNumber:t,channelDataCounts:[],accelDataCounts:[],auxData:null,stopByte:pn.OBCIByteStop,boardTime:0,timestamp:0,valid:!0}}function Kn(t){var e=new Uint8Array(3);e.fill(0);var n=t/(.1875/(Math.pow(2,23)-1));return n=Math.floor(n),e[2]=255&n,e[1]=(65280&n)>>8,e[0]=(n&255<<16)>>16,e}function Qn(t){var e=new Uint8Array(2);e.fill(0);var n=t/mn;return n=Math.floor(n),e[1]=255&n,e[0]=(65280&n)>>8,e}function Jn(t){return t%2==0}function Xn(t,e,n){var r=new Uint8Array(pn.OBCIPacketSize);r.fill(0),r[0]=pn.OBCIByteStart,r[1]=t.sampleNumber;for(var i=0;i<pn.OBCINumberOfChannelsDefault;i++)Kn(t.channelData[i]).copy(r,2+3*i);return n.copy(r,26),r.writeInt32BE(e,28),r[pn.OBCIPacketSize-1]=$n(pn.OBCIStreamPacketRawAuxTimeSynced),r}function Zn(t,e){var n=new Uint8Array(pn.OBCIPacketSize);n.fill(0),n[0]=pn.OBCIByteStart,n[1]=t.sampleNumber;for(var r=0;r<pn.OBCINumberOfChannelsDefault;r++)Kn(t.channelData[r]).copy(n,2+3*r);return n.writeInt32BE(e,28),n[pn.OBCIPacketSize-1]=$n(pn.OBCIStreamPacketAccelTimeSynced),n}function $n(t){return(t<0||t>15)&&(t=0),pn.OBCIByteStop|t}function tr(t){return(240&t)===pn.OBCIByteStop}function er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?er(Object(n),!0).forEach((function(e){rr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function rr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ir=function(t){var e=t.channelData;return nr(nr({},function(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}(t,["channelData"])),{},{data:e})},or="ganglion",sr={reader:"2d30c082-f39f-4ce6-923f-3484ea480596",writer:"2d30c083-f39f-4ce6-923f-3484ea480596",connection:"2d30c084-f39f-4ce6-923f-3484ea480596"},ar={filters:[{namePrefix:"Ganglion-"}],optionalServices:[65156]},ur={start:"b",accelData:"n"};function cr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cr(Object(n),!0).forEach((function(e){hr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return pr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dr(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function yr(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){dr(o,r,i,s,a,"next",t)}function a(t){dr(o,r,i,s,a,"throw",t)}s(void 0)}))}}function vr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function br(t){var e=parseInt(t.rawDataPacket[0]);if(e<=pn.OBCIGanglionByteId19Bit.max)return An(t);switch(e){case pn.OBCIGanglionByteIdMultiPacket:return processMultiBytePacket(t);case pn.OBCIGanglionByteIdMultiPacketStop:return processMultiBytePacketStop(t);case pn.OBCIGanglionByteIdImpedanceChannel1:case pn.OBCIGanglionByteIdImpedanceChannel2:case pn.OBCIGanglionByteIdImpedanceChannel3:case pn.OBCIGanglionByteIdImpedanceChannel4:case pn.OBCIGanglionByteIdImpedanceChannelReference:return processImpedanceData(t);default:return null}}var mr=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function r(t){return{channelNumber:t,powerDown:!1,gain:24,inputType:"normal",bias:!0,srb2:!0,srb1:!1}}vr(this,t),this.options=n,this.gatt=null,this.device=null,this.deviceName=null,this.service=null,this.characteristics=null,this.onDisconnect$=new ee.Subject,this.boardName=or,this.channelSize=4;var i=function(t){for(var e=[],n=0;n<t;n++)e.push(r(n));return e};function o(t){for(var e=[],n=0;n<3;n++)e.push(new Array(t));return e}this.rawDataPacketToSample={accelArray:[0,0,0],channelSettings:i(4),decompressedSamples:o(4),lastSampleNumber:0,rawDataPacket:new Uint8Array(33).buffer,rawDataPackets:[],scale:!0,sendCounts:!1,timeOffset:0,verbose:!1},this.connectionStatus=new ne.BehaviorSubject(!1),this.stream=(new ee.Subject).pipe((0,ie.map)((function(t){return e.eventToBufferMapper(t)})),(0,re.tap)((function(t){return e.setRawDataPacket(t)})),(0,ie.map)((function(){return br(e.rawDataPacketToSample)})),(0,ue.mergeMap)((function(t){return t})),(0,ie.map)(ir),(0,ae.takeUntil)(this.onDisconnect$)),this.accelData=this.stream.pipe((0,se.filter)((function(t){return t.accelData.length})))}var e,n,r,i;return e=t,(n=[{key:"eventToBufferMapper",value:function(t){return new Uint8Array(t.target.value.buffer)}},{key:"setRawDataPacket",value:function(t){this.rawDataPacketToSample.rawDataPacket=t}},{key:"connect",value:(i=yr(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.bluetooth.requestDevice(ar);case 2:return this.device=t.sent,this.addDisconnectedEvent(),t.next=6,this.device.gatt.connect();case 6:return this.gatt=t.sent,this.deviceName=this.gatt.device.name,t.next=10,this.gatt.getPrimaryService(65156);case 10:return this.service=t.sent,t.t0=this,t.next=14,this.service.getCharacteristics();case 14:t.t1=t.sent,t.t0.setCharacteristics.call(t.t0,t.t1),this.connectionStatus.next(!0);case 17:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"setCharacteristics",value:function(t){this.characteristics=Object.entries(sr).reduce((function(e,n){var r=fr(n,2),i=r[0],o=r[1];return lr(lr({},e),{},hr({},i,t.find((function(t){return t.uuid===o}))))}),{})}},{key:"start",value:(r=yr(regeneratorRuntime.mark((function t(){var e,n,r,i,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.characteristics,n=e.reader,r=e.writer,i=Object.entries(ur).reduce((function(t,e){var n=fr(e,2),r=n[0],i=n[1];return lr(lr({},t),{},hr({},r,(new TextEncoder).encode(i)))}),{}),n.startNotifications(),n.addEventListener("characteristicvaluechanged",(function(t){o.stream.next(t)})),!this.options.accelData){t.next=8;break}return t.next=7,r.writeValue(i.accelData);case 7:n.readValue();case 8:return t.next=10,r.writeValue(i.start);case 10:n.readValue();case 11:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"addDisconnectedEvent",value:function(){var t=this;(0,ce.fromEvent)(this.device,"gattserverdisconnected").pipe((0,oe.first)()).subscribe((function(){t.gatt=null,t.device=null,t.deviceName=null,t.service=null,t.characteristics=null,t.connectionStatus.next(!1)}))}},{key:"disconnect",value:function(){this.gatt&&(this.onDisconnect$.next(),this.gatt.disconnect())}}])&&gr(e.prototype,n),t}();function wr(t){return function(t){if(Array.isArray(t))return _r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return _r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Sr(t){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Or(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Er(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Or(o,r,i,s,a,"next",t)}function a(t){Or(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Ar(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cr(t){return function(t){if(Array.isArray(t))return Ir(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ir(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Tr(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function xr(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Tr(o,r,i,s,a,"next",t)}function a(t){Tr(o,r,i,s,a,"throw",t)}s(void 0)}))}}function kr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nr=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};kr(this,t),this.sendCommand=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.interface.sendMessage(t)},this.requestAuthorization=function(){e.sendCommand("auth as developer\n")},this.acceptTerms=function(){e.sendCommand("accept\n"),e.pauseDeviceAlgorithm()},this.pauseDeviceAlgorithm=function(){e.stopAudio(),e.enableMotors(),e.clearMotorQueue()},this.resumeDeviceAlgorithm=function(){e.startAudio()},this.battery=function(){e.sendCommand("device battery_soc\n")},this.info=function(){e.sendCommand("device info\n")},this.connect=xr(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.interface.connect();case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)}))),this.disconnect=function(){e.interface.disconnect()},this.startAudio=function(){e.sendCommand("audio start\n")},this.stopAudio=function(){e.sendCommand("audio stop\n")},this.clearMotorQueue=function(){e.sendCommand("motors clear_queue\n")},this.enableMotors=function(){e.sendCommand("motors start\n")},this.disableMotors=function(){e.sendCommand("motors stop\n")},this.vibrateMotors=function(t){var n=btoa(String.fromCharCode.apply(String,Cr(new Uint8Array(t.flat()))));e.sendCommand("motors vibrate ".concat(n,"\n"))},this.setThreshold=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"default"==t&&(t=0),"always"==t&&(t=1),"threshold"==t&&(t=2),e.sendCommand("motors config_threshold ".concat(t," ").concat(n,"\n"))},this.getThreshold=function(){e.sendCommand("motors get_threshold\n")},this.setLRA=function(t){"open"==t&&(t=0),"closed"==t&&(t=1),e.sendCommand("motors config_lra_mode ".concat(t,"\n"))},this.getLRA=function(){e.sendCommand("motors get_lra_mode ".concat(mode,"\n"))},this.getLEDs=function(){e.sendCommand("leds get\n")},this.setLEDs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t,e,n){return"0x"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)};t=t.map((function(t){return r.apply(void 0,Cr(t))})),e.sendCommand("leds set ".concat(t.join(" ")," ").concat(n.map((function(t){return 50*t})).join(" "),"\n"))},this.setButton=function(t,n){1!=t&&"true"!=t||(t=1),0!=t&&"false"!=t||(t=0),1!=n&&"true"!=n||(n=1),0!=n&&"false"!=n||(n=0),e.sendCommand("set_buttons_response ".concat(t," ").concat(n,"\n"))},this.interface=null,this.minIntensity=15,this.maxIntensity=255,this.interface=new Br,this.interface.onNotificationCallback=function(t){n(t)};var r=function t(){e.disconnect(),window.removeEventListener("beforeunload",t)};window.addEventListener("beforeunload",r)}var e,n;return e=t,(n=[{key:"getIllusionActivations",value:function(t,e){var n=this.getMotorIntensity(t,this.minIntensity,this.maxIntensity),r=Math.floor(e/.25),i=Math.ceil(e/.25),o=e%.25*4,s=Array(4).fill(0);return s[r]=255*n*Math.sqrt(1-o),s[i]=255*n*Math.sqrt(o),s}},{key:"getMotorIntensity",value:function(t,e,n){return t<=0?e:t>=1?n:Math.expm1(t)/(Math.E-1)*(n-e)+e}},{key:"mapFrequencies",value:function(t){var e=function(t){if(0===t.length)return-1;for(var e=t[0],n=0,r=1;r<t.length;r++)t[r]>e&&(n=r,e=t[r]);return n}(t)/t.length;return this.getIllusionActivations(1,e)}}])&&Pr(e.prototype,n),t}(),Br=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"6e400001-b5a3-f393-e0a9-e50e24dcca9e",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"6e400003-b5a3-f393-e0a9-e50e24dcca9e";kr(this,t),Dr.call(this),this.serviceUUID=e,this.rxUUID=n,this.txUUID=r,this.encoder=new TextEncoder("utf-8"),this.decoder=new TextDecoder("utf-8"),this.device=null,this.server=null,this.service=null,this.rxchar=null,this.txchar=null,this.queue=[],this.readBuffer=[],this.android=navigator.userAgent.toLowerCase().indexOf("android")>-1,this.n},Dr=function(){var t=this;this.connect=xr(regeneratorRuntime.mark((function e(){var n,r,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:t.serviceUUID,r=o.length>1&&void 0!==o[1]?o[1]:t.rxUUID,i=o.length>2&&void 0!==o[2]?o[2]:t.txUUID,e.next=5,navigator.bluetooth.requestDevice({filters:[{services:[n]},{namePrefix:"Buzz"}],optionalServices:[n]}).then(function(){var e=xr(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.device=o,e.next=3,t.device.gatt.connect();case 3:return t.server=e.sent,e.next=6,t.server.getPrimaryService(n);case 6:return t.service=e.sent,e.next=9,t.service.getCharacteristic(r);case 9:return t.rxchar=e.sent,e.next=12,t.service.getCharacteristic(i);case 12:return t.txchar=e.sent,t.txchar.startNotifications().then((function(){t.txchar.addEventListener("characteristicvaluechanged",t._onNotificationCallback)})),t.onConnectedCallback(),e.abrupt("return",t.device);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),t.onErrorCallback(e)}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),this.onNotificationCallback=function(t){},this._onNotificationCallback=function(e){var n=t.decoder.decode(e.target.value),r=t.parseResponse(n),i="motor queue full";if(!r||null==r.data&&r.message.includes(i)){var o;r&&null!=r&&null!==(o=r.message)&&void 0!==o&&o.includes(i)&&console.log(i)}else{var s=t.queue.shift();if(s&&(s.callback(),0!==t.queue.length)){var a=t.queue.slice(0,1)[0];t.writeValue(a.msg)}t.onNotificationCallback(r)}},this.writeValue=function(e){return new Promise((function(n){t.rxchar.writeValue(t.encoder.encode(e)),n(),setTimeout((function(){n()}),50)}))},this.parseResponse=function(e){var n=!1;if(-1!=e.indexOf("{")&&0==t.readBuffer.length?(t.lastCommand=e.slice(0,e.indexOf("{")),-1!=e.lastIndexOf("}")?(t.readBuffer.push(e.substring(e.indexOf("{"),e.lastIndexOf("}")+1)),n=!0):t.readBuffer.push(e.substring(e.indexOf("{")))):-1!=e.lastIndexOf("}")?(t.readBuffer.push(e.substring(0,e.lastIndexOf("}")+1)),n=!0):0!=t.readBuffer.length&&t.readBuffer.push(e),n){var r=t.readBuffer.join("");return t.readBuffer=[],(e=JSON.parse(r)).command=t.lastCommand,t.readBuffer=[],e}},this.onConnectedCallback=function(){},this.onErrorCallback=function(){},this.sendMessage=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};"\n"!=e[e.length-2]&&(e+="\n");var r="motors vibrate";e.includes(r)||t.queue.push({msg:e,callback:n}),(t.queue.length<=1||e.includes(r))&&t.writeValue(e)},this.disconnect=function(){t.queue=[],setTimeout((function(){t.sendMessage("audio start\n",(function(){t.device.gatt.disconnect(),t.onDisconnectedCallback()}))}),50)},this.onDisconnectedCallback=function(){}};function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jr(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Mr(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){jr(o,r,i,s,a,"next",t)}function a(t){jr(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Lr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ur=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};Lr(this,t),this.init=function(){var t=Mr(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.deviceType="other",n.device=new Nr((function(t){if(t&&t.command.includes("auth as developer")){var e=document.getElementById("neosensory-termsDisplay");e&&(e.innerHTML="To use your Neosensory Buzz on The Brains@Play Platform, please agree to Neosensory Inc's Developer Terms and Conditions, which can be viewed at <a href='https://neosensory.com/legal/dev-terms-service'>https://neosensory.com/legal/dev-terms-service</a>")}})),n._onConnected=function(){n.setupAtlas(e,r)};case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.connect=function(){return new Promise(function(){var t=Mr(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.device.connect();case 2:if(!t.sent){t.next=10;break}return t.next=6,n.agreeToTerms();case 6:t.sent?(n._onConnected(),n.onconnect(),e(!0)):(n.device.disconnect(),r("Did not agree to Neosensory Developer Terms.")),t.next=11;break;case 10:r("Device failed to connect.");case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},this.disconnect=function(){null!=n.ui&&n.ui.deleteNode(),n.device.disconnect(),n.ondisconnect(),n.atlas.settings.deviceConnected=!1},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=Math.floor(1e4*Math.random()),r=function(){return"\n            <br>\n            <div id='"+e+"buzzControls'>\n                <h3>Control Panel</h3>\n                <hr>\n                <div style=\"display: flex; flex-wrap: wrap;\">\n                    <input id='"+e+"buzzcmd' type='text' placeholder='device info'></input><button id='"+e+"sendcmd'>Send</button>\n                </div>\n            </div>\n            "},i=function(){document.getElementById(e+"sendcmd").onclick=function(){n.device.sendCommand(document.getElementById(e+"buzzcmd").value)}};n.ui=new x(r,t,void 0,i)},this.agreeToTerms=function(){return new Promise(function(){var t=Mr(regeneratorRuntime.mark((function t(e,r){var i,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=Math.floor(1e4*Math.random()),o=function(){return"\n            <div id='"+i+'buzzTerms\' style="position: absolute; width: 100vw; height: 100vh; z-index: 10000; padding: 50px; background: rgba(0,0,0,0.7)">\n                <h3>Agree To Terms</h3>\n                <hr>\n                <div id=\'neosensory-termsDisplay\' style="padding: 25px;"></div>\n                <div style="display: flex; flex-wrap: wrap;">\n                    <button id=\''+i+"accept' class=\"brainsatplay-default-button\">Accept</button>\n                    <button id='"+i+'deny\' class="brainsatplay-default-button">Deny</button>\n                </div>\n            </div>\n            '},s=function(){n.device.requestAuthorization(),document.getElementById(i+"accept").onclick=function(){n.device.acceptTerms(),n.terms.deleteNode(),e(!0)},document.getElementById(i+"deny").onclick=function(){n.terms.deleteNode(),e(!1)}},n.terms=new x(o,document.body,void 0,s);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},this.mode=e,this.atlas=null,this.device=null,this.filters=[],this.ui=null,this.onconnect=r,this.ondisconnect=i}var e,n;return e=t,(n=[{key:"setupAtlas",value:function(t,e){!0===e?(this.atlas=new K(location+":"+this.mode,{},"neosensory_buzz",!1,!0,t.analysis),t.useAtlas=!0):"object"===Rr(e)&&(this.atlas=e,t.useAtlas=!0),this.atlas.settings.deviceConnected=!0}}])&&Fr(e.prototype,n),t}();function Vr(t){return function(t){if(Array.isArray(t))return zr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return zr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qr(t){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wr(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Gr(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Wr(o,r,i,s,a,"next",t)}function a(t){Wr(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Hr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kr=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;Hr(this,t),this.init=function(){var t=Gr(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.sps=256,e.deviceType="eeg",e.eegChannelTags="8",n.info=e,n._onConnected=function(){n.setupAtlas(r,e)};case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.info;if(!0===t){var r="10_20";n.atlas=new K(location+":"+n.mode,{eegshared:{eegChannelTags:e.eegChannelTags,sps:e.sps}},r,!0,!0,e.analysis),e.useAtlas=!0}else if("object"===qr(t)){var i;n.atlas=t,n.atlas.data.eegshared.sps=e.sps,n.atlas.data.eegshared.frequencies=n.atlas.bandpassWindow(0,128,.5*e.sps),n.atlas.data.eegshared.bandFreqs=n.atlas.getBandFreqs(n.atlas.data.eegshared.frequencies),n.atlas.data.eeg=n.atlas.gen10_20Atlas(e.eegChannelTags),e.eegChannelTags=[],n.atlas.data.eeg.forEach((function(t,n){e.eegChannelTags.push({ch:n,tag:t.tag,analyze:!0})})),null==n.atlas.data.eegshared.eegChannelTags&&(n.atlas.data.eegshared.eegChannelTags=e.eegChannelTags),n.atlas.data.coherence=n.atlas.genCoherenceMap(e.eegChannelTags),n.atlas.settings.coherence=!0,n.atlas.settings.eeg=!0,e.useAtlas=!0,e.analysis.length>0&&((i=n.atlas.settings.analysis).push.apply(i,Vr(e.analysis)),n.atlas.settings.analyzing||(n.atlas.settings.analyzing=!0,n.atlas.analyzer()))}Array.isArray(e.eegChannelTags)||(e.eegChannelTags=n.atlas.data.eegshared.eegChannelTags),!0===e.useFilters&&e.eegChannelTags.forEach((function(t,r){"other"!==t.tag?n.filters.push(new ct(t.ch,e.sps,!0,1)):n.filters.push(new ct(t.ch,e.sps,!1,1))}))},this._onConnected=function(){},this.connect=function(){n._onConnected(),n.atlas.data.eegshared.startTime=Date.now(),n.atlas.settings.deviceConnected=!0,!0!==n.atlas.settings.analyzing&&n.info.analysis.length>0&&(n.atlas.settings.analyzing=!0,setTimeout((function(){n.atlas.analyzer()}),1200)),n.onconnect(),n.simulateData()},this.disconnect=function(){n.ondisconnect(),n.ui&&n.ui.deleteNode(),n.atlas.settings.deviceConnected=!1,null!=("undefined"==typeof window?"undefined":qr(window))&&window.cancelAnimationFrame(n.loop),n.looping=!1},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;if(Math.floor(1e4*Math.random()),"replay"===n.mode){var e=function(){return"\n                "},r=function(){};n.ui=new x(e,t,void 0,r)}},this.timeCorrection=function(t,e,r){var i=t.times[t.times.length-1];null==i&&(i=r-e.length/n.info.sps);var o=(r-i)/e.length;n.info.sps=1e3/o;var s=Array(e.length).fill(r);return s=s.map((function(t,e){return t-o*(s.length-e)}))},this.simulateData=function(){!function(){if(n.looping){if(n.info.useAtlas){var t=n.info.eegChannelTags.length;n.info.eegChannelTags.forEach((function(e,r){var i,o,s=n.atlas.getEEGDataByTag(e.tag),a=s.times[s.times.length-1];isNaN(a)&&(a=Date.now()-100);var u=Math.floor(n.info.sps*(Date.now()-a)/1e3),c=Array(u).fill(Date.now());c=c.map((function(t,e){return t-n.info.sps/1e3*(c.length-e)}));var l=[];c.forEach((function(e){var n=Math.floor(1+r/t*39);l.push(200*Math.sin(2*Math.PI*n*e/1e3))})),(i=s.times).push.apply(i,Vr(c)),(o=s.raw).push.apply(o,l),s.count+=l.length}))}"undefined"==typeof window?setTimeout((function(){n.simulateData}),100):setTimeout(n.loop=requestAnimationFrame(n.simulateData),100)}}()},this.atlas=null,this.mode=e,this.device=null,this.filters=[],this.onconnect=r,this.ondisconnect=i,this.loop,this.looping=!0}var e,n;return e=t,(n=[{key:"replayData",value:function(){}},{key:"addControls",value:function(){}}])&&Yr(e.prototype,n),t}();function Qr(t){return function(t){if(Array.isArray(t))return Jr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Jr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Xr=function(t,e){t.info.eegChannelTags.forEach((function(n,r){var i,o,s=t.atlas.getEEGDataByChannel(n.ch),a=e.raw[r];if((i=s.raw).push.apply(i,Qr(a)),(o=s.times).push.apply(o,Qr(e.times)),!0===t.info.useFilters){var u,c=new Array(a.length).fill(0);void 0!==t.filters[n.ch]&&a.forEach((function(e,r){c[r]=t.filters[n.ch].apply(e)})),(u=s.filtered).push.apply(u,Qr(c))}}))};function Zr(t){return function(t){if(Array.isArray(t))return $r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ti(t){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function ni(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){ei(o,r,i,s,a,"next",t)}function a(t){ei(o,r,i,s,a,"throw",t)}s(void 0)}))}}function ri(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ii=n(942),oi=n.n(ii);function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ai(t){return function(t){if(Array.isArray(t))return ui(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ui(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ci(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function li(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){ci(o,r,i,s,a,"next",t)}function a(t){ci(o,r,i,s,a,"throw",t)}s(void 0)}))}}function hi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fi(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function pi(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){fi(o,r,i,s,a,"next",t)}function a(t){fi(o,r,i,s,a,"throw",t)}s(void 0)}))}}function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.onDecodedCallback,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onConnectedCallback,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onDisconnectedCallback,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.decode,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e7;yi(this,t),this.onDecodedCallback=e,this.onConnectedCallback=n,this.onDisconnectedCallback=r,this.decode=i,this.connected=!1,this.subscribed=!1,this.buffer="",this.startByte=160,this.stopByte=192,this.searchString=new Uint8Array([this.stopByte,this.startByte]),this.readRate=1,this.readBufferSize=2e3,this.decoder=new TextDecoder,this.sps=500,this.nChannels=32,this.nPeripheralChannels=6,this.updateMs=1e3/this.sps,this.stepSize=1/Math.pow(2,24),this.vref=1.2,this.gain=32,this.vscale=this.vref/this.gain*this.stepSize,this.uVperStep=this.vref/this.gain*this.stepSize*1e6,this.scalar=1/(1e6/(this.vref/this.gain*this.stepSize)),this.maxBufferedSamples=60*this.sps*2,this.data={count:0,startms:0,ms:[],A0:[],A1:[],A2:[],A3:[],A4:[],A5:[],A6:[],A7:[]},this.resetDataBuffers(),navigator.serial||console.error("`navigator.serial not found! Enable #enable-experimental-web-platform-features in chrome://flags (search 'experimental')"),this.port=null,this.reader=null,this.baudrate=o}var e,n,r,i,o,s,a;return e=t,(n=[{key:"resetDataBuffers",value:function(){for(var t in this.data.count=0,this.data.startms=0,this.data)"object"===di(this.data[t])&&(this.data[t]=new Array(this.maxBufferedSamples).fill(0))}},{key:"setScalar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/(Math.pow(2,23)-1),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4.5;this.stepSize=e,this.vref=n,this.gain=t,this.vscale=this.vref/this.gain*this.stepSize,this.uVperStep=this.vref/this.gain*this.stepSize*1e6,this.scalar=1/(1e6/(this.vref/this.gain*this.stepSize))}},{key:"getLatestData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A0",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e;return n<=1?this.data[t][this.data.count-1]:(n>this.data.count&&(n=this.data.count),this.data[t].slice(this.data.count-n,this.data.count))}},{key:"bytesToInt16",value:function(t,e){return 256*t+e}},{key:"int16ToBytes",value:function(t){return[255&t,t>>8&255]}},{key:"bytesToInt24",value:function(t,e,n){return 65536*t+256*e+n}},{key:"int24ToBytes",value:function(t){return[255&t,t>>8&255,t>>16&255]}},{key:"decode",value:function(){for(var t;(t=this.buffer.indexOf("\n"))>=0;){var e=this.buffer.substr(0,t+1).split("|");if(e.length>6){if(this.data.count++,this.data.ms[this.data.count-1]=parseInt(e[8]),0===this.startms&&(this.startms=this.data.ms[0]),this.data.A0[this.data.count-1]=parseInt(e[0]),this.data.A1[this.data.count-1]=parseInt(e[1]),this.data.A2[this.data.count-1]=parseInt(e[2]),this.data.A3[this.data.count-1]=parseInt(e[3]),this.data.A4[this.data.count-1]=parseInt(e[4]),this.data.A5[this.data.count-1]=parseInt(e[5]),this.data.A6[this.data.count-1]=parseInt(e[6]),this.data.A7[this.data.count-1]=parseInt(e[7]),this.data.count>this.maxBufferedSamples){for(var n in this.data)Array.isArray(this.data[n])&&(this.data[n].splice(0,5120),this.data[n].push(new Array(5120).fill(0)));this.data.count-=5120}this.onDecodedCallback(this.data.count)}this.buffer=this.buffer.substr(t+1)}}},{key:"onDecodedCallback",value:function(t){}},{key:"onConnectedCallback",value:function(){console.log("port connected!")}},{key:"onDisconnectedCallback",value:function(){console.log("port disconnected!")}},{key:"onReceive",value:function(t){this.buffer+=this.decoder.decode(t),this.decode()}},{key:"onPortSelected",value:(a=pi(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.baudrate,t.prev=1,t.prev=2,t.next=5,e.open({baudRate:n,bufferSize:this.readBufferSize});case 5:this.onConnectedCallback(),this.connected=!0,this.subscribed=!0,this.subscribe(e),t.next=19;break;case 11:return t.prev=11,t.t0=t.catch(2),t.next=15,e.open({baudrate:n,buffersize:this.readBufferSize});case 15:this.onConnectedCallback(),this.connected=!0,this.subscribed=!0,this.subscribe(e);case 19:t.next=25;break;case 21:t.prev=21,t.t1=t.catch(1),console.log(t.t1),this.connected=!1;case 25:case"end":return t.stop()}}),t,this,[[1,21],[2,11]])}))),function(t){return a.apply(this,arguments)})},{key:"subscribe",value:(s=pi(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.port.readable&&!0===this.subscribed&&(this.reader=e.readable.getReader(),(n=function(){var t=pi(regeneratorRuntime.mark((function t(){var i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.reader.read();case 3:if(i=t.sent,o=i.value,!i.done&&!1!==r.subscribed){t.next=9;break}return t.next=9,r.reader.releaseLock();case 9:if(o)try{r.onReceive(o)}catch(t){console.log(t)}!0===r.subscribed&&setTimeout((function(){n()}),r.readRate),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0),t.t0.message.includes("framing")||t.t0.message.includes("overflow")||t.t0.message.includes("overrun")||t.t0.message.includes("Overflow")||t.t0.message.includes("break")?(r.subscribed=!1,setTimeout(pi(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.reader){t.next=4;break}return t.next=3,r.reader.releaseLock();case 3:r.reader=null;case 4:r.subscribed=!0,r.subscribe(e);case 6:case"end":return t.stop()}}),t)}))),30)):t.t0.message.includes("parity")||t.t0.message.includes("Parity")?r.port&&(r.subscribed=!1,setTimeout(pi(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.reader){t.next=4;break}return t.next=3,r.reader.releaseLock();case 3:r.reader=null;case 4:return t.next=6,e.close();case 6:r.connected=!1,setTimeout((function(){r.onPortSelected(r.port)}),100);case 8:case"end":return t.stop()}}),t)}))),50)):r.closePort();case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}())());case 1:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"subscribeSafe",value:(o=pi(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:new Promise((function(t,r){for(;n.port.readable&&!0===n.subscribed;){n.reader=e.readable.getReader();for(var i=!0,o=new Promise((function(t,e){return n.reader.read()})),s=new Promise((function(t,e){setTimeout(t,100,"readfail")}));!0===i;)Promise.race([o,s]).then((function(t){if(console.log("newpromise"),"readfail"===t)console.log(t);else{var e=t.value;!0===t.done||!0===n.subscribed?new Promise((function(t,e){t(n.reader.releaseLock())})).then((function(){i=!1})):n.onReceive(e)}}))}t("not readable")}));case 1:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"closePort",value:(i=pi(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=r.length>0&&void 0!==r[0]?r[0]:this.port,this.port&&(this.subscribed=!1,setTimeout(pi(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.reader){t.next=4;break}return t.next=3,n.reader.releaseLock();case 3:n.reader=null;case 4:return t.next=6,e.close();case 6:n.port=null,n.connected=!1,n.onDisconnectedCallback();case 9:case"end":return t.stop()}}),t)}))),100));case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"setupSerialAsync",value:(r=pi(regeneratorRuntime.mark((function t(){var e,n=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:this.baudrate,t.next=4,navigator.serial.requestPort();case 4:this.port=t.sent,navigator.serial.addEventListener("disconnect",(function(t){n.closePort(n.port)})),this.onPortSelected(this.port,e);case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"asUint8Array",value:function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r>127)throw new TypeError("Only ASCII patterns are supported");e[n]=r}return e}return new Uint8Array(t)}},{key:"boyerMoore",value:function(t){var e=this,n=this.asUint8Array(t),r=n.length;if(0===r)throw new TypeError("patternBuffer must be at least 1 byte long");for(var i=new Int32Array(256),o=0;o<256;o++)i[o]=-1;for(var s=0;s<r;s++)i[n[s]]=s;var a=function(t,r,o){var s=e.asUint8Array(t);void 0===r&&(r=0),void 0===o&&(o=s.length);for(var a,u=n,c=i,l=o-u.length,h=u.length-1,f=r;f<=l;f+=a){a=0;for(var p=h;p>=0;p--){var d=s[f+p];if(u[p]!==d){a=Math.max(1,p-c[d]);break}}if(0===a)return f}return-1};return a.byteLength=n.byteLength,a}}])&&vi(e.prototype,n),t}();function bi(t){return function(t){if(Array.isArray(t))return mi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return mi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Si(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){_i(o,r,i,s,a,"next",t)}function a(t){_i(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Oi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ei=n(9954);function Ai(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ti(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ci(t){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ii(t){return function(t){if(Array.isArray(t))return xi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ti(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ti(t,e){if(t){if("string"==typeof t)return xi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xi(t,e):void 0}}function xi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ki(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Pi(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){ki(o,r,i,s,a,"next",t)}function a(t){ki(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Ni(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Bi=[{name:"Synthetic",id:"synthetic",company:"Brains@Play",analysis:["eegcoherence"],cls:Kr},{name:"Brainstorm",id:"brainstorm",company:"Brains@Play",analysis:["eegcoherence"],cls:function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onconnect,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.ondisconnect;ri(this,t),this.init=function(){var t=ni(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.info=e,t.abrupt("return",new Promise((function(t,i){var o=function(){r.session.createBrainstormBrowser(document.body,(function(i){r.subscription=i,r.setupAtlas(e,n),t(!0)}))};r.session.info.auth.authenticated?o():r.session.promptLogin(document.body,o)})));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.connect=ni(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(function t(){var e=r.session.getBrainstormData(r.subscription.username,"user");r.info.useAtlas&&e.length>0&&e.forEach((function(t){r.dataHandlers[t.format](r,t)})),r.animation=requestAnimationFrame(t)})(),r.atlas.settings.deviceConnected=!0,r.atlas.data.eegshared.startTime=Date.now(),r.atlas.settings.deviceConnected=!0,!0!==r.atlas.settings.analyzing&&r.info.analysis.length>0&&(r.atlas.settings.analyzing=!0,setTimeout((function(){r.atlas.analyzer()}),1200)),r.onconnect();case 7:case"end":return t.stop()}}),t)}))),this.disconnect=function(){r.ondisconnect(),r.ui&&r.ui.deleteNode(),r.session.unsubscribeFromUser(r.subscription.username),window.cancelAnimationFrame(r.animation),r.atlas.settings.deviceConnected=!1},this.setupAtlas=function(t,e){if(t.sps=r.subscription.props.sps,t.deviceType=r.subscription.props.deviceType,t.eegChannelTags=r.subscription.props.eegChannelTags,console.log(t.eegChannelTags),!0===e)r.atlas=new K(location+":"+r.mode,{eegshared:{eegChannelTags:t.eegChannelTags,sps:t.sps}},"10_20",!0,!0,t.analysis),t.useAtlas=!0;else if("object"===ti(e)){var n;r.atlas=e,r.atlas.data.eegshared.sps=t.sps,r.atlas.data.eegshared.frequencies=r.atlas.bandpassWindow(0,128,.5*t.sps),r.atlas.data.eegshared.bandFreqs=r.atlas.getBandFreqs(r.atlas.data.eegshared.frequencies),r.atlas.data.eeg=r.atlas.gen10_20Atlas(t.eegChannelTags),r.atlas.data.coherence=r.atlas.genCoherenceMap(t.eegChannelTags),r.atlas.settings.coherence=!0,r.atlas.settings.eeg=!0,t.useAtlas=!0,t.analysis.length>0&&((n=r.atlas.settings.analysis).push.apply(n,Zr(t.analysis)),r.atlas.settings.analyzing||(r.atlas.settings.analyzing=!0,r.atlas.analyzer()))}!0===t.useFilters&&t.eegChannelTags.forEach((function(e,n){"other"!==e.tag?r.filters.push(new ct(e.ch,t.sps,!0,1)):r.filters.push(new ct(e.ch,t.sps,!1,1))}))},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){arguments.length>0&&void 0!==arguments[0]||document.body},this.atlas=null,this.mode=e,this.session=n,this.subscription,this.dataHandlers={brainflow:Xr},this.device=null,this.filters=[],this.onconnect=i,this.ondisconnect=o}},{name:"Notion",id:"notion",company:"Neurosity",analysis:["eegcoherence"],cls:function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;Ni(this,t),this.init=function(){var t=Pi(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.device=new Ei.Notion({autoSelectDevice:!1}),n.info=e,t.abrupt("return",new Promise((function(t,i){n.promptLogin(document.body,(function(i){n.setupAtlas(e,r).then((function(){t(!0)}))}))})));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.timeCorrection=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"back",o=t.times[t.times.length-1];null==o&&(o=r-e.length/n.info.sps);var s=(r-o)/e.length;n.info.sps=1e3/s;var a=Array(e.length).fill(r);return a="back"===i?a.map((function(t,e){return t-s*(a.length-e)})):a.map((function(t,e){return t+s*e}))},this.connect=Pi(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.device.brainwaves("raw").subscribe((function(t){console.log(t);var e=t.data;n.info.useAtlas&&e.forEach((function(e,r){var i,o,s=n.atlas.getEEGDataByChannel(r),a=n.timeCorrection(s,e,t.info.startTime);if((i=s.times).push.apply(i,Ii(a)),(o=s.raw).push.apply(o,Ii(e)),s.count+=e.length,!0===n.info.useFilters){var u,c=new Array(e.length).fill(0);void 0!==n.filters[r]&&e.forEach((function(t,e){c[e]=n.filters[r].apply(t)})),(u=s.filtered).push.apply(u,Ii(c))}}))})),n.atlas.data.eegshared.startTime=Date.now(),n.atlas.settings.deviceConnected=!0,!0!==n.atlas.settings.analyzing&&n.info.analysis.length>0&&(n.atlas.settings.analyzing=!0,setTimeout((function(){n.atlas.analyzer()}),1200)),n.onconnect();case 5:case"end":return t.stop()}}),t)}))),this.disconnect=function(){n.device.disconnect(),n.device.logout().then((function(){console.log("logged out")})).catch((function(t){console.error("Log out error",t)})),n.connected&&(document.getElementById("brainsatplay-header-".concat(n.mode.split("_")[0])).innerHTML="Notion",n.ondisconnect(),n.ui&&n.ui.deleteNode(),n.atlas.settings.deviceConnected=!1)},this.setupAtlas=function(){var t=Pi(regeneratorRuntime.mark((function t(e,r){var i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.device.getInfo();case 2:return i=t.sent,e.sps=i.samplingRate,e.deviceType="eeg",e.eegChannelTags=[],i.channelNames.forEach((function(t,n){e.eegChannelTags.push({tag:t,ch:n,analyze:!0})})),!0===r?(n.atlas=new K(location+":"+n.mode,{eegshared:{eegChannelTags:e.eegChannelTags,sps:e.sps}},"10_20",!0,!0,e.analysis),e.useAtlas=!0):"object"===Ci(r)&&(n.atlas=r,n.atlas.data.eegshared.sps=e.sps,n.atlas.data.eegshared.frequencies=n.atlas.bandpassWindow(0,128,.5*e.sps),n.atlas.data.eegshared.bandFreqs=n.atlas.getBandFreqs(n.atlas.data.eegshared.frequencies),n.atlas.data.eeg=n.atlas.gen10_20Atlas(e.eegChannelTags),n.atlas.data.coherence=n.atlas.genCoherenceMap(e.eegChannelTags),n.atlas.settings.coherence=!0,n.atlas.settings.eeg=!0,e.useAtlas=!0,e.analysis.length>0&&((o=n.atlas.settings.analysis).push.apply(o,Ii(e.analysis)),n.atlas.settings.analyzing||(n.atlas.settings.analyzing=!0,n.atlas.analyzer()))),!0===e.useFilters&&e.eegChannelTags.forEach((function(t,r){"other"!==t.tag?n.filters.push(new ct(t.ch,e.sps,!0,1)):n.filters.push(new ct(t.ch,e.sps,!1,1))})),t.abrupt("return",n.atlas);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){arguments.length>0&&void 0!==arguments[0]||document.body},this.selectDevice=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return new Promise((function(i,o){var s=new x((function(){return'\n\t\t\t<div id="'.concat(n.id,'-deviceBrowser" style="z-index: 1000; background: black; width:100%; height: 100%; position: absolute; top: 0; left: 0; display:flex; align-items: center; justify-content: center; opacity: 0;">\n\t\t\t\t<div id="').concat(n.id,'-choiceDisplay" style="flex-grow: 1;">\n\t\t\t\t\t<h1>Select your Device</h1>\n\t\t\t\t\t<div style="display: flex;">\n\t\t\t\t\t\t<div id="').concat(n.id,'-deviceDiv" style="flex-grow: 1; overflow-y: scroll; border: 1px solid white;">\n\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button id="').concat(n.id,'-exitBrowser" class="brainsatplay-default-button" style="position: absolute; bottom:25px; right: 25px;">Go Back</button>\n\t\t\t</div>')}),e,void 0,(function(){var e=document.getElementById("".concat(n.id,"-deviceBrowser")),o=e.querySelector("[id='".concat(n.id,"-deviceDiv']")),a=function(){e.style.opacity="0",window.removeEventListener("resize",u),setTimeout((function(){s.deleteNode()}),1e3)},u=function(){var t=document.getElementById("".concat(n.id,"-deviceBrowser")),e=t.querySelector("[id='".concat(n.id,"-choiceDisplay']")),r=t.querySelector("[id='".concat(n.id,"-deviceDiv']"));t.style.padding="".concat(50,"px"),r.style.height="".concat(window.innerHeight-100-(e.offsetHeight-r.offsetHeight),"px")};e.querySelector("[id='".concat(n.id,"-exitBrowser']")).onclick=a,u(),window.addEventListener("resize",u),e.style.transition="opacity ".concat(1,"s"),e.style.opacity="1",function(){o.innerHTML="";var e=function(){n.style.background="rgb(35,35,35)",n.style.cursor="pointer"},s=function(){n.style.background="rgb(20,20,20)",n.style.cursor="default"};t.forEach((function(t){o.innerHTML+='\n                    <div  id="'.concat(n.id,"-device-").concat(t.deviceId,'" class="neurosity-device" style="').concat("\n\t\t\t\tbackground: rgb(20,20,20);\n\t\t\t\tpadding: 25px;\n\t\t\t\tborder: 1px solid black;\n\t\t\t\ttransition: 0.5s;\n\t\t\t",'" onMouseOver="(').concat(e,')()" onMouseOut="(').concat(s,')()">\n                    <p style="font-size: 60%;">').concat(t.model,"</p>\n                    <p>").concat(t.deviceNickname,'</p>\n                    <p style="font-size: 80%;">').concat(t.deviceId,"</p>\n                    </div>")}));var u,c=o.querySelectorAll(".neurosity-device"),l=document.getElementById("brainsatplay-header-".concat(n.mode.split("_")[0])),h=Ai(c);try{var f=function(){var t=u.value,e=t.id.split("".concat(n.id,"-device-"))[1];t.onclick=function(){var t=Pi(regeneratorRuntime.mark((function t(o){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.device.selectDevice((function(t){return t.find((function(t){return t.deviceId===e}))}));case 2:s=t.sent,l.innerHTML=s.deviceNickname,n.connected=!0,i(s),r(),a();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};for(h.s();!(u=h.n()).done;)f()}catch(t){h.e(t)}finally{h.f()}}()}))}))},this.promptLogin=Pi(regeneratorRuntime.mark((function t(){var e,r,i,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:document.body,r=o.length>1&&void 0!==o[1]?o[1]:function(){},i=new Promise((function(t,i){var o=new x((function(){return'\n\t\t<div id="'.concat(n.id,'login-page" class="brainsatplay-default-container" style="z-index: 1000; opacity: 0; transition: opacity 1s;">\n\t\t\t<div>\n\t\t\t\t<h2>Access Notion Data</h2>\n\t\t\t\t<div id="').concat(n.id,'login-container" class="form-container">\n\t\t\t\t\t<div id="').concat(n.id,'login" class="form-context">\n\t\t\t\t\t\t<p id="').concat(n.id,'login-message" class="small"></p>\n\t\t\t\t\t\t<div class=\'flex\'>\n\t\t\t\t\t\t\t<form id="').concat(n.id,'login-form" action="">\n                                <div class="login-element" style="margin-left: 0px; margin-right: 0px">\n                                    <input type="text" name="email" autocomplete="off" placeholder="Enter your email"/>\n                                    <br>\n                                    <input type="password" name="password" autocomplete="off" placeholder="Enter your password"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="login-buttons" style="justify-content: flex-start;">\n\t\t\t\t\t\t\t<div id="').concat(n.id,'login-button" class="brainsatplay-default-button">Sign In</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t')}),e,void 0,(function(){var e=document.getElementById("".concat(n.id,"login-page")),i=e.querySelector("[id='".concat(n.id,"login-button']")),s=e.querySelector("[id='".concat(n.id,"login-form']")),a=s.querySelector("input");s.addEventListener("keyup",(function(t){13===t.keyCode&&t.preventDefault()})),a.addEventListener("keyup",(function(t){13===t.keyCode&&(t.preventDefault(),i.click())})),i.onclick=function(){var i,a={},u=Ai(new FormData(s).entries());try{for(u.s();!(i=u.n()).done;){var c=i.value;a[c[0]]=c[1]}}catch(t){u.e(t)}finally{u.f()}n.device.login(a).then((function(t){console.log(t)})).catch((function(t){console.error(t)})).finally(function(){var i=Pi(regeneratorRuntime.mark((function i(s){var a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return console.log(s),i.next=3,n.device.getDevices();case 3:return a=i.sent,i.next=6,n.selectDevice(a,document.body);case 6:t(!0),r(),e.style.opacity="0",setTimeout((function(){o.deleteNode()}),1e3);case 10:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}())},e.style.transition="opacity 1s",e.style.opacity="1"}))})),t.abrupt("return",i);case 4:case"end":return t.stop()}}),t)}))),this.atlas=null,this.mode=e,this.connected=!1,this.device=null,this.filters=[],this.onconnect=r,this.ondisconnect=i;var o=function t(){n.disconnect(),window.removeEventListener("beforeunload",t)};window.addEventListener("beforeunload",o)}},{name:"Muse 2",id:"muse",company:"InteraXon",analysis:["eegcoherence"],variants:["","Aux"],cls:Ot},{name:"Muse S",id:"muse",company:"InteraXon",analysis:["eegcoherence"],variants:[""],cls:Ot},{name:"Ganglion",id:"ganglion",company:"OpenBCI",analysis:["eegcoherence"],cls:function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;Ar(this,t),this.init=function(){var t=Er(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.info=e,n.info.sps=200,n.info.deviceType="eeg",n.info.eegChannelTags=[{ch:0,tag:"FP1",analyze:!0},{ch:1,tag:"FP2",analyze:!0},{ch:2,tag:"C3",analyze:!0},{ch:3,tag:"C4",analyze:!0}];case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.info;if(n._onConnected=function(){n.setupAtlas(t,e)},!0===n.info.useFilters&&n.info.eegChannelTags.forEach((function(t,e){"other"!==t.tag?n.filters.push(new ct(t.ch,n.info.sps,!0,uvPerStep)):n.filters.push(new ct(t.ch,n.info.sps,!1,uvPerStep)),n.filters[n.filters.length-1].useScaling=!0,n.filters[n.filters.length-1].notch60.pop()})),!0===t){var r="10_20";n.atlas=new K(location+":"+n.mode,{eegshared:{eegChannelTags:n.info.eegChannelTags,sps:n.info.sps}},r,!0,!0,n.info.analysis),n.info.useAtlas=!0}else if("object"===Sr(t)){var i;n.atlas=t,n.atlas.data.eegshared.eegChannelTags=n.info.eegChannelTags,n.atlas.data.eegshared.sps=n.info.sps,n.atlas.data.eegshared.frequencies=n.atlas.bandpassWindow(0,128,.5*n.info.sps),n.atlas.data.eegshared.bandFreqs=n.atlas.getBandFreqs(n.atlas.data.eegshared.frequencies),n.atlas.data.eeg=n.atlas.gen10_20Atlas(),n.atlas.data.coherence=n.atlas.genCoherenceMap(n.info.eegChannelTags),n.atlas.data.eegshared.eegChannelTags.forEach((function(t,e){void 0===n.atlas.getEEGDataByTag(t.tag)&&n.atlas.addEEGCoord(t.ch)})),n.atlas.settings.coherence=!0,n.atlas.settings.eeg=!0,n.info.useAtlas=!0,e.analysis.length>0&&((i=n.atlas.settings.analysis).push.apply(i,wr(n.info.analysis)),n.atlas.settings.analyzing||(n.atlas.settings.analyzing=!0,n.atlas.analyzer()))}},this._onConnected=function(){},this.connect=Er(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.device=new mr,t.next=3,n.device.connect();case 3:return t.next=5,n.device.start();case 5:n._onConnected(),n.device.stream.subscribe((function(t){if(n.info.useAtlas){var e=t.timestamp;t.data.forEach((function(t,r){var i=n.atlas.getEEGDataByChannel(r);if(i.times.push(e),i.raw.push(t),i.count++,!0===n.info.useFilters){var o=0;void 0!==n.filters[r]&&(o=n.filters[r].apply(t)),i.filtered.push(o)}}))}})),!0===n.info.useAtlas&&(n.atlas.data.eegshared.startTime=Date.now(),!0!==n.atlas.settings.analyzing&&n.info.analysis.length>0&&(n.atlas.settings.analyzing=!0,setTimeout((function(){n.atlas.analyzer()}),1200))),n.atlas.settings.deviceConnected=!0,n.onconnect();case 10:case"end":return t.stop()}}),t)}))),this.disconnect=function(){n.device.disconnect(),n.atlas.settings.analyzing=!1,n.atlas.settings.deviceConnected=!1,n.ui&&n.ui.deleteNode(),n.ondisconnect()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=(Math.floor(1e4*Math.random()),function(){return"\n            "}),r=function(){};n.ui=new x(e,t,void 0,r)},this.atlas=null,this.mode=e,this.device=null,this.filters=[],this.onconnect=r,this.ondisconnect=i}},{name:"Cyton",id:"cyton",company:"OpenBCI",analysis:["eegcoherence"],variants:["","Daisy"],cls:function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cyton_daisy",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;te(this,t),this.init=$t(regeneratorRuntime.mark((function t(){var n,r,i,o,s,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=a.length>0&&void 0!==a[0]?a[0]:{sps:null,deviceType:null,eegChannelTags:null,analysis:["eegfft"],useAtlas:void 0},r=!(a.length>1&&void 0!==a[1])||a[1],n.sps=250,n.deviceType="eeg",i=function(t){e.atlas.data.eegshared.eegChannelTags.forEach((function(r,i){var o,s,a,u,c=e.device.getLatestData("A"+r.ch,t),l=new Array(c.length).fill(0);if("other"!==r.tag&&!0===n.useFilters)e.filters.forEach((function(t,e){t.channel===r.ch&&c.forEach((function(e,n){l[n]=t.apply(e)}))})),!0===n.useAtlas&&((u=null!==r.tag?e.atlas.getEEGDataByTag(r.tag):e.atlas.getEEGDataByChannel(r.ch)).count+=t,(o=u.times).push.apply(o,Jt(e.device.data.ms.slice(e.device.data.count-t,e.device.data.count))),(s=u.filtered).push.apply(s,Jt(l)),(a=u.raw).push.apply(a,Jt(c)));else if(!0===n.useAtlas){var h,f,p=e.atlas.getEEGDataByChannel(r.ch);p.count+=t,(h=p.times).push.apply(h,Jt(e.device.data.ms.slice(e.device.data.count-t,e.device.data.count))),(f=p.raw).push.apply(f,Jt(c))}}))},o=function(){e.setupAtlas(r,n),!0===n.useAtlas&&(e.atlas.data.eegshared.startTime=Date.now(),!0!==e.atlas.settings.analyzing&&n.analysis.length>0&&(e.atlas.settings.analyzing=!0,setTimeout((function(){e.atlas.analyzer()}),1200))),e.atlas.settings.deviceConnected=!0,e.onconnect()},s=function(){e.atlas.settings.analyzing=!1,e.atlas.settings.deviceConnected=!1,e.ondisconnect()},e.mode.indexOf("Daisy")>-1?e.device=new Kt(i,o,s,"daisy"):e.device=new Kt(i,o,s,"single");case 9:case"end":return t.stop()}}),t)}))),this.setupAtlas=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;if(!0===n.useFilters&&eegChannelTags.forEach((function(t,r){"other"!==t.tag?e.filters.push(new ct(t.ch,n.sps,!0,e.device.uVperStep)):e.filters.push(new ct(t.ch,n.sps,!1,e.device.uVperStep))})),n.eegChannelTags=eegChannelTags,!0===t){var r="10_20";e.atlas=new K(location+":"+e.mode,{eegshared:{eegChannelTags:n.eegChannelTags,sps:n.sps}},r,!0,!0,n.analysis),n.useAtlas=!0}else if("object"===Qt(t)){var i;e.atlas=t,e.atlas.data.eegshared.eegChannelTags=n.eegChannelTags,e.atlas.data.eegshared.sps=n.sps,e.atlas.data.eegshared.frequencies=e.atlas.bandpassWindow(0,128,.5*n.sps),e.atlas.data.eegshared.bandFreqs=e.atlas.getBandFreqs(e.atlas.data.eegshared.frequencies),e.atlas.data.eeg=e.atlas.gen10_20Atlas(),e.atlas.data.coherence=e.atlas.genCoherenceMap(n.eegChannelTags),e.atlas.data.eegshared.eegChannelTags.forEach((function(t,n){void 0===e.atlas.getEEGDataByTag(t.tag)&&e.atlas.addEEGCoord(t.ch)})),e.atlas.settings.coherence=!0,e.atlas.settings.eeg=!0,n.useAtlas=!0,n.analysis.length>0&&((i=e.atlas.settings.analysis).push.apply(i,Jt(n.analysis)),e.atlas.settings.analyzing||(e.atlas.settings.analyzing=!0,e.atlas.analyzer()))}},this.connect=$t(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.device.setupSerialAsync();case 2:case"end":return t.stop()}}),t)}))),this.disconnect=function(){e.ui&&e.ui.deleteNode(),e.device.closePort()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=(Math.floor(1e4*Math.random()),function(){return"\n            "}),r=function(){};e.ui=new x(n,t,void 0,r)},this.atlas=null,this.mode=n,this.device=null,this.filters=[],this.onconnect=r,this.ondisconnect=i}},{name:"HEGduino",id:"hegduino",company:"HEGAlpha",analysis:[],variants:["USB","Bluetooth"],cls:Vt},{name:"FreeEEG32",id:"freeeg32",company:"Neuroidss",analysis:["eegcoherence"],variants:["2","19"],cls:function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"freeeeg32_2",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;yt(this,t),this.init=function(){var t=dt(regeneratorRuntime.mark((function t(n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.info=n,n.sps=512,n.deviceType="eeg","freeeeg32_2"===e.mode?n.eegChannelTags=[{ch:4,tag:"FP2",analyze:!0},{ch:24,tag:"FP1",analyze:!0},{ch:8,tag:"other",analyze:!1}]:"freeeeg32_19"===e.mode?n.eegChannelTags=[{ch:4,tag:"FP2",analyze:!0},{ch:24,tag:"FP1",analyze:!0},{ch:0,tag:"O2",analyze:!0},{ch:1,tag:"T6",analyze:!0},{ch:2,tag:"T4",analyze:!0},{ch:3,tag:"F8",analyze:!0},{ch:5,tag:"F4",analyze:!0},{ch:6,tag:"C4",analyze:!0},{ch:7,tag:"P4",analyze:!0},{ch:25,tag:"F3",analyze:!0},{ch:26,tag:"C3",analyze:!0},{ch:27,tag:"P3",analyze:!0},{ch:28,tag:"O1",analyze:!0},{ch:29,tag:"T5",analyze:!0},{ch:30,tag:"T3",analyze:!0},{ch:31,tag:"F7",analyze:!0},{ch:16,tag:"FZ",analyze:!0},{ch:12,tag:"PZ",analyze:!0},{ch:8,tag:"other",analyze:!1}]:n.eegChannelTags=[{ch:4,tag:"FP2",analyze:!0},{ch:24,tag:"FP1",analyze:!0},{ch:8,tag:"other",analyze:!1}],e.device=new et((function(t){e.atlas.data.eegshared.eegChannelTags.forEach((function(r,i){var o,s,a,u,c=e.device.getLatestData("A"+r.ch,t),l=new Array(c.length).fill(0);if("other"!==r.tag&&!0===n.useFilters)e.filters.find((function(t,e){if(t.channel===r.ch)return c.forEach((function(e,n){l[n]=t.apply(e)})),!0})),!0===n.useAtlas&&((u=null!==r.tag?e.atlas.getEEGDataByTag(r.tag):e.atlas.getEEGDataByChannel(r.ch)).count+=t,(o=u.times).push.apply(o,ht(e.device.data.ms.slice(e.device.data.count-t,e.device.data.count))),(s=u.filtered).push.apply(s,ht(l)),(a=u.raw).push.apply(a,ht(c)));else if(!0===n.useAtlas){var h,f,p=e.atlas.getEEGDataByChannel(r.ch);p.count+=t,(h=p.times).push.apply(h,ht(e.device.data.ms.slice(e.device.data.count-t,e.device.data.count))),(f=p.raw).push.apply(f,ht(c))}}))}),(function(){e.setupAtlas(r,n),!0===n.useAtlas&&(e.atlas.data.eegshared.startTime=Date.now(),!0!==e.atlas.settings.analyzing&&n.analysis.length>0&&(e.atlas.settings.analyzing=!0,e.atlas.settings.deviceConnected=!0,setTimeout((function(){e.atlas.analyzer()}),1200)),e.onconnect())}),(function(){e.atlas.settings.analyzing=!1,e.ondisconnect()}));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(t,n){if(!0===n.useFilters&&n.eegChannelTags.forEach((function(t,r){"other"!==t.tag?e.filters.push(new ct(t.ch,n.sps,!0,e.device.uVperStep)):e.filters.push(new ct(t.ch,n.sps,!1,e.device.uVperStep)),e.filters[e.filters.length-1].useScaling=!0})),!0===t)e.atlas=new K(location+":"+e.mode,{eegshared:{eegChannelTags:n.eegChannelTags,sps:n.sps}},"10_20",!0,!0,n.analysis),n.useAtlas=!0;else if("object"===lt(t)){var r;e.atlas=t,e.atlas.data.eegshared.eegChannelTags=n.eegChannelTags,e.atlas.data.eegshared.sps=n.sps,e.atlas.data.eegshared.frequencies=e.atlas.bandpassWindow(0,128,.5*n.sps),e.atlas.data.eegshared.bandFreqs=e.atlas.getBandFreqs(e.atlas.data.eegshared.frequencies),e.atlas.data.eeg=e.atlas.gen10_20Atlas(),e.atlas.data.coherence=e.atlas.genCoherenceMap(n.eegChannelTags),e.atlas.data.eegshared.eegChannelTags.forEach((function(t,n){void 0===e.atlas.getEEGDataByTag(t.tag)&&e.atlas.addEEGCoord(t.ch)})),e.atlas.settings.coherence=!0,e.atlas.settings.eeg=!0,n.useAtlas=!0,n.analysis.length>0&&((r=e.atlas.settings.analysis).push.apply(r,ht(n.analysis)),e.atlas.settings.analyzing||(e.atlas.settings.analyzing=!0,e.atlas.analyzer()))}},this.connect=dt(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.device.setupSerialAsync();case 2:case"end":return t.stop()}}),t)}))),this.disconnect=function(){e.ui&&e.ui.deleteNode(),e.device.closePort()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){arguments.length>0&&void 0!==arguments[0]||document.body,Math.floor(1e4*Math.random())},this.atlas=null,this.mode=n,this.device=null,this.filters=[],this.info,this.onconnect=r,this.ondisconnect=i}},{name:"Buzz",id:"buzz",company:"Neosensory",analysis:[],cls:Ur},{name:"BCI2000",id:"bci2k",company:"BCI2000",analysis:["eegcoherence"],variants:["Operator","Data"],cls:function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;hi(this,t),this.init=function(){var t=li(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sps=256,e.deviceType="eeg",n.info=e,t.abrupt("return",new Promise((function(t,i){"bci2k_Operator"===n.mode?n.operator.connect("ws://127.0.0.1").then((function(){console.log("Connected to Operator layer through NodeJS server"),n.operator.execute("Reset System; Startup System localhost; Add State StimulusCode 4 0; Add State BrainClick 1 0; Add State Baseline 1 0; Add State TrialStart 1 0; Start executable SignalGenerator; Start executable DummyApplication; Start executable DummySignalProcessing; Set Parameter WSSourceServer *:20100; Wait for connected; Set Config; Start; "),n.connectToDataLayer(e,r).then((function(e){t(e)}))})):"bci2k_Data"===n.mode&&n.connectToDataLayer(e,r).then((function(e){t(e)}))})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.timeCorrection=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"back",o=t.times[t.times.length-1];null==o&&(o=r-e.length/n.info.sps);var s=(r-o)/e.length;n.info.sps=1e3/s;var a=Array(e.length).fill(r);return a="back"===i?a.map((function(t,e){return t-s*(a.length-e)})):a.map((function(t,e){return t+s*e}))},this.connectToDataLayer=function(){var t=li(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=li(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.device=new(oi().bciData),n.device.connect("ws://127.0.0.1:20100").then((function(t){n.device.onGenericSignal=function(t){n.info.useAtlas&&t.forEach((function(e,r){var i,o,s=n.atlas.getEEGDataByChannel(r),a=n.timeCorrection(s,t,Date.now(),"back");(i=s.times).push.apply(i,ai(a)),(o=s.raw).push.apply(o,ai(e)),s.count+=e.length}))},n.device.onStateFormat=function(t){return console.log(t)},n.device.onSignalProperties=function(t){null==n.atlas&&(n.info.eegChannelTags=t.channels.length,n.setupAtlas(n.info,r),n.onconnect()),e(!0)}}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(t,e){if(!0===e)n.atlas=new K(location+":"+n.mode,{eegshared:{eegChannelTags:t.eegChannelTags,sps:t.sps}},"10_20",!0,!0,t.analysis),t.useAtlas=!0;else if("object"===si(e)){var r;n.atlas=e,n.atlas.data.eegshared.eegChannelTags=t.eegChannelTags,n.atlas.data.eegshared.sps=t.sps,n.atlas.data.eegshared.frequencies=n.atlas.bandpassWindow(0,128,.5*t.sps),n.atlas.data.eegshared.bandFreqs=n.atlas.getBandFreqs(n.atlas.data.eegshared.frequencies),n.atlas.data.eeg=n.atlas.genMuseAtlas(),n.atlas.data.coherence=n.atlas.genCoherenceMap(t.eegChannelTags),n.atlas.settings.coherence=!0,n.atlas.settings.eeg=!0,t.useAtlas=!0,t.analysis.length>0&&((r=n.atlas.settings.analysis).push.apply(r,ai(t.analysis)),n.atlas.settings.analyzing||(n.atlas.settings.analyzing=!0,n.atlas.analyzer()))}Array.isArray(t.eegChannelTags)||(t.eegChannelTags=n.atlas.data.eegshared.eegChannelTags),console.log(t.eegChannelTags),!0===t.useFilters&&t.eegChannelTags.forEach((function(e,r){n.filters.push(new ct(e.ch,t.sps,!0,1))})),n.atlas.data.eegshared.startTime=Date.now(),n.atlas.settings.deviceConnected=!0,!0!==n.atlas.settings.analyzing&&n.info.analysis.length>0&&(n.atlas.settings.analyzing=!0,setTimeout((function(){n.atlas.analyzer()}),1200))},this._onConnected=function(){},this.connect=function(){},this.disconnect=function(){n.ui&&n.ui.deleteNode(),n.ondisconnect()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=(Math.floor(1e4*Math.random()),function(){return"\n            "}),r=function(){};n.ui=new x(e,t,void 0,r)},this.atlas=null,this.mode=e,this.operator=new(oi().bciOperator),this.filters=[],this.onconnect=r,this.ondisconnect=i}},{name:"8 Channel Proto",id:"8chproto",company:"Brains@Play",analysis:["eegcoherence"],cls:function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onconnect,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ondisconnect;Oi(this,t),this.init=function(){var t=Si(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.sps=500,e.deviceType="eeg",e.eegChannelTags=[{ch:0,tag:"FP1",analyze:!0},{ch:1,tag:"FP2",analyze:!0},{ch:2,tag:"FZ",analyze:!0},{ch:3,tag:"C3",analyze:!0},{ch:5,tag:"C4",analyze:!0},{ch:6,tag:"O1",analyze:!0},{ch:7,tag:"O2",analyze:!0}],n.device=new gi((function(t){t&&n.atlas.data.eegshared.eegChannelTags.forEach((function(r,i){var o,s=n.device.getLatestData("A"+r.ch,1),a=0;if("other"!==r.tag&&!0===e.useFilters)n.filters.find((function(t,e){if(t.channel===r.ch)return a=t.apply(s),!0})),!0===e.useAtlas&&((o=null!==r.tag?n.atlas.getEEGDataByTag(r.tag):n.atlas.getEEGDataByChannel(r.ch)).count++,o.times.push(n.device.data.ms[t]),o.filtered.push(a),o.raw.push(s));else if(!0===e.useAtlas){var u=n.atlas.getEEGDataByChannel(r.ch);u.count+=newLinesInt,u.times.push(n.device.data.ms[t]),u.raw.push(s)}}))}),(function(){n.setupAtlas(r,e),!0===e.useAtlas&&(n.atlas.data.eegshared.startTime=Date.now(),!0!==n.atlas.settings.analyzing&&e.analysis.length>0&&(n.atlas.settings.analyzing=!0,n.atlas.settings.deviceConnected=!0,setTimeout((function(){n.atlas.analyzer()}),1200)),n.onconnect())}),(function(){n.atlas.settings.analyzing=!1,n.ondisconnect()}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.setupAtlas=function(t,e){if(!0===e.useFilters&&e.eegChannelTags.forEach((function(t,r){"other"!==t.tag?n.filters.push(new ct(t.ch,e.sps,!0,n.device.uVperStep)):n.filters.push(new ct(t.ch,e.sps,!1,n.device.uVperStep)),n.filters[n.filters.length-1].useScaling=!0})),!0===t)n.atlas=new K(location+":"+n.mode,{eegshared:{eegChannelTags:e.eegChannelTags,sps:e.sps}},"10_20",!0,!0,e.analysis),e.useAtlas=!0;else if("object"===wi(t)){var r;n.atlas=t,n.atlas.data.eegshared.eegChannelTags=e.eegChannelTags,n.atlas.data.eegshared.sps=e.sps,n.atlas.data.eegshared.frequencies=n.atlas.bandpassWindow(0,128,.5*e.sps),n.atlas.data.eegshared.bandFreqs=n.atlas.getBandFreqs(n.atlas.data.eegshared.frequencies),n.atlas.data.eeg=n.atlas.gen10_20Atlas(),n.atlas.data.coherence=n.atlas.genCoherenceMap(e.eegChannelTags),n.atlas.data.eegshared.eegChannelTags.forEach((function(t,e){void 0===n.atlas.getEEGDataByTag(t.tag)&&n.atlas.addEEGCoord(t.ch)})),n.atlas.settings.coherence=!0,n.atlas.settings.eeg=!0,e.useAtlas=!0,e.analysis.length>0&&((r=n.atlas.settings.analysis).push.apply(r,bi(e.analysis)),n.atlas.settings.analyzing||(n.atlas.settings.analyzing=!0,n.atlas.analyzer()))}},this._onConnected=function(){},this.connect=function(){n.device.setupSerialAsync(1e6)},this.disconnect=function(){n.device.closePort()},this.onconnect=function(){},this.ondisconnect=function(){},this.addControls=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=(Math.floor(1e4*Math.random()),function(){return"\n            "}),r=function(){};n.ui=new x(e,t,void 0,r)},this.atlas=null,this.mode=e,this.device=null,this.filters=[],this.onconnect=r,this.ondisconnect=i}}];function Di(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),s=t.a,a=Math.round(t.h),u=t.s.toFixed(1),c=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var l=t.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+s+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+s+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+s+"}":"HSV_OBJ"===n?"{h:"+a+",s:"+u+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+a+",s:"+u+",v:"+c+",a:"+s+"}":"unknown format"}var Ri=Array.prototype.forEach,ji=Array.prototype.slice,Mi={BREAK:{},extend:function(t){return this.each(ji.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))}),this),t},defaults:function(t){return this.each(ji.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))}),this),t},compose:function(){var t=ji.call(arguments);return function(){for(var e=ji.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,n){if(t)if(Ri&&t.forEach&&t.forEach===Ri)t.forEach(e,n);else if(t.length===t.length+0){var r,i=void 0;for(i=0,r=t.length;i<r;i++)if(i in t&&e.call(n,t[i],i)===this.BREAK)return}else for(var o in t)if(e.call(n,t[o],o)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r=void 0;return function(){var i=this,o=arguments;function s(){r=null,n||t.apply(i,o)}var a=n||!r;clearTimeout(r),r=setTimeout(s,e),a&&t.apply(i,o)}},toArray:function(t){return t.toArray?t.toArray():ji.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return isNaN(t)})),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return t instanceof Function}},Li=[{litmus:Mi.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:Di},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:Di},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:Di},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:Di}}},{litmus:Mi.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:Mi.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:Mi.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(Mi.isNumber(t.r)&&Mi.isNumber(t.g)&&Mi.isNumber(t.b)&&Mi.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(Mi.isNumber(t.r)&&Mi.isNumber(t.g)&&Mi.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(Mi.isNumber(t.h)&&Mi.isNumber(t.s)&&Mi.isNumber(t.v)&&Mi.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(Mi.isNumber(t.h)&&Mi.isNumber(t.s)&&Mi.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],Fi=void 0,Ui=void 0,Vi=function(){Ui=!1;var t=arguments.length>1?Mi.toArray(arguments):arguments[0];return Mi.each(Li,(function(e){if(e.litmus(t))return Mi.each(e.conversions,(function(e,n){if(Fi=e.read(t),!1===Ui&&!1!==Fi)return Ui=Fi,Fi.conversionName=n,Fi.conversion=e,Mi.BREAK})),Mi.BREAK})),Ui},zi=void 0,qi={hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),s=n*(1-i*e),a=n*(1-(1-i)*e),u=[[n,a,o],[s,n,o],[o,n,a],[o,s,n],[a,o,n],[n,o,s]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=t===i?(e-n)/o:e===i?2+(n-t)/o:4+(t-e)/o,(s/=6)<0&&(s+=1),{h:360*s,s:o/i,v:i/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,n){return n<<(zi=8*e)|t&~(255<<zi)}},Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gi=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Hi=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Yi=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0},Ki=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Qi=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Ji=function(){function t(){if(Gi(this,t),this.__state=Vi.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Hi(t,[{key:"toString",value:function(){return Di(this)}},{key:"toHexString",value:function(){return Di(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function Xi(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space||Ji.recalculateRGB(this,e,n),this.__state[e]},set:function(t){"RGB"!==this.__state.space&&(Ji.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function Zi(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space||Ji.recalculateHSV(this),this.__state[e]},set:function(t){"HSV"!==this.__state.space&&(Ji.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}Ji.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=qi.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");Mi.extend(t.__state,qi.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},Ji.recalculateHSV=function(t){var e=qi.rgb_to_hsv(t.r,t.g,t.b);Mi.extend(t.__state,{s:e.s,v:e.v}),Mi.isNaN(e.h)?Mi.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},Ji.COMPONENTS=["r","g","b","h","s","v","hex","a"],Xi(Ji.prototype,"r",2),Xi(Ji.prototype,"g",1),Xi(Ji.prototype,"b",0),Zi(Ji.prototype,"h"),Zi(Ji.prototype,"s"),Zi(Ji.prototype,"v"),Object.defineProperty(Ji.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(Ji.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=qi.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var $i=function(){function t(e,n){Gi(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return Hi(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),to={};Mi.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(t,e){Mi.each(t,(function(t){to[t]=e}))}));var eo=/(\d+(\.\d+)?)px/;function no(t){if("0"===t||Mi.isUndefined(t))return 0;var e=t.match(eo);return Mi.isNull(e)?0:parseFloat(e[1])}var ro={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var r=n,i=e;Mi.isUndefined(i)&&(i=!0),Mi.isUndefined(r)&&(r=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,r){var i=n||{},o=to[e];if(!o)throw new Error("Event type "+e+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var a=i.x||i.clientX||0,u=i.y||i.clientY||0;s.initMouseEvent(e,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,a,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;Mi.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(e,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(e,i.bubbles||!1,i.cancelable||!0)}Mi.defaults(s,r),t.dispatchEvent(s)},bind:function(t,e,n,r){var i=r||!1;return t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),ro},unbind:function(t,e,n,r){var i=r||!1;return t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),ro},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return ro},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);-1!==r&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return ro},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return no(e["border-left-width"])+no(e["border-right-width"])+no(e["padding-left"])+no(e["padding-right"])+no(e.width)},getHeight:function(t){var e=getComputedStyle(t);return no(e["border-top-width"])+no(e["border-bottom-width"])+no(e["padding-top"])+no(e["padding-bottom"])+no(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},io=function(t){function e(t,n){Gi(this,e);var r=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),i=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),ro.bind(r.__checkbox,"change",(function(){i.setValue(!i.__prev)}),!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return Ki(e,t),Hi(e,[{key:"setValue",value:function(t){var n=Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}($i),oo=function(t){function e(t,n,r){Gi(this,e);var i=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r,s=i;if(i.__select=document.createElement("select"),Mi.isArray(o)){var a={};Mi.each(o,(function(t){a[t]=t})),o=a}return Mi.each(o,(function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),s.__select.appendChild(n)})),i.updateDisplay(),ro.bind(i.__select,"change",(function(){var t=this.options[this.selectedIndex].value;s.setValue(t)})),i.domElement.appendChild(i.__select),i}return Ki(e,t),Hi(e,[{key:"setValue",value:function(t){var n=Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return ro.isActive(this.__select)?this:(this.__select.value=this.getValue(),Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}($i),so=function(t){function e(t,n){Gi(this,e);var r=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),i=r;function o(){i.setValue(i.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),ro.bind(r.__input,"keyup",o),ro.bind(r.__input,"change",o),ro.bind(r.__input,"blur",(function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())})),ro.bind(r.__input,"keydown",(function(t){13===t.keyCode&&this.blur()})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return Ki(e,t),Hi(e,[{key:"updateDisplay",value:function(){return ro.isActive(this.__input)||(this.__input.value=this.getValue()),Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}($i);function ao(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var uo=function(t){function e(t,n,r){Gi(this,e);var i=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r||{};return i.__min=o.min,i.__max=o.max,i.__step=o.step,Mi.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=ao(i.__impliedStep),i}return Ki(e,t),Hi(e,[{key:"setValue",value:function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=ao(t),this}}]),e}($i),co=function(t){function e(t,n,r){Gi(this,e);var i=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,r));i.__truncationSuspended=!1;var o=i,s=void 0;function a(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function u(t){var e=s-t.clientY;o.setValue(o.getValue()+e*o.__impliedStep),s=t.clientY}function c(){ro.unbind(window,"mousemove",u),ro.unbind(window,"mouseup",c),a()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),ro.bind(i.__input,"change",(function(){var t=parseFloat(o.__input.value);Mi.isNaN(t)||o.setValue(t)})),ro.bind(i.__input,"blur",(function(){a()})),ro.bind(i.__input,"mousedown",(function(t){ro.bind(window,"mousemove",u),ro.bind(window,"mouseup",c),s=t.clientY})),ro.bind(i.__input,"keydown",(function(t){13===t.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,a())})),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return Ki(e,t),Hi(e,[{key:"updateDisplay",value:function(){var t,n,r;return this.__input.value=this.__truncationSuspended?this.getValue():(t=this.getValue(),n=this.__precision,r=Math.pow(10,n),Math.round(t*r)/r),Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(uo);function lo(t,e,n,r,i){return r+(t-e)/(n-e)*(i-r)}var ho=function(t){function e(t,n,r,i,o){Gi(this,e);var s=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:r,max:i,step:o})),a=s;function u(t){t.preventDefault();var e=a.__background.getBoundingClientRect();return a.setValue(lo(t.clientX,e.left,e.right,a.__min,a.__max)),!1}function c(){ro.unbind(window,"mousemove",u),ro.unbind(window,"mouseup",c),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function l(t){var e=t.touches[0].clientX,n=a.__background.getBoundingClientRect();a.setValue(lo(e,n.left,n.right,a.__min,a.__max))}function h(){ro.unbind(window,"touchmove",l),ro.unbind(window,"touchend",h),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return s.__background=document.createElement("div"),s.__foreground=document.createElement("div"),ro.bind(s.__background,"mousedown",(function(t){document.activeElement.blur(),ro.bind(window,"mousemove",u),ro.bind(window,"mouseup",c),u(t)})),ro.bind(s.__background,"touchstart",(function(t){1===t.touches.length&&(ro.bind(window,"touchmove",l),ro.bind(window,"touchend",h),l(t))})),ro.addClass(s.__background,"slider"),ro.addClass(s.__foreground,"slider-fg"),s.updateDisplay(),s.__background.appendChild(s.__foreground),s.domElement.appendChild(s.__background),s}return Ki(e,t),Hi(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",Yi(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(uo),fo=function(t){function e(t,n,r){Gi(this,e);var i=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===r?"Fire":r,ro.bind(i.__button,"click",(function(t){return t.preventDefault(),o.fire(),!1})),ro.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return Ki(e,t),Hi(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}($i),po=function(t){function e(t,n){Gi(this,e);var r=Qi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));r.__color=new Ji(r.getValue()),r.__temp=new Ji(0);var i=r;r.domElement=document.createElement("div"),ro.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",ro.bind(r.__input,"keydown",(function(t){13===t.keyCode&&h.call(this)})),ro.bind(r.__input,"blur",h),ro.bind(r.__selector,"mousedown",(function(){ro.addClass(this,"drag").bind(window,"mouseup",(function(){ro.removeClass(i.__selector,"drag")}))})),ro.bind(r.__selector,"touchstart",(function(){ro.addClass(this,"drag").bind(window,"touchend",(function(){ro.removeClass(i.__selector,"drag")}))}));var o,s=document.createElement("div");function a(t){p(t),ro.bind(window,"mousemove",p),ro.bind(window,"touchmove",p),ro.bind(window,"mouseup",c),ro.bind(window,"touchend",c)}function u(t){d(t),ro.bind(window,"mousemove",d),ro.bind(window,"touchmove",d),ro.bind(window,"mouseup",l),ro.bind(window,"touchend",l)}function c(){ro.unbind(window,"mousemove",p),ro.unbind(window,"touchmove",p),ro.unbind(window,"mouseup",c),ro.unbind(window,"touchend",c),f()}function l(){ro.unbind(window,"mousemove",d),ro.unbind(window,"touchmove",d),ro.unbind(window,"mouseup",l),ro.unbind(window,"touchend",l),f()}function h(){var t=Vi(this.value);!1!==t?(i.__color.__state=t,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function f(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function p(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__saturation_field.getBoundingClientRect(),n=t.touches&&t.touches[0]||t,r=n.clientX,o=n.clientY,s=(r-e.left)/(e.right-e.left),a=1-(o-e.top)/(e.bottom-e.top);return a>1?a=1:a<0&&(a=0),s>1?s=1:s<0&&(s=0),i.__color.v=a,i.__color.s=s,i.setValue(i.__color.toOriginal()),!1}function d(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__hue_field.getBoundingClientRect(),n=1-((t.touches&&t.touches[0]||t).clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),i.__color.h=360*n,i.setValue(i.__color.toOriginal()),!1}return Mi.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Mi.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Mi.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Mi.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Mi.extend(s.style,{width:"100%",height:"100%",background:"none"}),vo(s,"top","rgba(0,0,0,0)","#000"),Mi.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(o=r.__hue_field).style.background="",o.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",o.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Mi.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),ro.bind(r.__saturation_field,"mousedown",a),ro.bind(r.__saturation_field,"touchstart",a),ro.bind(r.__field_knob,"mousedown",a),ro.bind(r.__field_knob,"touchstart",a),ro.bind(r.__hue_field,"mousedown",u),ro.bind(r.__hue_field,"touchstart",u),r.__saturation_field.appendChild(s),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return Ki(e,t),Hi(e,[{key:"updateDisplay",value:function(){var t=Vi(this.getValue());if(!1!==t){var e=!1;Mi.each(Ji.COMPONENTS,(function(n){if(!Mi.isUndefined(t[n])&&!Mi.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}}),this),e&&Mi.extend(this.__color.__state,t)}Mi.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;Mi.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,vo(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Mi.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),e}($i),yo=["-moz-","-o-","-webkit-","-ms-",""];function vo(t,e,n,r){t.style.background="",Mi.each(yo,(function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "}))}var go='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',bo=function(t,e){var n=t[e];return Mi.isArray(arguments[2])||Mi.isObject(arguments[2])?new oo(t,e,arguments[2]):Mi.isNumber(n)?Mi.isNumber(arguments[2])&&Mi.isNumber(arguments[3])?Mi.isNumber(arguments[4])?new ho(t,e,arguments[2],arguments[3],arguments[4]):new ho(t,e,arguments[2],arguments[3]):Mi.isNumber(arguments[4])?new co(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new co(t,e,{min:arguments[2],max:arguments[3]}):Mi.isString(n)?new so(t,e):Mi.isFunction(n)?new fo(t,e,""):Mi.isBoolean(n)?new io(t,e):null},mo=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},wo=function(){function t(){Gi(this,t),this.backgroundElement=document.createElement("div"),Mi.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),ro.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Mi.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;ro.bind(this.backgroundElement,"click",(function(){e.hide()}))}return Hi(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Mi.defer((function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",ro.unbind(t.domElement,"webkitTransitionEnd",e),ro.unbind(t.domElement,"transitionend",e),ro.unbind(t.domElement,"oTransitionEnd",e)};ro.bind(this.domElement,"webkitTransitionEnd",e),ro.bind(this.domElement,"transitionend",e),ro.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-ro.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-ro.getHeight(this.domElement)/2+"px"}}]),t}();!function(t,e){var n=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(t){}}(function(t){if("undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var _o="Default",So=function(){try{return!!window.localStorage}catch(t){return!1}}(),Oo=void 0,Eo=!0,Ao=void 0,Co=!1,Io=[],To=function t(e){var n=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),ro.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Mi.defaults(r,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),r=Mi.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Mi.isUndefined(r.load)?r.load={preset:_o}:r.preset&&(r.load.preset=r.preset),Mi.isUndefined(r.parent)&&r.hideable&&Io.push(this),r.resizable=Mi.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Mi.isUndefined(r.scrollable)&&(r.scrollable=!0);var i,o=So&&"true"===localStorage.getItem(Do(0,"isLocal")),s=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(t){n.parent?n.getRoot().preset=t:r.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),n.revert()}},width:{get:function(){return r.width},set:function(t){r.width=t,Fo(n,t)}},name:{get:function(){return r.name},set:function(t){r.name=t,a&&(a.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(e){r.closed=e,r.closed?ro.addClass(n.__ul,t.CLASS_CLOSED):ro.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return o},set:function(t){So&&(o=t,t?ro.bind(window,"unload",s):ro.unbind(window,"unload",s),localStorage.setItem(Do(0,"isLocal"),t))}}}),Mi.isUndefined(r.parent)){if(this.closed=r.closed||!1,ro.addClass(this.domElement,t.CLASS_MAIN),ro.makeSelectable(this.domElement,!1),So&&o){n.useLocalStorage=!0;var u=localStorage.getItem(Do(0,"gui"));u&&(r.load=JSON.parse(u))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,ro.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),r.closeOnTop?(ro.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(ro.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),ro.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===r.closed&&(r.closed=!0);var c=document.createTextNode(r.name);ro.addClass(c,"controller-name"),a=xo(n,c),ro.addClass(this.__ul,t.CLASS_CLOSED),ro.addClass(a,"title"),ro.bind(a,"click",(function(t){return t.preventDefault(),n.closed=!n.closed,!1})),r.closed||(this.closed=!1)}r.autoPlace&&(Mi.isUndefined(r.parent)&&(Eo&&(Ao=document.createElement("div"),ro.addClass(Ao,"dg"),ro.addClass(Ao,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Ao),Eo=!1),Ao.appendChild(this.domElement),ro.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||Fo(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},ro.bind(window,"resize",this.__resizeHandler),ro.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),ro.bind(this.__ul,"transitionend",this.__resizeHandler),ro.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&Lo(this),s=function(){So&&"true"===localStorage.getItem(Do(0,"isLocal"))&&localStorage.setItem(Do(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=s,r.parent||((i=n.getRoot()).width+=1,Mi.defer((function(){i.width-=1})))};function xo(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function ko(t){ro.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&ro.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function Po(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function No(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(-1!==r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,s=void 0;if(o[t.preset])s=o[t.preset];else{if(!o.Default)return;s=o.Default}if(s[r]&&void 0!==s[r][e.property]){var a=s[r][e.property];e.initialValue=a,e.setValue(a)}}}}function Bo(t,e,n,r){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var i=void 0;if(r.color)i=new po(e,n);else{var o=[e,n].concat(r.factoryArgs);i=bo.apply(t,o)}r.before instanceof $i&&(r.before=r.before.__li),No(t,i),ro.addClass(i.domElement,"c");var s=document.createElement("span");ro.addClass(s,"property-name"),s.innerHTML=i.property;var a=document.createElement("div");a.appendChild(s),a.appendChild(i.domElement);var u=xo(t,a,r.before);return ro.addClass(u,To.CLASS_CONTROLLER_ROW),i instanceof po?ro.addClass(u,"color"):ro.addClass(u,Wi(i.getValue())),function(t,e,n){if(n.__li=e,n.__gui=t,Mi.extend(n,{options:function(e){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),Bo(t,n.object,n.property,{before:r,factoryArgs:[Mi.toArray(arguments)]})}if(Mi.isArray(e)||Mi.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),Bo(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof ho){var r=new co(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});Mi.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(t){var e=n[t],i=r[t];n[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(r,t),e.apply(n,t)}})),ro.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof co){var i=function(e){if(Mi.isNumber(n.__min)&&Mi.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=Bo(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return e};n.min=Mi.compose(i,n.min),n.max=Mi.compose(i,n.max)}else n instanceof io?(ro.bind(e,"click",(function(){ro.fakeEvent(n.__checkbox,"click")})),ro.bind(n.__checkbox,"click",(function(t){t.stopPropagation()}))):n instanceof fo?(ro.bind(e,"click",(function(){ro.fakeEvent(n.__button,"click")})),ro.bind(e,"mouseover",(function(){ro.addClass(n.__button,"hover")})),ro.bind(e,"mouseout",(function(){ro.removeClass(n.__button,"hover")}))):n instanceof po&&(ro.addClass(e,"color"),n.updateDisplay=Mi.compose((function(t){return e.style.borderLeftColor=n.__color.toString(),t}),n.updateDisplay),n.updateDisplay());n.setValue=Mi.compose((function(e){return t.getRoot().__preset_select&&n.isModified()&&Po(t.getRoot(),!0),e}),n.setValue)}(t,u,i),t.__controllers.push(i),i}function Do(t,e){return document.location.href+"."+e}function Ro(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function jo(t,e){e.style.display=t.useLocalStorage?"block":"none"}function Mo(t){var e=t.__save_row=document.createElement("li");ro.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),ro.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",ro.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",ro.addClass(r,"button"),ro.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",ro.addClass(i,"button"),ro.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",ro.addClass(o,"button"),ro.addClass(o,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?Mi.each(t.load.remembered,(function(e,n){Ro(t,n,n===t.preset)})):Ro(t,_o,!1),ro.bind(s,"change",(function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value})),e.appendChild(s),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),So){var a=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(Do(0,"isLocal"))&&u.setAttribute("checked","checked"),jo(t,a),ro.bind(u,"change",(function(){t.useLocalStorage=!t.useLocalStorage,jo(t,a)}))}var c=document.getElementById("dg-new-constructor");ro.bind(c,"keydown",(function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||Oo.hide()})),ro.bind(n,"click",(function(){c.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),Oo.show(),c.focus(),c.select()})),ro.bind(r,"click",(function(){t.save()})),ro.bind(i,"click",(function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)})),ro.bind(o,"click",(function(){t.revert()}))}function Lo(t){var e=void 0;function n(n){return n.preventDefault(),t.width+=e-n.clientX,t.onResize(),e=n.clientX,!1}function r(){ro.removeClass(t.__closeButton,To.CLASS_DRAG),ro.unbind(window,"mousemove",n),ro.unbind(window,"mouseup",r)}function i(i){return i.preventDefault(),e=i.clientX,ro.addClass(t.__closeButton,To.CLASS_DRAG),ro.bind(window,"mousemove",n),ro.bind(window,"mouseup",r),!1}t.__resize_handle=document.createElement("div"),Mi.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),ro.bind(t.__resize_handle,"mousedown",i),ro.bind(t.__closeButton,"mousedown",i),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function Fo(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function Uo(t,e){var n={};return Mi.each(t.__rememberedObjects,(function(r,i){var o={},s=t.__rememberedObjectIndecesToControllers[i];Mi.each(s,(function(t,n){o[n]=e?t.initialValue:t.getValue()})),n[i]=o})),n}function Vo(t){0!==t.length&&mo.call(window,(function(){Vo(t)})),Mi.each(t,(function(t){t.updateDisplay()}))}To.toggleHide=function(){Co=!Co,Mi.each(Io,(function(t){t.domElement.style.display=Co?"none":""}))},To.CLASS_AUTO_PLACE="a",To.CLASS_AUTO_PLACE_CONTAINER="ac",To.CLASS_MAIN="main",To.CLASS_CONTROLLER_ROW="cr",To.CLASS_TOO_TALL="taller-than-window",To.CLASS_CLOSED="closed",To.CLASS_CLOSE_BUTTON="close-button",To.CLASS_CLOSE_TOP="close-top",To.CLASS_CLOSE_BOTTOM="close-bottom",To.CLASS_DRAG="drag",To.DEFAULT_WIDTH=245,To.TEXT_CLOSED="Close Controls",To.TEXT_OPEN="Open Controls",To._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||To.toggleHide()},ro.bind(window,"keydown",To._keydownHandler,!1),Mi.extend(To.prototype,{add:function(t,e){return Bo(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return Bo(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;Mi.defer((function(){e.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Ao.removeChild(this.domElement);var t=this;Mi.each(this.__folders,(function(e){t.removeFolder(e)})),ro.unbind(window,"keydown",To._keydownHandler,!1),ko(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new To(e);this.__folders[t]=n;var r=xo(this,n.domElement);return ro.addClass(r,"folder"),n},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],ko(t);var e=this;Mi.each(t.__folders,(function(e){t.removeFolder(e)})),Mi.defer((function(){e.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=ro.getOffset(t.__ul).top,n=0;Mi.each(t.__ul.childNodes,(function(e){t.autoPlace&&e===t.__save_row||(n+=ro.getHeight(e))})),window.innerHeight-e-20<n?(ro.addClass(t.domElement,To.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(ro.removeClass(t.domElement,To.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&Mi.defer((function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"})),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:Mi.debounce((function(){this.onResize()}),50),remember:function(){if(Mi.isUndefined(Oo)&&((Oo=new wo).domElement.innerHTML=go),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;Mi.each(Array.prototype.slice.call(arguments),(function(e){0===t.__rememberedObjects.length&&Mo(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)})),this.autoPlace&&Fo(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=Uo(this)),t.folders={},Mi.each(this.__folders,(function(e,n){t.folders[n]=e.getSaveObject()})),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Uo(this),Po(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=Uo(this,!0)),this.load.remembered[t]=Uo(this),this.preset=t,Ro(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){Mi.each(this.__controllers,(function(e){this.getRoot().load.remembered?No(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())}),this),Mi.each(this.__folders,(function(t){t.revert(t)})),t||Po(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&Vo(this.__listening)},updateDisplay:function(){Mi.each(this.__controllers,(function(t){t.updateDisplay()})),Mi.each(this.__folders,(function(t){t.updateDisplay()}))}});var zo=To;function qo(t){return(qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Go=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=e,this.applets={},this.registry={local:{},brainstorm:{}},this.state=new R,this.gui=new zo({autoPlace:!1}),document.body.innerHTML+="<div class='guiContainer' style=\"position:absolute; top: 0px; right: 25px; z-index: 999;\"></div>",document.body.querySelector(".guiContainer").appendChild(this.gui.domElement),document.body.querySelector(".guiContainer").style.display="none",this.session.state.addToState("update",this.session.state.update,(function(t){if(t.added){var e=function(e){var r=n.registry.local[e].label;t.buffer.forEach((function(t){null==n.registry.brainstorm[t]&&t.includes(r)&&t!==r&&(n.registry.brainstorm[t]={count:1,id:n.session.state.subscribe(t,n.registry.local[e].callback),callback:n.registry.local[e].callback},n.registry.brainstorm[t].callback())}))};for(var r in n.registry.local)e(r)}t.removed&&t.buffer.forEach((function(t){null!=n.registry.brainstorm[t]&&(n.session.state.unsubscribe(t,n.registry.brainstorm[t].id),n.registry.brainstorm[t].callback(),delete n.registry.brainstorm[t])})),t.added="",t.removed="",t.buffer.clear()}))}var e,n;return e=t,(n=[{key:"add",value:function(t,e,n){var r=this,i=new Set,o={},s=[];n.forEach((function(t){t.edges.forEach((function(t){s.push(t)})),t.nodes.forEach((function(t){if(null==o[t.id]){o[t.id]=t;var e=new t.class(t.id,r.session,t.params);for(var n in e.paramOptions)null==e.params[n]&&(e.params[n]=e.paramOptions[n].default);o[t.id].instance=e}}))})),null==this.applets[t]&&(this.applets[t]={nodes:o,edges:s,name:e,streams:i,outputs:{},subscriptions:{session:{},local:{}}})}},{key:"addToGUI",value:function(t){var e,n=t.instance;if(n.paramOptions&&Object.keys(n.paramOptions).length>0){if(!Object.keys(this.gui.__folders).includes(n.label)){var r=document.body.querySelector(".guiContainer");"none"===r.style.display&&(r.style.display="block"),this.gui.addFolder(n.label),this.registry.local[t.class.id].gui[n.label]=[];var i=n.label[0].toUpperCase()+n.label.slice(1);this.gui.__folders[n.label].name=i}e=this.gui.__folders[n.label]}for(var o in n.paramOptions)"object"===qo(n.paramOptions[o])&&null!=n.params[o]&&!1!==n.paramOptions[o].show&&(null==n.paramOptions[o].options?this.registry.local[t.class.id].gui[n.label].push(e.add(n.params,o,n.paramOptions[o].min,n.paramOptions[o].max,n.paramOptions[o].step)):n.paramOptions[o].options.length>1&&this.registry.local[t.class.id].gui[n.label].push(e.add(n.params,o,n.paramOptions[o].options)))}},{key:"start",value:function(t){var e=this,n=this.applets[t];n.streams=new Set,n.classInstances={};var r=[],i={HTMLtemplate:"",setupHTML:[]},o=[],s=function(t){var e=n.nodes[t];if(!o.includes(e.id)){var i=e.instance.init(e.params);null!=i&&(u=i.setupHTML,i.setupHTML=function(t){u(t);var n=[{}];for(var r in e.instance.ports)e.instance.ports[r].defaults.input&&(n=e.instance.ports[r].defaults.input),e.instance[r](n)},r.push(i)),o.push(e.id)}};for(var a in n.nodes){var u;s(a)}for(var c in r.forEach((function(t){t.HTMLtemplate instanceof Function&&(t.HTMLtemplate=t.HTMLtemplate()),i.HTMLtemplate+=t.HTMLtemplate,i.setupHTML.push(t.setupHTML)})),n.nodes){var l=n.nodes[c],h=l.instance;h.state={value:null},null==this.registry.local[l.class.id]&&(this.registry.local[l.class.id]={label:h.label,count:0,state:null,gui:{},callback:function(){}},this.registry.local[l.class.id].state=h.state,this.addToGUI(l)),null==n.classInstances[l.class.id]?n.classInstances[l.class.id]=[h.label]:n.classInstances[l.class.id].push(h.label),this.registry.local[l.class.id].count++}return n.edges.forEach((function(r,o){var s=r.source.split(":"),a=s[0],u=s[1],c=n.nodes[a],l=c.instance,h=r.target.split(":"),f=h[0],p=h[1],d=n.nodes[f].instance,y=function(t){if(!Array.isArray(t)&&(null==t.value[0]||"object"!==qo(t.value[0])||null==t.value[0].username)){var n={username:e.session.info.auth.username};n.value=t.value,n.label=l.label,t=[n]}var r;return null!=t.timestamp?t=t.value:Array.isArray(t[0].value)?"object"===qo(t[0].value[0])&&null!=t[0].value[0].username&&(t=t.map((function(t){return t[0].value}))):null!=t[0].value&&"object"===qo(t[0].value)&&null!=t[0].value.username&&(t=t.map((function(t){return t.value}))),null!=p?r=d[p](t):d.default?r=d.default(t):console.log("no return"),null!=r&&Array.isArray(r)&&1===r.length?d.state.value=r[0]:d.state.value=r,d.state.timestamp=Date.now(),r};"brainstorm"==u?(c.loop?i.setupHTML.push(e._addStream(c,t,l.default,[y])):i.setupHTML.push(e._addData(c,t,[y])),null!=l.label&&n.streams.add(l.label)):l.label&&l.state&&(e.state.data[l.label]=l.state,null==n.subscriptions.local[l.label]&&(n.subscriptions.local[l.label]=[]),c.loop?e.findStreamFunction(l.label)?(e.session.state[l.label]?n.subscriptions.local[l.label].push(e.session.state.subscribe(l.label,y)):n.subscriptions.local[l.label].push(e.state.subscribe(l.label,y)),i.setupHTML.push((function(){return y(e.session.state[data][l.label])}))):(e.session.addStreamFunc(l.label,l.default,e.state,!1),n.subscriptions.local[l.label].push(e.state.subscribe(l.label,y))):n.subscriptions.local[l.label].push(e.state.subscribe(l.label,y)))})),{uiParams:i,streams:this.applets[t].streams}}},{key:"findStreamFunction",value:function(t){return this.session.streamObj.streamTable.find((function(e){if(e.prop===t)return e}))}},{key:"stop",value:function(t){var e=this,n=this.applets[t];for(var r in Object.keys(n.classInstances).forEach((function(t){n.classInstances[t].forEach((function(r){if(e.registry.local[t].count--,0==e.registry.local[t].count){for(var i in e.registry.local[t].gui){e.registry.local[t].gui[i].forEach((function(t){t.remove()}));var o=e.gui.__folders[i];o.close(),e.gui.__ul.removeChild(o.domElement.parentNode),delete e.gui.__folders[i]}var s=document.body.querySelector(".guiContainer");Object.keys(e.gui.__folders).length&&"none"!==s.style.display&&(s.style.display="none"),delete e.registry.local[t],e.session.removeStreaming(r),e.session.removeStreaming(r,null,e.state)}else{var a=n.subscriptions.session[r],u=n.subscriptions.local[r];null!=a&&n.subscriptions.session[r].forEach((function(t){e.session.removeStreaming(r,t)})),null!=u&&n.subscriptions.local[r].forEach((function(t){e.session.removeStreaming(r,t,e.state)}))}}))})),this.applets[t].nodes)this.applets[t].nodes[r].instance.deinit();delete this.applets[t]}},{key:"_addData",value:function(t,e,n){var r=this,i=this.applets[e],o=t.instance.label,s=this.findStreamFunction(o);return null==i.subscriptions.session[o]&&(i.subscriptions.session[o]=[]),this.registry.local[t.class.id].callback=function(){if(null!=r.session.state.data[o]&&n){var t=r.session.getBrainstormData(i.name,[o],"app","plugin");n.forEach((function(e){e instanceof Function&&e(t)}))}},null==s?i.subscriptions.session[o].push(this.session.streamAppData(o,this.registry.local[t.class.id].state,this.registry.local[t.class.id].callback)):i.subscriptions.session[o].push(this.session.state.subscribe(o,this.registry.local[t.class.id].callback)),function(){r.registry.local[t.class.id].callback(r.session.state.data[o])}}},{key:"_addStream",value:function(t,e,n,r){var i=this,o=this.applets[e],s=t.instance.label;return null==o.subscriptions.session[s]&&(o.subscriptions.session[s]=[]),null==this.findStreamFunction(s)&&this.session.addStreamFunc(s,n),this.registry.local[t.class.id].callback=function(){if(null!=i.session.state.data[s]&&r){var t=i.session.getBrainstormData(o.name,[s],"app","plugin");r.forEach((function(e){e instanceof Function&&e(t)}))}},o.subscriptions.session[s].push(this.session.state.subscribe(s,this.registry.local[t.class.id].callback)),function(){i.registry.local[t.class.id].callback(i.session.state.data[s])}}}])&&Wo(e.prototype,n),t}(),Ho=(n(1407).Buffer,"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{});function Yo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ko(t,e){return t(e={exports:{}},e.exports),e.exports}for(var Qo=[],Jo=[],Xo="undefined"!=typeof Uint8Array?Uint8Array:Array,Zo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$o=0,ts=Zo.length;$o<ts;++$o)Qo[$o]=Zo[$o],Jo[Zo.charCodeAt($o)]=$o;function es(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function ns(t,e,n){for(var r,i,o=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(Qo[(i=r)>>18&63]+Qo[i>>12&63]+Qo[i>>6&63]+Qo[63&i]);return o.join("")}Jo["-".charCodeAt(0)]=62,Jo["_".charCodeAt(0)]=63;var rs=function(t){var e,n,r=es(t),i=r[0],o=r[1],s=new Xo(function(t,e,n){return 3*(e+n)/4-n}(0,i,o)),a=0,u=o>0?i-4:i;for(n=0;n<u;n+=4)e=Jo[t.charCodeAt(n)]<<18|Jo[t.charCodeAt(n+1)]<<12|Jo[t.charCodeAt(n+2)]<<6|Jo[t.charCodeAt(n+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;return 2===o&&(e=Jo[t.charCodeAt(n)]<<2|Jo[t.charCodeAt(n+1)]>>4,s[a++]=255&e),1===o&&(e=Jo[t.charCodeAt(n)]<<10|Jo[t.charCodeAt(n+1)]<<4|Jo[t.charCodeAt(n+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e),s},is=function(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(ns(t,s,s+o>a?a:s+o));return 1===r?(e=t[n-1],i.push(Qo[e>>2]+Qo[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(Qo[e>>10]+Qo[e>>4&63]+Qo[e<<2&63]+"=")),i.join("")},os=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},ss=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*y},as=Ko((function(t,e){var n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},e.INSPECT_MAX_BYTES=50;var r=2147483647;function i(t){if(t>r)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,n)}function s(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|f(t,e),r=i(n),s=r.write(t,e);return s!==n&&(r=r.slice(0,s)),r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(L(t,Uint8Array)){var e=new Uint8Array(t);return l(e.buffer,e.byteOffset,e.byteLength)}return c(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t));if(L(t,ArrayBuffer)||t&&L(t.buffer,ArrayBuffer))return l(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(L(t,SharedArrayBuffer)||t&&L(t.buffer,SharedArrayBuffer)))return l(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return o.from(r,e,n);var s=function(t){if(o.isBuffer(t)){var e=0|h(t.length),n=i(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||F(t.length)?i(0):c(t):"Buffer"===t.type&&Array.isArray(t.data)?c(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t))}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),i(t<0?0:0|h(t))}function c(t){for(var e=t.length<0?0:0|h(t.length),n=i(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function l(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,o.prototype),r}function h(t){if(t>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|t}function f(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||L(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(t));var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return R(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(i)return r?-1:R(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return C(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function d(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),F(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function g(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(F(a))return s;t[n+s]=a}return s}function b(t,e,n,r){return M(R(e,t.length-n),t,n,r)}function m(t,e,n,r){return M(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return M(j(e),t,n,r)}function _(t,e,n,r){return M(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function S(t,e,n){return 0===e&&n===t.length?is(t):is(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=E));return n}(r)}e.kMaxLength=r,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,n){return s(t,e,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,n){return function(t,e,n){return a(t),t<=0?i(t):void 0!==e?"string"==typeof n?i(t).fill(e,n):i(t).fill(e):i(t)}(t,e,n)},o.allocUnsafe=function(t){return u(t)},o.allocUnsafeSlow=function(t){return u(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(L(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),L(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(L(s,Uint8Array))i+s.length>r.length?o.from(s).copy(r,i):Uint8Array.prototype.set.call(r,s,i);else{if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i)}i+=s.length}return r},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?O(this,0,t):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(t,e,n,r,i){if(L(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(t));if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),u=Math.min(s,a),c=this.slice(r,i),l=t.slice(e,n),h=0;h<u;++h)if(c[h]!==l[h]){s=c[h],a=l[h];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},o.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":case"latin1":case"binary":return m(this,t,e,n);case"base64":return w(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function I(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=U[t[o]];return i}function T(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,n,r,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function P(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(t,e,n,r,i){return e=+e,n>>>=0,i||P(t,0,n,4),ss(t,e,n,r,23,4),n+4}function B(t,e,n,r,i){return e=+e,n>>>=0,i||P(t,0,n,8),ss(t,e,n,r,52,8),n+8}o.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t>>>=0,e||x(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||x(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||x(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return t>>>=0,e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||x(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){t>>>=0,e||x(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||x(t,4,this.length),os(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||x(t,4,this.length),os(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||x(t,8,this.length),os(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||x(t,8,this.length),os(this,t,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||k(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||k(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);k(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);k(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,n){return N(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return N(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var a=o.isBuffer(t)?t:o.from(t,r),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-e;++s)this[s+e]=a[s%u]}return this};var D=/[^+/0-9A-Za-z-_]/g;function R(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function j(t){return rs(function(t){if((t=(t=t.split("=")[0]).trim().replace(D,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function M(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function L(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function F(t){return t!=t}var U=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()}));as.Buffer,as.SlowBuffer,as.INSPECT_MAX_BYTES,as.kMaxLength;var us={};Object.create;function cs(t,e){var n={seen:[],stylize:hs};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),vs(e)?n.showHidden=e:e&&Is(n,e),ws(n.showHidden)&&(n.showHidden=!1),ws(n.depth)&&(n.depth=2),ws(n.colors)&&(n.colors=!1),ws(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=ls),fs(n,t,n.depth)}function ls(t,e){var n=cs.styles[e];return n?"["+cs.colors[n][0]+"m"+t+"["+cs.colors[n][1]+"m":t}function hs(t,e){return t}function fs(t,e,n){if(t.customInspect&&e&&As(e.inspect)&&e.inspect!==cs&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return ms(r)||(r=fs(t,r,n)),r}var i=function(t,e){if(ws(e))return t.stylize("undefined","undefined");if(ms(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return bs(e)?t.stylize(""+e,"number"):vs(e)?t.stylize(""+e,"boolean"):gs(e)?t.stylize("null","null"):void 0}(t,e);if(i)return i;var o=Object.keys(e),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),Es(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return ps(e);if(0===o.length){if(As(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(_s(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Os(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Es(e))return ps(e)}var u,c="",l=!1,h=["{","}"];return ys(e)&&(l=!0,h=["[","]"]),As(e)&&(c=" [Function"+(e.name?": "+e.name:"")+"]"),_s(e)&&(c=" "+RegExp.prototype.toString.call(e)),Os(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Es(e)&&(c=" "+ps(e)),0!==o.length||l&&0!=e.length?n<0?_s(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),u=l?function(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)Ts(e,String(s))?o.push(ds(t,e,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(ds(t,e,n,r,i,!0))})),o}(t,e,n,s,o):o.map((function(r){return ds(t,e,n,s,r,l)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(u,c,h)):h[0]+c+h[1]}function ps(t){return"["+Error.prototype.toString.call(t)+"]"}function ds(t,e,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),Ts(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=gs(n)?fs(t,u.value,null):fs(t,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),ws(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function ys(t){return Array.isArray(t)}function vs(t){return"boolean"==typeof t}function gs(t){return null===t}function bs(t){return"number"==typeof t}function ms(t){return"string"==typeof t}function ws(t){return void 0===t}function _s(t){return Ss(t)&&"[object RegExp]"===Cs(t)}function Ss(t){return"object"===babelHelpers.typeof(t)&&null!==t}function Os(t){return Ss(t)&&"[object Date]"===Cs(t)}function Es(t){return Ss(t)&&("[object Error]"===Cs(t)||t instanceof Error)}function As(t){return"function"==typeof t}function Cs(t){return Object.prototype.toString.call(t)}cs.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},cs.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Is(t,e){if(!e||!Ss(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function Ts(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var xs=function t(e,r){if(ws(n.g.process))return function(){return t(e,r).apply(this,arguments)};var i=!1;return function(){return i||(console.error(r),i=!0),e.apply(this,arguments)}},ks=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.deprecate=e.isObjectLike=e.isDate=e.isBuffer=e.haveBuffer=e.isBigUInt64Array=e.isBigInt64Array=e.isUint8Array=e.randomBytes=e.normalizedFunctionString=void 0,e.normalizedFunctionString=function(t){return t.toString().replace("function(","function (")};var n="object"==typeof Ho.navigator&&"ReactNative"===Ho.navigator.product?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.",r=function(t){console.warn(n);for(var e=as.Buffer.alloc(t),r=0;r<t;++r)e[r]=Math.floor(256*Math.random());return e};function i(t){return"object"==typeof t&&null!==t}e.randomBytes=function(){if("undefined"!=typeof window){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues)return function(e){return t.getRandomValues(as.Buffer.alloc(e))}}if(void 0!==Ho&&Ho.crypto&&Ho.crypto.getRandomValues)return function(t){return Ho.crypto.getRandomValues(as.Buffer.alloc(t))};var e;try{e=us.randomBytes}catch(t){}return e||r}(),e.isUint8Array=function(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},e.isBigInt64Array=function(t){return"[object BigInt64Array]"===Object.prototype.toString.call(t)},e.isBigUInt64Array=function(t){return"[object BigUint64Array]"===Object.prototype.toString.call(t)},e.haveBuffer=function(){return void 0!==Ho&&void 0!==Ho.Buffer},e.isBuffer=function(t){var e;return"object"==typeof t&&"Buffer"===(null===(e=null==t?void 0:t.constructor)||void 0===e?void 0:e.name)},e.isDate=function(t){return i(t)&&"[object Date]"===Object.prototype.toString.call(t)},e.isObjectLike=i,e.deprecate=function(t,e){if("undefined"==typeof window&&"undefined"==typeof self)return xs(t,e);var n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(console.warn(e),n=!0),t.apply(this,r)}}}));Yo(ks),ks.deprecate,ks.isObjectLike,ks.isDate,ks.isBuffer,ks.haveBuffer,ks.isBigUInt64Array,ks.isBigInt64Array,ks.isUint8Array,ks.randomBytes,ks.normalizedFunctionString;var Ps=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ensureBuffer=void 0,e.ensureBuffer=function(t){if(ks.isBuffer(t))return t;if(ArrayBuffer.isView(t))return as.Buffer.from(t.buffer);if(t instanceof ArrayBuffer)return as.Buffer.from(t);throw new TypeError("Must use either Buffer or TypedArray")}}));Yo(Ps),Ps.ensureBuffer;var Ns=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.bufferToUuidHexString=e.uuidHexStringToBuffer=e.uuidValidateString=void 0;var n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i;e.uuidValidateString=function(t){return"string"==typeof t&&n.test(t)},e.uuidHexStringToBuffer=function(t){if(!e.uuidValidateString(t))throw new TypeError('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var n=t.replace(/-/g,"");return as.Buffer.from(n,"hex")},e.bufferToUuidHexString=function(t,e){return void 0===e&&(e=!0),e?t.toString("hex",0,4)+"-"+t.toString("hex",4,6)+"-"+t.toString("hex",6,8)+"-"+t.toString("hex",8,10)+"-"+t.toString("hex",10,16):t.toString("hex")}}));Yo(Ns),Ns.bufferToUuidHexString,Ns.uuidHexStringToBuffer,Ns.uuidValidateString;var Bs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.UUID=void 0;var n=Symbol("id"),r=function(){function t(e){if(void 0===e)this.id=t.generate();else if(e instanceof t)this[n]=as.Buffer.from(e.id),this.__id=e.__id;else if((as.Buffer.isBuffer(e)||ArrayBuffer.isView(e))&&16===e.byteLength)this.id=Ps.ensureBuffer(e);else{if("string"!=typeof e)throw new TypeError("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");this.id=Ns.uuidHexStringToBuffer(e)}}return Object.defineProperty(t.prototype,"id",{get:function(){return this[n]},set:function(e){this[n]=e,t.cacheHexString&&(this.__id=Ns.bufferToUuidHexString(e))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(e){if(void 0===e&&(e=!0),t.cacheHexString&&this.__id)return this.__id;var n=Ns.bufferToUuidHexString(this.id,e);return t.cacheHexString&&(this.__id=n),n},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){if(!e)return!1;if(e instanceof t)return e.id.equals(this.id);try{return new t(e).id.equals(this.id)}catch(t){return!1}},t.prototype.toBinary=function(){return new Ds.Binary(this.id,Ds.Binary.SUBTYPE_UUID)},t.generate=function(){var t=ks.randomBytes(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,as.Buffer.from(t)},t.isValid=function(e){if(!e)return!1;if(e instanceof t)return!0;if("string"==typeof e)return Ns.uuidValidateString(e);if(as.Buffer.isBuffer(e)){if(16!==e.length)return!1;try{return parseInt(e[6].toString(16)[0],10)===Ds.Binary.SUBTYPE_UUID}catch(t){return!1}}return!1},t.createFromHexString=function(e){return new t(Ns.uuidHexStringToBuffer(e))},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'+this.toHexString()+'")'},t}();e.UUID=r,Object.defineProperty(r.prototype,"_bsontype",{value:"UUID"})}));Yo(Bs),Bs.UUID;var Ds=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Binary=void 0;var n=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);if(!(null==e||"string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||Array.isArray(e)))throw new TypeError("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=null!=n?n:t.BSON_BINARY_SUBTYPE_DEFAULT,null==e?(this.buffer=as.Buffer.alloc(t.BUFFER_SIZE),this.position=0):("string"==typeof e?this.buffer=as.Buffer.from(e,"binary"):Array.isArray(e)?this.buffer=as.Buffer.from(e):this.buffer=Ps.ensureBuffer(e),this.position=this.buffer.byteLength)}return t.prototype.put=function(e){if("string"==typeof e&&1!==e.length)throw new TypeError("only accepts single character String");if("number"!=typeof e&&1!==e.length)throw new TypeError("only accepts single character Uint8Array or Array");var n;if((n="string"==typeof e?e.charCodeAt(0):"number"==typeof e?e:e[0])<0||n>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=n;else{var r=as.Buffer.alloc(t.BUFFER_SIZE+this.buffer.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r,this.buffer[this.position++]=n}},t.prototype.write=function(t,e){if(e="number"==typeof e?e:this.position,this.buffer.length<e+t.length){var n=as.Buffer.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(Ps.ensureBuffer(t),e),this.position=e+t.byteLength>this.position?e+t.length:this.position):"string"==typeof t&&(this.buffer.write(t,e,t.length,"binary"),this.position=e+t.length>this.position?e+t.length:this.position)},t.prototype.read=function(t,e){return e=e&&e>0?e:this.position,this.buffer.slice(t,t+e)},t.prototype.value=function(t){return(t=!!t)&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},t.prototype.length=function(){return this.position},t.prototype.toJSON=function(){return this.buffer.toString("base64")},t.prototype.toString=function(t){return this.buffer.toString(t)},t.prototype.toExtendedJSON=function(t){t=t||{};var e=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return t.legacy?{$binary:e,$type:1===n.length?"0"+n:n}:{$binary:{base64:e,subType:1===n.length?"0"+n:n}}},t.prototype.toUUID=function(){if(this.sub_type===t.SUBTYPE_UUID)return new Bs.UUID(this.buffer.slice(0,this.position));throw new Error('Binary sub_type "'+this.sub_type+'" is not supported for converting to UUID. Only "'+t.SUBTYPE_UUID+'" is currently supported.')},t.fromExtendedJSON=function(e,n){var r,i;if(n=n||{},"$binary"in e?n.legacy&&"string"==typeof e.$binary&&"$type"in e?(i=e.$type?parseInt(e.$type,16):0,r=as.Buffer.from(e.$binary,"base64")):"string"!=typeof e.$binary&&(i=e.$binary.subType?parseInt(e.$binary.subType,16):0,r=as.Buffer.from(e.$binary.base64,"base64")):"$uuid"in e&&(i=4,r=Ns.uuidHexStringToBuffer(e.$uuid)),!r)throw new TypeError("Unexpected Binary Extended JSON format "+JSON.stringify(e));return new t(r,i)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Binary(Buffer.from("'+this.value(!0).toString("hex")+'", "hex"), '+this.sub_type+")"},t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BUFFER_SIZE=256,t.SUBTYPE_DEFAULT=0,t.SUBTYPE_FUNCTION=1,t.SUBTYPE_BYTE_ARRAY=2,t.SUBTYPE_UUID_OLD=3,t.SUBTYPE_UUID=4,t.SUBTYPE_MD5=5,t.SUBTYPE_USER_DEFINED=128,t}();e.Binary=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Binary"})}));Yo(Ds),Ds.Binary;var Rs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Code=void 0;var n=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);this.code=e,this.scope=n}return t.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},t.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},t.fromExtendedJSON=function(e){return new t(e.$code,e.$scope)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=this.toJSON();return'new Code("'+t.code+'"'+(t.scope?", "+JSON.stringify(t.scope):"")+")"},t}();e.Code=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Code"})}));Yo(Rs),Rs.Code;var js=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.DBRef=e.isDBRefLike=void 0,e.isDBRefLike=function(t){return ks.isObjectLike(t)&&null!=t.$id&&null!=t.$ref};var n=function(){function t(e,n,r,i){if(!(this instanceof t))return new t(e,n,r,i);var o=e.split(".");2===o.length&&(r=o.shift(),e=o.shift()),this.collection=e,this.oid=n,this.db=r,this.fields=i||{}}return Object.defineProperty(t.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(t.$db=this.db),t},t.prototype.toExtendedJSON=function(t){t=t||{};var e={$ref:this.collection,$id:this.oid};return t.legacy?e:(this.db&&(e.$db=this.db),e=Object.assign(e,this.fields))},t.fromExtendedJSON=function(e){var n=Object.assign({},e);return delete n.$ref,delete n.$id,delete n.$db,new t(e.$ref,e.$id,e.$db,n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=void 0===this.oid||void 0===this.oid.toString?this.oid:this.oid.toString();return'new DBRef("'+this.namespace+'", new ObjectId("'+t+'")'+(this.db?', "'+this.db+'"':"")+")"},t}();e.DBRef=n,Object.defineProperty(n.prototype,"_bsontype",{value:"DBRef"})}));Yo(js),js.DBRef,js.isDBRefLike;var Ms=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Long=void 0;var n=void 0;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}var r=4294967296,i=0x10000000000000000,o=i/2,s={},a={},u=function(){function t(e,n,r){if(void 0===e&&(e=0),void 0===n&&(n=0),!(this instanceof t))return new t(e,n,r);this.low=0|e,this.high=0|n,this.unsigned=!!r,Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return t.fromBits=function(e,n,r){return new t(e,n,r)},t.fromInt=function(e,n){var r,i,o;return n?(o=0<=(e>>>=0)&&e<256)&&(i=a[e])?i:(r=t.fromBits(e,(0|e)<0?-1:0,!0),o&&(a[e]=r),r):(o=-128<=(e|=0)&&e<128)&&(i=s[e])?i:(r=t.fromBits(e,e<0?-1:0,!1),o&&(s[e]=r),r)},t.fromNumber=function(e,n){if(isNaN(e))return n?t.UZERO:t.ZERO;if(n){if(e<0)return t.UZERO;if(e>=i)return t.MAX_UNSIGNED_VALUE}else{if(e<=-o)return t.MIN_VALUE;if(e+1>=o)return t.MAX_VALUE}return e<0?t.fromNumber(-e,n).neg():t.fromBits(e%r|0,e/r|0,n)},t.fromBigInt=function(e,n){return t.fromString(e.toString(),n)},t.fromString=function(e,n,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t.ZERO;if("number"==typeof n?(r=n,n=!1):n=!!n,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return t.fromString(e.substring(1),n,r).neg();for(var o=t.fromNumber(Math.pow(r,8)),s=t.ZERO,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+u),r);if(u<8){var l=t.fromNumber(Math.pow(r,u));s=s.mul(l).add(t.fromNumber(c))}else s=(s=s.mul(o)).add(t.fromNumber(c))}return s.unsigned=n,s},t.fromBytes=function(e,n,r){return r?t.fromBytesLE(e,n):t.fromBytesBE(e,n)},t.fromBytesLE=function(e,n){return new t(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)},t.fromBytesBE=function(e,n){return new t(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)},t.isLong=function(t){return ks.isObjectLike(t)&&!0===t.__isLong__},t.fromValue=function(e,n){return"number"==typeof e?t.fromNumber(e,n):"string"==typeof e?t.fromString(e,n):t.fromBits(e.low,e.high,"boolean"==typeof n?n:e.unsigned)},t.prototype.add=function(e){t.isLong(e)||(e=t.fromValue(e));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=0,l=0,h=0,f=0;return h+=(f+=o+(65535&e.low))>>>16,f&=65535,l+=(h+=i+u)>>>16,h&=65535,c+=(l+=r+a)>>>16,l&=65535,c+=n+s,c&=65535,t.fromBits(h<<16|f,c<<16|l,this.unsigned)},t.prototype.and=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.compare=function(e){if(t.isLong(e)||(e=t.fromValue(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},t.prototype.comp=function(t){return this.compare(t)},t.prototype.divide=function(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;var r=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var i,o,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return t.UZERO;if(e.gt(this.shru(1)))return t.UONE;s=t.UZERO}else{if(this.eq(t.MIN_VALUE))return e.eq(t.ONE)||e.eq(t.NEG_ONE)?t.MIN_VALUE:e.eq(t.MIN_VALUE)?t.ONE:(i=this.shr(1).div(e).shl(1)).eq(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(o=this.sub(e.mul(i)),s=i.add(o.div(e)));if(e.eq(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=t.ZERO}for(o=this;o.gte(e);){i=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),u=a<=48?1:Math.pow(2,a-48),c=t.fromNumber(i),l=c.mul(e);l.isNegative()||l.gt(o);)i-=u,l=(c=t.fromNumber(i,this.unsigned)).mul(e);c.isZero()&&(c=t.ONE),s=s.add(c),o=o.sub(l)}return s},t.prototype.div=function(t){return this.divide(t)},t.prototype.equals=function(e){return t.isLong(e)||(e=t.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},t.prototype.eq=function(t){return this.equals(t)},t.prototype.getHighBits=function(){return this.high},t.prototype.getHighBitsUnsigned=function(){return this.high>>>0},t.prototype.getLowBits=function(){return this.low},t.prototype.getLowBitsUnsigned=function(){return this.low>>>0},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(t.MIN_VALUE)?64:this.neg().getNumBitsAbs();var e,n=0!==this.high?this.high:this.low;for(e=31;e>0&&0==(n&1<<e);e--);return 0!==this.high?e+33:e+1},t.prototype.greaterThan=function(t){return this.comp(t)>0},t.prototype.gt=function(t){return this.greaterThan(t)},t.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},t.prototype.gte=function(t){return this.greaterThanOrEqual(t)},t.prototype.ge=function(t){return this.greaterThanOrEqual(t)},t.prototype.isEven=function(){return 0==(1&this.low)},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isOdd=function(){return 1==(1&this.low)},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isZero=function(){return 0===this.high&&0===this.low},t.prototype.lessThan=function(t){return this.comp(t)<0},t.prototype.lt=function(t){return this.lessThan(t)},t.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},t.prototype.lte=function(t){return this.lessThanOrEqual(t)},t.prototype.modulo=function(e){if(t.isLong(e)||(e=t.fromValue(e)),n){var r=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,n.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},t.prototype.mod=function(t){return this.modulo(t)},t.prototype.rem=function(t){return this.modulo(t)},t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(t.isLong(e)||(e=t.fromValue(e)),n){var r=n.mul(this.low,this.high,e.low,e.high);return t.fromBits(r,n.get_high(),this.unsigned)}if(e.isZero())return t.ZERO;if(this.eq(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.eq(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(t.TWO_PWR_24)&&e.lt(t.TWO_PWR_24))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,o=65535&this.high,s=this.low>>>16,a=65535&this.low,u=e.high>>>16,c=65535&e.high,l=e.low>>>16,h=65535&e.low,f=0,p=0,d=0,y=0;return d+=(y+=a*h)>>>16,y&=65535,p+=(d+=s*h)>>>16,d&=65535,p+=(d+=a*l)>>>16,d&=65535,f+=(p+=o*h)>>>16,p&=65535,f+=(p+=s*l)>>>16,p&=65535,f+=(p+=a*c)>>>16,p&=65535,f+=i*h+o*l+s*c+a*u,f&=65535,t.fromBits(d<<16|y,f<<16|p,this.unsigned)},t.prototype.mul=function(t){return this.multiply(t)},t.prototype.negate=function(){return!this.unsigned&&this.eq(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.neg=function(){return this.negate()},t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.notEquals=function(t){return!this.equals(t)},t.prototype.neq=function(t){return this.notEquals(t)},t.prototype.ne=function(t){return this.notEquals(t)},t.prototype.or=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.shiftLeft=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shl=function(t){return this.shiftLeft(t)},t.prototype.shiftRight=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shr=function(t){return this.shiftRight(t)},t.prototype.shiftRightUnsigned=function(e){if(t.isLong(e)&&(e=e.toInt()),0==(e&=63))return this;var n=this.high;if(e<32){var r=this.low;return t.fromBits(r>>>e|n<<32-e,n>>>e,this.unsigned)}return 32===e?t.fromBits(n,0,this.unsigned):t.fromBits(n>>>e-32,0,this.unsigned)},t.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},t.prototype.shru=function(t){return this.shiftRightUnsigned(t)},t.prototype.subtract=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.neg())},t.prototype.sub=function(t){return this.subtract(t)},t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*r+(this.low>>>0):this.high*r+(this.low>>>0)},t.prototype.toBigInt=function(){return BigInt(this.toString())},t.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},t.prototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},t.prototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},t.prototype.toSigned=function(){return this.unsigned?t.fromBits(this.low,this.high,!1):this},t.prototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(t.MIN_VALUE)){var n=t.fromNumber(e),r=this.div(n),i=r.mul(n).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=t.fromNumber(Math.pow(e,6),this.unsigned),s=this,a="";;){var u=s.div(o),c=(s.sub(u.mul(o)).toInt()>>>0).toString(e);if((s=u).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},t.prototype.toUnsigned=function(){return this.unsigned?this:t.fromBits(this.low,this.high,!0)},t.prototype.xor=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.eqz=function(){return this.isZero()},t.prototype.le=function(t){return this.lessThanOrEqual(t)},t.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},t.fromExtendedJSON=function(e,n){var r=t.fromString(e.$numberLong);return n&&n.relaxed?r.toNumber():r},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Long("'+this.toString()+'")'},t.TWO_PWR_24=t.fromInt(16777216),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t}();e.Long=u,Object.defineProperty(u.prototype,"__isLong__",{value:!0}),Object.defineProperty(u.prototype,"_bsontype",{value:"Long"})}));Yo(Ms),Ms.Long;var Ls=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Decimal128=void 0;var n=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,r=/^(\+|-)?(Infinity|inf)$/i,i=/^(\+|-)?NaN$/i,o=6111,s=-6176,a=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),u=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),c=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),l=/^([-+])?(\d+)?$/;function h(t){return!isNaN(parseInt(t,10))}function f(t){var e=Ms.Long.fromNumber(1e9),n=Ms.Long.fromNumber(0);if(!(t.parts[0]||t.parts[1]||t.parts[2]||t.parts[3]))return{quotient:t,rem:n};for(var r=0;r<=3;r++)n=(n=n.shiftLeft(32)).add(new Ms.Long(t.parts[r],0)),t.parts[r]=n.div(e).low,n=n.modulo(e);return{quotient:t,rem:n}}function p(t,e){throw new TypeError('"'+t+'" is not a valid Decimal128 string - '+e)}var d=function(){function t(e){if(!(this instanceof t))return new t(e);this.bytes=e}return t.fromString=function(e){var f,d=!1,y=!1,v=!1,g=0,b=0,m=0,w=0,_=0,S=[0],O=0,E=0,A=0,C=0,I=0,T=0,x=new Ms.Long(0,0),k=new Ms.Long(0,0),P=0;if(e.length>=7e3)throw new TypeError(e+" not a valid Decimal128 string");var N=e.match(n),B=e.match(r),D=e.match(i);if(!N&&!B&&!D||0===e.length)throw new TypeError(e+" not a valid Decimal128 string");if(N){var R=N[2],j=N[4],M=N[5],L=N[6];j&&void 0===L&&p(e,"missing exponent power"),j&&void 0===R&&p(e,"missing exponent base"),void 0===j&&(M||L)&&p(e,"missing e before exponent")}if("+"!==e[P]&&"-"!==e[P]||(d="-"===e[P++]),!h(e[P])&&"."!==e[P]){if("i"===e[P]||"I"===e[P])return new t(as.Buffer.from(d?u:c));if("N"===e[P])return new t(as.Buffer.from(a))}for(;h(e[P])||"."===e[P];)"."!==e[P]?(O<34&&("0"!==e[P]||v)&&(v||(_=b),v=!0,S[E++]=parseInt(e[P],10),O+=1),v&&(m+=1),y&&(w+=1),b+=1,P+=1):(y&&p(e,"contains multiple periods"),y=!0,P+=1);if(y&&!b)throw new TypeError(e+" not a valid Decimal128 string");if("e"===e[P]||"E"===e[P]){var F=e.substr(++P).match(l);if(!F||!F[2])return new t(as.Buffer.from(a));I=parseInt(F[0],10),P+=F[0].length}if(e[P])return new t(as.Buffer.from(a));if(A=0,O){if(C=O-1,1!==(g=m))for(;"0"===e[_+g-1];)g-=1}else A=0,C=0,S[0]=0,m=1,O=1,g=0;for(I<=w&&w-I>16384?I=s:I-=w;I>o;){if((C+=1)-A>34){if(S.join("").match(/^0+$/)){I=o;break}p(e,"overflow")}I-=1}for(;I<s||O<m;){if(0===C&&g<O){I=s,g=0;break}if(O<m?m-=1:C-=1,I<o)I+=1;else{if(S.join("").match(/^0+$/)){I=o;break}p(e,"overflow")}}if(C-A+1<g){var U=b;y&&(_+=1,U+=1),d&&(_+=1,U+=1);var V=parseInt(e[_+C+1],10),z=0;if(V>=5&&(z=1,5===V))for(z=S[C]%2==1?1:0,T=_+C+2;T<U;T++)if(parseInt(e[T],10)){z=1;break}if(z)for(var q=C;q>=0;q--)if(++S[q]>9&&(S[q]=0,0===q)){if(!(I<o))return new t(as.Buffer.from(d?u:c));I+=1,S[q]=1}}if(x=Ms.Long.fromNumber(0),k=Ms.Long.fromNumber(0),0===g)x=Ms.Long.fromNumber(0),k=Ms.Long.fromNumber(0);else if(C-A<17)for(q=A,k=Ms.Long.fromNumber(S[q++]),x=new Ms.Long(0,0);q<=C;q++)k=(k=k.multiply(Ms.Long.fromNumber(10))).add(Ms.Long.fromNumber(S[q]));else{for(q=A,x=Ms.Long.fromNumber(S[q++]);q<=C-17;q++)x=(x=x.multiply(Ms.Long.fromNumber(10))).add(Ms.Long.fromNumber(S[q]));for(k=Ms.Long.fromNumber(S[q++]);q<=C;q++)k=(k=k.multiply(Ms.Long.fromNumber(10))).add(Ms.Long.fromNumber(S[q]))}var W,G,H,Y,K=function(t,e){if(!t&&!e)return{high:Ms.Long.fromNumber(0),low:Ms.Long.fromNumber(0)};var n=t.shiftRightUnsigned(32),r=new Ms.Long(t.getLowBits(),0),i=e.shiftRightUnsigned(32),o=new Ms.Long(e.getLowBits(),0),s=n.multiply(i),a=n.multiply(o),u=r.multiply(i),c=r.multiply(o);return s=s.add(a.shiftRightUnsigned(32)),a=new Ms.Long(a.getLowBits(),0).add(u).add(c.shiftRightUnsigned(32)),{high:s=s.add(a.shiftRightUnsigned(32)),low:c=a.shiftLeft(32).add(new Ms.Long(c.getLowBits(),0))}}(x,Ms.Long.fromString("100000000000000000"));K.low=K.low.add(k),G=k,((H=(W=K.low).high>>>0)<(Y=G.high>>>0)||H===Y&&W.low>>>0<G.low>>>0)&&(K.high=K.high.add(Ms.Long.fromNumber(1))),f=I+6176;var Q={low:Ms.Long.fromNumber(0),high:Ms.Long.fromNumber(0)};K.high.shiftRightUnsigned(49).and(Ms.Long.fromNumber(1)).equals(Ms.Long.fromNumber(1))?(Q.high=Q.high.or(Ms.Long.fromNumber(3).shiftLeft(61)),Q.high=Q.high.or(Ms.Long.fromNumber(f).and(Ms.Long.fromNumber(16383).shiftLeft(47))),Q.high=Q.high.or(K.high.and(Ms.Long.fromNumber(0x7fffffffffff)))):(Q.high=Q.high.or(Ms.Long.fromNumber(16383&f).shiftLeft(49)),Q.high=Q.high.or(K.high.and(Ms.Long.fromNumber(562949953421311)))),Q.low=K.low,d&&(Q.high=Q.high.or(Ms.Long.fromString("9223372036854775808")));var J=as.Buffer.alloc(16);return P=0,J[P++]=255&Q.low.low,J[P++]=Q.low.low>>8&255,J[P++]=Q.low.low>>16&255,J[P++]=Q.low.low>>24&255,J[P++]=255&Q.low.high,J[P++]=Q.low.high>>8&255,J[P++]=Q.low.high>>16&255,J[P++]=Q.low.high>>24&255,J[P++]=255&Q.high.low,J[P++]=Q.high.low>>8&255,J[P++]=Q.high.low>>16&255,J[P++]=Q.high.low>>24&255,J[P++]=255&Q.high.high,J[P++]=Q.high.high>>8&255,J[P++]=Q.high.high>>16&255,J[P++]=Q.high.high>>24&255,new t(J)},t.prototype.toString=function(){for(var t,e=0,n=new Array(36),r=0;r<n.length;r++)n[r]=0;var i,o,s,a=0,u=!1,c={parts:[0,0,0,0]},l=[];a=0;var h=this.bytes,p=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24,d=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24,y=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24,v=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24;a=0,(new Ms.Long(p,d),new Ms.Long(y,v)).lessThan(Ms.Long.ZERO)&&l.push("-");var g=v>>26&31;if(g>>3==3){if(30===g)return l.join("")+"Infinity";if(31===g)return"NaN";t=v>>15&16383,i=8+(v>>14&1)}else i=v>>14&7,t=v>>17&16383;var b=t-6176;if(c.parts[0]=(16383&v)+((15&i)<<14),c.parts[1]=y,c.parts[2]=d,c.parts[3]=p,0===c.parts[0]&&0===c.parts[1]&&0===c.parts[2]&&0===c.parts[3])u=!0;else for(s=3;s>=0;s--){var m=0,w=f(c);if(c=w.quotient,m=w.rem.low)for(o=8;o>=0;o--)n[9*s+o]=m%10,m=Math.floor(m/10)}if(u)e=1,n[a]=0;else for(e=36;!n[a];)e-=1,a+=1;var _=e-1+b;if(_>=34||_<=-7||b>0){if(e>34)return l.push("0"),b>0?l.push("E+"+b):b<0&&l.push("E"+b),l.join("");for(l.push(""+n[a++]),(e-=1)&&l.push("."),r=0;r<e;r++)l.push(""+n[a++]);l.push("E"),_>0?l.push("+"+_):l.push(""+_)}else if(b>=0)for(r=0;r<e;r++)l.push(""+n[a++]);else{var S=e+b;if(S>0)for(r=0;r<S;r++)l.push(""+n[a++]);else l.push("0");for(l.push(".");S++<0;)l.push("0");for(r=0;r<e-Math.max(S-1,0);r++)l.push(""+n[a++])}return l.join("")},t.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},t.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},t.fromExtendedJSON=function(e){return t.fromString(e.$numberDecimal)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'Decimal128.fromString("'+this.toString()+'")'},t}();e.Decimal128=d,Object.defineProperty(d.prototype,"_bsontype",{value:"Decimal128"})}));Yo(Ls),Ls.Decimal128;var Fs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Double=void 0;var n=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-"+this.value.toFixed(1)}:(Number.isInteger(this.value)?(e=this.value.toFixed(1)).length>=13&&(e=this.value.toExponential(13).toUpperCase()):e=this.value.toString(),{$numberDouble:e});var e},t.fromExtendedJSON=function(e,n){var r=parseFloat(e.$numberDouble);return n&&n.relaxed?r:new t(r)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Double("+this.toExtendedJSON().$numberDouble+")"},t}();e.Double=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Double"})}));Yo(Fs),Fs.Double;var Us=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Int32=void 0;var n=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},t.fromExtendedJSON=function(e,n){return n&&n.relaxed?parseInt(e.$numberInt,10):new t(e.$numberInt)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Int32("+this.valueOf()+")"},t}();e.Int32=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Int32"})}));Yo(Us),Us.Int32;var Vs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MaxKey=void 0;var n=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$maxKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MaxKey()"},t}();e.MaxKey=n,Object.defineProperty(n.prototype,"_bsontype",{value:"MaxKey"})}));Yo(Vs),Vs.MaxKey;var zs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MinKey=void 0;var n=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$minKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MinKey()"},t}();e.MinKey=n,Object.defineProperty(n.prototype,"_bsontype",{value:"MinKey"})}));Yo(zs),zs.MinKey;var qs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectId=void 0;for(var n=ks.randomBytes(5),r=new RegExp("^[0-9a-fA-F]{24}$"),i=[],o=0;o<256;o++)i[o]=(o<=15?"0":"")+o.toString(16);for(var s=[],a=0;a<10;)s[48+a]=a++;for(;a<16;)s[55+a]=s[87+a]=a++;var u=Symbol("id"),c=function(){function t(e){if(!(this instanceof t))return new t(e);if(e instanceof t&&(this[u]=e.id,this.__id=e.__id),"object"==typeof e&&e&&"id"in e&&("toHexString"in e&&"function"==typeof e.toHexString?this[u]=as.Buffer.from(e.toHexString(),"hex"):this[u]="string"==typeof e.id?as.Buffer.from(e.id):e.id),null!=e&&"number"!=typeof e||(this[u]=t.generate("number"==typeof e?e:void 0),t.cacheHexString&&(this.__id=this.id.toString("hex"))),ArrayBuffer.isView(e)&&12===e.byteLength&&(this[u]=Ps.ensureBuffer(e)),"string"==typeof e)if(12===e.length){var n=as.Buffer.from(e);12===n.byteLength&&(this[u]=n)}else{if(24!==e.length||!r.test(e))throw new TypeError("Argument passed in must be a Buffer or string of 12 bytes or a string of 24 hex characters");this[u]=as.Buffer.from(e,"hex")}t.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(t.prototype,"id",{get:function(){return this[u]},set:function(e){this[u]=e,t.cacheHexString&&(this.__id=e.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(){if(t.cacheHexString&&this.__id)return this.__id;var e=this.id.toString("hex");return t.cacheHexString&&!this.__id&&(this.__id=e),e},t.getInc=function(){return t.index=(t.index+1)%16777215},t.generate=function(e){"number"!=typeof e&&(e=~~(Date.now()/1e3));var r=t.getInc(),i=as.Buffer.alloc(12);return i.writeUInt32BE(e,0),i[4]=n[0],i[5]=n[1],i[6]=n[2],i[7]=n[3],i[8]=n[4],i[11]=255&r,i[10]=r>>8&255,i[9]=r>>16&255,i},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){return null!=e&&(e instanceof t?this.toString()===e.toString():"string"==typeof e&&t.isValid(e)&&12===e.length&&as.Buffer.isBuffer(this.id)?e===this.id.toString("binary"):"string"==typeof e&&t.isValid(e)&&24===e.length?e.toLowerCase()===this.toHexString():"string"==typeof e&&t.isValid(e)&&12===e.length?as.Buffer.from(e).equals(this.id):"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&e.toHexString()===this.toHexString())},t.prototype.getTimestamp=function(){var t=new Date,e=this.id.readUInt32BE(0);return t.setTime(1e3*Math.floor(e)),t},t.createPk=function(){return new t},t.createFromTime=function(e){var n=as.Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0]);return n.writeUInt32BE(e,0),new t(n)},t.createFromHexString=function(e){if(void 0===e||null!=e&&24!==e.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new t(as.Buffer.from(e,"hex"))},t.isValid=function(e){return null!=e&&("number"==typeof e||("string"==typeof e?12===e.length||24===e.length&&r.test(e):e instanceof t||!(!as.Buffer.isBuffer(e)||12!==e.length)||"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&("string"==typeof e.id?12===e.id.length:24===e.toHexString().length&&r.test(e.id.toString("hex")))))},t.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},t.fromExtendedJSON=function(e){return new t(e.$oid)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new ObjectId("'+this.toHexString()+'")'},t.index=~~(16777215*Math.random()),t}();e.ObjectId=c,Object.defineProperty(c.prototype,"generate",{value:ks.deprecate((function(t){return c.generate(t)}),"Please use the static `ObjectId.generate(time)` instead")}),Object.defineProperty(c.prototype,"getInc",{value:ks.deprecate((function(){return c.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(c.prototype,"get_inc",{value:ks.deprecate((function(){return c.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(c,"get_inc",{value:ks.deprecate((function(){return c.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(c.prototype,"_bsontype",{value:"ObjectID"})}));Yo(qs),qs.ObjectId;var Ws=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.BSONRegExp=void 0;var n=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);this.pattern=e,this.options=null!=n?n:"",this.options.split("").sort().join("");for(var r=0;r<this.options.length;r++)if("i"!==this.options[r]&&"m"!==this.options[r]&&"x"!==this.options[r]&&"l"!==this.options[r]&&"s"!==this.options[r]&&"u"!==this.options[r])throw new Error("The regular expression option ["+this.options[r]+"] is not supported")}return t.parseOptions=function(t){return t?t.split("").sort().join(""):""},t.prototype.toExtendedJSON=function(t){return(t=t||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},t.fromExtendedJSON=function(e){if("$regex"in e){if("string"==typeof e.$regex)return new t(e.$regex,t.parseOptions(e.$options));if("BSONRegExp"===e.$regex._bsontype)return e}if("$regularExpression"in e)return new t(e.$regularExpression.pattern,t.parseOptions(e.$regularExpression.options));throw new TypeError("Unexpected BSONRegExp EJSON object form: "+JSON.stringify(e))},t}();e.BSONRegExp=n,Object.defineProperty(n.prototype,"_bsontype",{value:"BSONRegExp"})}));Yo(Ws),Ws.BSONRegExp;var Gs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.BSONSymbol=void 0;var n=function(){function t(e){if(!(this instanceof t))return new t(e);this.value=e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return this.value},t.prototype.inspect=function(){return'new BSONSymbol("'+this.value+'")'},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(){return{$symbol:this.value}},t.fromExtendedJSON=function(e){return new t(e.$symbol)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t}();e.BSONSymbol=n,Object.defineProperty(n.prototype,"_bsontype",{value:"Symbol"})}));Yo(Gs),Gs.BSONSymbol;var Hs=function(t,e){return(Hs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},Ys=function(){return(Ys=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Ks(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qs(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Js(t){return this instanceof Js?(this.v=t,this):new Js(t)}var Xs=Object.freeze({__proto__:null,__extends:function(t,e){function n(){this.constructor=t}Hs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},get __assign(){return Ys},__rest:function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},__decorate:function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":babelHelpers.typeof(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__param:function(t,e){return function(n,r){e(n,r,t)}},__metadata:function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":babelHelpers.typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},__generator:function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__createBinding:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]},__exportStar:function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])},__values:Ks,__read:Qs,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Qs(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r},__await:Js,__asyncGenerator:function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{(n=i[t](e)).value instanceof Js?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function u(t){a("next",t)}function c(t){a("throw",t)}function l(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:Js(t[r](e)),done:"return"===r}:i?i(e):e}:i}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=Ks(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}}),Zs=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Timestamp=e.LongWithoutOverridesClass=void 0,e.LongWithoutOverridesClass=Ms.Long;var n=function(t){function e(n,r){var i=this;return i instanceof e?(i=Ms.Long.isLong(n)?t.call(this,n.low,n.high,!0)||this:t.call(this,n,r,!0)||this,Object.defineProperty(i,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),i):new e(n,r)}return Xs.__extends(e,t),e.prototype.toJSON=function(){return{$timestamp:this.toString()}},e.fromInt=function(t){return new e(Ms.Long.fromInt(t,!0))},e.fromNumber=function(t){return new e(Ms.Long.fromNumber(t,!0))},e.fromBits=function(t,n){return new e(t,n)},e.fromString=function(t,n){return new e(Ms.Long.fromString(t,!0,n))},e.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},e.fromExtendedJSON=function(t){return new e(t.$timestamp.i,t.$timestamp.t)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Timestamp("+this.getLowBits().toString()+", "+this.getHighBits().toString()+")"},e.MAX_VALUE=Ms.Long.MAX_UNSIGNED_VALUE,e}(e.LongWithoutOverridesClass);e.Timestamp=n}));Yo(Zs),Zs.Timestamp,Zs.LongWithoutOverridesClass;var $s=Ko((function(t,e){function n(t){return ks.isObjectLike(t)&&Reflect.has(t,"_bsontype")&&"string"==typeof t._bsontype}Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=e.isBSONType=void 0,e.isBSONType=n;var r=2147483647,i=-2147483648,o=0x8000000000000000,s=-0x8000000000000000,a={$oid:qs.ObjectId,$binary:Ds.Binary,$uuid:Ds.Binary,$symbol:Gs.BSONSymbol,$numberInt:Us.Int32,$numberDecimal:Ls.Decimal128,$numberDouble:Fs.Double,$numberLong:Ms.Long,$minKey:zs.MinKey,$maxKey:Vs.MaxKey,$regex:Ws.BSONRegExp,$regularExpression:Ws.BSONRegExp,$timestamp:Zs.Timestamp};function u(t,e){if(void 0===e&&(e={}),"number"==typeof t){if(e.relaxed||e.legacy)return t;if(Math.floor(t)===t){if(t>=i&&t<=r)return new Us.Int32(t);if(t>=s&&t<=o)return Ms.Long.fromNumber(t)}return new Fs.Double(t)}if(null==t||"object"!=typeof t)return t;if(t.$undefined)return null;for(var n=Object.keys(t).filter((function(e){return e.startsWith("$")&&null!=t[e]})),c=0;c<n.length;c++){var l=a[n[c]];if(l)return l.fromExtendedJSON(t,e)}if(null!=t.$date){var h=t.$date,f=new Date;return e.legacy?"number"==typeof h?f.setTime(h):"string"==typeof h&&f.setTime(Date.parse(h)):"string"==typeof h?f.setTime(Date.parse(h)):Ms.Long.isLong(h)?f.setTime(h.toNumber()):"number"==typeof h&&e.relaxed&&f.setTime(h),f}if(null!=t.$code){var p=Object.assign({},t);return t.$scope&&(p.$scope=u(t.$scope)),Rs.Code.fromExtendedJSON(t)}if(null!=t.$ref||null!=t.$dbPointer){var d=t.$ref?t:t.$dbPointer;if(d instanceof js.DBRef)return d;var y=Object.keys(d).filter((function(t){return t.startsWith("$")})),v=!0;if(y.forEach((function(t){-1===["$ref","$id","$db"].indexOf(t)&&(v=!1)})),v)return js.DBRef.fromExtendedJSON(d)}return t}function c(t){var e=t.toISOString();return 0!==t.getUTCMilliseconds()?e:e.slice(0,-5)+"Z"}function l(t,e){if(Array.isArray(t))return function(t,e){return t.map((function(t){return l(t,e)}))}(t,e);if(void 0===t)return null;if(t instanceof Date){var a=t.getTime(),u=a>-1&&a<2534023188e5;return e.legacy?e.relaxed&&u?{$date:t.getTime()}:{$date:c(t)}:e.relaxed&&u?{$date:c(t)}:{$date:{$numberLong:t.getTime().toString()}}}if("number"==typeof t&&!e.relaxed){if(Math.floor(t)===t){var f=t>=s&&t<=o;if(t>=i&&t<=r)return{$numberInt:t.toString()};if(f)return{$numberLong:t.toString()}}return{$numberDouble:t.toString()}}if(t instanceof RegExp){var p=t.flags;if(void 0===p){var d=t.toString().match(/[gimuy]*$/);d&&(p=d[0])}return new Ws.BSONRegExp(t.source,p).toExtendedJSON(e)}return null!=t&&"object"==typeof t?function(t,e){if(null==t||"object"!=typeof t)throw new Error("not an object instance");var r=t._bsontype;if(void 0===r){var i={};for(var o in t)i[o]=l(t[o],e);return i}if(n(t)){var s=t;if("function"!=typeof s.toExtendedJSON){var a=h[t._bsontype];if(!a)throw new TypeError("Unrecognized or invalid _bsontype: "+t._bsontype);s=a(s)}return"Code"===r&&s.scope?s=new Rs.Code(s.code,l(s.scope,e)):"DBRef"===r&&s.oid&&(s=new js.DBRef(s.collection,l(s.oid,e),s.db,s.fields)),s.toExtendedJSON(e)}throw new Error("_bsontype must be a string, but was: "+typeof r)}(t,e):t}var h={Binary:function(t){return new Ds.Binary(t.value(),t.sub_type)},Code:function(t){return new Rs.Code(t.code,t.scope)},DBRef:function(t){return new js.DBRef(t.collection||t.namespace,t.oid,t.db,t.fields)},Decimal128:function(t){return new Ls.Decimal128(t.bytes)},Double:function(t){return new Fs.Double(t.value)},Int32:function(t){return new Us.Int32(t.value)},Long:function(t){return Ms.Long.fromBits(null!=t.low?t.low:t.low_,null!=t.low?t.high:t.high_,null!=t.low?t.unsigned:t.unsigned_)},MaxKey:function(){return new Vs.MaxKey},MinKey:function(){return new zs.MinKey},ObjectID:function(t){return new qs.ObjectId(t)},ObjectId:function(t){return new qs.ObjectId(t)},BSONRegExp:function(t){return new Ws.BSONRegExp(t.pattern,t.options)},Symbol:function(t){return new Gs.BSONSymbol(t.value)},Timestamp:function(t){return Zs.Timestamp.fromBits(t.low,t.high)}};!function(t){function e(t,e){var n=Object.assign({},{relaxed:!0,legacy:!1},e);return"boolean"==typeof n.relaxed&&(n.strict=!n.relaxed),"boolean"==typeof n.strict&&(n.relaxed=!n.strict),JSON.parse(t,(function(t,e){return u(e,n)}))}function n(t,e,n,r){null!=n&&"object"==typeof n&&(r=n,n=0),null==e||"object"!=typeof e||Array.isArray(e)||(r=e,e=void 0,n=0);var i=l(t,r=Object.assign({},{relaxed:!0,legacy:!1},r));return JSON.stringify(i,e,n)}t.parse=e,t.stringify=n,t.serialize=function(t,e){return e=e||{},JSON.parse(n(t,e))},t.deserialize=function(t,n){return n=n||{},e(JSON.stringify(t),n)}}(e.EJSON||(e.EJSON={}))}));Yo($s),$s.EJSON,$s.isBSONType;var ta=Ko((function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Map=void 0,e.Map=n;var r=function(t){return t&&t.Math==Math&&t},i=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof Ho&&Ho)||Function("return this")();Object.prototype.hasOwnProperty.call(i,"Map")?e.Map=n=i.Map:e.Map=n=function(){function t(t){void 0===t&&(t=[]),this._keys=[],this._values={};for(var e=0;e<t.length;e++)if(null!=t[e]){var n=t[e],r=n[0],i=n[1];this._keys.push(r),this._values[r]={v:i,i:this._keys.length-1}}}return t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(t){var e=this._values[t];return null!=e&&(delete this._values[t],this._keys.splice(e.i,1),!0)},t.prototype.entries=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?[n,t._values[n].v]:void 0,done:void 0===n}}}},t.prototype.forEach=function(t,e){e=e||this;for(var n=0;n<this._keys.length;n++){var r=this._keys[n];t.call(e,this._values[r].v,r,e)}},t.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},t.prototype.has=function(t){return null!=this._values[t]},t.prototype.keys=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?n:void 0,done:void 0===n}}}},t.prototype.set=function(t,e){return this._values[t]?(this._values[t].v=e,this):(this._keys.push(t),this._values[t]={v:e,i:this._keys.length-1},this)},t.prototype.values=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?t._values[n].v:void 0,done:void 0===n}}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),t}()}));Yo(ta),ta.Map;var ea=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.BSON_BINARY_SUBTYPE_USER_DEFINED=e.BSON_BINARY_SUBTYPE_MD5=e.BSON_BINARY_SUBTYPE_UUID_NEW=e.BSON_BINARY_SUBTYPE_UUID=e.BSON_BINARY_SUBTYPE_BYTE_ARRAY=e.BSON_BINARY_SUBTYPE_FUNCTION=e.BSON_BINARY_SUBTYPE_DEFAULT=e.BSON_DATA_MAX_KEY=e.BSON_DATA_MIN_KEY=e.BSON_DATA_DECIMAL128=e.BSON_DATA_LONG=e.BSON_DATA_TIMESTAMP=e.BSON_DATA_INT=e.BSON_DATA_CODE_W_SCOPE=e.BSON_DATA_SYMBOL=e.BSON_DATA_CODE=e.BSON_DATA_DBPOINTER=e.BSON_DATA_REGEXP=e.BSON_DATA_NULL=e.BSON_DATA_DATE=e.BSON_DATA_BOOLEAN=e.BSON_DATA_OID=e.BSON_DATA_UNDEFINED=e.BSON_DATA_BINARY=e.BSON_DATA_ARRAY=e.BSON_DATA_OBJECT=e.BSON_DATA_STRING=e.BSON_DATA_NUMBER=e.JS_INT_MIN=e.JS_INT_MAX=e.BSON_INT64_MIN=e.BSON_INT64_MAX=e.BSON_INT32_MIN=e.BSON_INT32_MAX=void 0,e.BSON_INT32_MAX=2147483647,e.BSON_INT32_MIN=-2147483648,e.BSON_INT64_MAX=Math.pow(2,63)-1,e.BSON_INT64_MIN=-Math.pow(2,63),e.JS_INT_MAX=Math.pow(2,53),e.JS_INT_MIN=-Math.pow(2,53),e.BSON_DATA_NUMBER=1,e.BSON_DATA_STRING=2,e.BSON_DATA_OBJECT=3,e.BSON_DATA_ARRAY=4,e.BSON_DATA_BINARY=5,e.BSON_DATA_UNDEFINED=6,e.BSON_DATA_OID=7,e.BSON_DATA_BOOLEAN=8,e.BSON_DATA_DATE=9,e.BSON_DATA_NULL=10,e.BSON_DATA_REGEXP=11,e.BSON_DATA_DBPOINTER=12,e.BSON_DATA_CODE=13,e.BSON_DATA_SYMBOL=14,e.BSON_DATA_CODE_W_SCOPE=15,e.BSON_DATA_INT=16,e.BSON_DATA_TIMESTAMP=17,e.BSON_DATA_LONG=18,e.BSON_DATA_DECIMAL128=19,e.BSON_DATA_MIN_KEY=255,e.BSON_DATA_MAX_KEY=127,e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BSON_BINARY_SUBTYPE_FUNCTION=1,e.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,e.BSON_BINARY_SUBTYPE_UUID=3,e.BSON_BINARY_SUBTYPE_UUID_NEW=4,e.BSON_BINARY_SUBTYPE_MD5=5,e.BSON_BINARY_SUBTYPE_USER_DEFINED=128}));Yo(ea),ea.BSON_BINARY_SUBTYPE_USER_DEFINED,ea.BSON_BINARY_SUBTYPE_MD5,ea.BSON_BINARY_SUBTYPE_UUID_NEW,ea.BSON_BINARY_SUBTYPE_UUID,ea.BSON_BINARY_SUBTYPE_BYTE_ARRAY,ea.BSON_BINARY_SUBTYPE_FUNCTION,ea.BSON_BINARY_SUBTYPE_DEFAULT,ea.BSON_DATA_MAX_KEY,ea.BSON_DATA_MIN_KEY,ea.BSON_DATA_DECIMAL128,ea.BSON_DATA_LONG,ea.BSON_DATA_TIMESTAMP,ea.BSON_DATA_INT,ea.BSON_DATA_CODE_W_SCOPE,ea.BSON_DATA_SYMBOL,ea.BSON_DATA_CODE,ea.BSON_DATA_DBPOINTER,ea.BSON_DATA_REGEXP,ea.BSON_DATA_NULL,ea.BSON_DATA_DATE,ea.BSON_DATA_BOOLEAN,ea.BSON_DATA_OID,ea.BSON_DATA_UNDEFINED,ea.BSON_DATA_BINARY,ea.BSON_DATA_ARRAY,ea.BSON_DATA_OBJECT,ea.BSON_DATA_STRING,ea.BSON_DATA_NUMBER,ea.JS_INT_MIN,ea.JS_INT_MAX,ea.BSON_INT64_MIN,ea.BSON_INT64_MAX,ea.BSON_INT32_MIN,ea.BSON_INT32_MAX;var na=Ko((function(t,e){function n(t,e,n){var i=5;if(Array.isArray(t))for(var o=0;o<t.length;o++)i+=r(o.toString(),t[o],e,!0,n);else for(var s in t.toBSON&&(t=t.toBSON()),t)i+=r(s,t[s],e,!1,n);return i}function r(t,e,r,i,o){switch(void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),e&&e.toBSON&&(e=e.toBSON()),typeof e){case"string":return 1+as.Buffer.byteLength(t,"utf8")+1+4+as.Buffer.byteLength(e,"utf8")+1;case"number":return Math.floor(e)===e&&e>=ea.JS_INT_MIN&&e<=ea.JS_INT_MAX&&e>=ea.BSON_INT32_MIN&&e<=ea.BSON_INT32_MAX?(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+5:(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+9;case"undefined":return i||!o?(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1:0;case"boolean":return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+2;case"object":if(null==e||"MinKey"===e._bsontype||"MaxKey"===e._bsontype)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1;if("ObjectId"===e._bsontype||"ObjectID"===e._bsontype)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+13;if(e instanceof Date||ks.isDate(e))return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+9;if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+6+e.byteLength;if("Long"===e._bsontype||"Double"===e._bsontype||"Timestamp"===e._bsontype)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+9;if("Decimal128"===e._bsontype)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+17;if("Code"===e._bsontype)return null!=e.scope&&Object.keys(e.scope).length>0?(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+4+4+as.Buffer.byteLength(e.code.toString(),"utf8")+1+n(e.scope,r,o):(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+4+as.Buffer.byteLength(e.code.toString(),"utf8")+1;if("Binary"===e._bsontype)return e.sub_type===Ds.Binary.SUBTYPE_BYTE_ARRAY?(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+(e.position+1+4+1+4):(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+(e.position+1+4+1);if("Symbol"===e._bsontype)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+as.Buffer.byteLength(e.value,"utf8")+4+1+1;if("DBRef"===e._bsontype){var s=Object.assign({$ref:e.collection,$id:e.oid},e.fields);return null!=e.db&&(s.$db=e.db),(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+n(s,r,o)}return e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)?(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+as.Buffer.byteLength(e.source,"utf8")+1+(e.global?1:0)+(e.ignoreCase?1:0)+(e.multiline?1:0)+1:"BSONRegExp"===e._bsontype?(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+as.Buffer.byteLength(e.pattern,"utf8")+1+as.Buffer.byteLength(e.options,"utf8")+1:(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+n(e,r,o)+1;case"function":if(e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)||"[object RegExp]"===String.call(e))return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+as.Buffer.byteLength(e.source,"utf8")+1+(e.global?1:0)+(e.ignoreCase?1:0)+(e.multiline?1:0)+1;if(r&&null!=e.scope&&Object.keys(e.scope).length>0)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+4+4+as.Buffer.byteLength(ks.normalizedFunctionString(e),"utf8")+1+n(e.scope,r,o);if(r)return(null!=t?as.Buffer.byteLength(t,"utf8")+1:0)+1+4+as.Buffer.byteLength(ks.normalizedFunctionString(e),"utf8")+1}return 0}Object.defineProperty(e,"__esModule",{value:!0}),e.calculateObjectSize=void 0,e.calculateObjectSize=n}));Yo(na),na.calculateObjectSize;var ra=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateUtf8=void 0,e.validateUtf8=function(t,e,n){for(var r=0,i=e;i<n;i+=1){var o=t[i];if(r){if(128!=(192&o))return!1;r-=1}else if(128&o)if(192==(224&o))r=1;else if(224==(240&o))r=2;else{if(240!=(248&o))return!1;r=3}}return!r}}));Yo(ra),ra.validateUtf8;var ia=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.deserialize=void 0;var n=Ms.Long.fromNumber(ea.JS_INT_MAX),r=Ms.Long.fromNumber(ea.JS_INT_MIN),i={};function o(t,e,a,u){void 0===u&&(u=!1);var c=null!=a.evalFunctions&&a.evalFunctions,l=null!=a.cacheFunctions&&a.cacheFunctions,h=null==a.fieldsAsRaw?null:a.fieldsAsRaw,f=null!=a.raw&&a.raw,p="boolean"==typeof a.bsonRegExp&&a.bsonRegExp,d=null!=a.promoteBuffers&&a.promoteBuffers,y=null==a.promoteLongs||a.promoteLongs,v=null==a.promoteValues||a.promoteValues,g=e;if(t.length<5)throw new Error("corrupt bson message < 5 bytes long");var b=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;if(b<5||b>t.length)throw new Error("corrupt bson message");for(var m=u?[]:{},w=0;;){var _=t[e++];if(0===_)break;for(var S=e;0!==t[S]&&S<t.length;)S++;if(S>=t.byteLength)throw new Error("Bad BSON Document: illegal CString");var O=u?w++:t.toString("utf8",e,S);if(e=S+1,_===ea.BSON_DATA_STRING){if((Y=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Y>t.length-e||0!==t[e+Y-1])throw new Error("bad string length in bson");if(!ra.validateUtf8(t,e,e+Y-1))throw new Error("Invalid UTF-8 string in BSON document");var E=t.toString("utf8",e,e+Y-1);m[O]=E,e+=Y}else if(_===ea.BSON_DATA_OID){var A=as.Buffer.alloc(12);t.copy(A,0,e,e+12),m[O]=new qs.ObjectId(A),e+=12}else if(_===ea.BSON_DATA_INT&&!1===v)m[O]=new Us.Int32(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24);else if(_===ea.BSON_DATA_INT)m[O]=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;else if(_===ea.BSON_DATA_NUMBER&&!1===v)m[O]=new Fs.Double(t.readDoubleLE(e)),e+=8;else if(_===ea.BSON_DATA_NUMBER)m[O]=t.readDoubleLE(e),e+=8;else if(_===ea.BSON_DATA_DATE){var C=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,I=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;m[O]=new Date(new Ms.Long(C,I).toNumber())}else if(_===ea.BSON_DATA_BOOLEAN){if(0!==t[e]&&1!==t[e])throw new Error("illegal boolean type value");m[O]=1===t[e++]}else if(_===ea.BSON_DATA_OBJECT){var T=e;if((G=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)<=0||G>t.length-e)throw new Error("bad embedded document length in bson");m[O]=f?t.slice(e,e+G):o(t,T,a,!1),e+=G}else if(_===ea.BSON_DATA_ARRAY){T=e;var x=a,k=e+(G=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24);if(h&&h[O]){for(var P in x={},a)x[P]=a[P];x.raw=!0}if(m[O]=o(t,T,x,!0),0!==t[(e+=G)-1])throw new Error("invalid array terminator byte");if(e!==k)throw new Error("corrupted array bson")}else if(_===ea.BSON_DATA_UNDEFINED)m[O]=void 0;else if(_===ea.BSON_DATA_NULL)m[O]=null;else if(_===ea.BSON_DATA_LONG){C=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,I=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;var N=new Ms.Long(C,I);m[O]=y&&!0===v&&N.lessThanOrEqual(n)&&N.greaterThanOrEqual(r)?N.toNumber():N}else if(_===ea.BSON_DATA_DECIMAL128){var B=as.Buffer.alloc(16);t.copy(B,0,e,e+16),e+=16;var D=new Ls.Decimal128(B);"toObject"in D&&"function"==typeof D.toObject?m[O]=D.toObject():m[O]=D}else if(_===ea.BSON_DATA_BINARY){var R=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,j=R,M=t[e++];if(R<0)throw new Error("Negative binary type element size found");if(R>t.byteLength)throw new Error("Binary type size larger than document size");if(null!=t.slice){if(M===Ds.Binary.SUBTYPE_BYTE_ARRAY){if((R=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(R>j-4)throw new Error("Binary type with subtype 0x02 contains too long binary size");if(R<j-4)throw new Error("Binary type with subtype 0x02 contains too short binary size")}m[O]=d&&v?t.slice(e,e+R):new Ds.Binary(t.slice(e,e+R),M)}else{var L=as.Buffer.alloc(R);if(M===Ds.Binary.SUBTYPE_BYTE_ARRAY){if((R=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(R>j-4)throw new Error("Binary type with subtype 0x02 contains too long binary size");if(R<j-4)throw new Error("Binary type with subtype 0x02 contains too short binary size")}for(S=0;S<R;S++)L[S]=t[e+S];m[O]=d&&v?L:new Ds.Binary(L,M)}e+=R}else if(_===ea.BSON_DATA_REGEXP&&!1===p){for(S=e;0!==t[S]&&S<t.length;)S++;if(S>=t.length)throw new Error("Bad BSON Document: illegal CString");var F=t.toString("utf8",e,S);for(S=e=S+1;0!==t[S]&&S<t.length;)S++;if(S>=t.length)throw new Error("Bad BSON Document: illegal CString");var U=t.toString("utf8",e,S);e=S+1;var V=new Array(U.length);for(S=0;S<U.length;S++)switch(U[S]){case"m":V[S]="m";break;case"s":V[S]="g";break;case"i":V[S]="i"}m[O]=new RegExp(F,V.join(""))}else if(_===ea.BSON_DATA_REGEXP&&!0===p){for(S=e;0!==t[S]&&S<t.length;)S++;if(S>=t.length)throw new Error("Bad BSON Document: illegal CString");for(F=t.toString("utf8",e,S),S=e=S+1;0!==t[S]&&S<t.length;)S++;if(S>=t.length)throw new Error("Bad BSON Document: illegal CString");U=t.toString("utf8",e,S),e=S+1,m[O]=new Ws.BSONRegExp(F,U)}else if(_===ea.BSON_DATA_SYMBOL){if((Y=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Y>t.length-e||0!==t[e+Y-1])throw new Error("bad string length in bson");var z=t.toString("utf8",e,e+Y-1);m[O]=v?z:new Gs.BSONSymbol(z),e+=Y}else if(_===ea.BSON_DATA_TIMESTAMP)C=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,I=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,m[O]=new Zs.Timestamp(C,I);else if(_===ea.BSON_DATA_MIN_KEY)m[O]=new zs.MinKey;else if(_===ea.BSON_DATA_MAX_KEY)m[O]=new Vs.MaxKey;else if(_===ea.BSON_DATA_CODE){if((Y=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Y>t.length-e||0!==t[e+Y-1])throw new Error("bad string length in bson");var q=t.toString("utf8",e,e+Y-1);m[O]=c?l?s(q,i,m):s(q):new Rs.Code(q),e+=Y}else if(_===ea.BSON_DATA_CODE_W_SCOPE){var W=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;if(W<13)throw new Error("code_w_scope total size shorter minimum expected length");if((Y=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Y>t.length-e||0!==t[e+Y-1])throw new Error("bad string length in bson");q=t.toString("utf8",e,e+Y-1),T=e+=Y;var G=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,H=o(t,T,a,!1);if(e+=G,W<8+G+Y)throw new Error("code_w_scope total size is too short, truncating scope");if(W>8+G+Y)throw new Error("code_w_scope total size is too long, clips outer document");c?(m[O]=l?s(q,i,m):s(q),m[O].scope=H):m[O]=new Rs.Code(q,H)}else{if(_!==ea.BSON_DATA_DBPOINTER)throw new Error("Detected unknown BSON type "+_.toString(16)+' for fieldname "'+O+'"');var Y;if((Y=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Y>t.length-e||0!==t[e+Y-1])throw new Error("bad string length in bson");if(!ra.validateUtf8(t,e,e+Y-1))throw new Error("Invalid UTF-8 string in BSON document");var K=t.toString("utf8",e,e+Y-1);e+=Y;var Q=as.Buffer.alloc(12);t.copy(Q,0,e,e+12),A=new qs.ObjectId(Q),e+=12,m[O]=new js.DBRef(K,A)}}if(b!==e-g){if(u)throw new Error("corrupt array bson");throw new Error("corrupt object bson")}var J=Object.keys(m).filter((function(t){return t.startsWith("$")})),X=!0;if(J.forEach((function(t){-1===["$ref","$id","$db"].indexOf(t)&&(X=!1)})),!X)return m;if(js.isDBRefLike(m)){var Z=Object.assign({},m);return delete Z.$ref,delete Z.$id,delete Z.$db,new js.DBRef(m.$ref,m.$id,m.$db,Z)}return m}function s(t,e,n){return e?(null==e[t]&&(e[t]=new Function(t)),e[t].bind(n)):new Function(t)}e.deserialize=function(t,e,n){var r=(e=null==e?{}:e)&&e.index?e.index:0,i=t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24;if(i<5)throw new Error("bson size must be >= 5, is "+i);if(e.allowObjectSmallerThanBufferSize&&t.length<i)throw new Error("buffer length "+t.length+" must be >= bson size "+i);if(!e.allowObjectSmallerThanBufferSize&&t.length!==i)throw new Error("buffer length "+t.length+" must === bson size "+i);if(i+r>t.byteLength)throw new Error("(bson size "+i+" + options.index "+r+" must be <= buffer length "+t.byteLength+")");if(0!==t[r+i-1])throw new Error("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return o(t,r,e,n)}}));Yo(ia),ia.deserialize;var oa=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.writeIEEE754=e.readIEEE754=void 0,e.readIEEE754=function(t,e,n,r,i){var o,s,a="big"===n,u=8*i-r-1,c=(1<<u)-1,l=c>>1,h=-7,f=a?0:i-1,p=a?1:-1,d=t[e+f];for(f+=p,o=d&(1<<-h)-1,d>>=-h,h+=u;h>0;o=256*o+t[e+f],f+=p,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+f],f+=p,h-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=l}return(d?-1:1)*s*Math.pow(2,o-r)},e.writeIEEE754=function(t,e,n,r,i,o){var s,a,u,c="big"===r,l=8*o-i-1,h=(1<<l)-1,f=h>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=c?o-1:0,y=c?-1:1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+f>=1?p/u:p*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=h?(a=0,s=h):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0)),isNaN(e)&&(a=0);i>=8;)t[n+d]=255&a,d+=y,a/=256,i-=8;for(s=s<<i|a,isNaN(e)&&(s+=8),l+=i;l>0;)t[n+d]=255&s,d+=y,s/=256,l-=8;t[n+d-y]|=128*v}}));Yo(oa),oa.writeIEEE754,oa.readIEEE754;var sa=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeInto=void 0;var n=/\x00/,r=new Set(["$db","$ref","$id","$clusterTime"]);function i(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function o(t,e,n,r,i){t[r++]=ea.BSON_DATA_STRING;var o=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8");t[(r=r+o+1)-1]=0;var s=t.write(n,r+4,void 0,"utf8");return t[r+3]=s+1>>24&255,t[r+2]=s+1>>16&255,t[r+1]=s+1>>8&255,t[r]=s+1&255,r=r+4+s,t[r++]=0,r}function s(t,e,n,r,i){return Number.isInteger(n)&&n>=ea.BSON_INT32_MIN&&n<=ea.BSON_INT32_MAX?(t[r++]=ea.BSON_DATA_INT,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=n>>16&255,t[r++]=n>>24&255):(t[r++]=ea.BSON_DATA_NUMBER,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,oa.writeIEEE754(t,n,r,"little",52,8),r+=8),r}function a(t,e,n,r,i){return t[r++]=ea.BSON_DATA_NULL,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,r}function u(t,e,n,r,i){return t[r++]=ea.BSON_DATA_BOOLEAN,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t[r++]=n?1:0,r}function c(t,e,n,r,i){t[r++]=ea.BSON_DATA_DATE,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=Ms.Long.fromNumber(n.getTime()),s=o.getLowBits(),a=o.getHighBits();return t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,t[r++]=255&a,t[r++]=a>>8&255,t[r++]=a>>16&255,t[r++]=a>>24&255,r}function l(t,e,r,i,o){if(t[i++]=ea.BSON_DATA_REGEXP,i+=o?t.write(e,i,void 0,"ascii"):t.write(e,i,void 0,"utf8"),t[i++]=0,r.source&&null!=r.source.match(n))throw Error("value "+r.source+" must not contain null bytes");return i+=t.write(r.source,i,void 0,"utf8"),t[i++]=0,r.ignoreCase&&(t[i++]=105),r.global&&(t[i++]=115),r.multiline&&(t[i++]=109),t[i++]=0,i}function h(t,e,r,i,o){if(t[i++]=ea.BSON_DATA_REGEXP,i+=o?t.write(e,i,void 0,"ascii"):t.write(e,i,void 0,"utf8"),t[i++]=0,null!=r.pattern.match(n))throw Error("pattern "+r.pattern+" must not contain null bytes");return i+=t.write(r.pattern,i,void 0,"utf8"),t[i++]=0,i+=t.write(r.options.split("").sort().join(""),i,void 0,"utf8"),t[i++]=0,i}function f(t,e,n,r,i){return null===n?t[r++]=ea.BSON_DATA_NULL:"MinKey"===n._bsontype?t[r++]=ea.BSON_DATA_MIN_KEY:t[r++]=ea.BSON_DATA_MAX_KEY,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,r}function p(t,e,n,r,i){if(t[r++]=ea.BSON_DATA_OID,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,"string"==typeof n.id)t.write(n.id,r,void 0,"binary");else{if(!n.id||!n.id.copy)throw new TypeError("object ["+JSON.stringify(n)+"] is not a valid ObjectId");n.id.copy(t,r,0,12)}return r+12}function d(t,e,n,r,i){t[r++]=ea.BSON_DATA_BINARY,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=n.length;return t[r++]=255&o,t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255,t[r++]=ea.BSON_BINARY_SUBTYPE_DEFAULT,t.set(Ps.ensureBuffer(n),r),r+o}function y(t,e,n,r,i,o,s,a,u,c){void 0===i&&(i=!1),void 0===o&&(o=0),void 0===s&&(s=!1),void 0===a&&(a=!0),void 0===u&&(u=!1),void 0===c&&(c=[]);for(var l=0;l<c.length;l++)if(c[l]===n)throw new Error("cyclic dependency detected");c.push(n),t[r++]=Array.isArray(n)?ea.BSON_DATA_ARRAY:ea.BSON_DATA_OBJECT,r+=u?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var h=A(t,n,i,r,o+1,s,a,c);return c.pop(),h}function v(t,e,n,r,i){return t[r++]=ea.BSON_DATA_DECIMAL128,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,n.bytes.copy(t,r,0,16),r+16}function g(t,e,n,r,i){t[r++]="Long"===n._bsontype?ea.BSON_DATA_LONG:ea.BSON_DATA_TIMESTAMP,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=n.getLowBits(),s=n.getHighBits();return t[r++]=255&o,t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255,t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,r}function b(t,e,n,r,i){return n=n.valueOf(),t[r++]=ea.BSON_DATA_INT,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=n>>16&255,t[r++]=n>>24&255,r}function m(t,e,n,r,i){return t[r++]=ea.BSON_DATA_NUMBER,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,oa.writeIEEE754(t,n.value,r,"little",52,8),r+8}function w(t,e,n,r,i,o,s){t[r++]=ea.BSON_DATA_CODE,r+=s?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var a=ks.normalizedFunctionString(n),u=t.write(a,r+4,void 0,"utf8")+1;return t[r]=255&u,t[r+1]=u>>8&255,t[r+2]=u>>16&255,t[r+3]=u>>24&255,r=r+4+u-1,t[r++]=0,r}function _(t,e,n,r,i,o,s,a,u){if(void 0===i&&(i=!1),void 0===o&&(o=0),void 0===s&&(s=!1),void 0===a&&(a=!0),void 0===u&&(u=!1),n.scope&&"object"==typeof n.scope){t[r++]=ea.BSON_DATA_CODE_W_SCOPE,r+=u?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var c=r,l="string"==typeof n.code?n.code:n.code.toString();r+=4;var h=t.write(l,r+4,void 0,"utf8")+1;t[r]=255&h,t[r+1]=h>>8&255,t[r+2]=h>>16&255,t[r+3]=h>>24&255,t[r+4+h-1]=0,r=r+h+4;var f=A(t,n.scope,i,r,o+1,s,a);r=f-1;var p=f-c;t[c++]=255&p,t[c++]=p>>8&255,t[c++]=p>>16&255,t[c++]=p>>24&255,t[r++]=0}else{t[r++]=ea.BSON_DATA_CODE,r+=u?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,l=n.code.toString();var d=t.write(l,r+4,void 0,"utf8")+1;t[r]=255&d,t[r+1]=d>>8&255,t[r+2]=d>>16&255,t[r+3]=d>>24&255,r=r+4+d-1,t[r++]=0}return r}function S(t,e,n,r,i){t[r++]=ea.BSON_DATA_BINARY,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=n.value(!0),s=n.position;return n.sub_type===Ds.Binary.SUBTYPE_BYTE_ARRAY&&(s+=4),t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,t[r++]=n.sub_type,n.sub_type===Ds.Binary.SUBTYPE_BYTE_ARRAY&&(s-=4,t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255),t.set(o,r),r+n.position}function O(t,e,n,r,i){t[r++]=ea.BSON_DATA_SYMBOL,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=t.write(n.value,r+4,void 0,"utf8")+1;return t[r]=255&o,t[r+1]=o>>8&255,t[r+2]=o>>16&255,t[r+3]=o>>24&255,r=r+4+o-1,t[r++]=0,r}function E(t,e,n,r,i,o,s){t[r++]=ea.BSON_DATA_OBJECT,r+=s?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var a=r,u={$ref:n.collection||n.namespace,$id:n.oid};null!=n.db&&(u.$db=n.db);var c=A(t,u=Object.assign(u,n.fields),!1,r,i+1,o),l=c-a;return t[a++]=255&l,t[a++]=l>>8&255,t[a++]=l>>16&255,t[a++]=l>>24&255,c}function A(t,e,A,C,I,T,x,k){void 0===A&&(A=!1),void 0===C&&(C=0),void 0===I&&(I=0),void 0===T&&(T=!1),void 0===x&&(x=!0),void 0===k&&(k=[]),C=C||0,(k=k||[]).push(e);var P=C+4;if(Array.isArray(e))for(var N=0;N<e.length;N++){var B=""+N;if((L=e[N])&&L.toBSON){if("function"!=typeof L.toBSON)throw new TypeError("toBSON is not a function");L=L.toBSON()}if("string"==typeof L)P=o(t,B,L,P,!0);else if("number"==typeof L)P=s(t,B,L,P,!0);else{if("bigint"==typeof L)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"==typeof L)P=u(t,B,L,P,!0);else if(L instanceof Date||ks.isDate(L))P=c(t,B,L,P,!0);else if(void 0===L)P=a(t,B,0,P,!0);else if(null===L)P=a(t,B,0,P,!0);else if("ObjectId"===L._bsontype||"ObjectID"===L._bsontype)P=p(t,B,L,P,!0);else if(ks.isBuffer(L)||ks.isUint8Array(L))P=d(t,B,L,P,!0);else if(L instanceof RegExp||i(L))P=l(t,B,L,P,!0);else if("object"==typeof L&&null==L._bsontype)P=y(t,B,L,P,A,I,T,x,!0,k);else if("object"==typeof L&&$s.isBSONType(L)&&"Decimal128"===L._bsontype)P=v(t,B,L,P,!0);else if("Long"===L._bsontype||"Timestamp"===L._bsontype)P=g(t,B,L,P,!0);else if("Double"===L._bsontype)P=m(t,B,L,P,!0);else if("function"==typeof L&&T)P=w(t,B,L,P,0,0,!0);else if("Code"===L._bsontype)P=_(t,B,L,P,A,I,T,x,!0);else if("Binary"===L._bsontype)P=S(t,B,L,P,!0);else if("Symbol"===L._bsontype)P=O(t,B,L,P,!0);else if("DBRef"===L._bsontype)P=E(t,B,L,P,I,T,!0);else if("BSONRegExp"===L._bsontype)P=h(t,B,L,P,!0);else if("Int32"===L._bsontype)P=b(t,B,L,P,!0);else if("MinKey"===L._bsontype||"MaxKey"===L._bsontype)P=f(t,B,L,P,!0);else if(void 0!==L._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+L._bsontype)}}else if(e instanceof ta.Map)for(var D=e.entries(),R=!1;!R;){var j=D.next();if(!(R=!!j.done)){B=j.value[0];var M=typeof(L=j.value[1]);if("string"==typeof B&&!r.has(B)){if(null!=B.match(n))throw Error("key "+B+" must not contain null bytes");if(A){if("$"===B[0])throw Error("key "+B+" must not start with '$'");if(~B.indexOf("."))throw Error("key "+B+" must not contain '.'")}}if("string"===M)P=o(t,B,L,P);else if("number"===M)P=s(t,B,L,P);else{if("bigint"===M||ks.isBigInt64Array(L)||ks.isBigUInt64Array(L))throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===M)P=u(t,B,L,P);else if(L instanceof Date||ks.isDate(L))P=c(t,B,L,P);else if(null===L||void 0===L&&!1===x)P=a(t,B,0,P);else if("ObjectId"===L._bsontype||"ObjectID"===L._bsontype)P=p(t,B,L,P);else if(ks.isBuffer(L)||ks.isUint8Array(L))P=d(t,B,L,P);else if(L instanceof RegExp||i(L))P=l(t,B,L,P);else if("object"===M&&null==L._bsontype)P=y(t,B,L,P,A,I,T,x,!1,k);else if("object"===M&&"Decimal128"===L._bsontype)P=v(t,B,L,P);else if("Long"===L._bsontype||"Timestamp"===L._bsontype)P=g(t,B,L,P);else if("Double"===L._bsontype)P=m(t,B,L,P);else if("Code"===L._bsontype)P=_(t,B,L,P,A,I,T,x);else if("function"==typeof L&&T)P=w(t,B,L,P,0,0,T);else if("Binary"===L._bsontype)P=S(t,B,L,P);else if("Symbol"===L._bsontype)P=O(t,B,L,P);else if("DBRef"===L._bsontype)P=E(t,B,L,P,I,T);else if("BSONRegExp"===L._bsontype)P=h(t,B,L,P);else if("Int32"===L._bsontype)P=b(t,B,L,P);else if("MinKey"===L._bsontype||"MaxKey"===L._bsontype)P=f(t,B,L,P);else if(void 0!==L._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+L._bsontype)}}}else{if(e.toBSON){if("function"!=typeof e.toBSON)throw new TypeError("toBSON is not a function");if(null!=(e=e.toBSON())&&"object"!=typeof e)throw new TypeError("toBSON function did not return an object")}for(var B in e){var L;if((L=e[B])&&L.toBSON){if("function"!=typeof L.toBSON)throw new TypeError("toBSON is not a function");L=L.toBSON()}if(M=typeof L,"string"==typeof B&&!r.has(B)){if(null!=B.match(n))throw Error("key "+B+" must not contain null bytes");if(A){if("$"===B[0])throw Error("key "+B+" must not start with '$'");if(~B.indexOf("."))throw Error("key "+B+" must not contain '.'")}}if("string"===M)P=o(t,B,L,P);else if("number"===M)P=s(t,B,L,P);else{if("bigint"===M)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===M)P=u(t,B,L,P);else if(L instanceof Date||ks.isDate(L))P=c(t,B,L,P);else if(void 0===L)!1===x&&(P=a(t,B,0,P));else if(null===L)P=a(t,B,0,P);else if("ObjectId"===L._bsontype||"ObjectID"===L._bsontype)P=p(t,B,L,P);else if(ks.isBuffer(L)||ks.isUint8Array(L))P=d(t,B,L,P);else if(L instanceof RegExp||i(L))P=l(t,B,L,P);else if("object"===M&&null==L._bsontype)P=y(t,B,L,P,A,I,T,x,!1,k);else if("object"===M&&"Decimal128"===L._bsontype)P=v(t,B,L,P);else if("Long"===L._bsontype||"Timestamp"===L._bsontype)P=g(t,B,L,P);else if("Double"===L._bsontype)P=m(t,B,L,P);else if("Code"===L._bsontype)P=_(t,B,L,P,A,I,T,x);else if("function"==typeof L&&T)P=w(t,B,L,P,0,0,T);else if("Binary"===L._bsontype)P=S(t,B,L,P);else if("Symbol"===L._bsontype)P=O(t,B,L,P);else if("DBRef"===L._bsontype)P=E(t,B,L,P,I,T);else if("BSONRegExp"===L._bsontype)P=h(t,B,L,P);else if("Int32"===L._bsontype)P=b(t,B,L,P);else if("MinKey"===L._bsontype||"MaxKey"===L._bsontype)P=f(t,B,L,P);else if(void 0!==L._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+L._bsontype)}}}k.pop(),t[P++]=0;var F=P-C;return t[C++]=255&F,t[C++]=F>>8&255,t[C++]=F>>16&255,t[C++]=F>>24&255,P}e.serializeInto=A}));Yo(sa),sa.serializeInto;var aa=Ko((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectID=e.Decimal128=e.BSONRegExp=e.MaxKey=e.MinKey=e.Int32=e.Double=e.Timestamp=e.Long=e.UUID=e.ObjectId=e.Binary=e.DBRef=e.BSONSymbol=e.Map=e.Code=e.LongWithoutOverridesClass=e.EJSON=e.BSON_INT64_MIN=e.BSON_INT64_MAX=e.BSON_INT32_MIN=e.BSON_INT32_MAX=e.BSON_DATA_UNDEFINED=e.BSON_DATA_TIMESTAMP=e.BSON_DATA_SYMBOL=e.BSON_DATA_STRING=e.BSON_DATA_REGEXP=e.BSON_DATA_OID=e.BSON_DATA_OBJECT=e.BSON_DATA_NUMBER=e.BSON_DATA_NULL=e.BSON_DATA_MIN_KEY=e.BSON_DATA_MAX_KEY=e.BSON_DATA_LONG=e.BSON_DATA_INT=e.BSON_DATA_DECIMAL128=e.BSON_DATA_DBPOINTER=e.BSON_DATA_DATE=e.BSON_DATA_CODE_W_SCOPE=e.BSON_DATA_CODE=e.BSON_DATA_BOOLEAN=e.BSON_DATA_BINARY=e.BSON_DATA_ARRAY=e.BSON_BINARY_SUBTYPE_UUID_NEW=e.BSON_BINARY_SUBTYPE_UUID=e.BSON_BINARY_SUBTYPE_USER_DEFINED=e.BSON_BINARY_SUBTYPE_MD5=e.BSON_BINARY_SUBTYPE_FUNCTION=e.BSON_BINARY_SUBTYPE_DEFAULT=e.BSON_BINARY_SUBTYPE_BYTE_ARRAY=void 0,e.deserializeStream=e.calculateObjectSize=e.deserialize=e.serializeWithBufferAndIndex=e.serialize=e.setInternalBufferSize=void 0,Object.defineProperty(e,"Binary",{enumerable:!0,get:function(){return Ds.Binary}}),Object.defineProperty(e,"Code",{enumerable:!0,get:function(){return Rs.Code}}),Object.defineProperty(e,"DBRef",{enumerable:!0,get:function(){return js.DBRef}}),Object.defineProperty(e,"Decimal128",{enumerable:!0,get:function(){return Ls.Decimal128}}),Object.defineProperty(e,"Double",{enumerable:!0,get:function(){return Fs.Double}}),Object.defineProperty(e,"Int32",{enumerable:!0,get:function(){return Us.Int32}}),Object.defineProperty(e,"Long",{enumerable:!0,get:function(){return Ms.Long}}),Object.defineProperty(e,"Map",{enumerable:!0,get:function(){return ta.Map}}),Object.defineProperty(e,"MaxKey",{enumerable:!0,get:function(){return Vs.MaxKey}}),Object.defineProperty(e,"MinKey",{enumerable:!0,get:function(){return zs.MinKey}}),Object.defineProperty(e,"ObjectId",{enumerable:!0,get:function(){return qs.ObjectId}}),Object.defineProperty(e,"ObjectID",{enumerable:!0,get:function(){return qs.ObjectId}}),Object.defineProperty(e,"BSONRegExp",{enumerable:!0,get:function(){return Ws.BSONRegExp}}),Object.defineProperty(e,"BSONSymbol",{enumerable:!0,get:function(){return Gs.BSONSymbol}}),Object.defineProperty(e,"Timestamp",{enumerable:!0,get:function(){return Zs.Timestamp}}),Object.defineProperty(e,"UUID",{enumerable:!0,get:function(){return Bs.UUID}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_BYTE_ARRAY",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_BYTE_ARRAY}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_DEFAULT",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_DEFAULT}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_FUNCTION",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_FUNCTION}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_MD5",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_MD5}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_USER_DEFINED",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_USER_DEFINED}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_UUID",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_UUID}}),Object.defineProperty(e,"BSON_BINARY_SUBTYPE_UUID_NEW",{enumerable:!0,get:function(){return ea.BSON_BINARY_SUBTYPE_UUID_NEW}}),Object.defineProperty(e,"BSON_DATA_ARRAY",{enumerable:!0,get:function(){return ea.BSON_DATA_ARRAY}}),Object.defineProperty(e,"BSON_DATA_BINARY",{enumerable:!0,get:function(){return ea.BSON_DATA_BINARY}}),Object.defineProperty(e,"BSON_DATA_BOOLEAN",{enumerable:!0,get:function(){return ea.BSON_DATA_BOOLEAN}}),Object.defineProperty(e,"BSON_DATA_CODE",{enumerable:!0,get:function(){return ea.BSON_DATA_CODE}}),Object.defineProperty(e,"BSON_DATA_CODE_W_SCOPE",{enumerable:!0,get:function(){return ea.BSON_DATA_CODE_W_SCOPE}}),Object.defineProperty(e,"BSON_DATA_DATE",{enumerable:!0,get:function(){return ea.BSON_DATA_DATE}}),Object.defineProperty(e,"BSON_DATA_DBPOINTER",{enumerable:!0,get:function(){return ea.BSON_DATA_DBPOINTER}}),Object.defineProperty(e,"BSON_DATA_DECIMAL128",{enumerable:!0,get:function(){return ea.BSON_DATA_DECIMAL128}}),Object.defineProperty(e,"BSON_DATA_INT",{enumerable:!0,get:function(){return ea.BSON_DATA_INT}}),Object.defineProperty(e,"BSON_DATA_LONG",{enumerable:!0,get:function(){return ea.BSON_DATA_LONG}}),Object.defineProperty(e,"BSON_DATA_MAX_KEY",{enumerable:!0,get:function(){return ea.BSON_DATA_MAX_KEY}}),Object.defineProperty(e,"BSON_DATA_MIN_KEY",{enumerable:!0,get:function(){return ea.BSON_DATA_MIN_KEY}}),Object.defineProperty(e,"BSON_DATA_NULL",{enumerable:!0,get:function(){return ea.BSON_DATA_NULL}}),Object.defineProperty(e,"BSON_DATA_NUMBER",{enumerable:!0,get:function(){return ea.BSON_DATA_NUMBER}}),Object.defineProperty(e,"BSON_DATA_OBJECT",{enumerable:!0,get:function(){return ea.BSON_DATA_OBJECT}}),Object.defineProperty(e,"BSON_DATA_OID",{enumerable:!0,get:function(){return ea.BSON_DATA_OID}}),Object.defineProperty(e,"BSON_DATA_REGEXP",{enumerable:!0,get:function(){return ea.BSON_DATA_REGEXP}}),Object.defineProperty(e,"BSON_DATA_STRING",{enumerable:!0,get:function(){return ea.BSON_DATA_STRING}}),Object.defineProperty(e,"BSON_DATA_SYMBOL",{enumerable:!0,get:function(){return ea.BSON_DATA_SYMBOL}}),Object.defineProperty(e,"BSON_DATA_TIMESTAMP",{enumerable:!0,get:function(){return ea.BSON_DATA_TIMESTAMP}}),Object.defineProperty(e,"BSON_DATA_UNDEFINED",{enumerable:!0,get:function(){return ea.BSON_DATA_UNDEFINED}}),Object.defineProperty(e,"BSON_INT32_MAX",{enumerable:!0,get:function(){return ea.BSON_INT32_MAX}}),Object.defineProperty(e,"BSON_INT32_MIN",{enumerable:!0,get:function(){return ea.BSON_INT32_MIN}}),Object.defineProperty(e,"BSON_INT64_MAX",{enumerable:!0,get:function(){return ea.BSON_INT64_MAX}}),Object.defineProperty(e,"BSON_INT64_MIN",{enumerable:!0,get:function(){return ea.BSON_INT64_MIN}});var n=$s;Object.defineProperty(e,"EJSON",{enumerable:!0,get:function(){return n.EJSON}});var r=Zs;Object.defineProperty(e,"LongWithoutOverridesClass",{enumerable:!0,get:function(){return r.LongWithoutOverridesClass}});var i=17825792,o=as.Buffer.alloc(i);function s(t){o.length<t&&(o=as.Buffer.alloc(t))}function a(t,e){void 0===e&&(e={});var n="boolean"==typeof e.checkKeys&&e.checkKeys,r="boolean"==typeof e.serializeFunctions&&e.serializeFunctions,s="boolean"!=typeof e.ignoreUndefined||e.ignoreUndefined,a="number"==typeof e.minInternalBufferSize?e.minInternalBufferSize:i;o.length<a&&(o=as.Buffer.alloc(a));var u=sa.serializeInto(o,t,n,0,0,r,s,[]),c=as.Buffer.alloc(u);return o.copy(c,0,0,c.length),c}function u(t,e,n){void 0===n&&(n={});var r="boolean"==typeof n.checkKeys&&n.checkKeys,i="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,s="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,a="number"==typeof n.index?n.index:0,u=sa.serializeInto(o,t,r,0,0,i,s);return o.copy(e,a,0,u),a+u-1}function c(t,e){return void 0===e&&(e={}),ia.deserialize(Ps.ensureBuffer(t),e)}function l(t,e){void 0===e&&(e={});var n="boolean"==typeof(e=e||{}).serializeFunctions&&e.serializeFunctions,r="boolean"!=typeof e.ignoreUndefined||e.ignoreUndefined;return na.calculateObjectSize(t,n,r)}function h(t,e,n,r,i,o){for(var s=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},o),a=Ps.ensureBuffer(t),u=e,c=0;c<n;c++){var l=a[u]|a[u+1]<<8|a[u+2]<<16|a[u+3]<<24;s.index=u,r[i+c]=ia.deserialize(a,s),u+=l}return u}e.setInternalBufferSize=s,e.serialize=a,e.serializeWithBufferAndIndex=u,e.deserialize=c,e.calculateObjectSize=l,e.deserializeStream=h;var f={Binary:Ds.Binary,Code:Rs.Code,DBRef:js.DBRef,Decimal128:Ls.Decimal128,Double:Fs.Double,Int32:Us.Int32,Long:Ms.Long,UUID:Bs.UUID,Map:ta.Map,MaxKey:Vs.MaxKey,MinKey:zs.MinKey,ObjectId:qs.ObjectId,ObjectID:qs.ObjectId,BSONRegExp:Ws.BSONRegExp,BSONSymbol:Gs.BSONSymbol,Timestamp:Zs.Timestamp,EJSON:$s.EJSON,setInternalBufferSize:s,serialize:a,serializeWithBufferAndIndex:u,deserialize:c,calculateObjectSize:l,deserializeStream:h};e.default=f})),ua=(Yo(aa),aa.ObjectID,aa.Decimal128,aa.BSONRegExp,aa.MaxKey,aa.MinKey,aa.Int32,aa.Double,aa.Timestamp,aa.Long,aa.UUID,aa.ObjectId),ca=(aa.Binary,aa.DBRef,aa.BSONSymbol,aa.Map,aa.Code,aa.LongWithoutOverridesClass,aa.EJSON);aa.BSON_INT64_MIN,aa.BSON_INT64_MAX,aa.BSON_INT32_MIN,aa.BSON_INT32_MAX,aa.BSON_DATA_UNDEFINED,aa.BSON_DATA_TIMESTAMP,aa.BSON_DATA_SYMBOL,aa.BSON_DATA_STRING,aa.BSON_DATA_REGEXP,aa.BSON_DATA_OID,aa.BSON_DATA_OBJECT,aa.BSON_DATA_NUMBER,aa.BSON_DATA_NULL,aa.BSON_DATA_MIN_KEY,aa.BSON_DATA_MAX_KEY,aa.BSON_DATA_LONG,aa.BSON_DATA_INT,aa.BSON_DATA_DECIMAL128,aa.BSON_DATA_DBPOINTER,aa.BSON_DATA_DATE,aa.BSON_DATA_CODE_W_SCOPE,aa.BSON_DATA_CODE,aa.BSON_DATA_BOOLEAN,aa.BSON_DATA_BINARY,aa.BSON_DATA_ARRAY,aa.BSON_BINARY_SUBTYPE_UUID_NEW,aa.BSON_BINARY_SUBTYPE_UUID,aa.BSON_BINARY_SUBTYPE_USER_DEFINED,aa.BSON_BINARY_SUBTYPE_MD5,aa.BSON_BINARY_SUBTYPE_FUNCTION,aa.BSON_BINARY_SUBTYPE_DEFAULT,aa.BSON_BINARY_SUBTYPE_BYTE_ARRAY,aa.deserializeStream,aa.calculateObjectSize,aa.deserialize,aa.serializeWithBufferAndIndex,aa.serialize,aa.setInternalBufferSize;var la=n(4155),ha=function(t,e,n){this.name=t,this.version=e,this.os=n,this.type="browser"},fa=function(t,e,n,r){this.name=t,this.version=e,this.os=n,this.bot=r,this.type="bot-device"},pa=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},da=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ya=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],va=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ga(t){var e=function(t){return""!==t&&ya.reduce((function(e,n){var r=n[0],i=n[1];if(e)return e;var o=i.exec(t);return!!o&&[r,o]}),!1)}(t);if(!e)return null;var n=e[0],r=e[1];if("searchbot"===n)return new pa;var i=r[1]&&r[1].split(/[._]/).slice(0,3);i?i.length<3&&(i=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(i,function(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}(3-i.length))):i=[];var o=i.join("."),s=function(t){for(var e=0,n=va.length;e<n;e++){var r=va[e],i=r[0];if(r[1].exec(t))return i}return null}(t),a=da.exec(t);return a&&a[1]?new fa(n,o,s,a[1]):new ha(n,o,s)}class ba{constructor(){if(!ba.fetch)throw new Error("DefaultNetworkTransport.fetch must be set before it's used");if(!ba.AbortController)throw new Error("DefaultNetworkTransport.AbortController must be set before it's used")}fetchWithCallbacks(t,e){this.fetch(t).then((async t=>{const e=await t.text(),n={};return t.headers.forEach(((t,e)=>{n[e]=t})),{statusCode:t.status,headers:n,body:e}})).then((t=>e.onSuccess(t))).catch((t=>e.onError(t)))}async fetch(t){const{timeoutMs:e,url:n,...r}=t,{signal:i,cancelTimeout:o}=this.createTimeoutSignal(e);try{return await ba.fetch(n,{signal:i,...r})}finally{o()}}createTimeoutSignal(t){if("number"==typeof t){const e=new ba.AbortController,n=setTimeout((()=>{e.abort()}),t);return{signal:e.signal,cancelTimeout:()=>{clearTimeout(n)}}}return{signal:void 0,cancelTimeout:()=>{}}}}ba.DEFAULT_HEADERS={"Content-Type":"application/json"},ba.fetch=window.fetch.bind(window),ba.AbortController=window.AbortController;var ma="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},wa=function(t,e,n){return function(t,e){var n;n="undefined"!=typeof self?self:"undefined"!=typeof window?window:ma,t.exports=function(e){var n,r=(e=e||{}).Base64,i="2.6.4",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(t){for(var e={},n=0,r=t.length;n<r;n++)e[t.charAt(n)]=n;return e}(o),a=String.fromCharCode,u=function(t){if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?a(192|e>>>6)+a(128|63&e):a(224|e>>>12&15)+a(128|e>>>6&63)+a(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return a(240|e>>>18&7)+a(128|e>>>12&63)+a(128|e>>>6&63)+a(128|63&e)},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,l=function(t){return t.replace(c,u)},h=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[o.charAt(n>>>18),o.charAt(n>>>12&63),e>=2?"=":o.charAt(n>>>6&63),e>=1?"=":o.charAt(63&n)].join("")},f=e.btoa&&"function"==typeof e.btoa?function(t){return e.btoa(t)}:function(t){if(t.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return t.replace(/[\s\S]{1,3}/g,h)},p=function(t){return f(l(String(t)))},d=function(t){return t.replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"})).replace(/=/g,"")},y=function(t,e){return e?d(p(t)):p(t)},v=function(t){return y(t,!0)};e.Uint8Array&&(n=function(t,e){for(var n="",r=0,i=t.length;r<i;r+=3){var s=t[r],a=t[r+1],u=t[r+2],c=s<<16|a<<8|u;n+=o.charAt(c>>>18)+o.charAt(c>>>12&63)+(void 0!==a?o.charAt(c>>>6&63):"=")+(void 0!==u?o.charAt(63&c):"=")}return e?d(n):n});var g,b=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,m=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return a(55296+(e>>>10))+a(56320+(1023&e));case 3:return a((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return a((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},w=function(t){return t.replace(b,m)},_=function(t){var e=t.length,n=e%4,r=(e>0?s[t.charAt(0)]<<18:0)|(e>1?s[t.charAt(1)]<<12:0)|(e>2?s[t.charAt(2)]<<6:0)|(e>3?s[t.charAt(3)]:0),i=[a(r>>>16),a(r>>>8&255),a(255&r)];return i.length-=[0,0,2,1][n],i.join("")},S=e.atob&&"function"==typeof e.atob?function(t){return e.atob(t)}:function(t){return t.replace(/\S{1,4}/g,_)},O=function(t){return S(String(t).replace(/[^A-Za-z0-9\+\/]/g,""))},E=function(t){return w(S(t))},A=function(t){return String(t).replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},C=function(t){return E(A(t))};e.Uint8Array&&(g=function(t){return Uint8Array.from(O(A(t)),(function(t){return t.charCodeAt(0)}))});var I=function(){var t=e.Base64;return e.Base64=r,t};if(e.Base64={VERSION:i,atob:O,btoa:f,fromBase64:C,toBase64:y,utob:l,encode:y,encodeURI:v,btou:w,decode:C,noConflict:I,fromUint8Array:n,toUint8Array:g},"function"==typeof Object.defineProperty){var T=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};e.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",T((function(){return C(this)}))),Object.defineProperty(String.prototype,"toBase64",T((function(t){return y(this,t)}))),Object.defineProperty(String.prototype,"toBase64URI",T((function(){return y(this,!0)})))}}return e.Meteor&&(Base64=e.Base64),t.exports&&(t.exports.Base64=e.Base64),{Base64:e.Base64}}(n)}(n={path:void 0,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}();const _a={relaxed:!1};function Sa(t){return ca.serialize(t,_a)}function Oa(t){return Array.isArray(t)?t.map((t=>ca.deserialize(t))):ca.deserialize(t)}var Ea,Aa;!function(t){t.Normal="normal",t.Server="server"}(Ea||(Ea={})),function(t){t.NAME="name",t.EMAIL="email",t.PICTURE="picture",t.FIRST_NAME="first_name",t.LAST_NAME="last_name",t.GENDER="gender",t.BIRTHDAY="birthday",t.MIN_AGE="min_age",t.MAX_AGE="max_age"}(Aa||(Aa={}));const Ca={[Aa.NAME]:"name",[Aa.EMAIL]:"email",[Aa.PICTURE]:"pictureUrl",[Aa.FIRST_NAME]:"firstName",[Aa.LAST_NAME]:"lastName",[Aa.GENDER]:"gender",[Aa.BIRTHDAY]:"birthday",[Aa.MIN_AGE]:"minAge",[Aa.MAX_AGE]:"maxAge"};class Ia{constructor(t){if(this.type=Ea.Normal,this.identities=[],"object"==typeof t&&null!==t){const{type:e,identities:n,data:r}=t;if("string"!=typeof e)throw new Error("Expected 'type' in the response body");if(this.type=e,!Array.isArray(n))throw new Error("Expected 'identities' in the response body");if(this.identities=n.map((t=>({id:t.id,providerType:t.provider_type}))),"object"!=typeof r||null===r)throw new Error("Expected 'data' in the response body");{const t=Object.fromEntries(Object.entries(r).map((([t,e])=>t in Ca?[Ca[t],e]:[t,e])));this.data=Oa(t)}}else this.data={}}}class Ta{constructor(t,e){this.storage=t,this.keyPart=e}get(t){return this.storage.get(this.keyPart+Ta.PART_SEPARATOR+t)}set(t,e){return this.storage.set(this.keyPart+Ta.PART_SEPARATOR+t,e)}remove(t){return this.storage.remove(this.keyPart+Ta.PART_SEPARATOR+t)}prefix(t){return new Ta(this,t)}clear(t=""){return this.storage.clear(this.keyPart+Ta.PART_SEPARATOR+t)}addListener(t){return this.storage.addListener(t)}removeListener(t){return this.storage.addListener(t)}}Ta.PART_SEPARATOR=":";const xa="accessToken",ka="refreshToken",Pa="profile",Na="providerType";class Ba extends Ta{constructor(t,e){super(t,`user(${e})`)}get accessToken(){return this.get(xa)}set accessToken(t){null===t?this.remove(xa):this.set(xa,t)}get refreshToken(){return this.get(ka)}set refreshToken(t){null===t?this.remove(ka):this.set(ka,t)}get profile(){const t=this.get(Pa);if(t){const e=new Ia;return Object.assign(e,JSON.parse(t)),e}}set profile(t){t?this.set(Pa,JSON.stringify(t)):this.remove(Pa)}get providerType(){const t=this.get(Na);if(t)return t}set providerType(t){t?this.set(Na,t):this.remove(Na)}}function Da(t){return Object.fromEntries(Object.entries(t).filter((t=>void 0!==t[1])))}function Ra(t,e=!0){const n=Da(t);return(e&&Object.keys(n).length>0?"?":"")+Object.entries(n).map((([t,e])=>`${t}=${encodeURIComponent(e)}`)).join("&")}const ja=["inspect","callFunction","callFunctionStreaming",...Object.getOwnPropertyNames(Object.prototype)];function Ma(t){return function(t){for(const e of t)if("object"==typeof e)for(const[t,n]of Object.entries(e))void 0===n&&delete e[t];return t}(t).map((t=>"object"==typeof t?Sa(t):t))}class La{constructor(t,e={}){this.fetcher=t,this.serviceName=e.serviceName,this.argsTransformation=e.argsTransformation||Ma}static create(t,e={}){const n=new La(t,e);return new Proxy(n,{get(t,e,n){if("string"==typeof e&&-1===ja.indexOf(e))return t.callFunction.bind(t,e);{const r=Reflect.get(t,e,n);return"function"==typeof r?r.bind(t):r}}})}async callFunction(t,...e){const n={name:t,arguments:this.argsTransformation?this.argsTransformation(e):e};this.serviceName&&(n.service=this.serviceName);const r=this.fetcher.appRoute;return this.fetcher.fetchJSON({method:"POST",path:r.functionsCall().path,body:n})}callFunctionStreaming(t,...e){const n={name:t,arguments:this.argsTransformation?this.argsTransformation(e):e};this.serviceName&&(n.service=this.serviceName);const r=this.fetcher.appRoute,i=Ra({baas_request:Base64.encode(JSON.stringify(n))});return this.fetcher.fetchStream({method:"GET",path:r.functionsCall().path+i})}}class Fa{constructor(t,e="local-userpass"){this.fetcher=t,this.providerName=e}async registerUser(t,e){const n=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:n.emailPasswordAuth(this.providerName).register().path,body:{email:t,password:e}})}async confirmUser(t,e){const n=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:n.emailPasswordAuth(this.providerName).confirm().path,body:{token:t,tokenId:e}})}async resendConfirmationEmail(t){const e=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:e.emailPasswordAuth(this.providerName).confirmSend().path,body:{email:t}})}async resetPassword(t,e,n){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).reset().path,body:{token:t,tokenId:e,password:n}})}async sendResetPasswordEmail(t){const e=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:e.emailPasswordAuth(this.providerName).resetSend().path,body:{email:t}})}async callResetPasswordFunction(t,e,...n){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).resetCall().path,body:{email:t,password:e,arguments:n}})}}var Ua=function(){return{path:"/api/client/v2.0",app(t){return{path:this.path+`/app/${t}`,location(){return{path:this.path+"/location"}},authProvider(t){return{path:this.path+`/auth/providers/${t}`,login(){return{path:this.path+"/login"}}}},emailPasswordAuth(t){return{...this.authProvider(t),register(){return{path:this.path+"/register"}},confirm(){return{path:this.path+"/confirm"}},confirmSend(){return{path:this.path+"/confirm/send"}},reset(){return{path:this.path+"/reset"}},resetSend(){return{path:this.path+"/reset/send"}},resetCall(){return{path:this.path+"/reset/call"}}}},functionsCall(){return{path:this.path+"/functions/call"}}}},auth(){return{path:this.path+"/auth",apiKeys(){return{path:this.path+"/api_keys",key(t){return{path:this.path+`/${t}`,enable(){return{path:this.path+"/enable"}},disable(){return{path:this.path+"/disable"}}}}}},profile(){return{path:this.path+"/profile"}},session(){return{path:this.path+"/session"}}}}}};class Va{constructor(t,e="api-key"){this.fetcher=t}create(t){return this.fetcher.fetchJSON({method:"POST",body:{name:t},path:Ua().auth().apiKeys().path,tokenType:"refresh"})}fetch(t){return this.fetcher.fetchJSON({method:"GET",path:Ua().auth().apiKeys().key(t).path,tokenType:"refresh"})}fetchAll(){return this.fetcher.fetchJSON({method:"GET",tokenType:"refresh",path:Ua().auth().apiKeys().path})}async delete(t){await this.fetcher.fetchJSON({method:"DELETE",path:Ua().auth().apiKeys().key(t).path,tokenType:"refresh"})}async enable(t){await this.fetcher.fetchJSON({method:"PUT",path:Ua().auth().apiKeys().key(t).enable().path,tokenType:"refresh"})}async disable(t){await this.fetcher.fetchJSON({method:"PUT",path:Ua().auth().apiKeys().key(t).disable().path,tokenType:"refresh"})}}let za=null;function qa(){if(za)return za;throw new Error("Cannot get environment before it's set")}class Wa extends Error{constructor({message:t,code:e}){super(t),this.name="WatchError",this.code=e}}var Ga,Ha,Ya;!function(t){t.NEED_DATA="NEED_DATA",t.HAVE_EVENT="HAVE_EVENT",t.HAVE_ERROR="HAVE_ERROR"}(Ga||(Ga={}));class Ka{constructor(){this._state=Ga.NEED_DATA,this._error=null,this._textDecoder=new(qa().TextDecoder),this._buffer="",this._bufferOffset=0,this._eventType="",this._dataBuffer=""}feedBuffer(t){this.assertState(Ga.NEED_DATA),this._buffer+=this._textDecoder.decode(t,{stream:!0}),this.advanceBufferState()}feedLine(t){if(this.assertState(Ga.NEED_DATA),t.endsWith("\n")&&(t=t.substr(0,t.length-1)),t.endsWith("\r")&&(t=t.substr(0,t.length-1)),0===t.length){if(0===this._dataBuffer.length)return void(this._eventType="");this._dataBuffer.endsWith("\n")&&(this._dataBuffer=this._dataBuffer.substr(0,this._dataBuffer.length-1)),this.feedSse({data:this._dataBuffer,eventType:this._eventType}),this._dataBuffer="",this._eventType=""}if(":"===t[0])return;const e=t.indexOf(":"),n=t.substr(0,e);let r=-1===e?"":t.substr(e+1);r.startsWith(" ")&&(r=r.substr(1)),"event"===n?this._eventType=r:"data"===n&&(this._dataBuffer+=r,this._dataBuffer+="\n")}feedSse(t){this.assertState(Ga.NEED_DATA);const e=t.data.indexOf("%");if(-1!==e){let n="",r=0;for(let i=e;-1!==i;i=t.data.indexOf("%",r)){n+=t.data.substr(r,i-r);const e=t.data.substr(i,3);n+="%25"===e?"%":"%0A"===e?"\n":"%0D"===e?"\r":e,r=i+e.length}n+=t.data.substr(r),t.data=n}if(t.eventType&&"message"!==t.eventType){if("error"===t.eventType){this._state=Ga.HAVE_ERROR,this._error=new Wa({message:t.data,code:"unknown"});try{const{error_code:e,error:n}=ca.parse(t.data);if("string"!=typeof e)return;if("string"!=typeof n)return;this._error=new Wa({message:n,code:e})}catch{return}}}else{try{const e=ca.parse(t.data);if("object"==typeof e)return this._nextEvent=e,void(this._state=Ga.HAVE_EVENT)}catch{}this._state=Ga.HAVE_ERROR,this._error=new Wa({message:"server returned malformed event: "+t.data,code:"bad bson parse"})}}get state(){return this._state}nextEvent(){this.assertState(Ga.HAVE_EVENT);const t=this._nextEvent;return this._state=Ga.NEED_DATA,this.advanceBufferState(),t}get error(){return this._error}advanceBufferState(){for(this.assertState(Ga.NEED_DATA);this.state===Ga.NEED_DATA;){if(this._bufferOffset===this._buffer.length)return this._buffer="",void(this._bufferOffset=0);const t=this._buffer.indexOf("\n",this._bufferOffset);if(-1===t)return void(0!==this._bufferOffset&&(this._buffer=this._buffer.substr(this._bufferOffset,this._buffer.length-this._bufferOffset),this._bufferOffset=0));this.feedLine(this._buffer.substr(this._bufferOffset,t-this._bufferOffset)),this._bufferOffset=t+1}}assertState(t){if(this._state!==t)throw Error(`Expected WatchStream to be in state ${t}, but in state ${this._state}`)}}class Qa{constructor(t,e,n,r){this.functions=La.create(t,{serviceName:e}),this.databaseName=n,this.collectionName=r,this.serviceName=e,this.fetcher=t}find(t={},e={}){return this.functions.find({database:this.databaseName,collection:this.collectionName,query:t,project:e.projection,sort:e.sort,limit:e.limit})}findOne(t={},e={}){return this.functions.findOne({database:this.databaseName,collection:this.collectionName,query:t,project:e.projection,sort:e.sort})}findOneAndUpdate(t={},e,n={}){return this.functions.findOneAndUpdate({database:this.databaseName,collection:this.collectionName,filter:t,update:e,sort:n.sort,projection:n.projection,upsert:n.upsert,returnNewDocument:n.returnNewDocument})}findOneAndReplace(t={},e,n={}){return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:t,update:e,sort:n.sort,projection:n.projection,upsert:n.upsert,returnNewDocument:n.returnNewDocument})}findOneAndDelete(t={},e={}){return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:t,sort:e.sort,projection:e.projection})}aggregate(t){return this.functions.aggregate({database:this.databaseName,collection:this.collectionName,pipeline:t})}count(t={},e={}){return this.functions.count({database:this.databaseName,collection:this.collectionName,query:t,limit:e.limit})}insertOne(t){return this.functions.insertOne({database:this.databaseName,collection:this.collectionName,document:t})}insertMany(t){return this.functions.insertMany({database:this.databaseName,collection:this.collectionName,documents:t})}deleteOne(t={}){return this.functions.deleteOne({database:this.databaseName,collection:this.collectionName,query:t})}deleteMany(t={}){return this.functions.deleteMany({database:this.databaseName,collection:this.collectionName,query:t})}updateOne(t,e,n={}){return this.functions.updateOne({database:this.databaseName,collection:this.collectionName,query:t,update:e,upsert:n.upsert})}updateMany(t,e,n={}){return this.functions.updateMany({database:this.databaseName,collection:this.collectionName,query:t,update:e,upsert:n.upsert})}async*watch({ids:t,filter:e}={}){const n=await this.functions.callFunctionStreaming("watch",{database:this.databaseName,collection:this.collectionName,ids:t,filter:e}),r=new Ka;for await(const t of n)if(t){for(r.feedBuffer(t);r.state==Ga.HAVE_EVENT;)yield r.nextEvent();if(r.state==Ga.HAVE_ERROR)throw r.error}}}function Ja(t,e,n,r){return new Qa(t,e,n,r)}function Xa(t,e,n){return{collection:Ja.bind(null,t,e,n)}}!function(t){t.Active="active",t.LoggedOut="logged-out",t.Removed="removed"}(Ha||(Ha={})),function(t){t.Normal="normal",t.Server="server"}(Ya||(Ya={}));class Za{constructor(t){if(this.app=t.app,this.id=t.id,this.storage=new Ba(this.app.storage,this.id),"accessToken"in t&&"refreshToken"in t&&"providerType"in t)this._accessToken=t.accessToken,this._refreshToken=t.refreshToken,this.providerType=t.providerType,this.storage.accessToken=t.accessToken,this.storage.refreshToken=t.refreshToken,this.storage.providerType=t.providerType;else{this._accessToken=this.storage.accessToken,this._refreshToken=this.storage.refreshToken;const t=this.storage.providerType;if(this._profile=this.storage.profile,!t)throw new Error("Storage is missing a provider type");this.providerType=t}this.fetcher=this.app.fetcher.clone({userContext:{currentUser:this}}),this.apiKeys=new Va(this.fetcher),this.functions=La.create(this.fetcher)}get accessToken(){return this._accessToken}set accessToken(t){this._accessToken=t,this.storage.accessToken=t}get refreshToken(){return this._refreshToken}set refreshToken(t){this._refreshToken=t,this.storage.refreshToken=t}get state(){return this.id in this.app.allUsers?null===this.refreshToken?Ha.LoggedOut:Ha.Active:Ha.Removed}get isLoggedIn(){return this.state===Ha.Active}get customData(){if(this.accessToken)return this.decodeAccessToken().userData;throw new Error("Cannot read custom data without an access token")}get profile(){if(this._profile)return this._profile.data;throw new Error("A profile was never fetched for this user")}get identities(){if(this._profile)return this._profile.identities;throw new Error("A profile was never fetched for this user")}get deviceId(){if(this.accessToken){const t=this.accessToken.split(".")[1];if(t){const e=JSON.parse(wa.Base64.decode(t)).baas_device_id;if("string"==typeof e&&"000000000000000000000000"!==e)return e}}return null}async refreshProfile(){const t=await this.fetcher.fetchJSON({method:"GET",path:Ua().auth().profile().path});this._profile=new Ia(t),this.storage.profile=this._profile}async logOut(){try{null!==this._refreshToken&&await this.fetcher.fetchJSON({method:"DELETE",path:Ua().auth().session().path,tokenType:"refresh"})}finally{this.accessToken=null,this.refreshToken=null}}async linkCredentials(t){const e=await this.app.authenticator.authenticate(t,this);if(this.id!==e.userId){const t=`got user id ${e.userId} expected ${this.id}`;throw new Error(`Link response ment for another user (${t})`)}this.accessToken=e.accessToken,await this.refreshProfile()}async refreshAccessToken(){const t=await this.fetcher.fetchJSON({method:"POST",path:Ua().auth().session().path,tokenType:"refresh"}),{access_token:e}=t;if("string"!=typeof e)throw new Error("Expected an 'access_token' in the response");this.accessToken=e}async refreshCustomData(){return await this.refreshAccessToken(),this.customData}callFunction(t,...e){return this.functions.callFunction(t,...e)}toJSON(){return{id:this.id,accessToken:this.accessToken,refreshToken:this.refreshToken,profile:this._profile,state:this.state,customData:this.customData}}push(t=""){throw new Error("Not yet implemented")}mongoClient(t){return function(t,e="mongo-db"){return{db:Xa.bind(null,t,e)}}(this.fetcher,t)}decodeAccessToken(){if(this.accessToken){const t=this.accessToken.split(".");if(3!==t.length)throw new Error("Expected an access token with three parts");const e=t[1],n=wa.Base64.decode(e),r=JSON.parse(n),{exp:i,iat:o,sub:s,user_data:a={}}=r;if("number"!=typeof i)throw new Error("Failed to decode access token 'exp'");if("number"!=typeof o)throw new Error("Failed to decode access token 'iat'");return{expires:i,issuedAt:o,subject:s,userData:a}}throw new Error("Missing an access token")}}class $a{constructor(t,e,n){this.providerName=t,this.providerType=e,this.payload=n}static anonymous(){return new $a("anon-user","anon-user",{})}static userApiKey(t){return new $a("api-key","api-key",{key:t})}static serverApiKey(t){return new $a("api-key","api-key",{key:t})}static apiKey(t){return new $a("api-key","api-key",{key:t})}static emailPassword(t,e){return new $a("local-userpass","local-userpass",{username:t,password:e})}static function(t){return new $a("custom-function","custom-function",t)}static jwt(t){return new $a("custom-token","custom-token",{token:t})}static google(t){return new $a("oauth2-google","oauth2-google",$a.derivePayload(t))}static derivePayload(t){if("string"==typeof t){if(t.includes("://"))return this.derivePayload({redirectUrl:t});if(t.startsWith("4/"))return this.derivePayload({authCode:t});if(t.startsWith("ey"))return this.derivePayload({idToken:t});throw new Error(`Unexpected payload: ${t}`)}if(1===Object.keys(t).length){if("authCode"in t||"redirectUrl"in t)return t;if("idToken"in t)return{id_token:t.idToken};throw new Error("Unexpected payload: "+JSON.stringify(t))}throw new Error("Expected only one property in payload, got "+JSON.stringify(t))}static facebook(t){return new $a("oauth2-facebook","oauth2-facebook",t.includes("://")?{redirectUrl:t}:{accessToken:t})}static apple(t){return new $a("oauth2-apple","oauth2-apple",t.includes("://")?{redirectUrl:t}:{id_token:t})}}const tu="userIds",eu="deviceId";class nu extends Ta{constructor(t,e){super(t,`app(${e})`)}getUserIds(){const t=this.get(tu),e=t?JSON.parse(t):[];if(Array.isArray(e))return[...new Set(e)];throw new Error("Expected the user ids to be an array")}setUserIds(t,e){if(e){const e=this.getUserIds();for(const n of e)-1===t.indexOf(n)&&t.push(n)}this.set(tu,JSON.stringify(t))}removeUserId(t){const e=this.getUserIds().filter((e=>e!==t));this.setUserIds(e,!1)}getDeviceId(){return this.get(eu)}setDeviceId(t){this.set(eu,t)}}const ru={_stitch_client_app_id:"appId",_baas_client_app_id:"appId",_stitch_ua:"userAuth",_baas_ua:"userAuth",_stitch_link:"link",_baas_link:"link",_stitch_error:"error",_baas_error:"error",_stitch_state:"state",_baas_state:"state"};class iu{constructor(t,e=qa().openWindow){this.storage=t.prefix("oauth2"),this.openWindow=e}static parseRedirectLocation(t){const e=function(t){const e="?"===t[0]?t.substr(1):t;return Object.fromEntries(e.split("&").filter((t=>t.length>0)).map((t=>t.split("="))).map((([t,e])=>[t,decodeURIComponent(e)])))}(t),n={};for(const[t,r]of Object.entries(ru)){const i=e[t];i&&(n[r]=i)}return n}static handleRedirect(t,e=qa().defaultStorage){const n=iu.parseRedirectLocation(t),{state:r,error:i}=n;if("string"!=typeof r)throw i?new Error(`Failed to handle OAuth 2.0 redirect: ${i}`):new Error("Failed to handle OAuth 2.0 redirect.");{const t=e.prefix("oauth2");iu.getStateStorage(t,r).set("result",JSON.stringify(n))}}static decodeAuthInfo(t){const e=(t||"").split("$");if(4===e.length){const[t,n,r,i]=e;return{accessToken:t,refreshToken:n,userId:r,deviceId:i}}throw new Error("Failed to decode 'authInfo' into ids and tokens")}static getStateStorage(t,e){return t.prefix(`state(${e})`)}openWindowAndWaitForRedirect(t,e){const n=iu.getStateStorage(this.storage,e);return new Promise(((e,r)=>{let i,o=null;const s=()=>{const t=n.get("result");if(t){const r=JSON.parse(t);n.removeListener(s),n.clear();try{o&&(clearInterval(i),o.close())}catch(t){console.warn(`Failed closing redirect window: ${t}`)}finally{e(r)}}};n.addListener(s),o=this.openWindow(t),i=setInterval((()=>{if(o){if(o.closed){clearInterval(i),n.removeListener(s);const t=new Error("Window closed");r(t)}}else clearInterval(i)}),100)}))}generateState(){return function(t,e){let n="";for(let t=0;t<12;t++)n+=e[Math.floor(Math.random()*e.length)];return n}(0,"abcdefghijklmnopqrstuvwxyz")}}class ou{constructor(t,e,n){this.fetcher=t,this.oauth2=new iu(e),this.getDeviceInformation=n}async authenticate(t,e){const n=this.getDeviceInformation(),r="object"==typeof e;if(t.providerType.startsWith("oauth2")&&"string"==typeof t.payload.redirectUrl){const i=this.oauth2.generateState(),o=await this.getLogInUrl(t,r,{state:i,redirect:t.payload.redirectUrl,providerRedirectHeader:!!r||void 0,device:r?void 0:n.encode()});if(r){const t=(await this.fetcher.fetch({method:"GET",url:o,tokenType:r?"access":"none",user:e,mode:"cors",credentials:"include"})).headers.get("x-baas-location");if(t)return this.openWindowAndWaitForAuthResponse(t,i);throw new Error("Missing x-baas-location header")}return this.openWindowAndWaitForAuthResponse(o,i)}{const i=await this.getLogInUrl(t,r),o=await this.fetcher.fetchJSON({method:"POST",url:i,body:{...t.payload,options:{device:n.toJSON()}},tokenType:r?"access":"none",user:e}),{user_id:s,access_token:a,refresh_token:u=null,device_id:c}=o;if("string"!=typeof s)throw new Error("Expected a user id in the response");if("string"!=typeof a)throw new Error("Expected an access token in the response");return{userId:s,accessToken:a,refreshToken:u,deviceId:c}}}async getLogInUrl(t,e=!1,n={}){const r=this.fetcher.appRoute.authProvider(t.providerName).login(),i=Ra({link:e?"true":void 0,...n});return await this.fetcher.locationUrl+r.path+i}async openWindowAndWaitForAuthResponse(t,e){const n=await this.oauth2.openWindowAndWaitForRedirect(t,e);return iu.decodeAuthInfo(n.userAuth)}}class su extends Error{constructor(t,e,n,r,i,o,s){const a=r?`status ${n} ${r}`:`status ${n}`;super("string"==typeof i?`Request failed (${t} ${e}): ${i} (${a})`:`Request failed (${t} ${e}): (${a})`),this.method=t,this.url=e,this.statusText=r,this.statusCode=n,this.error=i,this.errorCode=o,this.link=s}static async fromRequestAndResponse(t,e){var n;const{url:r,method:i}=t,{status:o,statusText:s}=e;if(null===(n=e.headers.get("content-type"))||void 0===n?void 0:n.startsWith("application/json")){const t=await e.json(),n=t.error||"No message",a=t.error_code,u=t.link;return new su(i,r,o,s,n,a,u)}return new su(i,r,o,s)}}class au{constructor({appId:t,transport:e,userContext:n,locationUrlContext:r}){this.appId=t,this.transport=e,this.userContext=n,this.locationUrlContext=r}static buildAuthorizationHeader(t,e){if(t&&"none"!==e){if("access"===e)return{Authorization:`Bearer ${t.accessToken}`};if("refresh"===e)return{Authorization:`Bearer ${t.refreshToken}`};throw new Error(`Unexpected token type (${e})`)}return{}}static buildBody(t){if(t){if("object"==typeof t&&null!==t)return JSON.stringify(Sa(t));if("string"==typeof t)return t;throw console.log("body is",t),new Error("Unexpected type of body")}}static buildJsonHeader(t){return t&&t.length>0?{"Content-Type":"application/json"}:{}}clone(t){return new au({appId:this.appId,transport:this.transport,userContext:this.userContext,locationUrlContext:this.locationUrlContext,...t})}async fetch(t){const{path:e,url:n,tokenType:r="access",user:i=this.userContext.currentUser,...o}=t;if("string"==typeof e&&"string"==typeof n)throw new Error("Use of 'url' and 'path' mutually exclusive");if("string"==typeof e){const n=await this.locationUrlContext.locationUrl+e;return this.fetch({...t,path:void 0,url:n})}if("string"==typeof n){const e=await this.transport.fetch({...o,url:n,headers:{...au.buildAuthorizationHeader(i,r),...t.headers}});if(e.ok)return e;if(i&&401===e.status&&"access"===r)return await i.refreshAccessToken(),this.fetch({...t,user:i});throw i&&401===e.status&&"refresh"===r&&(i.accessToken=null,i.refreshToken=null),await su.fromRequestAndResponse(t,e)}throw new Error("Expected either 'url' or 'path'")}async fetchJSON(t){const{body:e}=t,n=au.buildBody(e),r=au.buildJsonHeader(n),i=await this.fetch({...t,body:n,headers:{Accept:"application/json",...r,...t.headers}}),o=i.headers.get("content-type");if(null==o?void 0:o.startsWith("application/json"))return Oa(await i.json());if(null===o)return null;throw new Error(`Expected JSON response, got "${o}"`)}async fetchStream(t){const{body:e}=await this.fetch({...t,headers:{Accept:"text/event-stream",...t.headers}});return function(t){if("object"!=typeof t||null===t)throw new Error("Expected a non-null object");if(Symbol.asyncIterator in t)return t;if("getReader"in t){const e=t;return{[Symbol.asyncIterator](){const t=e.getReader();return{next:()=>t.read(),return:async()=>(await t.cancel(),{done:!0,value:null})}}}}throw new Error("Expected an AsyncIterable or a ReadableStream")}(e)}get appRoute(){return Ua().app(this.appId)}get locationUrl(){return this.locationUrlContext.locationUrl}}var uu;!function(t){t.DEVICE_ID="deviceId",t.APP_ID="appId",t.APP_VERSION="appVersion",t.PLATFORM="platform",t.PLATFORM_VERSION="platformVersion",t.SDK_VERSION="sdkVersion"}(uu||(uu={}));class cu{constructor({appId:t,appVersion:e,deviceId:n}){this.sdkVersion="1.2.1";const r=qa();this.platform=r.platform,this.platformVersion=r.platformVersion,this.appId=t,this.appVersion=e,this.deviceId=n}encode(){const t=Da(this);return wa.Base64.encode(JSON.stringify(t))}toJSON(){return Da(this)}}class lu{constructor(t){this.users=[],this._locationUrl=null;const e="string"==typeof t?{id:t}:t;if("object"!=typeof e||"string"!=typeof e.id)throw new Error("Missing a MongoDB Realm app-id");this.id=e.id,this.baseUrl=e.baseUrl||"https://stitch.mongodb.com",this.localApp=e.app;const{storage:n,transport:r=new ba}=e;this.fetcher=new au({appId:this.id,userContext:this,locationUrlContext:this,transport:r}),this.emailPasswordAuth=new Fa(this.fetcher);const i=n||qa().defaultStorage;this.storage=new nu(i,this.id),this.authenticator=new ou(this.fetcher,i,(()=>this.deviceInformation));try{this.hydrate()}catch(t){this.storage.clear(),console.warn("Realm app hydration failed:",t.message)}}static getApp(t){if(t in lu.appCache)return lu.appCache[t];{const e=new lu(t);return lu.appCache[t]=e,e}}switchUser(t){const e=this.users.findIndex((e=>e===t));if(-1===e)throw new Error("The user was never logged into this app");const[n]=this.users.splice(e,1);this.users.unshift(n)}async logIn(t,e=!0){const n=await this.authenticator.authenticate(t),r=this.createOrUpdateUser(n,t.providerType);this.switchUser(r),e&&await r.refreshProfile(),this.storage.setUserIds(this.users.map((t=>t.id)),!0);const i=n.deviceId;return i&&"000000000000000000000000"!==i&&this.storage.set("deviceId",i),r}async removeUser(t){const e=this.users.findIndex((e=>e===t));if(-1===e)throw new Error("The user was never logged into this app");this.users.splice(e,1),await t.logOut(),this.storage.remove(`user(${t.id}):profile`),this.storage.removeUserId(t.id)}get currentUser(){const t=this.users.filter((t=>t.state===Ha.Active));return 0===t.length?null:t[0]}get allUsers(){return Object.fromEntries(this.users.map((t=>[t.id,t])))}get locationUrl(){if(!this._locationUrl){const t=Ua().app(this.id).location().path;this._locationUrl=this.fetcher.fetchJSON({method:"GET",url:this.baseUrl+t,tokenType:"none"}).then((({hostname:t})=>{if("string"!=typeof t)throw new Error("Expected response to contain a 'hostname'");return t})).catch((t=>{throw this._locationUrl=null,t}))}return this._locationUrl}get deviceInformation(){const t=this.storage.getDeviceId(),e="string"==typeof t&&"000000000000000000000000"!==t?new ua(t):void 0;return new cu({appId:this.localApp?this.localApp.name:void 0,appVersion:this.localApp?this.localApp.version:void 0,deviceId:e})}createOrUpdateUser(t,e){const n=this.users.find((e=>e.id===t.userId));if(n)return n.accessToken=t.accessToken,n.refreshToken=t.refreshToken,n;{if(!t.refreshToken)throw new Error("No refresh token in response from server");const n=new Za({app:this,id:t.userId,accessToken:t.accessToken,refreshToken:t.refreshToken,providerType:e});return this.users.unshift(n),n}}hydrate(){const t=this.storage.getUserIds();this.users=t.map((t=>new Za({app:this,id:t})))}}lu.appCache={},lu.Credentials=$a;const hu="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}:"undefined"!=typeof navigator?ga(navigator.userAgent):void 0!==la&&la.version?new function(t){this.version=t,this.type="node",this.name="node",this.os=la.platform}(la.version.slice(1)):null;const fu={defaultStorage:(new class{constructor(){if("object"!=typeof window)throw new Error("Cannot use LocalStorage without a global window object");this.window=window}get(t){return this.window.localStorage.getItem(t)}set(t,e){return this.window.localStorage.setItem(t,e)}remove(t){return this.window.localStorage.removeItem(t)}prefix(t){return new Ta(this,t)}clear(t){const e=[];for(let n=0;n<this.window.localStorage.length;n++){const r=this.window.localStorage.key(n);!r||t&&!r.startsWith(t)||e.push(r)}for(const t of e)this.window.localStorage.removeItem(t)}addListener(t){return this.window.addEventListener("storage",t)}removeListener(t){return this.window.removeEventListener("storage",t)}}).prefix("realm-web"),openWindow:t=>window.open(t),platform:(null==hu?void 0:hu.name)||"web",platformVersion:(null==hu?void 0:hu.version)||"0.0.0",TextDecoder};function pu(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function du(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){pu(o,r,i,s,a,"next",t)}function a(t){pu(o,r,i,s,a,"throw",t)}s(void 0)}))}}za=fu;var yu=new lu("brainsatplay-tvmdj"),vu="".concat(window.location.origin,"/"),gu=($a.google(vu),function(){var t=du(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.gapi.auth2.getAuthInstance().signIn();case 2:return e=t.sent,n=e.getAuthResponse(),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()),bu=function(){var t=du(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(n=yu.currentUser)||void 0===n||!n.isLoggedIn){t.next=4;break}r=yu.currentUser,t.next=9;break;case 4:return(i=$a.google(e.id_token)).payload.redirectUrl=vu,t.next=8,yu.logIn(i);case 8:r=t.sent;case 9:return t.next=11,r.refreshCustomData();case 11:return t.sent,t.abrupt("return",r);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function mu(t){return function(t){if(Array.isArray(t))return Ou(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Su(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(t,e)||Su(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _u(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Su(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Su(t,e){if(t){if("string"==typeof t)return Ou(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ou(t,e):void 0}}function Ou(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Eu(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Au(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Eu(o,r,i,s,a,"next",t)}function a(t){Eu(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Cu(t){return(Cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Iu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xu(t,e,n){return e&&Tu(t.prototype,e),n&&Tu(t,n),t}var ku=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://localhost.com";Iu(this,t),this.onconnected=function(){},this.ondisconnected=function(){},this.autoselectDevice=function(t){var e=t.device.replace(/[|&;$%@"<>()+,]/g,"").replace(" ",""),n=""!=t.variant?"".concat(e,"_").concat(t.variant):e;document.getElementById("brainsatplay-".concat(n)).click()},this.getDeviceData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eeg",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e.deviceStreams.forEach((function(e,i){if(e.info.deviceType.indexOf(t)>-1&&e.info.deviceNum===r)return"all"===n?e.atlas.data[t]:e.atlas.getDeviceDataByTag(t,n)}))},this.subscribe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eeg",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FP1",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){},o=void 0,s=n,a=null;return t.toLowerCase().indexOf("eeg")>-1||t.toLowerCase().indexOf("muse")>-1||t.toLowerCase().indexOf("notion")>-1?(a="eeg","shared"===s&&(s="eeghared")):t.toLowerCase().indexOf("heg")>-1&&(a="heg","shared"===s&&(s="hegshared")),null!==a&&e.deviceStreams.find((function(n,u){if(n.info.deviceName.indexOf(t)>-1&&!0===n.info.useAtlas){var c=void 0;return"string"==typeof s?s.indexOf("shared")>-1&&(c=n.device.atlas.getDeviceDataByTag(s,null)):c=null===s||"all"===s?n.device.atlas.data[a]:n.device.atlas.getDeviceDataByTag(a,s),void 0!==c&&(null===r||Array.isArray(c)||"object"!==Cu(c[r])?o=e.state.addToState(s,c,i):"object"===Cu(c[r])&&(o=e.state.addToState(s+"_"+r,c[r],i))),!0}})),o},this.unsubscribe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FP1",n=arguments.length>1?arguments[1]:void 0;e.state.unsubscribe(t,n)},this.unsubscribeAll=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FP1";e.state.unsubscribeAll(t)},this.getApp=function(){return lu.getApp("brainsatplay-tvmdj")},this.loginWithGoogle=Au(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,gu();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),this.loginWithRealm=function(){var t=Au(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bu(n);case 2:return r=t.sent,e.info.googleAuth=r,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.promptLogin=Au(regeneratorRuntime.mark((function t(){var n,r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:document.body,r=i.length>1&&void 0!==i[1]?i[1]:function(){},t.abrupt("return",new Promise((function(t,i){var o=new x((function(){return'\n\t\t<div id="'.concat(e.id,'login-page" class="brainsatplay-default-container" style="z-index: 1000; opacity: 0; transition: opacity 1s;">\n\t\t\t<div>\n\t\t\t\t<h2>Choose your Username</h2>\n\t\t\t\t<div id="').concat(e.id,'login-container" class="form-container">\n\t\t\t\t\t<div id="').concat(e.id,'login" class="form-context">\n\t\t\t\t\t\t<p id="').concat(e.id,'login-message" class="small"></p>\n\t\t\t\t\t\t<div class=\'flex\'>\n\t\t\t\t\t\t\t<form id="').concat(e.id,'login-form" action="">\n\t\t\t\t\t\t\t\t<div class="login-element" style="margin-left: 0px; margin-right: 0px">\n\t\t\t\t\t\t\t\t\t<input type="text" name="username" autocomplete="off" placeholder="Enter a username"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="login-buttons" style="justify-content: flex-start;">\n\t\t\t\t\t\t\t<div id="').concat(e.id,'login-button" class="brainsatplay-default-button">Sign In</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t')}),n,void 0,(function(){var n=document.getElementById("".concat(e.id,"login-page")),i=n.querySelector("[id='".concat(e.id,"login-button']")),s=n.querySelector("[id='".concat(e.id,"login-form']")),a=s.querySelector("input");s.addEventListener("keyup",(function(t){13===t.keyCode&&t.preventDefault()})),a.addEventListener("keyup",(function(t){13===t.keyCode&&(t.preventDefault(),i.click())})),i.onclick=function(){var n,i={},a=_u(new FormData(s).entries());try{for(a.s();!(n=a.n()).done;){var u=n.value;i[u[0]]=u[1]}}catch(t){a.e(t)}finally{a.f()}e.setLoginInfo(i.username),e.login(!0,e.info.auth,(function(){r(),t(!0),setTimeout((function(){o.deleteNode()}),1e3)}))},null!=e.info.googleAuth&&e.info.googleAuth.refreshCustomData().then((function(t){n.querySelector("[name='username']")[0].value=t.username,i.click()})),n.style.transition="opacity 1s",n.style.opacity="1"}))})));case 3:case"end":return t.stop()}}),t)}))),this.createBrainstormBrowser=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=1,i=function(){return'\n\t\t\t<div id="'.concat(e.id,'-brainstormBrowser" style="z-index: 1000; background: black; width:100%; height: 100%; position: absolute; top: 0; left: 0; display:flex; align-items: center; justify-content: center; opacity: 0;">\n\t\t\t\t<div id="').concat(e.id,'-choiceDisplay" style="flex-grow: 1;">\n\t\t\t\t\t<h1>Browse the Brainstorm</h1>\n\t\t\t\t\t<div style="display: flex;">\n\t\t\t\t\t\t<div id="').concat(e.id,'-userDiv" style="flex-grow: 1; overflow-y: scroll; border: 1px solid white;">\n\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="').concat(e.id,'-controlsDiv" style="overflow-y: scroll; width: 200px; display: flex; flex-wrap: wrap; justify-content: center;">\n\t\t\t\t\t\t\t<button name="users" class="brainsatplay-default-button" style="margin: 12.5px 25px;">WebSocket</button>\n\t\t\t\t\t\t\t<button name="osc" class="brainsatplay-default-button" style="margin: 12.5px 25px;">OSC</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button id="').concat(e.id,'-exitBrowser" class="brainsatplay-default-button" style="position: absolute; bottom:25px; right: 25px;">Go Back</button>\n\t\t\t</div>')},o=function(){var t=document.getElementById("".concat(e.id,"-brainstormBrowser")),i=t.querySelector("[id='".concat(e.id,"-userDiv']")),o=t.querySelector("[id='".concat(e.id,"-controlsDiv']")),a=o.querySelector("[name='users']"),u=o.querySelector("[name='osc']"),c=(o.querySelector("[name='lsl']"),function(){t.style.opacity="0",window.removeEventListener("resize",l),setTimeout((function(){s.deleteNode()}),1e3*r)}),l=function(){var t=document.getElementById("".concat(e.id,"-brainstormBrowser")),n=t.querySelector("[id='".concat(e.id,"-choiceDisplay']")),r=t.querySelector("[id='".concat(e.id,"-userDiv']"));t.style.padding="".concat(50,"px"),r.style.height="".concat(window.innerHeight-100-(n.offsetHeight-r.offsetHeight),"px")};t.querySelector("[id='".concat(e.id,"-exitBrowser']")).onclick=c,l(),window.addEventListener("resize",l),t.style.transition="opacity ".concat(r,"s"),t.style.opacity="1";var h=function(t,r){i.innerHTML="";var o="\n\t\t\t\tbackground: rgb(20,20,20);\n\t\t\t\tpadding: 25px;\n\t\t\t\tborder: 1px solid black;\n\t\t\t\ttransition: 0.5s;\n\t\t\t",s=function(){e.style.background="rgb(35,35,35)",e.style.cursor="pointer"},a=function(){e.style.background="rgb(20,20,20)",e.style.cursor="default"};r.forEach((function(t){var n=Object.keys(t),r=""==t[n[0]]?"Idle":"Currently in ".concat(t[n[0]]);t[n[1]]!==e.info.auth.username?i.innerHTML+='\n\t\t\t\t\t\t<div  id="'.concat(e.id,"-user-").concat(t[n[1]],'" class="brainstorm-user" style="').concat(o,'" onMouseOver="(').concat(s,')()" onMouseOut="(').concat(a,')()">\n\t\t\t\t\t\t<p style="font-size: 60%;">').concat(t[n[2]],"</p>\n\t\t\t\t\t\t<p>").concat(t[n[1]],'</p>\n\t\t\t\t\t\t<p style="font-size: 80%;">').concat(r,"</p>\n\t\t\t\t\t\t</div>"):i.insertAdjacentHTML("afterbegin",'\n\t\t\t\t\t\t<div  id="'.concat(e.id,"-user-").concat(t[n[1]],'" class="brainstorm-user" style="').concat(o,'">\n\t\t\t\t\t\t\t<p style="font-size: 60%;">').concat(t[n[2]],"</p>\n\t\t\t\t\t\t\t<p>").concat(t[n[1]],'</p>\n\t\t\t\t\t\t\t<p style="font-size: 80%;">').concat(r,"</p>\n\t\t\t\t\t\t</div>"))}));var u,l=_u(i.querySelectorAll(".brainstorm-user"));try{var h=function(){var r=u.value,i=r.id.split("".concat(e.id,"-user-"))[1];i!==e.info.auth.username&&(r.onclick=function(r){"ws"==t?e.subscribeToUser(i,[],(function(t){n(t)})):"osc"==t&&e.sendBrainstormCommand(["sendOSC",{test:"connected"}]),c()})};for(l.s();!(u=l.n()).done;)h()}catch(t){l.e(t)}finally{l.f()}};a.addEventListener("click",(function(){e.getUsers(null,(function(t){h("ws",t)}))})),u.addEventListener("click",(function(){e.startOSC(void 0,void 0,void 0,void 0,(function(t){console.log(t),h("osc",t)}))})),a.click()},s=new x(i,t,void 0,o)},this.createIntro=function(t){var n,r;document.getElementById("".concat(t.props.id)).innerHTML+="\n\t\t\t<div id='".concat(t.props.id,'appHero\' class="brainsatplay-default-container" style="z-index: 6;"><div>\n\t\t\t<h1>').concat(t.info.name,"</h1>\n\t\t\t<p>").concat(null!==(n=null!==(r=t.subtitle)&&void 0!==r?r:t.info.intro.subtitle)&&void 0!==n?n:"",'</p>\n\t\t\t<div class="brainsatplay-intro-loadingbar" style="z-index: 6;"></div>\n\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div id=\'').concat(t.props.id,'mode-screen\' class="brainsatplay-default-container" style="z-index: 5"><div>\n\t\t\t\t<h2>Game Mode</h2>\n\t\t\t\t<div style="display: flex; align-items: center;">\n\t\t\t\t\t\t<div id="').concat(t.props.id,'solo-button" class="brainsatplay-default-button">Solo</div>\n\t\t\t\t\t\t<div id="').concat(t.props.id,'multiplayer-button" class="brainsatplay-default-button">Multiplayer</div>\n\t\t\t\t</div>\n\t\t\t</div></div>\n\n\t\t\t<div id=\'').concat(t.props.id,'login-screen\' class="brainsatplay-default-container" style="z-index: 4"><div>\n\t\t\t\t<h2>Choose your Username</h2>\n\t\t\t\t<div id="').concat(t.props.id,'login-container" class="form-container">\n\t\t\t\t\t<div id="').concat(t.props.id,'login" class="form-context">\n\t\t\t\t\t\t<p id="').concat(t.props.id,'login-message" class="small"></p>\n\t\t\t\t\t\t<div class=\'flex\'>\n\t\t\t\t\t\t\t<form id="').concat(t.props.id,'login-form" action="">\n\t\t\t\t\t\t\t\t<div class="login-element" style="margin-left: 0px; margin-right: 0px">\n\t\t\t\t\t\t\t\t\t<input type="text" name="username" autocomplete="off" placeholder="Enter a username"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="login-buttons" style="justify-content: flex-start;">\n\t\t\t\t\t\t\t<div id="').concat(t.props.id,'login-button" class="brainsatplay-default-button">Sign In</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div></div>\n\n\t\t\t<div id=\'').concat(t.props.id,'sessionSelection\' class="brainsatplay-default-container" style="z-index: 3"><div>\n\t\t\t\t<div id=\'').concat(t.props.id,'multiplayerDiv\'">\n\t\t\t\t<div style="\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tcolumn-gap: 15px;\n\t\t\t\tgrid-template-columns: repeat(2,1fr)">\n\t\t\t\t\t<h2>Choose a Session</h2>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button id=\'').concat(t.props.id,'createSession\' class="brainsatplay-default-button" style="flex-grow:0; padding: 10px; width: auto; min-height: auto; font-size: 70%;">Make New Session</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div></div>\n\t\t\t<div id=\'').concat(t.props.id,'exitSession\' class="brainsatplay-default-button" style="position: absolute; bottom: 25px; right: 25px;">Exit Session</div>\n\t\t\t');var i=document.getElementById("".concat(t.props.id,"mode-screen")),o=document.getElementById("".concat(t.props.id,"login-screen")),s=document.getElementById("".concat(t.props.id,"sessionSelection")),a=document.getElementById("".concat(t.props.id,"exitSession")),u=(document.getElementById("".concat(t.props.id,"appHero")),document.querySelector(".brainsatplay-intro-loadingbar")),c=i.querySelector('[id="'.concat(t.props.id,'solo-button"]')),l=i.querySelector('[id="'.concat(t.props.id,'multiplayer-button"]'));c.onclick=function(){i.style.opacity=0,i.style.pointerEvents="none",s.style.display="none",o.style.display="none",a.style.display="none"},window.navigator.onLine?l.onclick=function(){i.style.opacity=0,i.style.pointerEvents="none"}:(l.style.opacity=.25,l.style.pointerEvents="none"),t.info.intro&&("single"===t.info.intro.mode&&c.click(),"multi"===t.info.intro.mode&&l.click());var h="".concat(t.props.id).concat(t.info.name);document.getElementById("".concat(t.props.id,"multiplayerDiv")).innerHTML+="<button id='".concat(h,'search\' class="brainsatplay-default-button">Search</button>'),document.getElementById("".concat(t.props.id,"multiplayerDiv")).innerHTML+="<div id='".concat(h,"browserContainer' style=\"box-sizing: border-box; padding: 10px 0px; overflow-y: hidden; height: 100%; width: 100%;\"><div id='").concat(h,"browser' style='display: flex; align-items: center; width: 100%; font-size: 80%; overflow-x: scroll; box-sizing: border-box; padding: 25px 5%;'></div></div>");var f=function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.includes(e.state.data.commandResult.msg)?r(e.state.data.commandResult.msg):setTimeout((function(){return t(n,r)}),250)},p=document.getElementById("".concat(h,"search"));p.onclick=function(){e.getSessions(t.info.name,(function(t){var n="";t.sessions.forEach((function(e,r){e.usernames.length<10?n+="<div><h3>"+e.id+"</h3><p>Streamers: "+e.usernames.length+"</p><div><button id='"+e.id+'connect\' style="margin-top: 5px;" class="brainsatplay-default-button">Connect</button><input id=\''+h+"spectate' type='checkbox' style=\"display: none\"></div></div>":t.sessions.splice(r,1)})),document.getElementById(h+"browser").innerHTML=n;t.sessions.forEach((function(t){document.getElementById("".concat(t.id,"connect")).addEventListener("click",(function(){!function(t){var n=!0;e.atlas.settings.deviceConnected&&(n=!1),e.subscribeToSession(t.id,n,(function(n){s.style.opacity=0,s.style.pointerEvents="none",a.addEventListener("click",(function(){e.unsubscribeFromSession(t.id,(function(){p.click(),s.style.opacity=1,s.style.pointerEvents="auto"}))}))}))}(t)}))}))}))};var d=document.getElementById("".concat(t.props.id,"login-button")),y=document.getElementById("".concat(t.props.id,"login-form")),v=y.querySelector("input");y.addEventListener("keyup",(function(t){13===t.keyCode&&t.preventDefault()})),v.addEventListener("keyup",(function(t){13===t.keyCode&&(t.preventDefault(),d.click())})),d.onclick=function(){var n,r=document.getElementById("".concat(t.props.id,"login-form")),i={},s=_u(new FormData(r).entries());try{for(s.s();!(n=s.n()).done;){var a=n.value;i[a[0]]=a[1]}}catch(t){s.e(t)}finally{s.f()}var u=function t(){if(1===e.socket.readyState){p.click();var n=e.state.subscribe("commandResult",(function(t){if("appNotFound"===t.msg){g.click();var r=e.state.subscribe("commandResult",(function(t){"sessionCreated"===t.msg&&(p.click(),o.style.opacity=0,o.style.pointerEvents="none",e.state.unsubscribe("commandResult",r))}));e.state.unsubscribe("commandResult",n)}else e.state.unsubscribe("commandResult",n),o.style.opacity=0,o.style.pointerEvents="none"}))}else setTimeout((function(){t()}),500)};e.setLoginInfo(i.username),e.login(!0).then((function(){u(e.socket)}))},null!=e.info.googleAuth&&e.info.googleAuth.refreshCustomData().then((function(t){document.getElementsByName("username")[0].value=t.username,d.click()})),a.onclick=function(){s.style.opacity=1,s.style.pointerEvents="auto"};var g=document.getElementById("".concat(t.props.id,"createSession"));g.onclick=function(){e.sendBrainstormCommand(["createSession",t.info.name,t.info.devices,Array.from(t.streams)]),f(["sessionCreated"],(function(){p.click()}))},p.style.display="none",setTimeout((function(){u.style.transition="transform ".concat(2,"s"),u.style.transform="scaleX(1)"}),1e3),setTimeout((function(){u&&(u.classList.add("ended"),u.style.transform="");var e=document.getElementById("".concat(t.props.id,"appHero"));e&&(e.style.opacity=0,e.style.pointerEvents="none")}),3e3)},this.kickUserFromSession=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};if(null!==e.socket&&1===e.socket.readyState){e.sendBrainstormCommand(["leaveSession",t,n]);var i=e.state.subscribe("commandResult",(function(o){if("leftSession"===o.msg&&o.id===t){for(var s in e.state.data)s.indexOf(n)>-1&&e.state.removeState(s);r(o),e.state.unsubscribe("commandResult",i)}}))}},this.waitForOpenConnection=function(t){return new Promise((function(e,n){var r=0,i=setInterval((function(){r>9?(clearInterval(i),n(new Error("Maximum number of attempts exceeded"))):t.readyState===t.OPEN&&(clearInterval(i),e()),r++}),200)}))},this.deviceStreams=[],this.state=new R({commandResult:{}}),this.atlas=new K("atlas",void 0,void 0,!0,!1),this.info={nDevices:0,auth:{url:new URL(i),username:n,password:r,authenticated:!1},subscriptions:[]},this.id=Math.floor(1e4*Math.random()),this.socket=null,this.streamObj=new Bu(this.info),this.streamObj.deviceStreams=this.deviceStreams,this.graphs=new Go(this)}var e,n,r,i,o,s;return xu(t,[{key:"setLoginInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.info.auth.username=t,this.info.auth.password=e}},{key:"connect",value:(s=Au(regeneratorRuntime.mark((function t(){var e,n,r,i,o,s,a,u,c,l,h=this,f=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=f.length>0&&void 0!==f[0]?f[0]:"freeeeg32_2",n=f.length>1&&void 0!==f[1]?f[1]:["eegfft"],r=f.length>2&&void 0!==f[2]?f[2]:function(){},i=f.length>3&&void 0!==f[3]?f[3]:function(){},o=f.length>4&&void 0!==f[4]&&f[4],s=f.length>5&&void 0!==f[5]?f[5]:[],a=!(f.length>6&&void 0!==f[6])||f[6],u=!(f.length>7&&void 0!==f[7])||f[7],!0!==o){t.next=12;break}if(null!=this.socket&&1===this.socket.readyState){t.next=12;break}return console.error("Server connection not found, please run login() first"),t.abrupt("return",!1);case 12:return this.deviceStreams.length>0&&(e.indexOf("eeg")>-1||e.indexOf("muse")>-1)&&(this.deviceStreams.find((function(t,e){if("eeg"===t.deviceType)return!0}))||(u=this.deviceStreams[0].device.atlas)),c=e.includes("brainstorm")?new Pu(e,n,a,u,this.info.auth,this):new Pu(e,n,a,u,this.info.auth),l=this.deviceStreams.length,c.onconnect=function(){h.deviceStreams.push(c),1===h.deviceStreams.length&&(h.atlas=h.deviceStreams[0].device.atlas),h.info.nDevices++,s[0]&&h.beginStream(s),h.state.addToState("device"+(l+1),c.info),r(c),h.onconnected()},c.ondisconnect=function(){i(c),h.ondisconnected(),c.info.analysis.length>0&&(c.device.atlas.analyzing=!1),h.deviceStreams.splice(l+1,1),h.deviceStreams.length>1&&(h.atlas=h.deviceStreams[0].device.atlas),h.info.nDevices--},t.next=19,c.init();case 19:return t.next=21,c.connect();case 21:return t.abrupt("return",c);case 22:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"reconnect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.deviceStreams.length-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};t>-1?(this.deviceStreams[t].connect(),e()):console.log("No devices connected")}},{key:"disconnect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.deviceStreams.length-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};t>-1?(this.deviceStreams[t].disconnect(),e()):console.log("No devices connected")}},{key:"connectDevice",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Au(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},a=function(){return'\n\t\t<div id="'.concat(t.id,'DeviceSelection"  class="brainsatplay-default-menu" style="z-index: 999; width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; opacity: 0; pointer-events: none; transition: opacity 1s;">\n\t\t\t<div style="width: 100%; height: 100%; background: black; opacity: 0.8; position: absolute; top: 0; left: 0;"></div>\n\t\t\t<div class="main" style="padding: 50px; width: 100%; height: 100%; position: absolute; top: 0; left: 0;">\n\t\t\t\t<div class="brainsatplay-header-grid"><h1>Device Manager</h1><button id="').concat(t.id,'deviceSelectionClose" class=\'brainsatplay-default-button\'>Close</button></div>\n\t\t\t\t<hr>\n\t\t\t\t<div class="brainsatplay-device-gallery" style="overflow-y: scroll;"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t')},u=function(){var e=document.getElementById("".concat(t.id,"DeviceSelection")),a=e.querySelector(".brainsatplay-device-gallery"),u=document.getElementById("".concat(t.id,"deviceSelectionClose")),c=function(){var t=e.querySelector(".main");a.style.height="".concat(window.innerHeight-parseInt(t.style.padding.replace("px",""))-a.offsetTop,"px")};c(),window.addEventListener("resize",c),u.onclick=function(){e.style.opacity="0",e.style.pointerEvents="none"},null!=r&&(Bi=Bi.filter((function(t){return r.includes(t.name)}))),Bi.sort((function(t,e){var n=function(t){return"Brains@Play"==t.company?0:"HEGAlpha"==t.company?1:"Neuroidss"==t.company?2:"OpenBCI"==t.company?3:"Neosensory"==t.company?4:"InteraXon"==t.company?5:3};return n(t)-n(e)})),Bi.forEach((function(e,n){null==e.variants&&(e.variants=[""]);var r=e.company.replace(/[|&;$%@"<>()+,]/g,""),i=a.querySelector('[name="'.concat(r,'"]'));i||((i=document.createElement("div")).classList.add("brainsatplay-companyCard"),i.setAttribute("name",r),i.innerHTML+="<h3>".concat(e.company,'</h3><div class="devices"></div>'),a.insertAdjacentElement("beforeend",i));var u=document.createElement("div");u.id="brainsatplay-device-".concat(e.id),u.classList.add("brainsatplay-deviceCard");var c=document.createElement("h4");c.id="brainsatplay-header-".concat(e.id),c.innerHTML=e.name,u.insertAdjacentElement("beforeend",c),u.innerHTML+='<div class="variants"></div>';var l=e.name.replace(/[|&;$%@"<>()+,]/g,"").replace(" ",""),h=document.createElement("div");h.classList.add("indicator"),u.insertAdjacentElement("beforeend",h),e.variants.forEach((function(n){var r=""!=n?"".concat(l,"_").concat(n):l,i=""!=n?"".concat(e.id,"_").concat(n):e.id,a=""!=n?n:"Connect",c=document.createElement("div");c.id="brainsatplay-".concat(r),c.classList.add("brainsatplay-variantButton"),c.innerHTML="<p>".concat(a,"</p>");var f=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?h.classList.add("on"):h.classList.remove("on")},p=function(e){o(),c.querySelector("p").innerHTML="Disconnect",f(!0),c.onclick=function(){t.disconnect()}},d=function n(r){s(),f(!1),c.querySelector("p").innerHTML=a,c.onclick=function(){t.connect(i,e.analysis,p,n)}};c.onclick=function(n){t.connect(i,e.analysis,p,d)},u.querySelector(".variants").insertAdjacentElement("beforeend",c)})),i.querySelector(".devices").insertAdjacentElement("beforeend",u)}));var l=function(){e.style.opacity="1",e.style.pointerEvents="auto"};if(null==n){var h=document.createElement("div");h.id="deviceManagerOpen",h.classList.add("brainsatplay-default-button"),h.style="\n\t\t\t\tposition: absolute; \n\t\t\t\tbottom: 25px; \n\t\t\t\tright: 25px;\n\t\t\t\tz-index: 100;\n\t\t\t",h.innerHTML="Open Device Manager",document.body.insertAdjacentElement("afterbegin",h),h.onclick=l}else n.onclick=l;null!=i&&t.autoselectDevice(i)},c=document.getElementById("".concat(this.id,"DeviceSelection"));null==c?new x(a,e,void 0,u):null!=i&&this.autoselectDevice(i)}},{key:"beginStream",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.streamObj.info.streaming||(t&&this.addStreamParams(t),this.streamObj.info.streaming=!0,this.streamObj.streamLoop())}},{key:"endStream",value:function(){this.streamObj.info.streaming=!1}},{key:"getDevice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FreeEEG32_2",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=void 0;return this.deviceStreams.find((function(r,i){return r.info.deviceName.indexOf(t)>-1&&r.info.deviceNum===e||r.info.deviceType.indexOf(t)>-1&&r.info.deviceNum===e?(n=r,!0):void 0})),n}},{key:"addAnalysisMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.data.device0.deviceName,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getDevice(e,n),i=r.info.analysis.find((function(e,n){if(e===t)return!0}));i||r.info.analysis.push(t),r.atlas.settings.analyzing||(r.atlas.settings.analyzing=!0,r.atlas.analyzer())}},{key:"stopAnalysis",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.deviceStreams.length>0?""!==e&&"string"==typeof e?this.atlas.settings.analysis.find((function(n,r){if(e===n)return t.atlas.settings.analysis.splice(r,1),!0})):this.atlas.settings.analyzing=!1:console.error("no devices connected")}},{key:"addAnalyzerFunc",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.deviceStreams.forEach((function(n,r){null!==n.device.atlas&&null!==t&&(n.device.atlas.analyzerOpts.indexOf(t)<0?(n.device.atlas.analyzerOpts.push(t),n.device.atlas.analyzerFuncs.push(e)):console.error("property "+t+" exists"))}))}},{key:"streamAppData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){},i="".concat(e);this.state.addToState(i,n,r),this.state.data[i+"_flag"]=!0,this.state.subscribe(i,(function(){t.state.data[i+"_flag"]=!0}));var o=function(){return!0===t.state.data[i+"_flag"]?(t.state.data[i+"_flag"]=!1,t.state.data[i]):void 0};return this.addStreamFunc(i,o),i}},{key:"removeStreaming",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state;if(null==e){n.removeState(t),n.removeState(t+"_flag"),this.streamObj.removeStreamFunc(t);var r=this.streamObj.info.appStreamParams.findIndex((function(e,n){return e.join("_")===t}));null!=r&&this.streamObj.info.appStreamParams.splice(r,1)}else n.unsubscribe(t,e)}},{key:"addStreamFunc",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state;if("string"==typeof t&&"function"==typeof e){var r=function(){var r=e();return null!=r&&(n.data[t]=r),r};this.streamObj.streamLoop(),this.streamObj.addStreamFunc(t,r),n===this.state?this.addStreamParams([[t]]):this.addStreamParams([[t,void 0,"ignore"]])}else console.error("addStreamFunc error")}},{key:"addStreamParams",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e,n){Array.isArray(e)&&(t.deviceStreams.find((function(n){if(e[0].indexOf(n.info.deviceType)>-1)return"eeg"===n.info.deviceType?n.atlas.data.eegshared.eegChannelTags.find((function(n){if(n.tag===e[1]||n.ch===e[1])return t.streamObj.info.deviceStreamParams.push(e),!0})):t.streamObj.info.deviceStreamParams.push(e),!0}))||t.streamObj.info.appStreamParams.push(e))}))}},{key:"login",value:(o=Au(regeneratorRuntime.mark((function t(){var e,n,r,i=this,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]&&o[0],n=o.length>1&&void 0!==o[1]?o[1]:this.info.auth,r=o.length>2&&void 0!==o[2]?o[2]:function(t){},null!=this.socket&&1===this.socket.readyState){t.next=7;break}this.socket=this.setupWebSocket(n).then((function(t){i.socket=t,i.info.auth.authenticated=!0,null!==i.socket&&1===i.socket.readyState&&!0===e&&i.beginStream();var n=i.state.subscribe("commandResult",(function(t){"object"===Cu(t)&&"resetUsername"===t.msg&&(i.info.auth.username=t.username,i.state.unsubscribe("commandResult",n),r(t))}))})),t.next=8;break;case 7:return t.abrupt("return",this.info.auth);case 8:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"signup",value:(i=Au(regeneratorRuntime.mark((function t(){var e,n,r,i,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:{},n=o.length>1&&void 0!==o[1]?o[1]:this.info.auth.url.toString(),n=this.checkURL(n),r=JSON.stringify(e),t.next=6,fetch(n.toString()+"signup",{method:"POST",mode:"cors",headers:new Headers({Accept:"application/json","Content-Type":"application/json"}),body:r}).then((function(t){return t.json().then((function(t){return t}))})).then((function(t){return console.log("\n"+t),t})).catch((function(t){console.error("\n"+t.message)}));case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"request",value:(r=Au(regeneratorRuntime.mark((function t(e){var n,r,i,o,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:"POST",r=s.length>2&&void 0!==s[2]?s[2]:"",i=s.length>3&&void 0!==s[3]?s[3]:this.info.auth.url.toString(),""===r){t.next=13;break}return i=this.checkURL(i),r=this.checkPathname(r),o={method:n,mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"}},"POST"===n&&(o.body=JSON.stringify(e)),t.next=10,fetch(i+r,o).then((function(t){return t.json().then((function(t){return t.message}))})).catch((function(t){console.error("\n"+t.message)}));case 10:return t.abrupt("return",t.sent);case 13:return console.error("You must provide a valid pathname to request resources from "+i),t.abrupt("return");case 15:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"processSocketMessage",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=JSON.parse(e);if(n.msg)if("userData"===n.msg)for(var r in n.userData)this.state.updateState("userData_"+n.username+"_"+r,n.userData[r]);else if("sessionData"===n.msg){if(n.userData.forEach((function(e,r){var i=e.username;for(var o in e)"username"!==o&&t.state.updateState("".concat(n.id,"_").concat(i,"_").concat(o),e[o])})),n.userLeft)for(var i in this.state.data)i.indexOf(n.userLeft)>-1&&this.state.removeState(i);this.state.updateState("commandResult",n)}else"getUsersResult"===n.msg||"getSessionDataResult"===n.msg||"getSessionInfoResult"===n.msg||"getSessionsResult"===n.msg||"sessionCreated"===n.msg||"subscribedToUser"===n.msg||"userNotFound"===n.msg||"subscribedToSession"===n.msg||"leftSession"===n.msg||"sessionDeleted"===n.msg||"unsubscribed"===n.msg||"appNotFound"===n.msg||"sessionNotFound"===n.msg||"resetUsername"===n.msg||"getUserDataResult"===n.msg||"oscError"===n.msg||"oscInfo"===n.msg?this.state.updateState("commandResult",n):"oscData"===n.msg?console.log(n.oscData):console.log(n);else console.log(e)}},{key:"setupWebSocket",value:(n=Au(regeneratorRuntime.mark((function t(){var e,n,r,i,o,s=this,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:this.info.auth,r=null,i=["username&"+(n=function(t){return t.replace(" ","%20")})(e.username),"password&"+n(e.password),"origin&"+n("brainsatplay.js")],"http:"!==e.url.protocol){t.next=8;break}r=new WebSocket("ws://"+e.url.host,i),t.next=14;break;case 8:if("https:"!==e.url.protocol){t.next=12;break}r=new WebSocket("wss://"+e.url.host,i),t.next=14;break;case 12:return console.log("invalid protocol"),t.abrupt("return");case 14:return o=new Promise((function(t,e){r.onerror=function(t){console.log("error",t)},r.onopen=function(){s.streamObj.socket=r,t(r)},r.onmessage=function(t){s.processSocketMessage(t.data)},r.onclose=function(t){console.log("close")}})),t.abrupt("return",o);case 16:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"subscribeToUser",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};if(null!==this.socket&&1===this.socket.readyState){this.sendBrainstormCommand(["getUserData",e]),n.forEach((function(n){var r=n;Array.isArray(r)&&(r=n.join("_")),t.state.updateState(e+"_"+r,null)}));var i=this.state.subscribe("commandResult",(function(o){if("object"===Cu(o))if("getUserDataResult"===o.msg){if(o.username===e){t.sendBrainstormCommand(["subscribeToUser",e,n]);for(var s=0,a=Object.entries(o.userData.props);s<a.length;s++){var u=wu(a[s],2),c=u[0],l=u[1];t.state.updateState("userData_"+e+"_"+c,l)}}r(o.userData),t.state.unsubscribe("commandResult",i)}else"userNotFound"===o.msg&&o.username===e&&(t.state.unsubscribe("commandResult",i),console.log("User not found: ",e))}))}}},{key:"unsubscribeFromUser",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};if(null!==this.socket&&1===this.socket.readyState){this.sendBrainstormCommand(["unsubscribeFromUser",e,n]);var i=this.state.subscribe("commandResult",(function(n){if("unsubscribed"===n.msg&&n.username===e){for(var o in t.state.data)o.indexOf(e)>-1&&t.state.removeState(o);r(n),t.state.unsubscribe("commandResult",i)}}))}}},{key:"getUsers",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){};if(null!==this.socket&&1===this.socket.readyState){this.sendBrainstormCommand(["getUsers",t]);var r=this.state.subscribe("commandResult",(function(i){if("object"===Cu(i)){if("getUsersResult"===i.msg)return n(i.userData),e.state.unsubscribe("commandResult",r),i.userData}else if("usersNotFound"===i.msg)return e.state.unsubscribe("commandResult",r),console.log("Users not found: ",t),[]}))}}},{key:"startOSC",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"127.0.0.1",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:57121,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(t){};null==r&&(r=e),null==i&&(i=n),this.sendBrainstormCommand(["startOSC",e,n,r,i]);var s=this.state.subscribe("commandResult",(function(e){if("object"===Cu(e)){if("oscInfo"===e.msg)return o(e.oscInfo),t.state.unsubscribe("commandResult",s),e.oscInfo}else if("oscError"===e.msg)return t.state.unsubscribe("commandResult",s),console.log("OSC Error",e.oscError),[]}))}},{key:"getSessions",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){};if(null!==this.socket&&1===this.socket.readyState){this.sendBrainstormCommand(["getSessions",t]);var r=this.state.subscribe("commandResult",(function(i){if("object"===Cu(i)){if("getSessionsResult"===i.msg&&i.appname===t)return n(i),e.state.unsubscribe("commandResult",r),i.sessions}else if("appNotFound"===i.msg&i.appname===t)return e.state.unsubscribe("commandResult",r),console.log("App not found: ",t),[]}))}}},{key:"subscribeToSession",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};if(console.log(this.info.auth.username),null!==this.socket&&1===this.socket.readyState){this.sendBrainstormCommand(["getSessionInfo",t]);var i=this.state.subscribe("commandResult",(function(o){if("object"===Cu(o))if("getSessionInfoResult"===o.msg&&o.sessionInfo.id===t){var s=!0;if(!1===n){var a=[];o.sessionInfo.propnames.forEach((function(t){a.push(t.split("_"))})),s=e.configureStreamForSession(o.sessionInfo.devices,a),r(o)}!0===s&&(e.sendBrainstormCommand(["subscribeToSession",t,n]),e.info.subscriptions.push(t),r(o)),e.state.unsubscribe("commandResult",i)}else"sessionNotFound"===o.msg&o.id===t&&(e.state.unsubscribe("commandResult",i),console.log("Session not found: ",t))}))}}},{key:"unsubscribeFromSession",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){};if(null!==this.socket&&1===this.socket.readyState){this.sendBrainstormCommand(["leaveSession",e]);var r=this.state.subscribe("commandResult",(function(i){if("leftSession"===i.msg&&i.id===e){for(var o in t.state.data)o.indexOf(e)>-1&&t.state.removeState(o);n(i),t.state.unsubscribe("commandResult",r)}}))}}},{key:"getBrainstormData",value:function(t){var e,n,r,i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"app",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default";"user"===s?(e=1,n=2,r=function(t){return"userData"===t.split("_")[0]}):(e=2,n=3,r=function(t){return"userData"!==t.split("_")[0]});var u=[];if(null!=t){var c=new RegExp(t),l=Object.keys(this.state.data).filter((function(t){var e=c.test(t),n=r(t),i=!1;if(o.forEach((function(e){t.includes(e)&&(i=!0)})),e&&n&&i)return!0})),h=[];l.forEach((function(t){var r=t.split("_");h.includes(r[e])||(h.push(r[e]),u.push({username:r[e]})),u.find((function(o){var s=r.slice(n).join("_");o.username===r[e]&&("plugin"===a?(o.value=i.state.data[t].value,o.label=s):o[s]=i.state.data[t])}))}));var f=u.length;u.push({username:this.info.auth.username}),o.forEach((function(t){"plugin"===a?(u[f].value=i.state.data[t].value,u[f].label=t):u[f][t]=i.state.data[t]}))}else console.error("please specify a query for the Brainstorm (app, username, prop)");return u}},{key:"configureStreamForSession",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=n;return 0===this.deviceStreams.length?(r.forEach((function(e){t.streamObj.deviceStreams.find((function(t){if(e[0].indexOf(t.info.deviceType)>-1)return!0}))||t.streamObj.info.appStreamParams.find((function(t){if(t.toString()===e.toString())return!0}))||t.streamObj.info.appStreamParams.push(e)})),!1===this.streamObj.info.streaming&&(this.streamObj.info.streaming=!0,this.streamObj.streamLoop())):e.forEach((function(e,n){t.deviceStreams.find((function(n,i){if(n.info.deviceType.toLowerCase()===e.toLowerCase()){var o,s=[];if(r.forEach((function(e){e[0].indexOf(n.info.deviceType)>-1&&!t.streamObj.info.deviceStreamParams.find((function(t){return t.toString()===e.toString()}))?"eeg"===n.info.deviceType.toLowerCase()?n.device.atlas.data.eegshared.eegChannelTags.find((function(t){if(t.tag===e[1]||t.ch===e[1])return s.push(e),!0})):s.push(e):t.streamObj.deviceStreams.find((function(t){if(e[0].indexOf(t.info.deviceType)>-1)return!0}))||t.streamObj.info.appStreamParams.find((function(t){if(t.toString()===e.toString())return!0}))||t.streamObj.info.appStreamParams.push(e)})),s.length>0||t.streamObj.info.appStreamParams.length>0)return(o=t.streamObj.info.deviceStreamParams).push.apply(o,s),!1===t.streamObj.info.streaming&&(t.streamObj.info.streaming=!0,t.streamObj.streamLoop()),!0}}))})),0!==this.streamObj.info.deviceStreamParams.length||0!==this.streamObj.info.appStreamParams.length||(console.error("Compatible device not found"),!1)}},{key:"sendBrainstormCommand",value:(e=Au(regeneratorRuntime.mark((function t(){var e,n,r,i,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:"",n=o.length>1&&void 0!==o[1]?o[1]:{},r={cmd:e,username:this.info.auth.username},Object.assign(r,n),i=JSON.stringify(r),1===this.socket.readyState){t.next=17;break}return t.prev=6,t.next=9,waitForOpenConnection(this.socket);case 9:this.socket.send(i),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),console.error(t.t0);case 15:t.next=18;break;case 17:this.socket.send(i);case 18:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(){return e.apply(this,arguments)})},{key:"closeSocket",value:function(){this.socket.close()}},{key:"onconnectionLost",value:function(t){var e=!1;this.info.subscriptions.find((function(n,r){if(n.username===t.username)return e=!0,!0})),!0===e&&(this.info.subscriptions.splice(0,1),this.info.nDevices--)}},{key:"checkURL",value:function(t){return"/"!==t.slice(-1)&&(t+="/"),t}},{key:"checkPathname",value:function(t){return"/"===t.slice(0)&&t.splice(0,1),t}}]),t}(),Pu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"freeeeg32_2",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["eegfft"],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{username:"guest"},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;Iu(this,t),Nu.call(this),this.info={deviceName:e,deviceType:null,analysis:n,session:s,deviceNum:0,googleAuth:null,auth:o,sps:null,useFilters:r,useAtlas:!1,simulating:!1},this.device=null,this.deviceConfigs=Bi,this.pipeToAtlas=i}return xu(t,[{key:"onconnect",value:function(){}},{key:"ondisconnect",value:function(){}}]),t}(),Nu=function(){var t=this;this.init=Au(regeneratorRuntime.mark((function e(){var n,r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:t.info,r=i.length>1&&void 0!==i[1]?i[1]:t.pipeToAtlas,e.abrupt("return",new Promise(function(){var e=Au(regeneratorRuntime.mark((function e(i,o){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=function(){return(s=Au(regeneratorRuntime.mark((function t(e,n){var r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.map(n),t.next=3,Promise.all(r);case 3:return i=t.sent,o=i.findIndex((function(t){return t})),t.abrupt("return",e[o]);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)},function(t,e){s.apply(this,arguments)}(t.deviceConfigs,function(){var e=Au(regeneratorRuntime.mark((function e(o,s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.deviceName.indexOf(o.id)>-1)){e.next=6;break}return n.deviceName.includes("brainstorm")?t.device=new o.cls(n.deviceName,n.session,t.onconnect,t.ondisconnect):t.device=new o.cls(n.deviceName,t.onconnect,t.ondisconnect),e.next=4,t.device.init(n,r);case 4:return i(!0),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)}))),this.connect=Au(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.device.connect();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.disconnect=function(){t.device.disconnect()}},Bu=function(){function t(e,n){var r=this;Iu(this,t),this.getDataForSocket=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[["prop","tag","arg1"]],n={};return e.forEach((function(e,i){r.streamTable.find((function(r,i){if(e[0]===r.prop){var o,s=0!==(o=t?[t].concat(mu(e.slice(1))):e.slice(1)).length?r.callback.apply(r,mu(o)):r.callback();return void 0!==s&&"ignore"!==e[2]&&(n[e.join("_")]=s),!0}}))})),n},this.streamLoop=function(){var t={username:r.info.auth.username,userData:{}};!0===r.info.streaming&&1===r.socket.readyState?(r.deviceStreams.forEach((function(e){r.info.nDevices<r.deviceStreams.length&&(t.userData.devices||(t.userData.devices=[]),t.userData.devices.push(e.info.deviceName),r.info.nDevices++);var n=[];r.info.deviceStreamParams.forEach((function(t,i){if(0===r.info.deviceStreamParams.length)return console.error("No stream parameters set"),!1;t[0].indexOf(e.info.deviceType)>-1&&n.push(t)})),n.length>0&&Object.assign(t.userData,r.getDataForSocket(e,n))})),Object.assign(t.userData,r.getDataForSocket(void 0,r.info.appStreamParams)),r.info.subscriptions.length>0&&Object.keys(t.userData).length>0&&r.socket.send(JSON.stringify(t)),r.info.streamCt++,setTimeout((function(){r.streamLoop()}),r.info.streamLoopTiming)):(r.getDataForSocket(void 0,r.info.appStreamParams),r.info.streamCt=0,setTimeout((function(){r.streamLoop()}),r.info.streamLoopTiming))},this.deviceStreams=[],this.info={auth:e.auth,subscriptions:e.subscriptions,streaming:!1,deviceStreamParams:[],nDevices:0,appStreamParams:[],streamCt:0,streamLoopTiming:50},this.streamTable=[],this.socket=n,this.configureDefaultStreamTable()}return xu(t,[{key:"configureDefaultStreamTable",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=n;if(!0!==t.info.useAtlas);else{var i=!1;if(void 0!==(i="number"==typeof e?t.atlas.getEEGDataByChannel(e):t.atlas.getEEGDataByTag(e))){if("all"===r){if(0===i.count)return;if(r=i.count-i.lastRead,i.lastRead=i.count,0===r)return}if(i.filtered.length>0){var o=i.times.slice(i.times.length-r,i.times.length),s=i.filtered.slice(i.filtered.length-r,i.filtered.length);return{times:o,samples:s}}if(i.raw.length>0){var a=i.times.slice(i.times.length-r,i.times.length),u=i.raw.slice(i.raw.length-r,i.raw.length);return{times:a,samples:u}}return}}},r=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=n;if(!0!==t.info.useAtlas);else{var i=!1;if(void 0!==(i="number"==typeof e?t.atlas.getEEGFFTData(e):t.atlas.getEEGDataByTag(e))){if("all"===r){if(0===i.fftCount)return;if(r=i.fftCount-i.lastReadFFT,i.lastReadFFT=i.fftCount,0===r)return}var o=i.fftTimes.slice(i.fftTimes.length-r,i.fftTimes.length),s=i.ffts.slice(i.ffts.length-r,i.ffts.length);return{times:o,ffts:s}}}},i=function(t,e){var n;if(!0===t.info.useAtlas)return void 0!==(n=t.atlas.getLatestFFTData(e)[0])?{time:n.time,bandpowers:n.mean}:void 0},o=function(t,e){var n;if(!0===t.info.useAtlas)return void 0!==(n=t.atlas.getLatestCoherenceData(e))?{time:n.time,bandpowers:n.mean}:void 0},s=function(t,e){var n;if(!0===t.info.useAtlas)return void 0!==(n=t.atlas.getLatestFFTData(e)[0])?{time:n.time,bandpowers:n.slice}:void 0},a=function(t,e){var n;if(!0===t.info.useAtlas)return void 0!==(n=t.atlas.getLatestCoherenceData(e)[0])?{time:n.time,bandpowers:n.slice}:void 0},u=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=n;if(!0!==t.info.useAtlas);else{var i=t.atlas.getCoherenceByTag(e);if(void 0!==i){if("all"===r){if(0===i.fftCount)return;if(r=i.fftCount-i.lastRead,i.lastRead=i.fftCount,0===r)return}var o=i.times.slice(i.fftTimes.length-r,i.fftTimes.length),s=i.ffts.slice(i.ffts.length-r,i.ffts.length);return{times:o,ffts:s}}}},c=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=r;if(!0!==(null==t||null===(e=t.info)||void 0===e?void 0:e.useAtlas));else{var s=t.atlas.getDeviceDataByTag("heg",n);if("all"===o&&(o=s.count-s.lastRead,s.lastRead=s.count,o<=0))return;if(void 0!==s){if(void 0!==i){var a=s.times.slice(s.times.length-o,s.times.length),u=s[i].slice(s.ffts.length-o,s.ffts.length),c={times:a};return c[i]=u,c}return s}}};this.streamTable=[{prop:"eegch",callback:n},{prop:"eegfft",callback:r},{prop:"eegcoherence",callback:u},{prop:"eegfftbands",callback:i},{prop:"eegcoherencebands",callback:o},{prop:"eegfftbandslices",callback:s},{prop:"eegcoherencebandslices",callback:a},{prop:"hegdata",callback:c}],e.length>0&&(t=this.streamTable).push.apply(t,mu(e))}},{key:"addStreamFunc",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.streamTable.push({prop:t,callback:e})}},{key:"removeStreamFunc",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.streamTable.find((function(n,r){if(n.prop===e)return t.streamTable.splice(r,1)}))}},{key:"configureStreamParams",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[["prop","tag"]],e=[];t.forEach((function(t,n){e.push(t.join("_"))})),this.sendBrainstormCommand(["addProps",e])}}]),t}();function Du(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ru(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ju=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ku,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];Du(this,t),this.session=r,this.parentNode=n,this.info=e,this.settings=i,this.AppletHTML=null,this.props={id:String(Math.floor(1e6*Math.random()))},this.session.graphs.add(this.props.id,this.info.name,this.info.graphs)}var e,n;return e=t,(n=[{key:"init",value:function(){var t=this,e=this.session.graphs.start(this.props.id);this.streams=e.streams,this.uiParams=e.uiParams,this.uiParams.HTMLtemplate='<div id="'.concat(this.props.id,'" style="height:100%; width:100%;">').concat(this.uiParams.HTMLtemplate,"</div>"),this.AppletHTML=new x(this.uiParams.HTMLtemplate,this.parentNode,this.props,(function(){null!=t.info.intro&&t.session.createIntro(t),console.log("setting up"),t.uiParams.setupHTML.forEach((function(e){e(t)}))}),void 0,"NEVER"),this.settings.length>0&&this.configure(this.settings)}},{key:"deinit",value:function(){this.session.graphs.stop(this.props.id),this.AppletHTML&&this.AppletHTML.deleteNode()}},{key:"responsive",value:function(){this.info.responsive instanceof Function&&this.info.responsive()}},{key:"configure",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t,e){}))}}])&&Ru(e.prototype,n),t}()})(),r})()}));